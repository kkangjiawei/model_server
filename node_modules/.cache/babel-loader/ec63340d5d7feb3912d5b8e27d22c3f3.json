{"remainingRequest":"/Users/admin/Downloads/vue-element-admin/node_modules/babel-loader/lib/index.js!/Users/admin/Downloads/vue-element-admin/src/utils/jquery.js","dependencies":[{"path":"/Users/admin/Downloads/vue-element-admin/src/utils/jquery.js","mtime":1677395941000},{"path":"/Users/admin/Downloads/vue-element-admin/babel.config.js","mtime":1677293736000},{"path":"/Users/admin/Downloads/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":1677293886000},{"path":"/Users/admin/Downloads/vue-element-admin/node_modules/babel-loader/lib/index.js","mtime":1677293894000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCIvVXNlcnMvYWRtaW4vRG93bmxvYWRzL3Z1ZS1lbGVtZW50LWFkbWluL25vZGVfbW9kdWxlcy9AdnVlL2NsaS1wbHVnaW4tYmFiZWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mLmpzIikuZGVmYXVsdDsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtcHJvdG90eXBlLW9mLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmxhdC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkudW5zY29wYWJsZXMuZmxhdC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5jb25zdHJ1Y3Rvci5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnN0aWNreS5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRlc3QuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyIpOwovKiEKICogalF1ZXJ5IEphdmFTY3JpcHQgTGlicmFyeSB2My41LjEKICogaHR0cHM6Ly9qcXVlcnkuY29tLwogKgogKiBJbmNsdWRlcyBTaXp6bGUuanMKICogaHR0cHM6Ly9zaXp6bGVqcy5jb20vCiAqCiAqIENvcHlyaWdodCBKUyBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMKICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlCiAqIGh0dHBzOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCiAqCiAqIERhdGU6IDIwMjAtMDUtMDRUMjI6NDlaCiAqLwooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgewogICJ1c2Ugc3RyaWN0IjsKCiAgaWYgKCh0eXBlb2YgbW9kdWxlID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihtb2R1bGUpKSA9PT0gIm9iamVjdCIgJiYgX3R5cGVvZihtb2R1bGUuZXhwb3J0cykgPT09ICJvYmplY3QiKSB7CiAgICAvLyBGb3IgQ29tbW9uSlMgYW5kIENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHdoZXJlIGEgcHJvcGVyIGB3aW5kb3dgCiAgICAvLyBpcyBwcmVzZW50LCBleGVjdXRlIHRoZSBmYWN0b3J5IGFuZCBnZXQgalF1ZXJ5LgogICAgLy8gRm9yIGVudmlyb25tZW50cyB0aGF0IGRvIG5vdCBoYXZlIGEgYHdpbmRvd2Agd2l0aCBhIGBkb2N1bWVudGAKICAgIC8vIChzdWNoIGFzIE5vZGUuanMpLCBleHBvc2UgYSBmYWN0b3J5IGFzIG1vZHVsZS5leHBvcnRzLgogICAgLy8gVGhpcyBhY2NlbnR1YXRlcyB0aGUgbmVlZCBmb3IgdGhlIGNyZWF0aW9uIG9mIGEgcmVhbCBgd2luZG93YC4KICAgIC8vIGUuZy4gdmFyIGpRdWVyeSA9IHJlcXVpcmUoImpxdWVyeSIpKHdpbmRvdyk7CiAgICAvLyBTZWUgdGlja2V0ICMxNDU0OSBmb3IgbW9yZSBpbmZvLgogICAgbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWwuZG9jdW1lbnQgPyBmYWN0b3J5KGdsb2JhbCwgdHJ1ZSkgOiBmdW5jdGlvbiAodykgewogICAgICBpZiAoIXcuZG9jdW1lbnQpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQiKTsKICAgICAgfQogICAgICByZXR1cm4gZmFjdG9yeSh3KTsKICAgIH07CiAgfSBlbHNlIHsKICAgIGZhY3RvcnkoZ2xvYmFsKTsKICB9CgogIC8vIFBhc3MgdGhpcyBpZiB3aW5kb3cgaXMgbm90IGRlZmluZWQgeWV0Cn0pKHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKHdpbmRvdywgbm9HbG9iYWwpIHsKICAvLyBFZGdlIDw9IDEyIC0gMTMrLCBGaXJlZm94IDw9MTggLSA0NSssIElFIDEwIC0gMTEsIFNhZmFyaSA1LjEgLSA5KywgaU9TIDYgLSA5LjEKICAvLyB0aHJvdyBleGNlcHRpb25zIHdoZW4gbm9uLXN0cmljdCBjb2RlIChlLmcuLCBBU1AuTkVUIDQuNSkgYWNjZXNzZXMgc3RyaWN0IG1vZGUKICAvLyBhcmd1bWVudHMuY2FsbGVlLmNhbGxlciAodHJhYy0xMzMzNSkuIEJ1dCBhcyBvZiBqUXVlcnkgMy4wICgyMDE2KSwgc3RyaWN0IG1vZGUgc2hvdWxkIGJlIGNvbW1vbgogIC8vIGVub3VnaCB0aGF0IGFsbCBzdWNoIGF0dGVtcHRzIGFyZSBndWFyZGVkIGluIGEgdHJ5IGJsb2NrLgogICJ1c2Ugc3RyaWN0IjsKCiAgdmFyIGFyciA9IFtdOwogIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjsKICB2YXIgX3NsaWNlID0gYXJyLnNsaWNlOwogIHZhciBmbGF0ID0gYXJyLmZsYXQgPyBmdW5jdGlvbiAoYXJyYXkpIHsKICAgIHJldHVybiBhcnIuZmxhdC5jYWxsKGFycmF5KTsKICB9IDogZnVuY3Rpb24gKGFycmF5KSB7CiAgICByZXR1cm4gYXJyLmNvbmNhdC5hcHBseShbXSwgYXJyYXkpOwogIH07CiAgdmFyIHB1c2ggPSBhcnIucHVzaDsKICB2YXIgaW5kZXhPZiA9IGFyci5pbmRleE9mOwogIHZhciBjbGFzczJ0eXBlID0ge307CiAgdmFyIHRvU3RyaW5nID0gY2xhc3MydHlwZS50b1N0cmluZzsKICB2YXIgaGFzT3duID0gY2xhc3MydHlwZS5oYXNPd25Qcm9wZXJ0eTsKICB2YXIgZm5Ub1N0cmluZyA9IGhhc093bi50b1N0cmluZzsKICB2YXIgT2JqZWN0RnVuY3Rpb25TdHJpbmcgPSBmblRvU3RyaW5nLmNhbGwoT2JqZWN0KTsKICB2YXIgc3VwcG9ydCA9IHt9OwogIHZhciBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gaXNGdW5jdGlvbihvYmopIHsKICAgIC8vIFN1cHBvcnQ6IENocm9tZSA8PTU3LCBGaXJlZm94IDw9NTIKICAgIC8vIEluIHNvbWUgYnJvd3NlcnMsIHR5cGVvZiByZXR1cm5zICJmdW5jdGlvbiIgZm9yIEhUTUwgPG9iamVjdD4gZWxlbWVudHMKICAgIC8vIChpLmUuLCBgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJvYmplY3QiICkgPT09ICJmdW5jdGlvbiJgKS4KICAgIC8vIFdlIGRvbid0IHdhbnQgdG8gY2xhc3NpZnkgKmFueSogRE9NIG5vZGUgYXMgYSBmdW5jdGlvbi4KICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBvYmoubm9kZVR5cGUgIT09ICJudW1iZXIiOwogIH07CiAgdmFyIGlzV2luZG93ID0gZnVuY3Rpb24gaXNXaW5kb3cob2JqKSB7CiAgICByZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09PSBvYmoud2luZG93OwogIH07CiAgdmFyIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50OwogIHZhciBwcmVzZXJ2ZWRTY3JpcHRBdHRyaWJ1dGVzID0gewogICAgdHlwZTogdHJ1ZSwKICAgIHNyYzogdHJ1ZSwKICAgIG5vbmNlOiB0cnVlLAogICAgbm9Nb2R1bGU6IHRydWUKICB9OwogIGZ1bmN0aW9uIERPTUV2YWwoY29kZSwgbm9kZSwgZG9jKSB7CiAgICBkb2MgPSBkb2MgfHwgZG9jdW1lbnQ7CiAgICB2YXIgaSwKICAgICAgdmFsLAogICAgICBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgICBzY3JpcHQudGV4dCA9IGNvZGU7CiAgICBpZiAobm9kZSkgewogICAgICBmb3IgKGkgaW4gcHJlc2VydmVkU2NyaXB0QXR0cmlidXRlcykgewogICAgICAgIC8vIFN1cHBvcnQ6IEZpcmVmb3ggNjQrLCBFZGdlIDE4KwogICAgICAgIC8vIFNvbWUgYnJvd3NlcnMgZG9uJ3Qgc3VwcG9ydCB0aGUgIm5vbmNlIiBwcm9wZXJ0eSBvbiBzY3JpcHRzLgogICAgICAgIC8vIE9uIHRoZSBvdGhlciBoYW5kLCBqdXN0IHVzaW5nIGBnZXRBdHRyaWJ1dGVgIGlzIG5vdCBlbm91Z2ggYXMKICAgICAgICAvLyB0aGUgYG5vbmNlYCBhdHRyaWJ1dGUgaXMgcmVzZXQgdG8gYW4gZW1wdHkgc3RyaW5nIHdoZW5ldmVyIGl0CiAgICAgICAgLy8gYmVjb21lcyBicm93c2luZy1jb250ZXh0IGNvbm5lY3RlZC4KICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3doYXR3Zy9odG1sL2lzc3Vlcy8yMzY5CiAgICAgICAgLy8gU2VlIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvI25vbmNlLWF0dHJpYnV0ZXMKICAgICAgICAvLyBUaGUgYG5vZGUuZ2V0QXR0cmlidXRlYCBjaGVjayB3YXMgYWRkZWQgZm9yIHRoZSBzYWtlIG9mCiAgICAgICAgLy8gYGpRdWVyeS5nbG9iYWxFdmFsYCBzbyB0aGF0IGl0IGNhbiBmYWtlIGEgbm9uY2UtY29udGFpbmluZyBub2RlCiAgICAgICAgLy8gdmlhIGFuIG9iamVjdC4KICAgICAgICB2YWwgPSBub2RlW2ldIHx8IG5vZGUuZ2V0QXR0cmlidXRlICYmIG5vZGUuZ2V0QXR0cmlidXRlKGkpOwogICAgICAgIGlmICh2YWwpIHsKICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUoaSwgdmFsKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGRvYy5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpOwogIH0KICBmdW5jdGlvbiB0b1R5cGUob2JqKSB7CiAgICBpZiAob2JqID09IG51bGwpIHsKICAgICAgcmV0dXJuIG9iaiArICIiOwogICAgfQoKICAgIC8vIFN1cHBvcnQ6IEFuZHJvaWQgPD0yLjMgb25seSAoZnVuY3Rpb25pc2ggUmVnRXhwKQogICAgcmV0dXJuIF90eXBlb2Yob2JqKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIG9iaiA9PT0gImZ1bmN0aW9uIiA/IGNsYXNzMnR5cGVbdG9TdHJpbmcuY2FsbChvYmopXSB8fCAib2JqZWN0IiA6IF90eXBlb2Yob2JqKTsKICB9CiAgLyogZ2xvYmFsIFN5bWJvbCAqLwogIC8vIERlZmluaW5nIHRoaXMgZ2xvYmFsIGluIC5lc2xpbnRyYy5qc29uIHdvdWxkIGNyZWF0ZSBhIGRhbmdlciBvZiB1c2luZyB0aGUgZ2xvYmFsCiAgLy8gdW5ndWFyZGVkIGluIGFub3RoZXIgcGxhY2UsIGl0IHNlZW1zIHNhZmVyIHRvIGRlZmluZSBnbG9iYWwgb25seSBmb3IgdGhpcyBtb2R1bGUKCiAgdmFyIHZlcnNpb24gPSAiMy41LjEiLAogICAgLy8gRGVmaW5lIGEgbG9jYWwgY29weSBvZiBqUXVlcnkKICAgIGpRdWVyeSA9IGZ1bmN0aW9uIGpRdWVyeShzZWxlY3RvciwgY29udGV4dCkgewogICAgICAvLyBUaGUgalF1ZXJ5IG9iamVjdCBpcyBhY3R1YWxseSBqdXN0IHRoZSBpbml0IGNvbnN0cnVjdG9yICdlbmhhbmNlZCcKICAgICAgLy8gTmVlZCBpbml0IGlmIGpRdWVyeSBpcyBjYWxsZWQgKGp1c3QgYWxsb3cgZXJyb3IgdG8gYmUgdGhyb3duIGlmIG5vdCBpbmNsdWRlZCkKICAgICAgcmV0dXJuIG5ldyBqUXVlcnkuZm4uaW5pdChzZWxlY3RvciwgY29udGV4dCk7CiAgICB9OwogIGpRdWVyeS5mbiA9IGpRdWVyeS5wcm90b3R5cGUgPSB7CiAgICAvLyBUaGUgY3VycmVudCB2ZXJzaW9uIG9mIGpRdWVyeSBiZWluZyB1c2VkCiAgICBqcXVlcnk6IHZlcnNpb24sCiAgICBjb25zdHJ1Y3RvcjogalF1ZXJ5LAogICAgLy8gVGhlIGRlZmF1bHQgbGVuZ3RoIG9mIGEgalF1ZXJ5IG9iamVjdCBpcyAwCiAgICBsZW5ndGg6IDAsCiAgICB0b0FycmF5OiBmdW5jdGlvbiB0b0FycmF5KCkgewogICAgICByZXR1cm4gX3NsaWNlLmNhbGwodGhpcyk7CiAgICB9LAogICAgLy8gR2V0IHRoZSBOdGggZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldCBPUgogICAgLy8gR2V0IHRoZSB3aG9sZSBtYXRjaGVkIGVsZW1lbnQgc2V0IGFzIGEgY2xlYW4gYXJyYXkKICAgIGdldDogZnVuY3Rpb24gZ2V0KG51bSkgewogICAgICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBpbiBhIGNsZWFuIGFycmF5CiAgICAgIGlmIChudW0gPT0gbnVsbCkgewogICAgICAgIHJldHVybiBfc2xpY2UuY2FsbCh0aGlzKTsKICAgICAgfQoKICAgICAgLy8gUmV0dXJuIGp1c3QgdGhlIG9uZSBlbGVtZW50IGZyb20gdGhlIHNldAogICAgICByZXR1cm4gbnVtIDwgMCA/IHRoaXNbbnVtICsgdGhpcy5sZW5ndGhdIDogdGhpc1tudW1dOwogICAgfSwKICAgIC8vIFRha2UgYW4gYXJyYXkgb2YgZWxlbWVudHMgYW5kIHB1c2ggaXQgb250byB0aGUgc3RhY2sKICAgIC8vIChyZXR1cm5pbmcgdGhlIG5ldyBtYXRjaGVkIGVsZW1lbnQgc2V0KQogICAgcHVzaFN0YWNrOiBmdW5jdGlvbiBwdXNoU3RhY2soZWxlbXMpIHsKICAgICAgLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKICAgICAgdmFyIHJldCA9IGpRdWVyeS5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksIGVsZW1zKTsKCiAgICAgIC8vIEFkZCB0aGUgb2xkIG9iamVjdCBvbnRvIHRoZSBzdGFjayAoYXMgYSByZWZlcmVuY2UpCiAgICAgIHJldC5wcmV2T2JqZWN0ID0gdGhpczsKCiAgICAgIC8vIFJldHVybiB0aGUgbmV3bHktZm9ybWVkIGVsZW1lbnQgc2V0CiAgICAgIHJldHVybiByZXQ7CiAgICB9LAogICAgLy8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC4KICAgIGVhY2g6IGZ1bmN0aW9uIGVhY2goY2FsbGJhY2spIHsKICAgICAgcmV0dXJuIGpRdWVyeS5lYWNoKHRoaXMsIGNhbGxiYWNrKTsKICAgIH0sCiAgICBtYXA6IGZ1bmN0aW9uIG1hcChjYWxsYmFjaykgewogICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5Lm1hcCh0aGlzLCBmdW5jdGlvbiAoZWxlbSwgaSkgewogICAgICAgIHJldHVybiBjYWxsYmFjay5jYWxsKGVsZW0sIGksIGVsZW0pOwogICAgICB9KSk7CiAgICB9LAogICAgc2xpY2U6IGZ1bmN0aW9uIHNsaWNlKCkgewogICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soX3NsaWNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogICAgfSwKICAgIGZpcnN0OiBmdW5jdGlvbiBmaXJzdCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZXEoMCk7CiAgICB9LAogICAgbGFzdDogZnVuY3Rpb24gbGFzdCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZXEoLTEpOwogICAgfSwKICAgIGV2ZW46IGZ1bmN0aW9uIGV2ZW4oKSB7CiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhqUXVlcnkuZ3JlcCh0aGlzLCBmdW5jdGlvbiAoX2VsZW0sIGkpIHsKICAgICAgICByZXR1cm4gKGkgKyAxKSAlIDI7CiAgICAgIH0pKTsKICAgIH0sCiAgICBvZGQ6IGZ1bmN0aW9uIG9kZCgpIHsKICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGpRdWVyeS5ncmVwKHRoaXMsIGZ1bmN0aW9uIChfZWxlbSwgaSkgewogICAgICAgIHJldHVybiBpICUgMjsKICAgICAgfSkpOwogICAgfSwKICAgIGVxOiBmdW5jdGlvbiBlcShpKSB7CiAgICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aCwKICAgICAgICBqID0gK2kgKyAoaSA8IDAgPyBsZW4gOiAwKTsKICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGogPj0gMCAmJiBqIDwgbGVuID8gW3RoaXNbal1dIDogW10pOwogICAgfSwKICAgIGVuZDogZnVuY3Rpb24gZW5kKCkgewogICAgICByZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IoKTsKICAgIH0sCiAgICAvLyBGb3IgaW50ZXJuYWwgdXNlIG9ubHkuCiAgICAvLyBCZWhhdmVzIGxpa2UgYW4gQXJyYXkncyBtZXRob2QsIG5vdCBsaWtlIGEgalF1ZXJ5IG1ldGhvZC4KICAgIHB1c2g6IHB1c2gsCiAgICBzb3J0OiBhcnIuc29ydCwKICAgIHNwbGljZTogYXJyLnNwbGljZQogIH07CiAgalF1ZXJ5LmV4dGVuZCA9IGpRdWVyeS5mbi5leHRlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgb3B0aW9ucywKICAgICAgbmFtZSwKICAgICAgc3JjLAogICAgICBjb3B5LAogICAgICBjb3B5SXNBcnJheSwKICAgICAgY2xvbmUsCiAgICAgIHRhcmdldCA9IGFyZ3VtZW50c1swXSB8fCB7fSwKICAgICAgaSA9IDEsCiAgICAgIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsCiAgICAgIGRlZXAgPSBmYWxzZTsKCiAgICAvLyBIYW5kbGUgYSBkZWVwIGNvcHkgc2l0dWF0aW9uCiAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4iKSB7CiAgICAgIGRlZXAgPSB0YXJnZXQ7CgogICAgICAvLyBTa2lwIHRoZSBib29sZWFuIGFuZCB0aGUgdGFyZ2V0CiAgICAgIHRhcmdldCA9IGFyZ3VtZW50c1tpXSB8fCB7fTsKICAgICAgaSsrOwogICAgfQoKICAgIC8vIEhhbmRsZSBjYXNlIHdoZW4gdGFyZ2V0IGlzIGEgc3RyaW5nIG9yIHNvbWV0aGluZyAocG9zc2libGUgaW4gZGVlcCBjb3B5KQogICAgaWYgKF90eXBlb2YodGFyZ2V0KSAhPT0gIm9iamVjdCIgJiYgIWlzRnVuY3Rpb24odGFyZ2V0KSkgewogICAgICB0YXJnZXQgPSB7fTsKICAgIH0KCiAgICAvLyBFeHRlbmQgalF1ZXJ5IGl0c2VsZiBpZiBvbmx5IG9uZSBhcmd1bWVudCBpcyBwYXNzZWQKICAgIGlmIChpID09PSBsZW5ndGgpIHsKICAgICAgdGFyZ2V0ID0gdGhpczsKICAgICAgaS0tOwogICAgfQogICAgZm9yICg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAvLyBPbmx5IGRlYWwgd2l0aCBub24tbnVsbC91bmRlZmluZWQgdmFsdWVzCiAgICAgIGlmICgob3B0aW9ucyA9IGFyZ3VtZW50c1tpXSkgIT0gbnVsbCkgewogICAgICAgIC8vIEV4dGVuZCB0aGUgYmFzZSBvYmplY3QKICAgICAgICBmb3IgKG5hbWUgaW4gb3B0aW9ucykgewogICAgICAgICAgY29weSA9IG9wdGlvbnNbbmFtZV07CgogICAgICAgICAgLy8gUHJldmVudCBPYmplY3QucHJvdG90eXBlIHBvbGx1dGlvbgogICAgICAgICAgLy8gUHJldmVudCBuZXZlci1lbmRpbmcgbG9vcAogICAgICAgICAgaWYgKG5hbWUgPT09ICJfX3Byb3RvX18iIHx8IHRhcmdldCA9PT0gY29weSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKICAgICAgICAgIGlmIChkZWVwICYmIGNvcHkgJiYgKGpRdWVyeS5pc1BsYWluT2JqZWN0KGNvcHkpIHx8IChjb3B5SXNBcnJheSA9IEFycmF5LmlzQXJyYXkoY29weSkpKSkgewogICAgICAgICAgICBzcmMgPSB0YXJnZXRbbmFtZV07CgogICAgICAgICAgICAvLyBFbnN1cmUgcHJvcGVyIHR5cGUgZm9yIHRoZSBzb3VyY2UgdmFsdWUKICAgICAgICAgICAgaWYgKGNvcHlJc0FycmF5ICYmICFBcnJheS5pc0FycmF5KHNyYykpIHsKICAgICAgICAgICAgICBjbG9uZSA9IFtdOwogICAgICAgICAgICB9IGVsc2UgaWYgKCFjb3B5SXNBcnJheSAmJiAhalF1ZXJ5LmlzUGxhaW5PYmplY3Qoc3JjKSkgewogICAgICAgICAgICAgIGNsb25lID0ge307CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY2xvbmUgPSBzcmM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29weUlzQXJyYXkgPSBmYWxzZTsKCiAgICAgICAgICAgIC8vIE5ldmVyIG1vdmUgb3JpZ2luYWwgb2JqZWN0cywgY2xvbmUgdGhlbQogICAgICAgICAgICB0YXJnZXRbbmFtZV0gPSBqUXVlcnkuZXh0ZW5kKGRlZXAsIGNsb25lLCBjb3B5KTsKCiAgICAgICAgICAgIC8vIERvbid0IGJyaW5nIGluIHVuZGVmaW5lZCB2YWx1ZXMKICAgICAgICAgIH0gZWxzZSBpZiAoY29weSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHRhcmdldFtuYW1lXSA9IGNvcHk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgLy8gUmV0dXJuIHRoZSBtb2RpZmllZCBvYmplY3QKICAgIHJldHVybiB0YXJnZXQ7CiAgfTsKICBqUXVlcnkuZXh0ZW5kKHsKICAgIC8vIFVuaXF1ZSBmb3IgZWFjaCBjb3B5IG9mIGpRdWVyeSBvbiB0aGUgcGFnZQogICAgZXhwYW5kbzogImpRdWVyeSIgKyAodmVyc2lvbiArIE1hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csICIiKSwKICAgIC8vIEFzc3VtZSBqUXVlcnkgaXMgcmVhZHkgd2l0aG91dCB0aGUgcmVhZHkgbW9kdWxlCiAgICBpc1JlYWR5OiB0cnVlLAogICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKG1zZykgewogICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTsKICAgIH0sCiAgICBub29wOiBmdW5jdGlvbiBub29wKCkge30sCiAgICBpc1BsYWluT2JqZWN0OiBmdW5jdGlvbiBpc1BsYWluT2JqZWN0KG9iaikgewogICAgICB2YXIgcHJvdG8sIEN0b3I7CgogICAgICAvLyBEZXRlY3Qgb2J2aW91cyBuZWdhdGl2ZXMKICAgICAgLy8gVXNlIHRvU3RyaW5nIGluc3RlYWQgb2YgalF1ZXJ5LnR5cGUgdG8gY2F0Y2ggaG9zdCBvYmplY3RzCiAgICAgIGlmICghb2JqIHx8IHRvU3RyaW5nLmNhbGwob2JqKSAhPT0gIltvYmplY3QgT2JqZWN0XSIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcHJvdG8gPSBnZXRQcm90byhvYmopOwoKICAgICAgLy8gT2JqZWN0cyB3aXRoIG5vIHByb3RvdHlwZSAoZS5nLiwgYE9iamVjdC5jcmVhdGUoIG51bGwgKWApIGFyZSBwbGFpbgogICAgICBpZiAoIXByb3RvKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIC8vIE9iamVjdHMgd2l0aCBwcm90b3R5cGUgYXJlIHBsYWluIGlmZiB0aGV5IHdlcmUgY29uc3RydWN0ZWQgYnkgYSBnbG9iYWwgT2JqZWN0IGZ1bmN0aW9uCiAgICAgIEN0b3IgPSBoYXNPd24uY2FsbChwcm90bywgImNvbnN0cnVjdG9yIikgJiYgcHJvdG8uY29uc3RydWN0b3I7CiAgICAgIHJldHVybiB0eXBlb2YgQ3RvciA9PT0gImZ1bmN0aW9uIiAmJiBmblRvU3RyaW5nLmNhbGwoQ3RvcikgPT09IE9iamVjdEZ1bmN0aW9uU3RyaW5nOwogICAgfSwKICAgIGlzRW1wdHlPYmplY3Q6IGZ1bmN0aW9uIGlzRW1wdHlPYmplY3Qob2JqKSB7CiAgICAgIHZhciBuYW1lOwogICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgIC8vIEV2YWx1YXRlcyBhIHNjcmlwdCBpbiBhIHByb3ZpZGVkIGNvbnRleHQ7IGZhbGxzIGJhY2sgdG8gdGhlIGdsb2JhbCBvbmUKICAgIC8vIGlmIG5vdCBzcGVjaWZpZWQuCiAgICBnbG9iYWxFdmFsOiBmdW5jdGlvbiBnbG9iYWxFdmFsKGNvZGUsIG9wdGlvbnMsIGRvYykgewogICAgICBET01FdmFsKGNvZGUsIHsKICAgICAgICBub25jZTogb3B0aW9ucyAmJiBvcHRpb25zLm5vbmNlCiAgICAgIH0sIGRvYyk7CiAgICB9LAogICAgZWFjaDogZnVuY3Rpb24gZWFjaChvYmosIGNhbGxiYWNrKSB7CiAgICAgIHZhciBsZW5ndGgsCiAgICAgICAgaSA9IDA7CiAgICAgIGlmIChpc0FycmF5TGlrZShvYmopKSB7CiAgICAgICAgbGVuZ3RoID0gb2JqLmxlbmd0aDsKICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChvYmpbaV0sIGksIG9ialtpXSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgaW4gb2JqKSB7CiAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChvYmpbaV0sIGksIG9ialtpXSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gb2JqOwogICAgfSwKICAgIC8vIHJlc3VsdHMgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHkKICAgIG1ha2VBcnJheTogZnVuY3Rpb24gbWFrZUFycmF5KGFyciwgcmVzdWx0cykgewogICAgICB2YXIgcmV0ID0gcmVzdWx0cyB8fCBbXTsKICAgICAgaWYgKGFyciAhPSBudWxsKSB7CiAgICAgICAgaWYgKGlzQXJyYXlMaWtlKE9iamVjdChhcnIpKSkgewogICAgICAgICAgalF1ZXJ5Lm1lcmdlKHJldCwgdHlwZW9mIGFyciA9PT0gInN0cmluZyIgPyBbYXJyXSA6IGFycik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHB1c2guY2FsbChyZXQsIGFycik7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXQ7CiAgICB9LAogICAgaW5BcnJheTogZnVuY3Rpb24gaW5BcnJheShlbGVtLCBhcnIsIGkpIHsKICAgICAgcmV0dXJuIGFyciA9PSBudWxsID8gLTEgOiBpbmRleE9mLmNhbGwoYXJyLCBlbGVtLCBpKTsKICAgIH0sCiAgICAvLyBTdXBwb3J0OiBBbmRyb2lkIDw9NC4wIG9ubHksIFBoYW50b21KUyAxIG9ubHkKICAgIC8vIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Mgb24gYW5jaWVudCBXZWJLaXQKICAgIG1lcmdlOiBmdW5jdGlvbiBtZXJnZShmaXJzdCwgc2Vjb25kKSB7CiAgICAgIHZhciBsZW4gPSArc2Vjb25kLmxlbmd0aCwKICAgICAgICBqID0gMCwKICAgICAgICBpID0gZmlyc3QubGVuZ3RoOwogICAgICBmb3IgKDsgaiA8IGxlbjsgaisrKSB7CiAgICAgICAgZmlyc3RbaSsrXSA9IHNlY29uZFtqXTsKICAgICAgfQogICAgICBmaXJzdC5sZW5ndGggPSBpOwogICAgICByZXR1cm4gZmlyc3Q7CiAgICB9LAogICAgZ3JlcDogZnVuY3Rpb24gZ3JlcChlbGVtcywgY2FsbGJhY2ssIGludmVydCkgewogICAgICB2YXIgY2FsbGJhY2tJbnZlcnNlLAogICAgICAgIG1hdGNoZXMgPSBbXSwKICAgICAgICBpID0gMCwKICAgICAgICBsZW5ndGggPSBlbGVtcy5sZW5ndGgsCiAgICAgICAgY2FsbGJhY2tFeHBlY3QgPSAhaW52ZXJ0OwoKICAgICAgLy8gR28gdGhyb3VnaCB0aGUgYXJyYXksIG9ubHkgc2F2aW5nIHRoZSBpdGVtcwogICAgICAvLyB0aGF0IHBhc3MgdGhlIHZhbGlkYXRvciBmdW5jdGlvbgogICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2FsbGJhY2tJbnZlcnNlID0gIWNhbGxiYWNrKGVsZW1zW2ldLCBpKTsKICAgICAgICBpZiAoY2FsbGJhY2tJbnZlcnNlICE9PSBjYWxsYmFja0V4cGVjdCkgewogICAgICAgICAgbWF0Y2hlcy5wdXNoKGVsZW1zW2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG1hdGNoZXM7CiAgICB9LAogICAgLy8gYXJnIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CiAgICBtYXA6IGZ1bmN0aW9uIG1hcChlbGVtcywgY2FsbGJhY2ssIGFyZykgewogICAgICB2YXIgbGVuZ3RoLAogICAgICAgIHZhbHVlLAogICAgICAgIGkgPSAwLAogICAgICAgIHJldCA9IFtdOwoKICAgICAgLy8gR28gdGhyb3VnaCB0aGUgYXJyYXksIHRyYW5zbGF0aW5nIGVhY2ggb2YgdGhlIGl0ZW1zIHRvIHRoZWlyIG5ldyB2YWx1ZXMKICAgICAgaWYgKGlzQXJyYXlMaWtlKGVsZW1zKSkgewogICAgICAgIGxlbmd0aCA9IGVsZW1zLmxlbmd0aDsKICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YWx1ZSA9IGNhbGxiYWNrKGVsZW1zW2ldLCBpLCBhcmcpOwogICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0LnB1c2godmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gR28gdGhyb3VnaCBldmVyeSBrZXkgb24gdGhlIG9iamVjdCwKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgaW4gZWxlbXMpIHsKICAgICAgICAgIHZhbHVlID0gY2FsbGJhY2soZWxlbXNbaV0sIGksIGFyZyk7CiAgICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgICAgICByZXQucHVzaCh2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCiAgICAgIHJldHVybiBmbGF0KHJldCk7CiAgICB9LAogICAgLy8gQSBnbG9iYWwgR1VJRCBjb3VudGVyIGZvciBvYmplY3RzCiAgICBndWlkOiAxLAogICAgLy8galF1ZXJ5LnN1cHBvcnQgaXMgbm90IHVzZWQgaW4gQ29yZSBidXQgb3RoZXIgcHJvamVjdHMgYXR0YWNoIHRoZWlyCiAgICAvLyBwcm9wZXJ0aWVzIHRvIGl0IHNvIGl0IG5lZWRzIHRvIGV4aXN0LgogICAgc3VwcG9ydDogc3VwcG9ydAogIH0pOwogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iKSB7CiAgICBqUXVlcnkuZm5bU3ltYm9sLml0ZXJhdG9yXSA9IGFycltTeW1ib2wuaXRlcmF0b3JdOwogIH0KCiAgLy8gUG9wdWxhdGUgdGhlIGNsYXNzMnR5cGUgbWFwCiAgalF1ZXJ5LmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCgiICIpLCBmdW5jdGlvbiAoX2ksIG5hbWUpIHsKICAgIGNsYXNzMnR5cGVbIltvYmplY3QgIiArIG5hbWUgKyAiXSJdID0gbmFtZS50b0xvd2VyQ2FzZSgpOwogIH0pOwogIGZ1bmN0aW9uIGlzQXJyYXlMaWtlKG9iaikgewogICAgLy8gU3VwcG9ydDogcmVhbCBpT1MgOC4yIG9ubHkgKG5vdCByZXByb2R1Y2libGUgaW4gc2ltdWxhdG9yKQogICAgLy8gYGluYCBjaGVjayB1c2VkIHRvIHByZXZlbnQgSklUIGVycm9yIChnaC0yMTQ1KQogICAgLy8gaGFzT3duIGlzbid0IHVzZWQgaGVyZSBkdWUgdG8gZmFsc2UgbmVnYXRpdmVzCiAgICAvLyByZWdhcmRpbmcgTm9kZWxpc3QgbGVuZ3RoIGluIElFCiAgICB2YXIgbGVuZ3RoID0gISFvYmogJiYgImxlbmd0aCIgaW4gb2JqICYmIG9iai5sZW5ndGgsCiAgICAgIHR5cGUgPSB0b1R5cGUob2JqKTsKICAgIGlmIChpc0Z1bmN0aW9uKG9iaikgfHwgaXNXaW5kb3cob2JqKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHlwZSA9PT0gImFycmF5IiB8fCBsZW5ndGggPT09IDAgfHwgdHlwZW9mIGxlbmd0aCA9PT0gIm51bWJlciIgJiYgbGVuZ3RoID4gMCAmJiBsZW5ndGggLSAxIGluIG9iajsKICB9CiAgdmFyIFNpenpsZSA9CiAgLyohCiAgKiBTaXp6bGUgQ1NTIFNlbGVjdG9yIEVuZ2luZSB2Mi4zLjUKICAqIGh0dHBzOi8vc2l6emxlanMuY29tLwogICoKICAqIENvcHlyaWdodCBKUyBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMKICAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQogICogaHR0cHM6Ly9qcy5mb3VuZGF0aW9uLwogICoKICAqIERhdGU6IDIwMjAtMDMtMTQKICAqLwogIGZ1bmN0aW9uICh3aW5kb3cpIHsKICAgIHZhciBpLAogICAgICBzdXBwb3J0LAogICAgICBFeHByLAogICAgICBnZXRUZXh0LAogICAgICBpc1hNTCwKICAgICAgdG9rZW5pemUsCiAgICAgIGNvbXBpbGUsCiAgICAgIHNlbGVjdCwKICAgICAgb3V0ZXJtb3N0Q29udGV4dCwKICAgICAgc29ydElucHV0LAogICAgICBoYXNEdXBsaWNhdGUsCiAgICAgIC8vIExvY2FsIGRvY3VtZW50IHZhcnMKICAgICAgc2V0RG9jdW1lbnQsCiAgICAgIGRvY3VtZW50LAogICAgICBkb2NFbGVtLAogICAgICBkb2N1bWVudElzSFRNTCwKICAgICAgcmJ1Z2d5UVNBLAogICAgICByYnVnZ3lNYXRjaGVzLAogICAgICBtYXRjaGVzLAogICAgICBjb250YWlucywKICAgICAgLy8gSW5zdGFuY2Utc3BlY2lmaWMgZGF0YQogICAgICBleHBhbmRvID0gInNpenpsZSIgKyAxICogbmV3IERhdGUoKSwKICAgICAgcHJlZmVycmVkRG9jID0gd2luZG93LmRvY3VtZW50LAogICAgICBkaXJydW5zID0gMCwKICAgICAgZG9uZSA9IDAsCiAgICAgIGNsYXNzQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAogICAgICB0b2tlbkNhY2hlID0gY3JlYXRlQ2FjaGUoKSwKICAgICAgY29tcGlsZXJDYWNoZSA9IGNyZWF0ZUNhY2hlKCksCiAgICAgIG5vbm5hdGl2ZVNlbGVjdG9yQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAogICAgICBzb3J0T3JkZXIgPSBmdW5jdGlvbiBzb3J0T3JkZXIoYSwgYikgewogICAgICAgIGlmIChhID09PSBiKSB7CiAgICAgICAgICBoYXNEdXBsaWNhdGUgPSB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgICAgfSwKICAgICAgLy8gSW5zdGFuY2UgbWV0aG9kcwogICAgICBoYXNPd24gPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgICAgYXJyID0gW10sCiAgICAgIHBvcCA9IGFyci5wb3AsCiAgICAgIHB1c2hOYXRpdmUgPSBhcnIucHVzaCwKICAgICAgcHVzaCA9IGFyci5wdXNoLAogICAgICBzbGljZSA9IGFyci5zbGljZSwKICAgICAgLy8gVXNlIGEgc3RyaXBwZWQtZG93biBpbmRleE9mIGFzIGl0J3MgZmFzdGVyIHRoYW4gbmF0aXZlCiAgICAgIC8vIGh0dHBzOi8vanNwZXJmLmNvbS90aG9yLWluZGV4b2YtdnMtZm9yLzUKICAgICAgaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YobGlzdCwgZWxlbSkgewogICAgICAgIHZhciBpID0gMCwKICAgICAgICAgIGxlbiA9IGxpc3QubGVuZ3RoOwogICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgIGlmIChsaXN0W2ldID09PSBlbGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0sCiAgICAgIGJvb2xlYW5zID0gImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnwiICsgImlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLAogICAgICAvLyBSZWd1bGFyIGV4cHJlc3Npb25zCgogICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jd2hpdGVzcGFjZQogICAgICB3aGl0ZXNwYWNlID0gIltcXHgyMFxcdFxcclxcblxcZl0iLAogICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvY3NzLXN5bnRheC0zLyNpZGVudC10b2tlbi1kaWFncmFtCiAgICAgIGlkZW50aWZpZXIgPSAiKD86XFxcXFtcXGRhLWZBLUZdezEsNn0iICsgd2hpdGVzcGFjZSArICI/fFxcXFxbXlxcclxcblxcZl18W1xcdy1dfFteXDAtXFx4N2ZdKSsiLAogICAgICAvLyBBdHRyaWJ1dGUgc2VsZWN0b3JzOiBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2F0dHJpYnV0ZS1zZWxlY3RvcnMKICAgICAgYXR0cmlidXRlcyA9ICJcXFsiICsgd2hpdGVzcGFjZSArICIqKCIgKyBpZGVudGlmaWVyICsgIikoPzoiICsgd2hpdGVzcGFjZSArCiAgICAgIC8vIE9wZXJhdG9yIChjYXB0dXJlIDIpCiAgICAgICIqKFsqXiR8IX5dPz0pIiArIHdoaXRlc3BhY2UgKwogICAgICAvLyAiQXR0cmlidXRlIHZhbHVlcyBtdXN0IGJlIENTUyBpZGVudGlmaWVycyBbY2FwdHVyZSA1XQogICAgICAvLyBvciBzdHJpbmdzIFtjYXB0dXJlIDMgb3IgY2FwdHVyZSA0XSIKICAgICAgIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcInwoIiArIGlkZW50aWZpZXIgKyAiKSl8KSIgKyB3aGl0ZXNwYWNlICsgIipcXF0iLAogICAgICBwc2V1ZG9zID0gIjooIiArIGlkZW50aWZpZXIgKyAiKSg/OlxcKCgiICsKICAgICAgLy8gVG8gcmVkdWNlIHRoZSBudW1iZXIgb2Ygc2VsZWN0b3JzIG5lZWRpbmcgdG9rZW5pemUgaW4gdGhlIHByZUZpbHRlciwgcHJlZmVyIGFyZ3VtZW50czoKICAgICAgLy8gMS4gcXVvdGVkIChjYXB0dXJlIDM7IGNhcHR1cmUgNCBvciBjYXB0dXJlIDUpCiAgICAgICIoJygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCIpfCIgKwogICAgICAvLyAyLiBzaW1wbGUgKGNhcHR1cmUgNikKICAgICAgIigoPzpcXFxcLnxbXlxcXFwoKVtcXF1dfCIgKyBhdHRyaWJ1dGVzICsgIikqKXwiICsKICAgICAgLy8gMy4gYW55dGhpbmcgZWxzZSAoY2FwdHVyZSAyKQogICAgICAiLioiICsgIilcXCl8KSIsCiAgICAgIC8vIExlYWRpbmcgYW5kIG5vbi1lc2NhcGVkIHRyYWlsaW5nIHdoaXRlc3BhY2UsIGNhcHR1cmluZyBzb21lIG5vbi13aGl0ZXNwYWNlIGNoYXJhY3RlcnMgcHJlY2VkaW5nIHRoZSBsYXR0ZXIKICAgICAgcndoaXRlc3BhY2UgPSBuZXcgUmVnRXhwKHdoaXRlc3BhY2UgKyAiKyIsICJnIiksCiAgICAgIHJ0cmltID0gbmV3IFJlZ0V4cCgiXiIgKyB3aGl0ZXNwYWNlICsgIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIgKyB3aGl0ZXNwYWNlICsgIiskIiwgImciKSwKICAgICAgcmNvbW1hID0gbmV3IFJlZ0V4cCgiXiIgKyB3aGl0ZXNwYWNlICsgIiosIiArIHdoaXRlc3BhY2UgKyAiKiIpLAogICAgICByY29tYmluYXRvcnMgPSBuZXcgUmVnRXhwKCJeIiArIHdoaXRlc3BhY2UgKyAiKihbPit+XXwiICsgd2hpdGVzcGFjZSArICIpIiArIHdoaXRlc3BhY2UgKyAiKiIpLAogICAgICByZGVzY2VuZCA9IG5ldyBSZWdFeHAod2hpdGVzcGFjZSArICJ8PiIpLAogICAgICBycHNldWRvID0gbmV3IFJlZ0V4cChwc2V1ZG9zKSwKICAgICAgcmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCJeIiArIGlkZW50aWZpZXIgKyAiJCIpLAogICAgICBtYXRjaEV4cHIgPSB7CiAgICAgICAgIklEIjogbmV3IFJlZ0V4cCgiXiMoIiArIGlkZW50aWZpZXIgKyAiKSIpLAogICAgICAgICJDTEFTUyI6IG5ldyBSZWdFeHAoIl5cXC4oIiArIGlkZW50aWZpZXIgKyAiKSIpLAogICAgICAgICJUQUciOiBuZXcgUmVnRXhwKCJeKCIgKyBpZGVudGlmaWVyICsgInxbKl0pIiksCiAgICAgICAgIkFUVFIiOiBuZXcgUmVnRXhwKCJeIiArIGF0dHJpYnV0ZXMpLAogICAgICAgICJQU0VVRE8iOiBuZXcgUmVnRXhwKCJeIiArIHBzZXVkb3MpLAogICAgICAgICJDSElMRCI6IG5ldyBSZWdFeHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIgKyB3aGl0ZXNwYWNlICsgIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiICsgd2hpdGVzcGFjZSArICIqKD86KFsrLV18KSIgKyB3aGl0ZXNwYWNlICsgIiooXFxkKyl8KSkiICsgd2hpdGVzcGFjZSArICIqXFwpfCkiLCAiaSIpLAogICAgICAgICJib29sIjogbmV3IFJlZ0V4cCgiXig/OiIgKyBib29sZWFucyArICIpJCIsICJpIiksCiAgICAgICAgLy8gRm9yIHVzZSBpbiBsaWJyYXJpZXMgaW1wbGVtZW50aW5nIC5pcygpCiAgICAgICAgLy8gV2UgdXNlIHRoaXMgZm9yIFBPUyBtYXRjaGluZyBpbiBgc2VsZWN0YAogICAgICAgICJuZWVkc0NvbnRleHQiOiBuZXcgUmVnRXhwKCJeIiArIHdoaXRlc3BhY2UgKyAiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFwoIiArIHdoaXRlc3BhY2UgKyAiKigoPzotXFxkKT9cXGQqKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSg/PVteLV18JCkiLCAiaSIpCiAgICAgIH0sCiAgICAgIHJodG1sID0gL0hUTUwkL2ksCiAgICAgIHJpbnB1dHMgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLAogICAgICByaGVhZGVyID0gL15oXGQkL2ksCiAgICAgIHJuYXRpdmUgPSAvXltee10rXHtccypcW25hdGl2ZSBcdy8sCiAgICAgIC8vIEVhc2lseS1wYXJzZWFibGUvcmV0cmlldmFibGUgSUQgb3IgVEFHIG9yIENMQVNTIHNlbGVjdG9ycwogICAgICBycXVpY2tFeHByID0gL14oPzojKFtcdy1dKyl8KFx3Kyl8XC4oW1x3LV0rKSkkLywKICAgICAgcnNpYmxpbmcgPSAvWyt+XS8sCiAgICAgIC8vIENTUyBlc2NhcGVzCiAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCNlc2NhcGVkLWNoYXJhY3RlcnMKICAgICAgcnVuZXNjYXBlID0gbmV3IFJlZ0V4cCgiXFxcXFtcXGRhLWZBLUZdezEsNn0iICsgd2hpdGVzcGFjZSArICI/fFxcXFwoW15cXHJcXG5cXGZdKSIsICJnIiksCiAgICAgIGZ1bmVzY2FwZSA9IGZ1bmN0aW9uIGZ1bmVzY2FwZShlc2NhcGUsIG5vbkhleCkgewogICAgICAgIHZhciBoaWdoID0gIjB4IiArIGVzY2FwZS5zbGljZSgxKSAtIDB4MTAwMDA7CiAgICAgICAgcmV0dXJuIG5vbkhleCA/CiAgICAgICAgLy8gU3RyaXAgdGhlIGJhY2tzbGFzaCBwcmVmaXggZnJvbSBhIG5vbi1oZXggZXNjYXBlIHNlcXVlbmNlCiAgICAgICAgbm9uSGV4IDoKICAgICAgICAvLyBSZXBsYWNlIGEgaGV4YWRlY2ltYWwgZXNjYXBlIHNlcXVlbmNlIHdpdGggdGhlIGVuY29kZWQgVW5pY29kZSBjb2RlIHBvaW50CiAgICAgICAgLy8gU3VwcG9ydDogSUUgPD0xMSsKICAgICAgICAvLyBGb3IgdmFsdWVzIG91dHNpZGUgdGhlIEJhc2ljIE11bHRpbGluZ3VhbCBQbGFuZSAoQk1QKSwgbWFudWFsbHkgY29uc3RydWN0IGEKICAgICAgICAvLyBzdXJyb2dhdGUgcGFpcgogICAgICAgIGhpZ2ggPCAwID8gU3RyaW5nLmZyb21DaGFyQ29kZShoaWdoICsgMHgxMDAwMCkgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKGhpZ2ggPj4gMTAgfCAweEQ4MDAsIGhpZ2ggJiAweDNGRiB8IDB4REMwMCk7CiAgICAgIH0sCiAgICAgIC8vIENTUyBzdHJpbmcvaWRlbnRpZmllciBzZXJpYWxpemF0aW9uCiAgICAgIC8vIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3NvbS8jY29tbW9uLXNlcmlhbGl6aW5nLWlkaW9tcwogICAgICByY3NzZXNjYXBlID0gLyhbXDAtXHgxZlx4N2ZdfF4tP1xkKXxeLSR8W15cMC1ceDFmXHg3Zi1cdUZGRkZcdy1dL2csCiAgICAgIGZjc3Nlc2NhcGUgPSBmdW5jdGlvbiBmY3NzZXNjYXBlKGNoLCBhc0NvZGVQb2ludCkgewogICAgICAgIGlmIChhc0NvZGVQb2ludCkgewogICAgICAgICAgLy8gVSswMDAwIE5VTEwgYmVjb21lcyBVK0ZGRkQgUkVQTEFDRU1FTlQgQ0hBUkFDVEVSCiAgICAgICAgICBpZiAoY2ggPT09ICJcMCIpIHsKICAgICAgICAgICAgcmV0dXJuICJcdUZGRkQiOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIENvbnRyb2wgY2hhcmFjdGVycyBhbmQgKGRlcGVuZGVudCB1cG9uIHBvc2l0aW9uKSBudW1iZXJzIGdldCBlc2NhcGVkIGFzIGNvZGUgcG9pbnRzCiAgICAgICAgICByZXR1cm4gY2guc2xpY2UoMCwgLTEpICsgIlxcIiArIGNoLmNoYXJDb2RlQXQoY2gubGVuZ3RoIC0gMSkudG9TdHJpbmcoMTYpICsgIiAiOwogICAgICAgIH0KCiAgICAgICAgLy8gT3RoZXIgcG90ZW50aWFsbHktc3BlY2lhbCBBU0NJSSBjaGFyYWN0ZXJzIGdldCBiYWNrc2xhc2gtZXNjYXBlZAogICAgICAgIHJldHVybiAiXFwiICsgY2g7CiAgICAgIH0sCiAgICAgIC8vIFVzZWQgZm9yIGlmcmFtZXMKICAgICAgLy8gU2VlIHNldERvY3VtZW50KCkKICAgICAgLy8gUmVtb3ZpbmcgdGhlIGZ1bmN0aW9uIHdyYXBwZXIgY2F1c2VzIGEgIlBlcm1pc3Npb24gRGVuaWVkIgogICAgICAvLyBlcnJvciBpbiBJRQogICAgICB1bmxvYWRIYW5kbGVyID0gZnVuY3Rpb24gdW5sb2FkSGFuZGxlcigpIHsKICAgICAgICBzZXREb2N1bWVudCgpOwogICAgICB9LAogICAgICBpbkRpc2FibGVkRmllbGRzZXQgPSBhZGRDb21iaW5hdG9yKGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IHRydWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiZmllbGRzZXQiOwogICAgICB9LCB7CiAgICAgICAgZGlyOiAicGFyZW50Tm9kZSIsCiAgICAgICAgbmV4dDogImxlZ2VuZCIKICAgICAgfSk7CgogICAgLy8gT3B0aW1pemUgZm9yIHB1c2guYXBwbHkoIF8sIE5vZGVMaXN0ICkKICAgIHRyeSB7CiAgICAgIHB1c2guYXBwbHkoYXJyID0gc2xpY2UuY2FsbChwcmVmZXJyZWREb2MuY2hpbGROb2RlcyksIHByZWZlcnJlZERvYy5jaGlsZE5vZGVzKTsKCiAgICAgIC8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wCiAgICAgIC8vIERldGVjdCBzaWxlbnRseSBmYWlsaW5nIHB1c2guYXBwbHkKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC1leHByZXNzaW9ucwogICAgICBhcnJbcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMubGVuZ3RoXS5ub2RlVHlwZTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcHVzaCA9IHsKICAgICAgICBhcHBseTogYXJyLmxlbmd0aCA/CiAgICAgICAgLy8gTGV2ZXJhZ2Ugc2xpY2UgaWYgcG9zc2libGUKICAgICAgICBmdW5jdGlvbiAodGFyZ2V0LCBlbHMpIHsKICAgICAgICAgIHB1c2hOYXRpdmUuYXBwbHkodGFyZ2V0LCBzbGljZS5jYWxsKGVscykpOwogICAgICAgIH0gOgogICAgICAgIC8vIFN1cHBvcnQ6IElFPDkKICAgICAgICAvLyBPdGhlcndpc2UgYXBwZW5kIGRpcmVjdGx5CiAgICAgICAgZnVuY3Rpb24gKHRhcmdldCwgZWxzKSB7CiAgICAgICAgICB2YXIgaiA9IHRhcmdldC5sZW5ndGgsCiAgICAgICAgICAgIGkgPSAwOwoKICAgICAgICAgIC8vIENhbid0IHRydXN0IE5vZGVMaXN0Lmxlbmd0aAogICAgICAgICAgd2hpbGUgKHRhcmdldFtqKytdID0gZWxzW2krK10pIHt9CiAgICAgICAgICB0YXJnZXQubGVuZ3RoID0gaiAtIDE7CiAgICAgICAgfQogICAgICB9OwogICAgfQogICAgZnVuY3Rpb24gU2l6emxlKHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkKSB7CiAgICAgIHZhciBtLAogICAgICAgIGksCiAgICAgICAgZWxlbSwKICAgICAgICBuaWQsCiAgICAgICAgbWF0Y2gsCiAgICAgICAgZ3JvdXBzLAogICAgICAgIG5ld1NlbGVjdG9yLAogICAgICAgIG5ld0NvbnRleHQgPSBjb250ZXh0ICYmIGNvbnRleHQub3duZXJEb2N1bWVudCwKICAgICAgICAvLyBub2RlVHlwZSBkZWZhdWx0cyB0byA5LCBzaW5jZSBjb250ZXh0IGRlZmF1bHRzIHRvIGRvY3VtZW50CiAgICAgICAgbm9kZVR5cGUgPSBjb250ZXh0ID8gY29udGV4dC5ub2RlVHlwZSA6IDk7CiAgICAgIHJlc3VsdHMgPSByZXN1bHRzIHx8IFtdOwoKICAgICAgLy8gUmV0dXJuIGVhcmx5IGZyb20gY2FsbHMgd2l0aCBpbnZhbGlkIHNlbGVjdG9yIG9yIGNvbnRleHQKICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gInN0cmluZyIgfHwgIXNlbGVjdG9yIHx8IG5vZGVUeXBlICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ICYmIG5vZGVUeXBlICE9PSAxMSkgewogICAgICAgIHJldHVybiByZXN1bHRzOwogICAgICB9CgogICAgICAvLyBUcnkgdG8gc2hvcnRjdXQgZmluZCBvcGVyYXRpb25zIChhcyBvcHBvc2VkIHRvIGZpbHRlcnMpIGluIEhUTUwgZG9jdW1lbnRzCiAgICAgIGlmICghc2VlZCkgewogICAgICAgIHNldERvY3VtZW50KGNvbnRleHQpOwogICAgICAgIGNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50OwogICAgICAgIGlmIChkb2N1bWVudElzSFRNTCkgewogICAgICAgICAgLy8gSWYgdGhlIHNlbGVjdG9yIGlzIHN1ZmZpY2llbnRseSBzaW1wbGUsIHRyeSB1c2luZyBhICJnZXQqQnkqIiBET00gbWV0aG9kCiAgICAgICAgICAvLyAoZXhjZXB0aW5nIERvY3VtZW50RnJhZ21lbnQgY29udGV4dCwgd2hlcmUgdGhlIG1ldGhvZHMgZG9uJ3QgZXhpc3QpCiAgICAgICAgICBpZiAobm9kZVR5cGUgIT09IDExICYmIChtYXRjaCA9IHJxdWlja0V4cHIuZXhlYyhzZWxlY3RvcikpKSB7CiAgICAgICAgICAgIC8vIElEIHNlbGVjdG9yCiAgICAgICAgICAgIGlmIChtID0gbWF0Y2hbMV0pIHsKICAgICAgICAgICAgICAvLyBEb2N1bWVudCBjb250ZXh0CiAgICAgICAgICAgICAgaWYgKG5vZGVUeXBlID09PSA5KSB7CiAgICAgICAgICAgICAgICBpZiAoZWxlbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQobSkpIHsKICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUsIE9wZXJhLCBXZWJraXQKICAgICAgICAgICAgICAgICAgLy8gVE9ETzogaWRlbnRpZnkgdmVyc2lvbnMKICAgICAgICAgICAgICAgICAgLy8gZ2V0RWxlbWVudEJ5SWQgY2FuIG1hdGNoIGVsZW1lbnRzIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAogICAgICAgICAgICAgICAgICBpZiAoZWxlbS5pZCA9PT0gbSkgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChlbGVtKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRWxlbWVudCBjb250ZXh0CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFLCBPcGVyYSwgV2Via2l0CiAgICAgICAgICAgICAgICAvLyBUT0RPOiBpZGVudGlmeSB2ZXJzaW9ucwogICAgICAgICAgICAgICAgLy8gZ2V0RWxlbWVudEJ5SWQgY2FuIG1hdGNoIGVsZW1lbnRzIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAogICAgICAgICAgICAgICAgaWYgKG5ld0NvbnRleHQgJiYgKGVsZW0gPSBuZXdDb250ZXh0LmdldEVsZW1lbnRCeUlkKG0pKSAmJiBjb250YWlucyhjb250ZXh0LCBlbGVtKSAmJiBlbGVtLmlkID09PSBtKSB7CiAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChlbGVtKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyBUeXBlIHNlbGVjdG9yCiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hbMl0pIHsKICAgICAgICAgICAgICBwdXNoLmFwcGx5KHJlc3VsdHMsIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoc2VsZWN0b3IpKTsKICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0czsKCiAgICAgICAgICAgICAgLy8gQ2xhc3Mgc2VsZWN0b3IKICAgICAgICAgICAgfSBlbHNlIGlmICgobSA9IG1hdGNoWzNdKSAmJiBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSB7CiAgICAgICAgICAgICAgcHVzaC5hcHBseShyZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobSkpOwogICAgICAgICAgICAgIHJldHVybiByZXN1bHRzOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gVGFrZSBhZHZhbnRhZ2Ugb2YgcXVlcnlTZWxlY3RvckFsbAogICAgICAgICAgaWYgKHN1cHBvcnQucXNhICYmICFub25uYXRpdmVTZWxlY3RvckNhY2hlW3NlbGVjdG9yICsgIiAiXSAmJiAoIXJidWdneVFTQSB8fCAhcmJ1Z2d5UVNBLnRlc3Qoc2VsZWN0b3IpKSAmJiAoCiAgICAgICAgICAvLyBTdXBwb3J0OiBJRSA4IG9ubHkKICAgICAgICAgIC8vIEV4Y2x1ZGUgb2JqZWN0IGVsZW1lbnRzCiAgICAgICAgICBub2RlVHlwZSAhPT0gMSB8fCBjb250ZXh0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICJvYmplY3QiKSkgewogICAgICAgICAgICBuZXdTZWxlY3RvciA9IHNlbGVjdG9yOwogICAgICAgICAgICBuZXdDb250ZXh0ID0gY29udGV4dDsKCiAgICAgICAgICAgIC8vIHFTQSBjb25zaWRlcnMgZWxlbWVudHMgb3V0c2lkZSBhIHNjb3Bpbmcgcm9vdCB3aGVuIGV2YWx1YXRpbmcgY2hpbGQgb3IKICAgICAgICAgICAgLy8gZGVzY2VuZGFudCBjb21iaW5hdG9ycywgd2hpY2ggaXMgbm90IHdoYXQgd2Ugd2FudC4KICAgICAgICAgICAgLy8gSW4gc3VjaCBjYXNlcywgd2Ugd29yayBhcm91bmQgdGhlIGJlaGF2aW9yIGJ5IHByZWZpeGluZyBldmVyeSBzZWxlY3RvciBpbiB0aGUKICAgICAgICAgICAgLy8gbGlzdCB3aXRoIGFuIElEIHNlbGVjdG9yIHJlZmVyZW5jaW5nIHRoZSBzY29wZSBjb250ZXh0LgogICAgICAgICAgICAvLyBUaGUgdGVjaG5pcXVlIGhhcyB0byBiZSB1c2VkIGFzIHdlbGwgd2hlbiBhIGxlYWRpbmcgY29tYmluYXRvciBpcyB1c2VkCiAgICAgICAgICAgIC8vIGFzIHN1Y2ggc2VsZWN0b3JzIGFyZSBub3QgcmVjb2duaXplZCBieSBxdWVyeVNlbGVjdG9yQWxsLgogICAgICAgICAgICAvLyBUaGFua3MgdG8gQW5kcmV3IER1cG9udCBmb3IgdGhpcyB0ZWNobmlxdWUuCiAgICAgICAgICAgIGlmIChub2RlVHlwZSA9PT0gMSAmJiAocmRlc2NlbmQudGVzdChzZWxlY3RvcikgfHwgcmNvbWJpbmF0b3JzLnRlc3Qoc2VsZWN0b3IpKSkgewogICAgICAgICAgICAgIC8vIEV4cGFuZCBjb250ZXh0IGZvciBzaWJsaW5nIHNlbGVjdG9ycwogICAgICAgICAgICAgIG5ld0NvbnRleHQgPSByc2libGluZy50ZXN0KHNlbGVjdG9yKSAmJiB0ZXN0Q29udGV4dChjb250ZXh0LnBhcmVudE5vZGUpIHx8IGNvbnRleHQ7CgogICAgICAgICAgICAgIC8vIFdlIGNhbiB1c2UgOnNjb3BlIGluc3RlYWQgb2YgdGhlIElEIGhhY2sgaWYgdGhlIGJyb3dzZXIKICAgICAgICAgICAgICAvLyBzdXBwb3J0cyBpdCAmIGlmIHdlJ3JlIG5vdCBjaGFuZ2luZyB0aGUgY29udGV4dC4KICAgICAgICAgICAgICBpZiAobmV3Q29udGV4dCAhPT0gY29udGV4dCB8fCAhc3VwcG9ydC5zY29wZSkgewogICAgICAgICAgICAgICAgLy8gQ2FwdHVyZSB0aGUgY29udGV4dCBJRCwgc2V0dGluZyBpdCBmaXJzdCBpZiBuZWNlc3NhcnkKICAgICAgICAgICAgICAgIGlmIChuaWQgPSBjb250ZXh0LmdldEF0dHJpYnV0ZSgiaWQiKSkgewogICAgICAgICAgICAgICAgICBuaWQgPSBuaWQucmVwbGFjZShyY3NzZXNjYXBlLCBmY3NzZXNjYXBlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2V0QXR0cmlidXRlKCJpZCIsIG5pZCA9IGV4cGFuZG8pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8gUHJlZml4IGV2ZXJ5IHNlbGVjdG9yIGluIHRoZSBsaXN0CiAgICAgICAgICAgICAgZ3JvdXBzID0gdG9rZW5pemUoc2VsZWN0b3IpOwogICAgICAgICAgICAgIGkgPSBncm91cHMubGVuZ3RoOwogICAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICAgIGdyb3Vwc1tpXSA9IChuaWQgPyAiIyIgKyBuaWQgOiAiOnNjb3BlIikgKyAiICIgKyB0b1NlbGVjdG9yKGdyb3Vwc1tpXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIG5ld1NlbGVjdG9yID0gZ3JvdXBzLmpvaW4oIiwiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHB1c2guYXBwbHkocmVzdWx0cywgbmV3Q29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKG5ld1NlbGVjdG9yKSk7CiAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICAgICAgICAgIH0gY2F0Y2ggKHFzYUVycm9yKSB7CiAgICAgICAgICAgICAgbm9ubmF0aXZlU2VsZWN0b3JDYWNoZShzZWxlY3RvciwgdHJ1ZSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgaWYgKG5pZCA9PT0gZXhwYW5kbykgewogICAgICAgICAgICAgICAgY29udGV4dC5yZW1vdmVBdHRyaWJ1dGUoImlkIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBBbGwgb3RoZXJzCiAgICAgIHJldHVybiBzZWxlY3Qoc2VsZWN0b3IucmVwbGFjZShydHJpbSwgIiQxIiksIGNvbnRleHQsIHJlc3VsdHMsIHNlZWQpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGtleS12YWx1ZSBjYWNoZXMgb2YgbGltaXRlZCBzaXplCiAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oc3RyaW5nLCBvYmplY3QpfSBSZXR1cm5zIHRoZSBPYmplY3QgZGF0YSBhZnRlciBzdG9yaW5nIGl0IG9uIGl0c2VsZiB3aXRoCiAgICAgKglwcm9wZXJ0eSBuYW1lIHRoZSAoc3BhY2Utc3VmZml4ZWQpIHN0cmluZyBhbmQgKGlmIHRoZSBjYWNoZSBpcyBsYXJnZXIgdGhhbiBFeHByLmNhY2hlTGVuZ3RoKQogICAgICoJZGVsZXRpbmcgdGhlIG9sZGVzdCBlbnRyeQogICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVDYWNoZSgpIHsKICAgICAgdmFyIGtleXMgPSBbXTsKICAgICAgZnVuY3Rpb24gY2FjaGUoa2V5LCB2YWx1ZSkgewogICAgICAgIC8vIFVzZSAoa2V5ICsgIiAiKSB0byBhdm9pZCBjb2xsaXNpb24gd2l0aCBuYXRpdmUgcHJvdG90eXBlIHByb3BlcnRpZXMgKHNlZSBJc3N1ZSAjMTU3KQogICAgICAgIGlmIChrZXlzLnB1c2goa2V5ICsgIiAiKSA+IEV4cHIuY2FjaGVMZW5ndGgpIHsKICAgICAgICAgIC8vIE9ubHkga2VlcCB0aGUgbW9zdCByZWNlbnQgZW50cmllcwogICAgICAgICAgZGVsZXRlIGNhY2hlW2tleXMuc2hpZnQoKV07CiAgICAgICAgfQogICAgICAgIHJldHVybiBjYWNoZVtrZXkgKyAiICJdID0gdmFsdWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGNhY2hlOwogICAgfQoKICAgIC8qKgogICAgICogTWFyayBhIGZ1bmN0aW9uIGZvciBzcGVjaWFsIHVzZSBieSBTaXp6bGUKICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBtYXJrCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1hcmtGdW5jdGlvbihmbikgewogICAgICBmbltleHBhbmRvXSA9IHRydWU7CiAgICAgIHJldHVybiBmbjsKICAgIH0KCiAgICAvKioKICAgICAqIFN1cHBvcnQgdGVzdGluZyB1c2luZyBhbiBlbGVtZW50CiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBQYXNzZWQgdGhlIGNyZWF0ZWQgZWxlbWVudCBhbmQgcmV0dXJucyBhIGJvb2xlYW4gcmVzdWx0CiAgICAgKi8KICAgIGZ1bmN0aW9uIGFzc2VydChmbikgewogICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpOwogICAgICB0cnkgewogICAgICAgIHJldHVybiAhIWZuKGVsKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAvLyBSZW1vdmUgZnJvbSBpdHMgcGFyZW50IGJ5IGRlZmF1bHQKICAgICAgICBpZiAoZWwucGFyZW50Tm9kZSkgewogICAgICAgICAgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7CiAgICAgICAgfQoKICAgICAgICAvLyByZWxlYXNlIG1lbW9yeSBpbiBJRQogICAgICAgIGVsID0gbnVsbDsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkcyB0aGUgc2FtZSBoYW5kbGVyIGZvciBhbGwgb2YgdGhlIHNwZWNpZmllZCBhdHRycwogICAgICogQHBhcmFtIHtTdHJpbmd9IGF0dHJzIFBpcGUtc2VwYXJhdGVkIGxpc3Qgb2YgYXR0cmlidXRlcwogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciBUaGUgbWV0aG9kIHRoYXQgd2lsbCBiZSBhcHBsaWVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFkZEhhbmRsZShhdHRycywgaGFuZGxlcikgewogICAgICB2YXIgYXJyID0gYXR0cnMuc3BsaXQoInwiKSwKICAgICAgICBpID0gYXJyLmxlbmd0aDsKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIEV4cHIuYXR0ckhhbmRsZVthcnJbaV1dID0gaGFuZGxlcjsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2tzIGRvY3VtZW50IG9yZGVyIG9mIHR3byBzaWJsaW5ncwogICAgICogQHBhcmFtIHtFbGVtZW50fSBhCiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGIKICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgbGVzcyB0aGFuIDAgaWYgYSBwcmVjZWRlcyBiLCBncmVhdGVyIHRoYW4gMCBpZiBhIGZvbGxvd3MgYgogICAgICovCiAgICBmdW5jdGlvbiBzaWJsaW5nQ2hlY2soYSwgYikgewogICAgICB2YXIgY3VyID0gYiAmJiBhLAogICAgICAgIGRpZmYgPSBjdXIgJiYgYS5ub2RlVHlwZSA9PT0gMSAmJiBiLm5vZGVUeXBlID09PSAxICYmIGEuc291cmNlSW5kZXggLSBiLnNvdXJjZUluZGV4OwoKICAgICAgLy8gVXNlIElFIHNvdXJjZUluZGV4IGlmIGF2YWlsYWJsZSBvbiBib3RoIG5vZGVzCiAgICAgIGlmIChkaWZmKSB7CiAgICAgICAgcmV0dXJuIGRpZmY7CiAgICAgIH0KCiAgICAgIC8vIENoZWNrIGlmIGIgZm9sbG93cyBhCiAgICAgIGlmIChjdXIpIHsKICAgICAgICB3aGlsZSAoY3VyID0gY3VyLm5leHRTaWJsaW5nKSB7CiAgICAgICAgICBpZiAoY3VyID09PSBiKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGEgPyAxIDogLTE7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGlucHV0IHR5cGVzCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZQogICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyh0eXBlKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIHZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIHJldHVybiBuYW1lID09PSAiaW5wdXQiICYmIGVsZW0udHlwZSA9PT0gdHlwZTsKICAgICAgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgYnV0dG9ucwogICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAgICAqLwogICAgZnVuY3Rpb24gY3JlYXRlQnV0dG9uUHNldWRvKHR5cGUpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgcmV0dXJuIChuYW1lID09PSAiaW5wdXQiIHx8IG5hbWUgPT09ICJidXR0b24iKSAmJiBlbGVtLnR5cGUgPT09IHR5cGU7CiAgICAgIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIDplbmFibGVkLzpkaXNhYmxlZAogICAgICogQHBhcmFtIHtCb29sZWFufSBkaXNhYmxlZCB0cnVlIGZvciA6ZGlzYWJsZWQ7IGZhbHNlIGZvciA6ZW5hYmxlZAogICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVEaXNhYmxlZFBzZXVkbyhkaXNhYmxlZCkgewogICAgICAvLyBLbm93biA6ZGlzYWJsZWQgZmFsc2UgcG9zaXRpdmVzOiBmaWVsZHNldFtkaXNhYmxlZF0gPiBsZWdlbmQ6bnRoLW9mLXR5cGUobisyKSA6Y2FuLWRpc2FibGUKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgLy8gT25seSBjZXJ0YWluIGVsZW1lbnRzIGNhbiBtYXRjaCA6ZW5hYmxlZCBvciA6ZGlzYWJsZWQKICAgICAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zY3JpcHRpbmcuaHRtbCNzZWxlY3Rvci1lbmFibGVkCiAgICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc2NyaXB0aW5nLmh0bWwjc2VsZWN0b3ItZGlzYWJsZWQKICAgICAgICBpZiAoImZvcm0iIGluIGVsZW0pIHsKICAgICAgICAgIC8vIENoZWNrIGZvciBpbmhlcml0ZWQgZGlzYWJsZWRuZXNzIG9uIHJlbGV2YW50IG5vbi1kaXNhYmxlZCBlbGVtZW50czoKICAgICAgICAgIC8vICogbGlzdGVkIGZvcm0tYXNzb2NpYXRlZCBlbGVtZW50cyBpbiBhIGRpc2FibGVkIGZpZWxkc2V0CiAgICAgICAgICAvLyAgIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2Zvcm1zLmh0bWwjY2F0ZWdvcnktbGlzdGVkCiAgICAgICAgICAvLyAgIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2Zvcm1zLmh0bWwjY29uY2VwdC1mZS1kaXNhYmxlZAogICAgICAgICAgLy8gKiBvcHRpb24gZWxlbWVudHMgaW4gYSBkaXNhYmxlZCBvcHRncm91cAogICAgICAgICAgLy8gICBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9mb3Jtcy5odG1sI2NvbmNlcHQtb3B0aW9uLWRpc2FibGVkCiAgICAgICAgICAvLyBBbGwgc3VjaCBlbGVtZW50cyBoYXZlIGEgImZvcm0iIHByb3BlcnR5LgogICAgICAgICAgaWYgKGVsZW0ucGFyZW50Tm9kZSAmJiBlbGVtLmRpc2FibGVkID09PSBmYWxzZSkgewogICAgICAgICAgICAvLyBPcHRpb24gZWxlbWVudHMgZGVmZXIgdG8gYSBwYXJlbnQgb3B0Z3JvdXAgaWYgcHJlc2VudAogICAgICAgICAgICBpZiAoImxhYmVsIiBpbiBlbGVtKSB7CiAgICAgICAgICAgICAgaWYgKCJsYWJlbCIgaW4gZWxlbS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS5wYXJlbnROb2RlLmRpc2FibGVkID09PSBkaXNhYmxlZDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IGRpc2FibGVkOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUgNiAtIDExCiAgICAgICAgICAgIC8vIFVzZSB0aGUgaXNEaXNhYmxlZCBzaG9ydGN1dCBwcm9wZXJ0eSB0byBjaGVjayBmb3IgZGlzYWJsZWQgZmllbGRzZXQgYW5jZXN0b3JzCiAgICAgICAgICAgIHJldHVybiBlbGVtLmlzRGlzYWJsZWQgPT09IGRpc2FibGVkIHx8CiAgICAgICAgICAgIC8vIFdoZXJlIHRoZXJlIGlzIG5vIGlzRGlzYWJsZWQsIGNoZWNrIG1hbnVhbGx5CiAgICAgICAgICAgIC8qIGpzaGludCAtVzAxOCAqLwogICAgICAgICAgICBlbGVtLmlzRGlzYWJsZWQgIT09ICFkaXNhYmxlZCAmJiBpbkRpc2FibGVkRmllbGRzZXQoZWxlbSkgPT09IGRpc2FibGVkOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IGRpc2FibGVkOwoKICAgICAgICAgIC8vIFRyeSB0byB3aW5ub3cgb3V0IGVsZW1lbnRzIHRoYXQgY2FuJ3QgYmUgZGlzYWJsZWQgYmVmb3JlIHRydXN0aW5nIHRoZSBkaXNhYmxlZCBwcm9wZXJ0eS4KICAgICAgICAgIC8vIFNvbWUgdmljdGltcyBnZXQgY2F1Z2h0IGluIG91ciBuZXQgKGxhYmVsLCBsZWdlbmQsIG1lbnUsIHRyYWNrKSwgYnV0IGl0IHNob3VsZG4ndAogICAgICAgICAgLy8gZXZlbiBleGlzdCBvbiB0aGVtLCBsZXQgYWxvbmUgaGF2ZSBhIGJvb2xlYW4gdmFsdWUuCiAgICAgICAgfSBlbHNlIGlmICgibGFiZWwiIGluIGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtLmRpc2FibGVkID09PSBkaXNhYmxlZDsKICAgICAgICB9CgogICAgICAgIC8vIFJlbWFpbmluZyBlbGVtZW50cyBhcmUgbmVpdGhlciA6ZW5hYmxlZCBub3IgOmRpc2FibGVkCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBwb3NpdGlvbmFscwogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4KICAgICAqLwogICAgZnVuY3Rpb24gY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmbikgewogICAgICByZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uIChhcmd1bWVudCkgewogICAgICAgIGFyZ3VtZW50ID0gK2FyZ3VtZW50OwogICAgICAgIHJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24gKHNlZWQsIG1hdGNoZXMpIHsKICAgICAgICAgIHZhciBqLAogICAgICAgICAgICBtYXRjaEluZGV4ZXMgPSBmbihbXSwgc2VlZC5sZW5ndGgsIGFyZ3VtZW50KSwKICAgICAgICAgICAgaSA9IG1hdGNoSW5kZXhlcy5sZW5ndGg7CgogICAgICAgICAgLy8gTWF0Y2ggZWxlbWVudHMgZm91bmQgYXQgdGhlIHNwZWNpZmllZCBpbmRleGVzCiAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgIGlmIChzZWVkW2ogPSBtYXRjaEluZGV4ZXNbaV1dKSB7CiAgICAgICAgICAgICAgc2VlZFtqXSA9ICEobWF0Y2hlc1tqXSA9IHNlZWRbal0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2tzIGEgbm9kZSBmb3IgdmFsaWRpdHkgYXMgYSBTaXp6bGUgY29udGV4dAogICAgICogQHBhcmFtIHtFbGVtZW50fE9iamVjdD19IGNvbnRleHQKICAgICAqIEByZXR1cm5zIHtFbGVtZW50fE9iamVjdHxCb29sZWFufSBUaGUgaW5wdXQgbm9kZSBpZiBhY2NlcHRhYmxlLCBvdGhlcndpc2UgYSBmYWxzeSB2YWx1ZQogICAgICovCiAgICBmdW5jdGlvbiB0ZXN0Q29udGV4dChjb250ZXh0KSB7CiAgICAgIHJldHVybiBjb250ZXh0ICYmIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIiAmJiBjb250ZXh0OwogICAgfQoKICAgIC8vIEV4cG9zZSBzdXBwb3J0IHZhcnMgZm9yIGNvbnZlbmllbmNlCiAgICBzdXBwb3J0ID0gU2l6emxlLnN1cHBvcnQgPSB7fTsKCiAgICAvKioKICAgICAqIERldGVjdHMgWE1MIG5vZGVzCiAgICAgKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBlbGVtIEFuIGVsZW1lbnQgb3IgYSBkb2N1bWVudAogICAgICogQHJldHVybnMge0Jvb2xlYW59IFRydWUgaWZmIGVsZW0gaXMgYSBub24tSFRNTCBYTUwgbm9kZQogICAgICovCiAgICBpc1hNTCA9IFNpenpsZS5pc1hNTCA9IGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIHZhciBuYW1lc3BhY2UgPSBlbGVtLm5hbWVzcGFjZVVSSSwKICAgICAgICBkb2NFbGVtID0gKGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtKS5kb2N1bWVudEVsZW1lbnQ7CgogICAgICAvLyBTdXBwb3J0OiBJRSA8PTgKICAgICAgLy8gQXNzdW1lIEhUTUwgd2hlbiBkb2N1bWVudEVsZW1lbnQgZG9lc24ndCB5ZXQgZXhpc3QsIHN1Y2ggYXMgaW5zaWRlIGxvYWRpbmcgaWZyYW1lcwogICAgICAvLyBodHRwczovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvNDgzMwogICAgICByZXR1cm4gIXJodG1sLnRlc3QobmFtZXNwYWNlIHx8IGRvY0VsZW0gJiYgZG9jRWxlbS5ub2RlTmFtZSB8fCAiSFRNTCIpOwogICAgfTsKCiAgICAvKioKICAgICAqIFNldHMgZG9jdW1lbnQtcmVsYXRlZCB2YXJpYWJsZXMgb25jZSBiYXNlZCBvbiB0aGUgY3VycmVudCBkb2N1bWVudAogICAgICogQHBhcmFtIHtFbGVtZW50fE9iamVjdH0gW2RvY10gQW4gZWxlbWVudCBvciBkb2N1bWVudCBvYmplY3QgdG8gdXNlIHRvIHNldCB0aGUgZG9jdW1lbnQKICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGN1cnJlbnQgZG9jdW1lbnQKICAgICAqLwogICAgc2V0RG9jdW1lbnQgPSBTaXp6bGUuc2V0RG9jdW1lbnQgPSBmdW5jdGlvbiAobm9kZSkgewogICAgICB2YXIgaGFzQ29tcGFyZSwKICAgICAgICBzdWJXaW5kb3csCiAgICAgICAgZG9jID0gbm9kZSA/IG5vZGUub3duZXJEb2N1bWVudCB8fCBub2RlIDogcHJlZmVycmVkRG9jOwoKICAgICAgLy8gUmV0dXJuIGVhcmx5IGlmIGRvYyBpcyBpbnZhbGlkIG9yIGFscmVhZHkgc2VsZWN0ZWQKICAgICAgLy8gU3VwcG9ydDogSUUgMTErLCBFZGdlIDE3IC0gMTgrCiAgICAgIC8vIElFL0VkZ2Ugc29tZXRpbWVzIHRocm93IGEgIlBlcm1pc3Npb24gZGVuaWVkIiBlcnJvciB3aGVuIHN0cmljdC1jb21wYXJpbmcKICAgICAgLy8gdHdvIGRvY3VtZW50czsgc2hhbGxvdyBjb21wYXJpc29ucyB3b3JrLgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxCiAgICAgIGlmIChkb2MgPT0gZG9jdW1lbnQgfHwgZG9jLm5vZGVUeXBlICE9PSA5IHx8ICFkb2MuZG9jdW1lbnRFbGVtZW50KSB7CiAgICAgICAgcmV0dXJuIGRvY3VtZW50OwogICAgICB9CgogICAgICAvLyBVcGRhdGUgZ2xvYmFsIHZhcmlhYmxlcwogICAgICBkb2N1bWVudCA9IGRvYzsKICAgICAgZG9jRWxlbSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgICAgZG9jdW1lbnRJc0hUTUwgPSAhaXNYTUwoZG9jdW1lbnQpOwoKICAgICAgLy8gU3VwcG9ydDogSUUgOSAtIDExKywgRWRnZSAxMiAtIDE4KwogICAgICAvLyBBY2Nlc3NpbmcgaWZyYW1lIGRvY3VtZW50cyBhZnRlciB1bmxvYWQgdGhyb3dzICJwZXJtaXNzaW9uIGRlbmllZCIgZXJyb3JzIChqUXVlcnkgIzEzOTM2KQogICAgICAvLyBTdXBwb3J0OiBJRSAxMSssIEVkZ2UgMTcgLSAxOCsKICAgICAgLy8gSUUvRWRnZSBzb21ldGltZXMgdGhyb3cgYSAiUGVybWlzc2lvbiBkZW5pZWQiIGVycm9yIHdoZW4gc3RyaWN0LWNvbXBhcmluZwogICAgICAvLyB0d28gZG9jdW1lbnRzOyBzaGFsbG93IGNvbXBhcmlzb25zIHdvcmsuCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXEKICAgICAgaWYgKHByZWZlcnJlZERvYyAhPSBkb2N1bWVudCAmJiAoc3ViV2luZG93ID0gZG9jdW1lbnQuZGVmYXVsdFZpZXcpICYmIHN1YldpbmRvdy50b3AgIT09IHN1YldpbmRvdykgewogICAgICAgIC8vIFN1cHBvcnQ6IElFIDExLCBFZGdlCiAgICAgICAgaWYgKHN1YldpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgICAgICBzdWJXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigidW5sb2FkIiwgdW5sb2FkSGFuZGxlciwgZmFsc2UpOwoKICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDkgLSAxMCBvbmx5CiAgICAgICAgfSBlbHNlIGlmIChzdWJXaW5kb3cuYXR0YWNoRXZlbnQpIHsKICAgICAgICAgIHN1YldpbmRvdy5hdHRhY2hFdmVudCgib251bmxvYWQiLCB1bmxvYWRIYW5kbGVyKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIFN1cHBvcnQ6IElFIDggLSAxMSssIEVkZ2UgMTIgLSAxOCssIENocm9tZSA8PTE2IC0gMjUgb25seSwgRmlyZWZveCA8PTMuNiAtIDMxIG9ubHksCiAgICAgIC8vIFNhZmFyaSA0IC0gNSBvbmx5LCBPcGVyYSA8PTExLjYgLSAxMi54IG9ubHkKICAgICAgLy8gSUUvRWRnZSAmIG9sZGVyIGJyb3dzZXJzIGRvbid0IHN1cHBvcnQgdGhlIDpzY29wZSBwc2V1ZG8tY2xhc3MuCiAgICAgIC8vIFN1cHBvcnQ6IFNhZmFyaSA2LjAgb25seQogICAgICAvLyBTYWZhcmkgNi4wIHN1cHBvcnRzIDpzY29wZSBidXQgaXQncyBhbiBhbGlhcyBvZiA6cm9vdCB0aGVyZS4KICAgICAgc3VwcG9ydC5zY29wZSA9IGFzc2VydChmdW5jdGlvbiAoZWwpIHsKICAgICAgICBkb2NFbGVtLmFwcGVuZENoaWxkKGVsKS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSk7CiAgICAgICAgcmV0dXJuIHR5cGVvZiBlbC5xdWVyeVNlbGVjdG9yQWxsICE9PSAidW5kZWZpbmVkIiAmJiAhZWwucXVlcnlTZWxlY3RvckFsbCgiOnNjb3BlIGZpZWxkc2V0IGRpdiIpLmxlbmd0aDsKICAgICAgfSk7CgogICAgICAvKiBBdHRyaWJ1dGVzCiAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCiAgICAgIC8vIFN1cHBvcnQ6IElFPDgKICAgICAgLy8gVmVyaWZ5IHRoYXQgZ2V0QXR0cmlidXRlIHJlYWxseSByZXR1cm5zIGF0dHJpYnV0ZXMgYW5kIG5vdCBwcm9wZXJ0aWVzCiAgICAgIC8vIChleGNlcHRpbmcgSUU4IGJvb2xlYW5zKQogICAgICBzdXBwb3J0LmF0dHJpYnV0ZXMgPSBhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgZWwuY2xhc3NOYW1lID0gImkiOwogICAgICAgIHJldHVybiAhZWwuZ2V0QXR0cmlidXRlKCJjbGFzc05hbWUiKTsKICAgICAgfSk7CgogICAgICAvKiBnZXRFbGVtZW50KHMpQnkqCiAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCiAgICAgIC8vIENoZWNrIGlmIGdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikgcmV0dXJucyBvbmx5IGVsZW1lbnRzCiAgICAgIHN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPSBhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlQ29tbWVudCgiIikpOwogICAgICAgIHJldHVybiAhZWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKS5sZW5ndGg7CiAgICAgIH0pOwoKICAgICAgLy8gU3VwcG9ydDogSUU8OQogICAgICBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgPSBybmF0aXZlLnRlc3QoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSk7CgogICAgICAvLyBTdXBwb3J0OiBJRTwxMAogICAgICAvLyBDaGVjayBpZiBnZXRFbGVtZW50QnlJZCByZXR1cm5zIGVsZW1lbnRzIGJ5IG5hbWUKICAgICAgLy8gVGhlIGJyb2tlbiBnZXRFbGVtZW50QnlJZCBtZXRob2RzIGRvbid0IHBpY2sgdXAgcHJvZ3JhbW1hdGljYWxseS1zZXQgbmFtZXMsCiAgICAgIC8vIHNvIHVzZSBhIHJvdW5kYWJvdXQgZ2V0RWxlbWVudHNCeU5hbWUgdGVzdAogICAgICBzdXBwb3J0LmdldEJ5SWQgPSBhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgZG9jRWxlbS5hcHBlbmRDaGlsZChlbCkuaWQgPSBleHBhbmRvOwogICAgICAgIHJldHVybiAhZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUgfHwgIWRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKGV4cGFuZG8pLmxlbmd0aDsKICAgICAgfSk7CgogICAgICAvLyBJRCBmaWx0ZXIgYW5kIGZpbmQKICAgICAgaWYgKHN1cHBvcnQuZ2V0QnlJZCkgewogICAgICAgIEV4cHIuZmlsdGVyWyJJRCJdID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICB2YXIgYXR0cklkID0gaWQucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSk7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCJpZCIpID09PSBhdHRySWQ7CiAgICAgICAgICB9OwogICAgICAgIH07CiAgICAgICAgRXhwci5maW5kWyJJRCJdID0gZnVuY3Rpb24gKGlkLCBjb250ZXh0KSB7CiAgICAgICAgICBpZiAodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQgIT09ICJ1bmRlZmluZWQiICYmIGRvY3VtZW50SXNIVE1MKSB7CiAgICAgICAgICAgIHZhciBlbGVtID0gY29udGV4dC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICAgICAgICAgIHJldHVybiBlbGVtID8gW2VsZW1dIDogW107CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBFeHByLmZpbHRlclsiSUQiXSA9IGZ1bmN0aW9uIChpZCkgewogICAgICAgICAgdmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UocnVuZXNjYXBlLCBmdW5lc2NhcGUpOwogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgICAgIHZhciBub2RlID0gdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlTm9kZSAhPT0gInVuZGVmaW5lZCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpOwogICAgICAgICAgICByZXR1cm4gbm9kZSAmJiBub2RlLnZhbHVlID09PSBhdHRySWQ7CiAgICAgICAgICB9OwogICAgICAgIH07CgogICAgICAgIC8vIFN1cHBvcnQ6IElFIDYgLSA3IG9ubHkKICAgICAgICAvLyBnZXRFbGVtZW50QnlJZCBpcyBub3QgcmVsaWFibGUgYXMgYSBmaW5kIHNob3J0Y3V0CiAgICAgICAgRXhwci5maW5kWyJJRCJdID0gZnVuY3Rpb24gKGlkLCBjb250ZXh0KSB7CiAgICAgICAgICBpZiAodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQgIT09ICJ1bmRlZmluZWQiICYmIGRvY3VtZW50SXNIVE1MKSB7CiAgICAgICAgICAgIHZhciBub2RlLAogICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgZWxlbXMsCiAgICAgICAgICAgICAgZWxlbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgICAgIC8vIFZlcmlmeSB0aGUgaWQgYXR0cmlidXRlCiAgICAgICAgICAgICAgbm9kZSA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTsKICAgICAgICAgICAgICBpZiAobm9kZSAmJiBub2RlLnZhbHVlID09PSBpZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFtlbGVtXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIEZhbGwgYmFjayBvbiBnZXRFbGVtZW50c0J5TmFtZQogICAgICAgICAgICAgIGVsZW1zID0gY29udGV4dC5nZXRFbGVtZW50c0J5TmFtZShpZCk7CiAgICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgICAgd2hpbGUgKGVsZW0gPSBlbGVtc1tpKytdKSB7CiAgICAgICAgICAgICAgICBub2RlID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpOwogICAgICAgICAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS52YWx1ZSA9PT0gaWQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIFtlbGVtXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIC8vIFRhZwogICAgICBFeHByLmZpbmRbIlRBRyJdID0gc3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZSA/IGZ1bmN0aW9uICh0YWcsIGNvbnRleHQpIHsKICAgICAgICBpZiAodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICByZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWcpOwoKICAgICAgICAgIC8vIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgZG9uJ3QgaGF2ZSBnRUJUTgogICAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5xc2EpIHsKICAgICAgICAgIHJldHVybiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwodGFnKTsKICAgICAgICB9CiAgICAgIH0gOiBmdW5jdGlvbiAodGFnLCBjb250ZXh0KSB7CiAgICAgICAgdmFyIGVsZW0sCiAgICAgICAgICB0bXAgPSBbXSwKICAgICAgICAgIGkgPSAwLAogICAgICAgICAgLy8gQnkgaGFwcHkgY29pbmNpZGVuY2UsIGEgKGJyb2tlbikgZ0VCVE4gYXBwZWFycyBvbiBEb2N1bWVudEZyYWdtZW50IG5vZGVzIHRvbwogICAgICAgICAgcmVzdWx0cyA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTsKCiAgICAgICAgLy8gRmlsdGVyIG91dCBwb3NzaWJsZSBjb21tZW50cwogICAgICAgIGlmICh0YWcgPT09ICIqIikgewogICAgICAgICAgd2hpbGUgKGVsZW0gPSByZXN1bHRzW2krK10pIHsKICAgICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICB0bXAucHVzaChlbGVtKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRtcDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICAgIH07CgogICAgICAvLyBDbGFzcwogICAgICBFeHByLmZpbmRbIkNMQVNTIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZnVuY3Rpb24gKGNsYXNzTmFtZSwgY29udGV4dCkgewogICAgICAgIGlmICh0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICE9PSAidW5kZWZpbmVkIiAmJiBkb2N1bWVudElzSFRNTCkgewogICAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc05hbWUpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIC8qIFFTQS9tYXRjaGVzU2VsZWN0b3IKICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKICAgICAgLy8gUVNBIGFuZCBtYXRjaGVzU2VsZWN0b3Igc3VwcG9ydAoKICAgICAgLy8gbWF0Y2hlc1NlbGVjdG9yKDphY3RpdmUpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChJRTkvT3BlcmEgMTEuNSkKICAgICAgcmJ1Z2d5TWF0Y2hlcyA9IFtdOwoKICAgICAgLy8gcVNhKDpmb2N1cykgcmVwb3J0cyBmYWxzZSB3aGVuIHRydWUgKENocm9tZSAyMSkKICAgICAgLy8gV2UgYWxsb3cgdGhpcyBiZWNhdXNlIG9mIGEgYnVnIGluIElFOC85IHRoYXQgdGhyb3dzIGFuIGVycm9yCiAgICAgIC8vIHdoZW5ldmVyIGBkb2N1bWVudC5hY3RpdmVFbGVtZW50YCBpcyBhY2Nlc3NlZCBvbiBhbiBpZnJhbWUKICAgICAgLy8gU28sIHdlIGFsbG93IDpmb2N1cyB0byBwYXNzIHRocm91Z2ggUVNBIGFsbCB0aGUgdGltZSB0byBhdm9pZCB0aGUgSUUgZXJyb3IKICAgICAgLy8gU2VlIGh0dHBzOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMzM3OAogICAgICByYnVnZ3lRU0EgPSBbXTsKICAgICAgaWYgKHN1cHBvcnQucXNhID0gcm5hdGl2ZS50ZXN0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwpKSB7CiAgICAgICAgLy8gQnVpbGQgUVNBIHJlZ2V4CiAgICAgICAgLy8gUmVnZXggc3RyYXRlZ3kgYWRvcHRlZCBmcm9tIERpZWdvIFBlcmluaQogICAgICAgIGFzc2VydChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHZhciBpbnB1dDsKCiAgICAgICAgICAvLyBTZWxlY3QgaXMgc2V0IHRvIGVtcHR5IHN0cmluZyBvbiBwdXJwb3NlCiAgICAgICAgICAvLyBUaGlzIGlzIHRvIHRlc3QgSUUncyB0cmVhdG1lbnQgb2Ygbm90IGV4cGxpY2l0bHkKICAgICAgICAgIC8vIHNldHRpbmcgYSBib29sZWFuIGNvbnRlbnQgYXR0cmlidXRlLAogICAgICAgICAgLy8gc2luY2UgaXRzIHByZXNlbmNlIHNob3VsZCBiZSBlbm91Z2gKICAgICAgICAgIC8vIGh0dHBzOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMjM1OQogICAgICAgICAgZG9jRWxlbS5hcHBlbmRDaGlsZChlbCkuaW5uZXJIVE1MID0gIjxhIGlkPSciICsgZXhwYW5kbyArICInPjwvYT4iICsgIjxzZWxlY3QgaWQ9JyIgKyBleHBhbmRvICsgIi1cclxcJyBtc2FsbG93Y2FwdHVyZT0nJz4iICsgIjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IjsKCiAgICAgICAgICAvLyBTdXBwb3J0OiBJRTgsIE9wZXJhIDExLTEyLjE2CiAgICAgICAgICAvLyBOb3RoaW5nIHNob3VsZCBiZSBzZWxlY3RlZCB3aGVuIGVtcHR5IHN0cmluZ3MgZm9sbG93IF49IG9yICQ9IG9yICo9CiAgICAgICAgICAvLyBUaGUgdGVzdCBhdHRyaWJ1dGUgbXVzdCBiZSB1bmtub3duIGluIE9wZXJhIGJ1dCAic2FmZSIgZm9yIFdpblJUCiAgICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2llL2hoNDY1Mzg4LmFzcHgjYXR0cmlidXRlX3NlY3Rpb24KICAgICAgICAgIGlmIChlbC5xdWVyeVNlbGVjdG9yQWxsKCJbbXNhbGxvd2NhcHR1cmVePScnXSIpLmxlbmd0aCkgewogICAgICAgICAgICByYnVnZ3lRU0EucHVzaCgiWypeJF09IiArIHdoaXRlc3BhY2UgKyAiKig/OicnfFwiXCIpIik7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU3VwcG9ydDogSUU4CiAgICAgICAgICAvLyBCb29sZWFuIGF0dHJpYnV0ZXMgYW5kICJ2YWx1ZSIgYXJlIG5vdCB0cmVhdGVkIGNvcnJlY3RseQogICAgICAgICAgaWYgKCFlbC5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RoKSB7CiAgICAgICAgICAgIHJidWdneVFTQS5wdXNoKCJcXFsiICsgd2hpdGVzcGFjZSArICIqKD86dmFsdWV8IiArIGJvb2xlYW5zICsgIikiKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBTdXBwb3J0OiBDaHJvbWU8MjksIEFuZHJvaWQ8NC40LCBTYWZhcmk8Ny4wKywgaU9TPDcuMCssIFBoYW50b21KUzwxLjkuOCsKICAgICAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iICsgZXhwYW5kbyArICItXSIpLmxlbmd0aCkgewogICAgICAgICAgICByYnVnZ3lRU0EucHVzaCgifj0iKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBTdXBwb3J0OiBJRSAxMSssIEVkZ2UgMTUgLSAxOCsKICAgICAgICAgIC8vIElFIDExL0VkZ2UgZG9uJ3QgZmluZCBlbGVtZW50cyBvbiBhIGBbbmFtZT0nJ11gIHF1ZXJ5IGluIHNvbWUgY2FzZXMuCiAgICAgICAgICAvLyBBZGRpbmcgYSB0ZW1wb3JhcnkgYXR0cmlidXRlIHRvIHRoZSBkb2N1bWVudCBiZWZvcmUgdGhlIHNlbGVjdGlvbiB3b3JrcwogICAgICAgICAgLy8gYXJvdW5kIHRoZSBpc3N1ZS4KICAgICAgICAgIC8vIEludGVyZXN0aW5nbHksIElFIDEwICYgb2xkZXIgZG9uJ3Qgc2VlbSB0byBoYXZlIHRoZSBpc3N1ZS4KICAgICAgICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgibmFtZSIsICIiKTsKICAgICAgICAgIGVsLmFwcGVuZENoaWxkKGlucHV0KTsKICAgICAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9JyddIikubGVuZ3RoKSB7CiAgICAgICAgICAgIHJidWdneVFTQS5wdXNoKCJcXFsiICsgd2hpdGVzcGFjZSArICIqbmFtZSIgKyB3aGl0ZXNwYWNlICsgIio9IiArIHdoaXRlc3BhY2UgKyAiKig/OicnfFwiXCIpIik7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gV2Via2l0L09wZXJhIC0gOmNoZWNrZWQgc2hvdWxkIHJldHVybiBzZWxlY3RlZCBvcHRpb24gZWxlbWVudHMKICAgICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkCiAgICAgICAgICAvLyBJRTggdGhyb3dzIGVycm9yIGhlcmUgYW5kIHdpbGwgbm90IHNlZSBsYXRlciB0ZXN0cwogICAgICAgICAgaWYgKCFlbC5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aCkgewogICAgICAgICAgICByYnVnZ3lRU0EucHVzaCgiOmNoZWNrZWQiKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBTdXBwb3J0OiBTYWZhcmkgOCssIGlPUyA4KwogICAgICAgICAgLy8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEzNjg1MQogICAgICAgICAgLy8gSW4tcGFnZSBgc2VsZWN0b3IjaWQgc2libGluZy1jb21iaW5hdG9yIHNlbGVjdG9yYCBmYWlscwogICAgICAgICAgaWYgKCFlbC5xdWVyeVNlbGVjdG9yQWxsKCJhIyIgKyBleHBhbmRvICsgIisqIikubGVuZ3RoKSB7CiAgICAgICAgICAgIHJidWdneVFTQS5wdXNoKCIuIy4rWyt+XSIpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFN1cHBvcnQ6IEZpcmVmb3ggPD0zLjYgLSA1IG9ubHkKICAgICAgICAgIC8vIE9sZCBGaXJlZm94IGRvZXNuJ3QgdGhyb3cgb24gYSBiYWRseS1lc2NhcGVkIGlkZW50aWZpZXIuCiAgICAgICAgICBlbC5xdWVyeVNlbGVjdG9yQWxsKCJcXFxmIik7CiAgICAgICAgICByYnVnZ3lRU0EucHVzaCgiW1xcclxcblxcZl0iKTsKICAgICAgICB9KTsKICAgICAgICBhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICBlbC5pbm5lckhUTUwgPSAiPGEgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT4iICsgIjxzZWxlY3QgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0aW9uLz48L3NlbGVjdD4iOwoKICAgICAgICAgIC8vIFN1cHBvcnQ6IFdpbmRvd3MgOCBOYXRpdmUgQXBwcwogICAgICAgICAgLy8gVGhlIHR5cGUgYW5kIG5hbWUgYXR0cmlidXRlcyBhcmUgcmVzdHJpY3RlZCBkdXJpbmcgLmlubmVySFRNTCBhc3NpZ25tZW50CiAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwogICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCJ0eXBlIiwgImhpZGRlbiIpOwogICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoaW5wdXQpLnNldEF0dHJpYnV0ZSgibmFtZSIsICJEIik7CgogICAgICAgICAgLy8gU3VwcG9ydDogSUU4CiAgICAgICAgICAvLyBFbmZvcmNlIGNhc2Utc2Vuc2l0aXZpdHkgb2YgbmFtZSBhdHRyaWJ1dGUKICAgICAgICAgIGlmIChlbC5xdWVyeVNlbGVjdG9yQWxsKCJbbmFtZT1kXSIpLmxlbmd0aCkgewogICAgICAgICAgICByYnVnZ3lRU0EucHVzaCgibmFtZSIgKyB3aGl0ZXNwYWNlICsgIipbKl4kfCF+XT89Iik7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gRkYgMy41IC0gOmVuYWJsZWQvOmRpc2FibGVkIGFuZCBoaWRkZW4gZWxlbWVudHMgKGhpZGRlbiBlbGVtZW50cyBhcmUgc3RpbGwgZW5hYmxlZCkKICAgICAgICAgIC8vIElFOCB0aHJvd3MgZXJyb3IgaGVyZSBhbmQgd2lsbCBub3Qgc2VlIGxhdGVyIHRlc3RzCiAgICAgICAgICBpZiAoZWwucXVlcnlTZWxlY3RvckFsbCgiOmVuYWJsZWQiKS5sZW5ndGggIT09IDIpIHsKICAgICAgICAgICAgcmJ1Z2d5UVNBLnB1c2goIjplbmFibGVkIiwgIjpkaXNhYmxlZCIpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFN1cHBvcnQ6IElFOS0xMSsKICAgICAgICAgIC8vIElFJ3MgOmRpc2FibGVkIHNlbGVjdG9yIGRvZXMgbm90IHBpY2sgdXAgdGhlIGNoaWxkcmVuIG9mIGRpc2FibGVkIGZpZWxkc2V0cwogICAgICAgICAgZG9jRWxlbS5hcHBlbmRDaGlsZChlbCkuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgaWYgKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCAhPT0gMikgewogICAgICAgICAgICByYnVnZ3lRU0EucHVzaCgiOmVuYWJsZWQiLCAiOmRpc2FibGVkIik7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU3VwcG9ydDogT3BlcmEgMTAgLSAxMSBvbmx5CiAgICAgICAgICAvLyBPcGVyYSAxMC0xMSBkb2VzIG5vdCB0aHJvdyBvbiBwb3N0LWNvbW1hIGludmFsaWQgcHNldWRvcwogICAgICAgICAgZWwucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpOwogICAgICAgICAgcmJ1Z2d5UVNBLnB1c2goIiwuKjoiKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgPSBybmF0aXZlLnRlc3QobWF0Y2hlcyA9IGRvY0VsZW0ubWF0Y2hlcyB8fCBkb2NFbGVtLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBkb2NFbGVtLm1vek1hdGNoZXNTZWxlY3RvciB8fCBkb2NFbGVtLm9NYXRjaGVzU2VsZWN0b3IgfHwgZG9jRWxlbS5tc01hdGNoZXNTZWxlY3RvcikpIHsKICAgICAgICBhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgaXQncyBwb3NzaWJsZSB0byBkbyBtYXRjaGVzU2VsZWN0b3IKICAgICAgICAgIC8vIG9uIGEgZGlzY29ubmVjdGVkIG5vZGUgKElFIDkpCiAgICAgICAgICBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoID0gbWF0Y2hlcy5jYWxsKGVsLCAiKiIpOwoKICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIGZhaWwgd2l0aCBhbiBleGNlcHRpb24KICAgICAgICAgIC8vIEdlY2tvIGRvZXMgbm90IGVycm9yLCByZXR1cm5zIGZhbHNlIGluc3RlYWQKICAgICAgICAgIG1hdGNoZXMuY2FsbChlbCwgIltzIT0nJ106eCIpOwogICAgICAgICAgcmJ1Z2d5TWF0Y2hlcy5wdXNoKCIhPSIsIHBzZXVkb3MpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJidWdneVFTQSA9IHJidWdneVFTQS5sZW5ndGggJiYgbmV3IFJlZ0V4cChyYnVnZ3lRU0Euam9pbigifCIpKTsKICAgICAgcmJ1Z2d5TWF0Y2hlcyA9IHJidWdneU1hdGNoZXMubGVuZ3RoICYmIG5ldyBSZWdFeHAocmJ1Z2d5TWF0Y2hlcy5qb2luKCJ8IikpOwoKICAgICAgLyogQ29udGFpbnMKICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwogICAgICBoYXNDb21wYXJlID0gcm5hdGl2ZS50ZXN0KGRvY0VsZW0uY29tcGFyZURvY3VtZW50UG9zaXRpb24pOwoKICAgICAgLy8gRWxlbWVudCBjb250YWlucyBhbm90aGVyCiAgICAgIC8vIFB1cnBvc2VmdWxseSBzZWxmLWV4Y2x1c2l2ZQogICAgICAvLyBBcyBpbiwgYW4gZWxlbWVudCBkb2VzIG5vdCBjb250YWluIGl0c2VsZgogICAgICBjb250YWlucyA9IGhhc0NvbXBhcmUgfHwgcm5hdGl2ZS50ZXN0KGRvY0VsZW0uY29udGFpbnMpID8gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICB2YXIgYWRvd24gPSBhLm5vZGVUeXBlID09PSA5ID8gYS5kb2N1bWVudEVsZW1lbnQgOiBhLAogICAgICAgICAgYnVwID0gYiAmJiBiLnBhcmVudE5vZGU7CiAgICAgICAgcmV0dXJuIGEgPT09IGJ1cCB8fCAhIShidXAgJiYgYnVwLm5vZGVUeXBlID09PSAxICYmIChhZG93bi5jb250YWlucyA/IGFkb3duLmNvbnRhaW5zKGJ1cCkgOiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICYmIGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYnVwKSAmIDE2KSk7CiAgICAgIH0gOiBmdW5jdGlvbiAoYSwgYikgewogICAgICAgIGlmIChiKSB7CiAgICAgICAgICB3aGlsZSAoYiA9IGIucGFyZW50Tm9kZSkgewogICAgICAgICAgICBpZiAoYiA9PT0gYSkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfTsKCiAgICAgIC8qIFNvcnRpbmcKICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKICAgICAgLy8gRG9jdW1lbnQgb3JkZXIgc29ydGluZwogICAgICBzb3J0T3JkZXIgPSBoYXNDb21wYXJlID8gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAvLyBGbGFnIGZvciBkdXBsaWNhdGUgcmVtb3ZhbAogICAgICAgIGlmIChhID09PSBiKSB7CiAgICAgICAgICBoYXNEdXBsaWNhdGUgPSB0cnVlOwogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICAvLyBTb3J0IG9uIG1ldGhvZCBleGlzdGVuY2UgaWYgb25seSBvbmUgaW5wdXQgaGFzIGNvbXBhcmVEb2N1bWVudFBvc2l0aW9uCiAgICAgICAgdmFyIGNvbXBhcmUgPSAhYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAtICFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uOwogICAgICAgIGlmIChjb21wYXJlKSB7CiAgICAgICAgICByZXR1cm4gY29tcGFyZTsKICAgICAgICB9CgogICAgICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiBpZiBib3RoIGlucHV0cyBiZWxvbmcgdG8gdGhlIHNhbWUgZG9jdW1lbnQKICAgICAgICAvLyBTdXBwb3J0OiBJRSAxMSssIEVkZ2UgMTcgLSAxOCsKICAgICAgICAvLyBJRS9FZGdlIHNvbWV0aW1lcyB0aHJvdyBhICJQZXJtaXNzaW9uIGRlbmllZCIgZXJyb3Igd2hlbiBzdHJpY3QtY29tcGFyaW5nCiAgICAgICAgLy8gdHdvIGRvY3VtZW50czsgc2hhbGxvdyBjb21wYXJpc29ucyB3b3JrLgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXEKICAgICAgICBjb21wYXJlID0gKGEub3duZXJEb2N1bWVudCB8fCBhKSA9PSAoYi5vd25lckRvY3VtZW50IHx8IGIpID8gYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKSA6CiAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIGtub3cgdGhleSBhcmUgZGlzY29ubmVjdGVkCiAgICAgICAgMTsKCiAgICAgICAgLy8gRGlzY29ubmVjdGVkIG5vZGVzCiAgICAgICAgaWYgKGNvbXBhcmUgJiAxIHx8ICFzdXBwb3J0LnNvcnREZXRhY2hlZCAmJiBiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGEpID09PSBjb21wYXJlKSB7CiAgICAgICAgICAvLyBDaG9vc2UgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBpcyByZWxhdGVkIHRvIG91ciBwcmVmZXJyZWQgZG9jdW1lbnQKICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDExKywgRWRnZSAxNyAtIDE4KwogICAgICAgICAgLy8gSUUvRWRnZSBzb21ldGltZXMgdGhyb3cgYSAiUGVybWlzc2lvbiBkZW5pZWQiIGVycm9yIHdoZW4gc3RyaWN0LWNvbXBhcmluZwogICAgICAgICAgLy8gdHdvIGRvY3VtZW50czsgc2hhbGxvdyBjb21wYXJpc29ucyB3b3JrLgogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGVxZXFlcQogICAgICAgICAgaWYgKGEgPT0gZG9jdW1lbnQgfHwgYS5vd25lckRvY3VtZW50ID09IHByZWZlcnJlZERvYyAmJiBjb250YWlucyhwcmVmZXJyZWREb2MsIGEpKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBTdXBwb3J0OiBJRSAxMSssIEVkZ2UgMTcgLSAxOCsKICAgICAgICAgIC8vIElFL0VkZ2Ugc29tZXRpbWVzIHRocm93IGEgIlBlcm1pc3Npb24gZGVuaWVkIiBlcnJvciB3aGVuIHN0cmljdC1jb21wYXJpbmcKICAgICAgICAgIC8vIHR3byBkb2N1bWVudHM7IHNoYWxsb3cgY29tcGFyaXNvbnMgd29yay4KICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXEKICAgICAgICAgIGlmIChiID09IGRvY3VtZW50IHx8IGIub3duZXJEb2N1bWVudCA9PSBwcmVmZXJyZWREb2MgJiYgY29udGFpbnMocHJlZmVycmVkRG9jLCBiKSkgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBNYWludGFpbiBvcmlnaW5hbCBvcmRlcgogICAgICAgICAgcmV0dXJuIHNvcnRJbnB1dCA/IGluZGV4T2Yoc29ydElucHV0LCBhKSAtIGluZGV4T2Yoc29ydElucHV0LCBiKSA6IDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb21wYXJlICYgNCA/IC0xIDogMTsKICAgICAgfSA6IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgLy8gRXhpdCBlYXJseSBpZiB0aGUgbm9kZXMgYXJlIGlkZW50aWNhbAogICAgICAgIGlmIChhID09PSBiKSB7CiAgICAgICAgICBoYXNEdXBsaWNhdGUgPSB0cnVlOwogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHZhciBjdXIsCiAgICAgICAgICBpID0gMCwKICAgICAgICAgIGF1cCA9IGEucGFyZW50Tm9kZSwKICAgICAgICAgIGJ1cCA9IGIucGFyZW50Tm9kZSwKICAgICAgICAgIGFwID0gW2FdLAogICAgICAgICAgYnAgPSBbYl07CgogICAgICAgIC8vIFBhcmVudGxlc3Mgbm9kZXMgYXJlIGVpdGhlciBkb2N1bWVudHMgb3IgZGlzY29ubmVjdGVkCiAgICAgICAgaWYgKCFhdXAgfHwgIWJ1cCkgewogICAgICAgICAgLy8gU3VwcG9ydDogSUUgMTErLCBFZGdlIDE3IC0gMTgrCiAgICAgICAgICAvLyBJRS9FZGdlIHNvbWV0aW1lcyB0aHJvdyBhICJQZXJtaXNzaW9uIGRlbmllZCIgZXJyb3Igd2hlbiBzdHJpY3QtY29tcGFyaW5nCiAgICAgICAgICAvLyB0d28gZG9jdW1lbnRzOyBzaGFsbG93IGNvbXBhcmlzb25zIHdvcmsuCiAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi8KICAgICAgICAgIHJldHVybiBhID09IGRvY3VtZW50ID8gLTEgOiBiID09IGRvY3VtZW50ID8gMSA6IC8qIGVzbGludC1lbmFibGUgZXFlcWVxICovCiAgICAgICAgICBhdXAgPyAtMSA6IGJ1cCA/IDEgOiBzb3J0SW5wdXQgPyBpbmRleE9mKHNvcnRJbnB1dCwgYSkgLSBpbmRleE9mKHNvcnRJbnB1dCwgYikgOiAwOwoKICAgICAgICAgIC8vIElmIHRoZSBub2RlcyBhcmUgc2libGluZ3MsIHdlIGNhbiBkbyBhIHF1aWNrIGNoZWNrCiAgICAgICAgfSBlbHNlIGlmIChhdXAgPT09IGJ1cCkgewogICAgICAgICAgcmV0dXJuIHNpYmxpbmdDaGVjayhhLCBiKTsKICAgICAgICB9CgogICAgICAgIC8vIE90aGVyd2lzZSB3ZSBuZWVkIGZ1bGwgbGlzdHMgb2YgdGhlaXIgYW5jZXN0b3JzIGZvciBjb21wYXJpc29uCiAgICAgICAgY3VyID0gYTsKICAgICAgICB3aGlsZSAoY3VyID0gY3VyLnBhcmVudE5vZGUpIHsKICAgICAgICAgIGFwLnVuc2hpZnQoY3VyKTsKICAgICAgICB9CiAgICAgICAgY3VyID0gYjsKICAgICAgICB3aGlsZSAoY3VyID0gY3VyLnBhcmVudE5vZGUpIHsKICAgICAgICAgIGJwLnVuc2hpZnQoY3VyKTsKICAgICAgICB9CgogICAgICAgIC8vIFdhbGsgZG93biB0aGUgdHJlZSBsb29raW5nIGZvciBhIGRpc2NyZXBhbmN5CiAgICAgICAgd2hpbGUgKGFwW2ldID09PSBicFtpXSkgewogICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gaSA/CiAgICAgICAgLy8gRG8gYSBzaWJsaW5nIGNoZWNrIGlmIHRoZSBub2RlcyBoYXZlIGEgY29tbW9uIGFuY2VzdG9yCiAgICAgICAgc2libGluZ0NoZWNrKGFwW2ldLCBicFtpXSkgOgogICAgICAgIC8vIE90aGVyd2lzZSBub2RlcyBpbiBvdXIgZG9jdW1lbnQgc29ydCBmaXJzdAogICAgICAgIC8vIFN1cHBvcnQ6IElFIDExKywgRWRnZSAxNyAtIDE4KwogICAgICAgIC8vIElFL0VkZ2Ugc29tZXRpbWVzIHRocm93IGEgIlBlcm1pc3Npb24gZGVuaWVkIiBlcnJvciB3aGVuIHN0cmljdC1jb21wYXJpbmcKICAgICAgICAvLyB0d28gZG9jdW1lbnRzOyBzaGFsbG93IGNvbXBhcmlzb25zIHdvcmsuCiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgZXFlcWVxICovCiAgICAgICAgYXBbaV0gPT0gcHJlZmVycmVkRG9jID8gLTEgOiBicFtpXSA9PSBwcmVmZXJyZWREb2MgPyAxIDogLyogZXNsaW50LWVuYWJsZSBlcWVxZXEgKi8KICAgICAgICAwOwogICAgICB9OwogICAgICByZXR1cm4gZG9jdW1lbnQ7CiAgICB9OwogICAgU2l6emxlLm1hdGNoZXMgPSBmdW5jdGlvbiAoZXhwciwgZWxlbWVudHMpIHsKICAgICAgcmV0dXJuIFNpenpsZShleHByLCBudWxsLCBudWxsLCBlbGVtZW50cyk7CiAgICB9OwogICAgU2l6emxlLm1hdGNoZXNTZWxlY3RvciA9IGZ1bmN0aW9uIChlbGVtLCBleHByKSB7CiAgICAgIHNldERvY3VtZW50KGVsZW0pOwogICAgICBpZiAoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgJiYgZG9jdW1lbnRJc0hUTUwgJiYgIW5vbm5hdGl2ZVNlbGVjdG9yQ2FjaGVbZXhwciArICIgIl0gJiYgKCFyYnVnZ3lNYXRjaGVzIHx8ICFyYnVnZ3lNYXRjaGVzLnRlc3QoZXhwcikpICYmICghcmJ1Z2d5UVNBIHx8ICFyYnVnZ3lRU0EudGVzdChleHByKSkpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdmFyIHJldCA9IG1hdGNoZXMuY2FsbChlbGVtLCBleHByKTsKCiAgICAgICAgICAvLyBJRSA5J3MgbWF0Y2hlc1NlbGVjdG9yIHJldHVybnMgZmFsc2Ugb24gZGlzY29ubmVjdGVkIG5vZGVzCiAgICAgICAgICBpZiAocmV0IHx8IHN1cHBvcnQuZGlzY29ubmVjdGVkTWF0Y2ggfHwKICAgICAgICAgIC8vIEFzIHdlbGwsIGRpc2Nvbm5lY3RlZCBub2RlcyBhcmUgc2FpZCB0byBiZSBpbiBhIGRvY3VtZW50CiAgICAgICAgICAvLyBmcmFnbWVudCBpbiBJRSA5CiAgICAgICAgICBlbGVtLmRvY3VtZW50ICYmIGVsZW0uZG9jdW1lbnQubm9kZVR5cGUgIT09IDExKSB7CiAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgbm9ubmF0aXZlU2VsZWN0b3JDYWNoZShleHByLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIFNpenpsZShleHByLCBkb2N1bWVudCwgbnVsbCwgW2VsZW1dKS5sZW5ndGggPiAwOwogICAgfTsKICAgIFNpenpsZS5jb250YWlucyA9IGZ1bmN0aW9uIChjb250ZXh0LCBlbGVtKSB7CiAgICAgIC8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZAogICAgICAvLyBTdXBwb3J0OiBJRSAxMSssIEVkZ2UgMTcgLSAxOCsKICAgICAgLy8gSUUvRWRnZSBzb21ldGltZXMgdGhyb3cgYSAiUGVybWlzc2lvbiBkZW5pZWQiIGVycm9yIHdoZW4gc3RyaWN0LWNvbXBhcmluZwogICAgICAvLyB0d28gZG9jdW1lbnRzOyBzaGFsbG93IGNvbXBhcmlzb25zIHdvcmsuCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXEKICAgICAgaWYgKChjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCkgIT0gZG9jdW1lbnQpIHsKICAgICAgICBzZXREb2N1bWVudChjb250ZXh0KTsKICAgICAgfQogICAgICByZXR1cm4gY29udGFpbnMoY29udGV4dCwgZWxlbSk7CiAgICB9OwogICAgU2l6emxlLmF0dHIgPSBmdW5jdGlvbiAoZWxlbSwgbmFtZSkgewogICAgICAvLyBTZXQgZG9jdW1lbnQgdmFycyBpZiBuZWVkZWQKICAgICAgLy8gU3VwcG9ydDogSUUgMTErLCBFZGdlIDE3IC0gMTgrCiAgICAgIC8vIElFL0VkZ2Ugc29tZXRpbWVzIHRocm93IGEgIlBlcm1pc3Npb24gZGVuaWVkIiBlcnJvciB3aGVuIHN0cmljdC1jb21wYXJpbmcKICAgICAgLy8gdHdvIGRvY3VtZW50czsgc2hhbGxvdyBjb21wYXJpc29ucyB3b3JrLgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxCiAgICAgIGlmICgoZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0pICE9IGRvY3VtZW50KSB7CiAgICAgICAgc2V0RG9jdW1lbnQoZWxlbSk7CiAgICAgIH0KICAgICAgdmFyIGZuID0gRXhwci5hdHRySGFuZGxlW25hbWUudG9Mb3dlckNhc2UoKV0sCiAgICAgICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKGpRdWVyeSAjMTM4MDcpCiAgICAgICAgdmFsID0gZm4gJiYgaGFzT3duLmNhbGwoRXhwci5hdHRySGFuZGxlLCBuYW1lLnRvTG93ZXJDYXNlKCkpID8gZm4oZWxlbSwgbmFtZSwgIWRvY3VtZW50SXNIVE1MKSA6IHVuZGVmaW5lZDsKICAgICAgcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkID8gdmFsIDogc3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFkb2N1bWVudElzSFRNTCA/IGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUpIDogKHZhbCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKSkgJiYgdmFsLnNwZWNpZmllZCA/IHZhbC52YWx1ZSA6IG51bGw7CiAgICB9OwogICAgU2l6emxlLmVzY2FwZSA9IGZ1bmN0aW9uIChzZWwpIHsKICAgICAgcmV0dXJuIChzZWwgKyAiIikucmVwbGFjZShyY3NzZXNjYXBlLCBmY3NzZXNjYXBlKTsKICAgIH07CiAgICBTaXp6bGUuZXJyb3IgPSBmdW5jdGlvbiAobXNnKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIiArIG1zZyk7CiAgICB9OwoKICAgIC8qKgogICAgICogRG9jdW1lbnQgc29ydGluZyBhbmQgcmVtb3ZpbmcgZHVwbGljYXRlcwogICAgICogQHBhcmFtIHtBcnJheUxpa2V9IHJlc3VsdHMKICAgICAqLwogICAgU2l6emxlLnVuaXF1ZVNvcnQgPSBmdW5jdGlvbiAocmVzdWx0cykgewogICAgICB2YXIgZWxlbSwKICAgICAgICBkdXBsaWNhdGVzID0gW10sCiAgICAgICAgaiA9IDAsCiAgICAgICAgaSA9IDA7CgogICAgICAvLyBVbmxlc3Mgd2UgKmtub3cqIHdlIGNhbiBkZXRlY3QgZHVwbGljYXRlcywgYXNzdW1lIHRoZWlyIHByZXNlbmNlCiAgICAgIGhhc0R1cGxpY2F0ZSA9ICFzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXM7CiAgICAgIHNvcnRJbnB1dCA9ICFzdXBwb3J0LnNvcnRTdGFibGUgJiYgcmVzdWx0cy5zbGljZSgwKTsKICAgICAgcmVzdWx0cy5zb3J0KHNvcnRPcmRlcik7CiAgICAgIGlmIChoYXNEdXBsaWNhdGUpIHsKICAgICAgICB3aGlsZSAoZWxlbSA9IHJlc3VsdHNbaSsrXSkgewogICAgICAgICAgaWYgKGVsZW0gPT09IHJlc3VsdHNbaV0pIHsKICAgICAgICAgICAgaiA9IGR1cGxpY2F0ZXMucHVzaChpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd2hpbGUgKGotLSkgewogICAgICAgICAgcmVzdWx0cy5zcGxpY2UoZHVwbGljYXRlc1tqXSwgMSk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBDbGVhciBpbnB1dCBhZnRlciBzb3J0aW5nIHRvIHJlbGVhc2Ugb2JqZWN0cwogICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9zaXp6bGUvcHVsbC8yMjUKICAgICAgc29ydElucHV0ID0gbnVsbDsKICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICB9OwoKICAgIC8qKgogICAgICogVXRpbGl0eSBmdW5jdGlvbiBmb3IgcmV0cmlldmluZyB0aGUgdGV4dCB2YWx1ZSBvZiBhbiBhcnJheSBvZiBET00gbm9kZXMKICAgICAqIEBwYXJhbSB7QXJyYXl8RWxlbWVudH0gZWxlbQogICAgICovCiAgICBnZXRUZXh0ID0gU2l6emxlLmdldFRleHQgPSBmdW5jdGlvbiAoZWxlbSkgewogICAgICB2YXIgbm9kZSwKICAgICAgICByZXQgPSAiIiwKICAgICAgICBpID0gMCwKICAgICAgICBub2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7CiAgICAgIGlmICghbm9kZVR5cGUpIHsKICAgICAgICAvLyBJZiBubyBub2RlVHlwZSwgdGhpcyBpcyBleHBlY3RlZCB0byBiZSBhbiBhcnJheQogICAgICAgIHdoaWxlIChub2RlID0gZWxlbVtpKytdKSB7CiAgICAgICAgICAvLyBEbyBub3QgdHJhdmVyc2UgY29tbWVudCBub2RlcwogICAgICAgICAgcmV0ICs9IGdldFRleHQobm9kZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5vZGVUeXBlID09PSAxIHx8IG5vZGVUeXBlID09PSA5IHx8IG5vZGVUeXBlID09PSAxMSkgewogICAgICAgIC8vIFVzZSB0ZXh0Q29udGVudCBmb3IgZWxlbWVudHMKICAgICAgICAvLyBpbm5lclRleHQgdXNhZ2UgcmVtb3ZlZCBmb3IgY29uc2lzdGVuY3kgb2YgbmV3IGxpbmVzIChqUXVlcnkgIzExMTUzKQogICAgICAgIGlmICh0eXBlb2YgZWxlbS50ZXh0Q29udGVudCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIHJldHVybiBlbGVtLnRleHRDb250ZW50OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBUcmF2ZXJzZSBpdHMgY2hpbGRyZW4KICAgICAgICAgIGZvciAoZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcpIHsKICAgICAgICAgICAgcmV0ICs9IGdldFRleHQoZWxlbSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5vZGVUeXBlID09PSAzIHx8IG5vZGVUeXBlID09PSA0KSB7CiAgICAgICAgcmV0dXJuIGVsZW0ubm9kZVZhbHVlOwogICAgICB9CgogICAgICAvLyBEbyBub3QgaW5jbHVkZSBjb21tZW50IG9yIHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb24gbm9kZXMKCiAgICAgIHJldHVybiByZXQ7CiAgICB9OwogICAgRXhwciA9IFNpenpsZS5zZWxlY3RvcnMgPSB7CiAgICAgIC8vIENhbiBiZSBhZGp1c3RlZCBieSB0aGUgdXNlcgogICAgICBjYWNoZUxlbmd0aDogNTAsCiAgICAgIGNyZWF0ZVBzZXVkbzogbWFya0Z1bmN0aW9uLAogICAgICBtYXRjaDogbWF0Y2hFeHByLAogICAgICBhdHRySGFuZGxlOiB7fSwKICAgICAgZmluZDoge30sCiAgICAgIHJlbGF0aXZlOiB7CiAgICAgICAgIj4iOiB7CiAgICAgICAgICBkaXI6ICJwYXJlbnROb2RlIiwKICAgICAgICAgIGZpcnN0OiB0cnVlCiAgICAgICAgfSwKICAgICAgICAiICI6IHsKICAgICAgICAgIGRpcjogInBhcmVudE5vZGUiCiAgICAgICAgfSwKICAgICAgICAiKyI6IHsKICAgICAgICAgIGRpcjogInByZXZpb3VzU2libGluZyIsCiAgICAgICAgICBmaXJzdDogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgIn4iOiB7CiAgICAgICAgICBkaXI6ICJwcmV2aW91c1NpYmxpbmciCiAgICAgICAgfQogICAgICB9LAogICAgICBwcmVGaWx0ZXI6IHsKICAgICAgICAiQVRUUiI6IGZ1bmN0aW9uIEFUVFIobWF0Y2gpIHsKICAgICAgICAgIG1hdGNoWzFdID0gbWF0Y2hbMV0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSk7CgogICAgICAgICAgLy8gTW92ZSB0aGUgZ2l2ZW4gdmFsdWUgdG8gbWF0Y2hbM10gd2hldGhlciBxdW90ZWQgb3IgdW5xdW90ZWQKICAgICAgICAgIG1hdGNoWzNdID0gKG1hdGNoWzNdIHx8IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8ICIiKS5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKTsKICAgICAgICAgIGlmIChtYXRjaFsyXSA9PT0gIn49IikgewogICAgICAgICAgICBtYXRjaFszXSA9ICIgIiArIG1hdGNoWzNdICsgIiAiOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG1hdGNoLnNsaWNlKDAsIDQpOwogICAgICAgIH0sCiAgICAgICAgIkNISUxEIjogZnVuY3Rpb24gQ0hJTEQobWF0Y2gpIHsKICAgICAgICAgIC8qIG1hdGNoZXMgZnJvbSBtYXRjaEV4cHJbIkNISUxEIl0KICAgICAgICAgIDEgdHlwZSAob25seXxudGh8Li4uKQogICAgICAgICAgMiB3aGF0IChjaGlsZHxvZi10eXBlKQogICAgICAgICAgMyBhcmd1bWVudCAoZXZlbnxvZGR8XGQqfFxkKm4oWystXVxkKyk/fC4uLikKICAgICAgICAgIDQgeG4tY29tcG9uZW50IG9mIHhuK3kgYXJndW1lbnQgKFsrLV0/XGQqbnwpCiAgICAgICAgICA1IHNpZ24gb2YgeG4tY29tcG9uZW50CiAgICAgICAgICA2IHggb2YgeG4tY29tcG9uZW50CiAgICAgICAgICA3IHNpZ24gb2YgeS1jb21wb25lbnQKICAgICAgICAgIDggeSBvZiB5LWNvbXBvbmVudAogICAgICAgICAgKi8KICAgICAgICAgIG1hdGNoWzFdID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTsKICAgICAgICAgIGlmIChtYXRjaFsxXS5zbGljZSgwLCAzKSA9PT0gIm50aCIpIHsKICAgICAgICAgICAgLy8gbnRoLSogcmVxdWlyZXMgYXJndW1lbnQKICAgICAgICAgICAgaWYgKCFtYXRjaFszXSkgewogICAgICAgICAgICAgIFNpenpsZS5lcnJvcihtYXRjaFswXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIG51bWVyaWMgeCBhbmQgeSBwYXJhbWV0ZXJzIGZvciBFeHByLmZpbHRlci5DSElMRAogICAgICAgICAgICAvLyByZW1lbWJlciB0aGF0IGZhbHNlL3RydWUgY2FzdCByZXNwZWN0aXZlbHkgdG8gMC8xCiAgICAgICAgICAgIG1hdGNoWzRdID0gKyhtYXRjaFs0XSA/IG1hdGNoWzVdICsgKG1hdGNoWzZdIHx8IDEpIDogMiAqIChtYXRjaFszXSA9PT0gImV2ZW4iIHx8IG1hdGNoWzNdID09PSAib2RkIikpOwogICAgICAgICAgICBtYXRjaFs1XSA9ICsobWF0Y2hbN10gKyBtYXRjaFs4XSB8fCBtYXRjaFszXSA9PT0gIm9kZCIpOwoKICAgICAgICAgICAgLy8gb3RoZXIgdHlwZXMgcHJvaGliaXQgYXJndW1lbnRzCiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoWzNdKSB7CiAgICAgICAgICAgIFNpenpsZS5lcnJvcihtYXRjaFswXSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgfSwKICAgICAgICAiUFNFVURPIjogZnVuY3Rpb24gUFNFVURPKG1hdGNoKSB7CiAgICAgICAgICB2YXIgZXhjZXNzLAogICAgICAgICAgICB1bnF1b3RlZCA9ICFtYXRjaFs2XSAmJiBtYXRjaFsyXTsKICAgICAgICAgIGlmIChtYXRjaEV4cHJbIkNISUxEIl0udGVzdChtYXRjaFswXSkpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQWNjZXB0IHF1b3RlZCBhcmd1bWVudHMgYXMtaXMKICAgICAgICAgIGlmIChtYXRjaFszXSkgewogICAgICAgICAgICBtYXRjaFsyXSA9IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8ICIiOwoKICAgICAgICAgICAgLy8gU3RyaXAgZXhjZXNzIGNoYXJhY3RlcnMgZnJvbSB1bnF1b3RlZCBhcmd1bWVudHMKICAgICAgICAgIH0gZWxzZSBpZiAodW5xdW90ZWQgJiYgcnBzZXVkby50ZXN0KHVucXVvdGVkKSAmJiAoCiAgICAgICAgICAvLyBHZXQgZXhjZXNzIGZyb20gdG9rZW5pemUgKHJlY3Vyc2l2ZWx5KQogICAgICAgICAgZXhjZXNzID0gdG9rZW5pemUodW5xdW90ZWQsIHRydWUpKSAmJiAoCiAgICAgICAgICAvLyBhZHZhbmNlIHRvIHRoZSBuZXh0IGNsb3NpbmcgcGFyZW50aGVzaXMKICAgICAgICAgIGV4Y2VzcyA9IHVucXVvdGVkLmluZGV4T2YoIikiLCB1bnF1b3RlZC5sZW5ndGggLSBleGNlc3MpIC0gdW5xdW90ZWQubGVuZ3RoKSkgewogICAgICAgICAgICAvLyBleGNlc3MgaXMgYSBuZWdhdGl2ZSBpbmRleAogICAgICAgICAgICBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKDAsIGV4Y2Vzcyk7CiAgICAgICAgICAgIG1hdGNoWzJdID0gdW5xdW90ZWQuc2xpY2UoMCwgZXhjZXNzKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBSZXR1cm4gb25seSBjYXB0dXJlcyBuZWVkZWQgYnkgdGhlIHBzZXVkbyBmaWx0ZXIgbWV0aG9kICh0eXBlIGFuZCBhcmd1bWVudCkKICAgICAgICAgIHJldHVybiBtYXRjaC5zbGljZSgwLCAzKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZpbHRlcjogewogICAgICAgICJUQUciOiBmdW5jdGlvbiBUQUcobm9kZU5hbWVTZWxlY3RvcikgewogICAgICAgICAgdmFyIG5vZGVOYW1lID0gbm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgcmV0dXJuIG5vZGVOYW1lU2VsZWN0b3IgPT09ICIqIiA/IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9IDogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBub2RlTmFtZTsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICAiQ0xBU1MiOiBmdW5jdGlvbiBDTEFTUyhjbGFzc05hbWUpIHsKICAgICAgICAgIHZhciBwYXR0ZXJuID0gY2xhc3NDYWNoZVtjbGFzc05hbWUgKyAiICJdOwogICAgICAgICAgcmV0dXJuIHBhdHRlcm4gfHwgKHBhdHRlcm4gPSBuZXcgUmVnRXhwKCIoXnwiICsgd2hpdGVzcGFjZSArICIpIiArIGNsYXNzTmFtZSArICIoIiArIHdoaXRlc3BhY2UgKyAifCQpIikpICYmIGNsYXNzQ2FjaGUoY2xhc3NOYW1lLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgICByZXR1cm4gcGF0dGVybi50ZXN0KHR5cGVvZiBlbGVtLmNsYXNzTmFtZSA9PT0gInN0cmluZyIgJiYgZWxlbS5jbGFzc05hbWUgfHwgdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlICE9PSAidW5kZWZpbmVkIiAmJiBlbGVtLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSB8fCAiIik7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgICJBVFRSIjogZnVuY3Rpb24gQVRUUihuYW1lLCBvcGVyYXRvciwgY2hlY2spIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gU2l6emxlLmF0dHIoZWxlbSwgbmFtZSk7CiAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCkgewogICAgICAgICAgICAgIHJldHVybiBvcGVyYXRvciA9PT0gIiE9IjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIW9wZXJhdG9yKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzdWx0ICs9ICIiOwoKICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqLwoKICAgICAgICAgICAgcmV0dXJuIG9wZXJhdG9yID09PSAiPSIgPyByZXN1bHQgPT09IGNoZWNrIDogb3BlcmF0b3IgPT09ICIhPSIgPyByZXN1bHQgIT09IGNoZWNrIDogb3BlcmF0b3IgPT09ICJePSIgPyBjaGVjayAmJiByZXN1bHQuaW5kZXhPZihjaGVjaykgPT09IDAgOiBvcGVyYXRvciA9PT0gIio9IiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKGNoZWNrKSA+IC0xIDogb3BlcmF0b3IgPT09ICIkPSIgPyBjaGVjayAmJiByZXN1bHQuc2xpY2UoLWNoZWNrLmxlbmd0aCkgPT09IGNoZWNrIDogb3BlcmF0b3IgPT09ICJ+PSIgPyAoIiAiICsgcmVzdWx0LnJlcGxhY2UocndoaXRlc3BhY2UsICIgIikgKyAiICIpLmluZGV4T2YoY2hlY2spID4gLTEgOiBvcGVyYXRvciA9PT0gInw9IiA/IHJlc3VsdCA9PT0gY2hlY2sgfHwgcmVzdWx0LnNsaWNlKDAsIGNoZWNrLmxlbmd0aCArIDEpID09PSBjaGVjayArICItIiA6IGZhbHNlOwogICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG1heC1sZW4gKi8KICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgIkNISUxEIjogZnVuY3Rpb24gQ0hJTEQodHlwZSwgd2hhdCwgX2FyZ3VtZW50LCBmaXJzdCwgbGFzdCkgewogICAgICAgICAgdmFyIHNpbXBsZSA9IHR5cGUuc2xpY2UoMCwgMykgIT09ICJudGgiLAogICAgICAgICAgICBmb3J3YXJkID0gdHlwZS5zbGljZSgtNCkgIT09ICJsYXN0IiwKICAgICAgICAgICAgb2ZUeXBlID0gd2hhdCA9PT0gIm9mLXR5cGUiOwogICAgICAgICAgcmV0dXJuIGZpcnN0ID09PSAxICYmIGxhc3QgPT09IDAgPwogICAgICAgICAgLy8gU2hvcnRjdXQgZm9yIDpudGgtKihuKQogICAgICAgICAgZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgcmV0dXJuICEhZWxlbS5wYXJlbnROb2RlOwogICAgICAgICAgfSA6IGZ1bmN0aW9uIChlbGVtLCBfY29udGV4dCwgeG1sKSB7CiAgICAgICAgICAgIHZhciBjYWNoZSwKICAgICAgICAgICAgICB1bmlxdWVDYWNoZSwKICAgICAgICAgICAgICBvdXRlckNhY2hlLAogICAgICAgICAgICAgIG5vZGUsCiAgICAgICAgICAgICAgbm9kZUluZGV4LAogICAgICAgICAgICAgIHN0YXJ0LAogICAgICAgICAgICAgIGRpciA9IHNpbXBsZSAhPT0gZm9yd2FyZCA/ICJuZXh0U2libGluZyIgOiAicHJldmlvdXNTaWJsaW5nIiwKICAgICAgICAgICAgICBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGUsCiAgICAgICAgICAgICAgbmFtZSA9IG9mVHlwZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksCiAgICAgICAgICAgICAgdXNlQ2FjaGUgPSAheG1sICYmICFvZlR5cGUsCiAgICAgICAgICAgICAgZGlmZiA9IGZhbHNlOwogICAgICAgICAgICBpZiAocGFyZW50KSB7CiAgICAgICAgICAgICAgLy8gOihmaXJzdHxsYXN0fG9ubHkpLShjaGlsZHxvZi10eXBlKQogICAgICAgICAgICAgIGlmIChzaW1wbGUpIHsKICAgICAgICAgICAgICAgIHdoaWxlIChkaXIpIHsKICAgICAgICAgICAgICAgICAgbm9kZSA9IGVsZW07CiAgICAgICAgICAgICAgICAgIHdoaWxlIChub2RlID0gbm9kZVtkaXJdKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9mVHlwZSA/IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6IG5vZGUubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIC8vIFJldmVyc2UgZGlyZWN0aW9uIGZvciA6b25seS0qIChpZiB3ZSBoYXZlbid0IHlldCBkb25lIHNvKQogICAgICAgICAgICAgICAgICBzdGFydCA9IGRpciA9IHR5cGUgPT09ICJvbmx5IiAmJiAhc3RhcnQgJiYgIm5leHRTaWJsaW5nIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzdGFydCA9IFtmb3J3YXJkID8gcGFyZW50LmZpcnN0Q2hpbGQgOiBwYXJlbnQubGFzdENoaWxkXTsKCiAgICAgICAgICAgICAgLy8gbm9uLXhtbCA6bnRoLWNoaWxkKC4uLikgc3RvcmVzIGNhY2hlIGRhdGEgb24gYHBhcmVudGAKICAgICAgICAgICAgICBpZiAoZm9yd2FyZCAmJiB1c2VDYWNoZSkgewogICAgICAgICAgICAgICAgLy8gU2VlayBgZWxlbWAgZnJvbSBhIHByZXZpb3VzbHktY2FjaGVkIGluZGV4CgogICAgICAgICAgICAgICAgLy8gLi4uaW4gYSBnemlwLWZyaWVuZGx5IHdheQogICAgICAgICAgICAgICAgbm9kZSA9IHBhcmVudDsKICAgICAgICAgICAgICAgIG91dGVyQ2FjaGUgPSBub2RlW2V4cGFuZG9dIHx8IChub2RlW2V4cGFuZG9dID0ge30pOwoKICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDw5IG9ubHkKICAgICAgICAgICAgICAgIC8vIERlZmVuZCBhZ2FpbnN0IGNsb25lZCBhdHRyb3BlcnRpZXMgKGpRdWVyeSBnaC0xNzA5KQogICAgICAgICAgICAgICAgdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlW25vZGUudW5pcXVlSURdIHx8IChvdXRlckNhY2hlW25vZGUudW5pcXVlSURdID0ge30pOwogICAgICAgICAgICAgICAgY2FjaGUgPSB1bmlxdWVDYWNoZVt0eXBlXSB8fCBbXTsKICAgICAgICAgICAgICAgIG5vZGVJbmRleCA9IGNhY2hlWzBdID09PSBkaXJydW5zICYmIGNhY2hlWzFdOwogICAgICAgICAgICAgICAgZGlmZiA9IG5vZGVJbmRleCAmJiBjYWNoZVsyXTsKICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlSW5kZXggJiYgcGFyZW50LmNoaWxkTm9kZXNbbm9kZUluZGV4XTsKICAgICAgICAgICAgICAgIHdoaWxlIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlW2Rpcl0gfHwgKAogICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gc2Vla2luZyBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKICAgICAgICAgICAgICAgIGRpZmYgPSBub2RlSW5kZXggPSAwKSB8fCBzdGFydC5wb3AoKSkgewogICAgICAgICAgICAgICAgICAvLyBXaGVuIGZvdW5kLCBjYWNoZSBpbmRleGVzIG9uIGBwYXJlbnRgIGFuZCBicmVhawogICAgICAgICAgICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMSAmJiArK2RpZmYgJiYgbm9kZSA9PT0gZWxlbSkgewogICAgICAgICAgICAgICAgICAgIHVuaXF1ZUNhY2hlW3R5cGVdID0gW2RpcnJ1bnMsIG5vZGVJbmRleCwgZGlmZl07CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gVXNlIHByZXZpb3VzbHktY2FjaGVkIGVsZW1lbnQgaW5kZXggaWYgYXZhaWxhYmxlCiAgICAgICAgICAgICAgICBpZiAodXNlQ2FjaGUpIHsKICAgICAgICAgICAgICAgICAgLy8gLi4uaW4gYSBnemlwLWZyaWVuZGx5IHdheQogICAgICAgICAgICAgICAgICBub2RlID0gZWxlbTsKICAgICAgICAgICAgICAgICAgb3V0ZXJDYWNoZSA9IG5vZGVbZXhwYW5kb10gfHwgKG5vZGVbZXhwYW5kb10gPSB7fSk7CgogICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBJRSA8OSBvbmx5CiAgICAgICAgICAgICAgICAgIC8vIERlZmVuZCBhZ2FpbnN0IGNsb25lZCBhdHRyb3BlcnRpZXMgKGpRdWVyeSBnaC0xNzA5KQogICAgICAgICAgICAgICAgICB1bmlxdWVDYWNoZSA9IG91dGVyQ2FjaGVbbm9kZS51bmlxdWVJRF0gfHwgKG91dGVyQ2FjaGVbbm9kZS51bmlxdWVJRF0gPSB7fSk7CiAgICAgICAgICAgICAgICAgIGNhY2hlID0gdW5pcXVlQ2FjaGVbdHlwZV0gfHwgW107CiAgICAgICAgICAgICAgICAgIG5vZGVJbmRleCA9IGNhY2hlWzBdID09PSBkaXJydW5zICYmIGNhY2hlWzFdOwogICAgICAgICAgICAgICAgICBkaWZmID0gbm9kZUluZGV4OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHhtbCA6bnRoLWNoaWxkKC4uLikKICAgICAgICAgICAgICAgIC8vIG9yIDpudGgtbGFzdC1jaGlsZCguLi4pIG9yIDpudGgoLWxhc3QpPy1vZi10eXBlKC4uLikKICAgICAgICAgICAgICAgIGlmIChkaWZmID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIHNhbWUgbG9vcCBhcyBhYm92ZSB0byBzZWVrIGBlbGVtYCBmcm9tIHRoZSBzdGFydAogICAgICAgICAgICAgICAgICB3aGlsZSAobm9kZSA9ICsrbm9kZUluZGV4ICYmIG5vZGUgJiYgbm9kZVtkaXJdIHx8IChkaWZmID0gbm9kZUluZGV4ID0gMCkgfHwgc3RhcnQucG9wKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoKG9mVHlwZSA/IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6IG5vZGUubm9kZVR5cGUgPT09IDEpICYmICsrZGlmZikgewogICAgICAgICAgICAgICAgICAgICAgLy8gQ2FjaGUgdGhlIGluZGV4IG9mIGVhY2ggZW5jb3VudGVyZWQgZWxlbWVudAogICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZUNhY2hlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dGVyQ2FjaGUgPSBub2RlW2V4cGFuZG9dIHx8IChub2RlW2V4cGFuZG9dID0ge30pOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUgPDkgb25seQogICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWZlbmQgYWdhaW5zdCBjbG9uZWQgYXR0cm9wZXJ0aWVzIChqUXVlcnkgZ2gtMTcwOSkKICAgICAgICAgICAgICAgICAgICAgICAgdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlW25vZGUudW5pcXVlSURdIHx8IChvdXRlckNhY2hlW25vZGUudW5pcXVlSURdID0ge30pOwogICAgICAgICAgICAgICAgICAgICAgICB1bmlxdWVDYWNoZVt0eXBlXSA9IFtkaXJydW5zLCBkaWZmXTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlID09PSBlbGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8gSW5jb3Jwb3JhdGUgdGhlIG9mZnNldCwgdGhlbiBjaGVjayBhZ2FpbnN0IGN5Y2xlIHNpemUKICAgICAgICAgICAgICBkaWZmIC09IGxhc3Q7CiAgICAgICAgICAgICAgcmV0dXJuIGRpZmYgPT09IGZpcnN0IHx8IGRpZmYgJSBmaXJzdCA9PT0gMCAmJiBkaWZmIC8gZmlyc3QgPj0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgICJQU0VVRE8iOiBmdW5jdGlvbiBQU0VVRE8ocHNldWRvLCBhcmd1bWVudCkgewogICAgICAgICAgLy8gcHNldWRvLWNsYXNzIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlCiAgICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI3BzZXVkby1jbGFzc2VzCiAgICAgICAgICAvLyBQcmlvcml0aXplIGJ5IGNhc2Ugc2Vuc2l0aXZpdHkgaW4gY2FzZSBjdXN0b20gcHNldWRvcyBhcmUgYWRkZWQgd2l0aCB1cHBlcmNhc2UgbGV0dGVycwogICAgICAgICAgLy8gUmVtZW1iZXIgdGhhdCBzZXRGaWx0ZXJzIGluaGVyaXRzIGZyb20gcHNldWRvcwogICAgICAgICAgdmFyIGFyZ3MsCiAgICAgICAgICAgIGZuID0gRXhwci5wc2V1ZG9zW3BzZXVkb10gfHwgRXhwci5zZXRGaWx0ZXJzW3BzZXVkby50b0xvd2VyQ2FzZSgpXSB8fCBTaXp6bGUuZXJyb3IoInVuc3VwcG9ydGVkIHBzZXVkbzogIiArIHBzZXVkbyk7CgogICAgICAgICAgLy8gVGhlIHVzZXIgbWF5IHVzZSBjcmVhdGVQc2V1ZG8gdG8gaW5kaWNhdGUgdGhhdAogICAgICAgICAgLy8gYXJndW1lbnRzIGFyZSBuZWVkZWQgdG8gY3JlYXRlIHRoZSBmaWx0ZXIgZnVuY3Rpb24KICAgICAgICAgIC8vIGp1c3QgYXMgU2l6emxlIGRvZXMKICAgICAgICAgIGlmIChmbltleHBhbmRvXSkgewogICAgICAgICAgICByZXR1cm4gZm4oYXJndW1lbnQpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEJ1dCBtYWludGFpbiBzdXBwb3J0IGZvciBvbGQgc2lnbmF0dXJlcwogICAgICAgICAgaWYgKGZuLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgYXJncyA9IFtwc2V1ZG8sIHBzZXVkbywgIiIsIGFyZ3VtZW50XTsKICAgICAgICAgICAgcmV0dXJuIEV4cHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShwc2V1ZG8udG9Mb3dlckNhc2UoKSkgPyBtYXJrRnVuY3Rpb24oZnVuY3Rpb24gKHNlZWQsIG1hdGNoZXMpIHsKICAgICAgICAgICAgICB2YXIgaWR4LAogICAgICAgICAgICAgICAgbWF0Y2hlZCA9IGZuKHNlZWQsIGFyZ3VtZW50KSwKICAgICAgICAgICAgICAgIGkgPSBtYXRjaGVkLmxlbmd0aDsKICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICBpZHggPSBpbmRleE9mKHNlZWQsIG1hdGNoZWRbaV0pOwogICAgICAgICAgICAgICAgc2VlZFtpZHhdID0gIShtYXRjaGVzW2lkeF0gPSBtYXRjaGVkW2ldKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pIDogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gZm4oZWxlbSwgMCwgYXJncyk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZm47CiAgICAgICAgfQogICAgICB9LAogICAgICBwc2V1ZG9zOiB7CiAgICAgICAgLy8gUG90ZW50aWFsbHkgY29tcGxleCBwc2V1ZG9zCiAgICAgICAgIm5vdCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgICAgIC8vIFRyaW0gdGhlIHNlbGVjdG9yIHBhc3NlZCB0byBjb21waWxlCiAgICAgICAgICAvLyB0byBhdm9pZCB0cmVhdGluZyBsZWFkaW5nIGFuZCB0cmFpbGluZwogICAgICAgICAgLy8gc3BhY2VzIGFzIGNvbWJpbmF0b3JzCiAgICAgICAgICB2YXIgaW5wdXQgPSBbXSwKICAgICAgICAgICAgcmVzdWx0cyA9IFtdLAogICAgICAgICAgICBtYXRjaGVyID0gY29tcGlsZShzZWxlY3Rvci5yZXBsYWNlKHJ0cmltLCAiJDEiKSk7CiAgICAgICAgICByZXR1cm4gbWF0Y2hlcltleHBhbmRvXSA/IG1hcmtGdW5jdGlvbihmdW5jdGlvbiAoc2VlZCwgbWF0Y2hlcywgX2NvbnRleHQsIHhtbCkgewogICAgICAgICAgICB2YXIgZWxlbSwKICAgICAgICAgICAgICB1bm1hdGNoZWQgPSBtYXRjaGVyKHNlZWQsIG51bGwsIHhtbCwgW10pLAogICAgICAgICAgICAgIGkgPSBzZWVkLmxlbmd0aDsKCiAgICAgICAgICAgIC8vIE1hdGNoIGVsZW1lbnRzIHVubWF0Y2hlZCBieSBgbWF0Y2hlcmAKICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgIGlmIChlbGVtID0gdW5tYXRjaGVkW2ldKSB7CiAgICAgICAgICAgICAgICBzZWVkW2ldID0gIShtYXRjaGVzW2ldID0gZWxlbSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KSA6IGZ1bmN0aW9uIChlbGVtLCBfY29udGV4dCwgeG1sKSB7CiAgICAgICAgICAgIGlucHV0WzBdID0gZWxlbTsKICAgICAgICAgICAgbWF0Y2hlcihpbnB1dCwgbnVsbCwgeG1sLCByZXN1bHRzKTsKCiAgICAgICAgICAgIC8vIERvbid0IGtlZXAgdGhlIGVsZW1lbnQgKGlzc3VlICMyOTkpCiAgICAgICAgICAgIGlucHV0WzBdID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuICFyZXN1bHRzLnBvcCgpOwogICAgICAgICAgfTsKICAgICAgICB9KSwKICAgICAgICAiaGFzIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgICAgIHJldHVybiBTaXp6bGUoc2VsZWN0b3IsIGVsZW0pLmxlbmd0aCA+IDA7CiAgICAgICAgICB9OwogICAgICAgIH0pLAogICAgICAgICJjb250YWlucyI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiAodGV4dCkgewogICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSk7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgcmV0dXJuIChlbGVtLnRleHRDb250ZW50IHx8IGdldFRleHQoZWxlbSkpLmluZGV4T2YodGV4dCkgPiAtMTsKICAgICAgICAgIH07CiAgICAgICAgfSksCiAgICAgICAgLy8gIldoZXRoZXIgYW4gZWxlbWVudCBpcyByZXByZXNlbnRlZCBieSBhIDpsYW5nKCkgc2VsZWN0b3IKICAgICAgICAvLyBpcyBiYXNlZCBzb2xlbHkgb24gdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZQogICAgICAgIC8vIGJlaW5nIGVxdWFsIHRvIHRoZSBpZGVudGlmaWVyIEMsCiAgICAgICAgLy8gb3IgYmVnaW5uaW5nIHdpdGggdGhlIGlkZW50aWZpZXIgQyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSAiLSIuCiAgICAgICAgLy8gVGhlIG1hdGNoaW5nIG9mIEMgYWdhaW5zdCB0aGUgZWxlbWVudCdzIGxhbmd1YWdlIHZhbHVlIGlzIHBlcmZvcm1lZCBjYXNlLWluc2Vuc2l0aXZlbHkuCiAgICAgICAgLy8gVGhlIGlkZW50aWZpZXIgQyBkb2VzIG5vdCBoYXZlIHRvIGJlIGEgdmFsaWQgbGFuZ3VhZ2UgbmFtZS4iCiAgICAgICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNsYW5nLXBzZXVkbwogICAgICAgICJsYW5nIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uIChsYW5nKSB7CiAgICAgICAgICAvLyBsYW5nIHZhbHVlIG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyCiAgICAgICAgICBpZiAoIXJpZGVudGlmaWVyLnRlc3QobGFuZyB8fCAiIikpIHsKICAgICAgICAgICAgU2l6emxlLmVycm9yKCJ1bnN1cHBvcnRlZCBsYW5nOiAiICsgbGFuZyk7CiAgICAgICAgICB9CiAgICAgICAgICBsYW5nID0gbGFuZy5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgICAgIHZhciBlbGVtTGFuZzsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIGlmIChlbGVtTGFuZyA9IGRvY3VtZW50SXNIVE1MID8gZWxlbS5sYW5nIDogZWxlbS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIikgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoImxhbmciKSkgewogICAgICAgICAgICAgICAgZWxlbUxhbmcgPSBlbGVtTGFuZy50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YobGFuZyArICItIikgPT09IDA7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IHdoaWxlICgoZWxlbSA9IGVsZW0ucGFyZW50Tm9kZSkgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH07CiAgICAgICAgfSksCiAgICAgICAgLy8gTWlzY2VsbGFuZW91cwogICAgICAgICJ0YXJnZXQiOiBmdW5jdGlvbiB0YXJnZXQoZWxlbSkgewogICAgICAgICAgdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24gJiYgd2luZG93LmxvY2F0aW9uLmhhc2g7CiAgICAgICAgICByZXR1cm4gaGFzaCAmJiBoYXNoLnNsaWNlKDEpID09PSBlbGVtLmlkOwogICAgICAgIH0sCiAgICAgICAgInJvb3QiOiBmdW5jdGlvbiByb290KGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtID09PSBkb2NFbGVtOwogICAgICAgIH0sCiAgICAgICAgImZvY3VzIjogZnVuY3Rpb24gZm9jdXMoZWxlbSkgewogICAgICAgICAgcmV0dXJuIGVsZW0gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKCFkb2N1bWVudC5oYXNGb2N1cyB8fCBkb2N1bWVudC5oYXNGb2N1cygpKSAmJiAhIShlbGVtLnR5cGUgfHwgZWxlbS5ocmVmIHx8IH5lbGVtLnRhYkluZGV4KTsKICAgICAgICB9LAogICAgICAgIC8vIEJvb2xlYW4gcHJvcGVydGllcwogICAgICAgICJlbmFibGVkIjogY3JlYXRlRGlzYWJsZWRQc2V1ZG8oZmFsc2UpLAogICAgICAgICJkaXNhYmxlZCI6IGNyZWF0ZURpc2FibGVkUHNldWRvKHRydWUpLAogICAgICAgICJjaGVja2VkIjogZnVuY3Rpb24gY2hlY2tlZChlbGVtKSB7CiAgICAgICAgICAvLyBJbiBDU1MzLCA6Y2hlY2tlZCBzaG91bGQgcmV0dXJuIGJvdGggY2hlY2tlZCBhbmQgc2VsZWN0ZWQgZWxlbWVudHMKICAgICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkCiAgICAgICAgICB2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICByZXR1cm4gbm9kZU5hbWUgPT09ICJpbnB1dCIgJiYgISFlbGVtLmNoZWNrZWQgfHwgbm9kZU5hbWUgPT09ICJvcHRpb24iICYmICEhZWxlbS5zZWxlY3RlZDsKICAgICAgICB9LAogICAgICAgICJzZWxlY3RlZCI6IGZ1bmN0aW9uIHNlbGVjdGVkKGVsZW0pIHsKICAgICAgICAgIC8vIEFjY2Vzc2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHQKICAgICAgICAgIC8vIG9wdGlvbnMgaW4gU2FmYXJpIHdvcmsgcHJvcGVybHkKICAgICAgICAgIGlmIChlbGVtLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC1leHByZXNzaW9ucwogICAgICAgICAgICBlbGVtLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBlbGVtLnNlbGVjdGVkID09PSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgLy8gQ29udGVudHMKICAgICAgICAiZW1wdHkiOiBmdW5jdGlvbiBlbXB0eShlbGVtKSB7CiAgICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2VtcHR5LXBzZXVkbwogICAgICAgICAgLy8gOmVtcHR5IGlzIG5lZ2F0ZWQgYnkgZWxlbWVudCAoMSkgb3IgY29udGVudCBub2RlcyAodGV4dDogMzsgY2RhdGE6IDQ7IGVudGl0eSByZWY6IDUpLAogICAgICAgICAgLy8gICBidXQgbm90IGJ5IG90aGVycyAoY29tbWVudDogODsgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbjogNzsgZXRjLikKICAgICAgICAgIC8vIG5vZGVUeXBlIDwgNiB3b3JrcyBiZWNhdXNlIGF0dHJpYnV0ZXMgKDIpIGRvIG5vdCBhcHBlYXIgYXMgY2hpbGRyZW4KICAgICAgICAgIGZvciAoZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcpIHsKICAgICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPCA2KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAogICAgICAgICJwYXJlbnQiOiBmdW5jdGlvbiBwYXJlbnQoZWxlbSkgewogICAgICAgICAgcmV0dXJuICFFeHByLnBzZXVkb3NbImVtcHR5Il0oZWxlbSk7CiAgICAgICAgfSwKICAgICAgICAvLyBFbGVtZW50L2lucHV0IHR5cGVzCiAgICAgICAgImhlYWRlciI6IGZ1bmN0aW9uIGhlYWRlcihlbGVtKSB7CiAgICAgICAgICByZXR1cm4gcmhlYWRlci50ZXN0KGVsZW0ubm9kZU5hbWUpOwogICAgICAgIH0sCiAgICAgICAgImlucHV0IjogZnVuY3Rpb24gaW5wdXQoZWxlbSkgewogICAgICAgICAgcmV0dXJuIHJpbnB1dHMudGVzdChlbGVtLm5vZGVOYW1lKTsKICAgICAgICB9LAogICAgICAgICJidXR0b24iOiBmdW5jdGlvbiBidXR0b24oZWxlbSkgewogICAgICAgICAgdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICByZXR1cm4gbmFtZSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09ICJidXR0b24iIHx8IG5hbWUgPT09ICJidXR0b24iOwogICAgICAgIH0sCiAgICAgICAgInRleHQiOiBmdW5jdGlvbiB0ZXh0KGVsZW0pIHsKICAgICAgICAgIHZhciBhdHRyOwogICAgICAgICAgcmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09ICJ0ZXh0IiAmJiAoCiAgICAgICAgICAvLyBTdXBwb3J0OiBJRTw4CiAgICAgICAgICAvLyBOZXcgSFRNTDUgYXR0cmlidXRlIHZhbHVlcyAoZS5nLiwgInNlYXJjaCIpIGFwcGVhciB3aXRoIGVsZW0udHlwZSA9PT0gInRleHQiCiAgICAgICAgICAoYXR0ciA9IGVsZW0uZ2V0QXR0cmlidXRlKCJ0eXBlIikpID09IG51bGwgfHwgYXR0ci50b0xvd2VyQ2FzZSgpID09PSAidGV4dCIpOwogICAgICAgIH0sCiAgICAgICAgLy8gUG9zaXRpb24taW4tY29sbGVjdGlvbgogICAgICAgICJmaXJzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFswXTsKICAgICAgICB9KSwKICAgICAgICAibGFzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24gKF9tYXRjaEluZGV4ZXMsIGxlbmd0aCkgewogICAgICAgICAgcmV0dXJuIFtsZW5ndGggLSAxXTsKICAgICAgICB9KSwKICAgICAgICAiZXEiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uIChfbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50KSB7CiAgICAgICAgICByZXR1cm4gW2FyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnRdOwogICAgICAgIH0pLAogICAgICAgICJldmVuIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiAobWF0Y2hJbmRleGVzLCBsZW5ndGgpIHsKICAgICAgICAgIHZhciBpID0gMDsKICAgICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICAgICAgbWF0Y2hJbmRleGVzLnB1c2goaSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbWF0Y2hJbmRleGVzOwogICAgICAgIH0pLAogICAgICAgICJvZGQiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uIChtYXRjaEluZGV4ZXMsIGxlbmd0aCkgewogICAgICAgICAgdmFyIGkgPSAxOwogICAgICAgICAgZm9yICg7IGkgPCBsZW5ndGg7IGkgKz0gMikgewogICAgICAgICAgICBtYXRjaEluZGV4ZXMucHVzaChpKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBtYXRjaEluZGV4ZXM7CiAgICAgICAgfSksCiAgICAgICAgImx0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiAobWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50KSB7CiAgICAgICAgICB2YXIgaSA9IGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQgPiBsZW5ndGggPyBsZW5ndGggOiBhcmd1bWVudDsKICAgICAgICAgIGZvciAoOyAtLWkgPj0gMDspIHsKICAgICAgICAgICAgbWF0Y2hJbmRleGVzLnB1c2goaSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbWF0Y2hJbmRleGVzOwogICAgICAgIH0pLAogICAgICAgICJndCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24gKG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCkgewogICAgICAgICAgdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwogICAgICAgICAgZm9yICg7ICsraSA8IGxlbmd0aDspIHsKICAgICAgICAgICAgbWF0Y2hJbmRleGVzLnB1c2goaSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbWF0Y2hJbmRleGVzOwogICAgICAgIH0pCiAgICAgIH0KICAgIH07CiAgICBFeHByLnBzZXVkb3NbIm50aCJdID0gRXhwci5wc2V1ZG9zWyJlcSJdOwoKICAgIC8vIEFkZCBidXR0b24vaW5wdXQgdHlwZSBwc2V1ZG9zCiAgICBmb3IgKGkgaW4gewogICAgICByYWRpbzogdHJ1ZSwKICAgICAgY2hlY2tib3g6IHRydWUsCiAgICAgIGZpbGU6IHRydWUsCiAgICAgIHBhc3N3b3JkOiB0cnVlLAogICAgICBpbWFnZTogdHJ1ZQogICAgfSkgewogICAgICBFeHByLnBzZXVkb3NbaV0gPSBjcmVhdGVJbnB1dFBzZXVkbyhpKTsKICAgIH0KICAgIGZvciAoaSBpbiB7CiAgICAgIHN1Ym1pdDogdHJ1ZSwKICAgICAgcmVzZXQ6IHRydWUKICAgIH0pIHsKICAgICAgRXhwci5wc2V1ZG9zW2ldID0gY3JlYXRlQnV0dG9uUHNldWRvKGkpOwogICAgfQoKICAgIC8vIEVhc3kgQVBJIGZvciBjcmVhdGluZyBuZXcgc2V0RmlsdGVycwogICAgZnVuY3Rpb24gc2V0RmlsdGVycygpIHt9CiAgICBzZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvczsKICAgIEV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7CiAgICB0b2tlbml6ZSA9IFNpenpsZS50b2tlbml6ZSA9IGZ1bmN0aW9uIChzZWxlY3RvciwgcGFyc2VPbmx5KSB7CiAgICAgIHZhciBtYXRjaGVkLAogICAgICAgIG1hdGNoLAogICAgICAgIHRva2VucywKICAgICAgICB0eXBlLAogICAgICAgIHNvRmFyLAogICAgICAgIGdyb3VwcywKICAgICAgICBwcmVGaWx0ZXJzLAogICAgICAgIGNhY2hlZCA9IHRva2VuQ2FjaGVbc2VsZWN0b3IgKyAiICJdOwogICAgICBpZiAoY2FjaGVkKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlT25seSA/IDAgOiBjYWNoZWQuc2xpY2UoMCk7CiAgICAgIH0KICAgICAgc29GYXIgPSBzZWxlY3RvcjsKICAgICAgZ3JvdXBzID0gW107CiAgICAgIHByZUZpbHRlcnMgPSBFeHByLnByZUZpbHRlcjsKICAgICAgd2hpbGUgKHNvRmFyKSB7CiAgICAgICAgLy8gQ29tbWEgYW5kIGZpcnN0IHJ1bgogICAgICAgIGlmICghbWF0Y2hlZCB8fCAobWF0Y2ggPSByY29tbWEuZXhlYyhzb0ZhcikpKSB7CiAgICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgLy8gRG9uJ3QgY29uc3VtZSB0cmFpbGluZyBjb21tYXMgYXMgdmFsaWQKICAgICAgICAgICAgc29GYXIgPSBzb0Zhci5zbGljZShtYXRjaFswXS5sZW5ndGgpIHx8IHNvRmFyOwogICAgICAgICAgfQogICAgICAgICAgZ3JvdXBzLnB1c2godG9rZW5zID0gW10pOwogICAgICAgIH0KICAgICAgICBtYXRjaGVkID0gZmFsc2U7CgogICAgICAgIC8vIENvbWJpbmF0b3JzCiAgICAgICAgaWYgKG1hdGNoID0gcmNvbWJpbmF0b3JzLmV4ZWMoc29GYXIpKSB7CiAgICAgICAgICBtYXRjaGVkID0gbWF0Y2guc2hpZnQoKTsKICAgICAgICAgIHRva2Vucy5wdXNoKHsKICAgICAgICAgICAgdmFsdWU6IG1hdGNoZWQsCiAgICAgICAgICAgIC8vIENhc3QgZGVzY2VuZGFudCBjb21iaW5hdG9ycyB0byBzcGFjZQogICAgICAgICAgICB0eXBlOiBtYXRjaFswXS5yZXBsYWNlKHJ0cmltLCAiICIpCiAgICAgICAgICB9KTsKICAgICAgICAgIHNvRmFyID0gc29GYXIuc2xpY2UobWF0Y2hlZC5sZW5ndGgpOwogICAgICAgIH0KCiAgICAgICAgLy8gRmlsdGVycwogICAgICAgIGZvciAodHlwZSBpbiBFeHByLmZpbHRlcikgewogICAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoRXhwclt0eXBlXS5leGVjKHNvRmFyKSkgJiYgKCFwcmVGaWx0ZXJzW3R5cGVdIHx8IChtYXRjaCA9IHByZUZpbHRlcnNbdHlwZV0obWF0Y2gpKSkpIHsKICAgICAgICAgICAgbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7CiAgICAgICAgICAgIHRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB2YWx1ZTogbWF0Y2hlZCwKICAgICAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgICAgIG1hdGNoZXM6IG1hdGNoCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzb0ZhciA9IHNvRmFyLnNsaWNlKG1hdGNoZWQubGVuZ3RoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFtYXRjaGVkKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBpbnZhbGlkIGV4Y2VzcwogICAgICAvLyBpZiB3ZSdyZSBqdXN0IHBhcnNpbmcKICAgICAgLy8gT3RoZXJ3aXNlLCB0aHJvdyBhbiBlcnJvciBvciByZXR1cm4gdG9rZW5zCiAgICAgIHJldHVybiBwYXJzZU9ubHkgPyBzb0Zhci5sZW5ndGggOiBzb0ZhciA/IFNpenpsZS5lcnJvcihzZWxlY3RvcikgOgogICAgICAvLyBDYWNoZSB0aGUgdG9rZW5zCiAgICAgIHRva2VuQ2FjaGUoc2VsZWN0b3IsIGdyb3Vwcykuc2xpY2UoMCk7CiAgICB9OwogICAgZnVuY3Rpb24gdG9TZWxlY3Rvcih0b2tlbnMpIHsKICAgICAgdmFyIGkgPSAwLAogICAgICAgIGxlbiA9IHRva2Vucy5sZW5ndGgsCiAgICAgICAgc2VsZWN0b3IgPSAiIjsKICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykgewogICAgICAgIHNlbGVjdG9yICs9IHRva2Vuc1tpXS52YWx1ZTsKICAgICAgfQogICAgICByZXR1cm4gc2VsZWN0b3I7CiAgICB9CiAgICBmdW5jdGlvbiBhZGRDb21iaW5hdG9yKG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UpIHsKICAgICAgdmFyIGRpciA9IGNvbWJpbmF0b3IuZGlyLAogICAgICAgIHNraXAgPSBjb21iaW5hdG9yLm5leHQsCiAgICAgICAga2V5ID0gc2tpcCB8fCBkaXIsCiAgICAgICAgY2hlY2tOb25FbGVtZW50cyA9IGJhc2UgJiYga2V5ID09PSAicGFyZW50Tm9kZSIsCiAgICAgICAgZG9uZU5hbWUgPSBkb25lKys7CiAgICAgIHJldHVybiBjb21iaW5hdG9yLmZpcnN0ID8KICAgICAgLy8gQ2hlY2sgYWdhaW5zdCBjbG9zZXN0IGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50CiAgICAgIGZ1bmN0aW9uIChlbGVtLCBjb250ZXh0LCB4bWwpIHsKICAgICAgICB3aGlsZSAoZWxlbSA9IGVsZW1bZGlyXSkgewogICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgY2hlY2tOb25FbGVtZW50cykgewogICAgICAgICAgICByZXR1cm4gbWF0Y2hlcihlbGVtLCBjb250ZXh0LCB4bWwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gOgogICAgICAvLyBDaGVjayBhZ2FpbnN0IGFsbCBhbmNlc3Rvci9wcmVjZWRpbmcgZWxlbWVudHMKICAgICAgZnVuY3Rpb24gKGVsZW0sIGNvbnRleHQsIHhtbCkgewogICAgICAgIHZhciBvbGRDYWNoZSwKICAgICAgICAgIHVuaXF1ZUNhY2hlLAogICAgICAgICAgb3V0ZXJDYWNoZSwKICAgICAgICAgIG5ld0NhY2hlID0gW2RpcnJ1bnMsIGRvbmVOYW1lXTsKCiAgICAgICAgLy8gV2UgY2FuJ3Qgc2V0IGFyYml0cmFyeSBkYXRhIG9uIFhNTCBub2Rlcywgc28gdGhleSBkb24ndCBiZW5lZml0IGZyb20gY29tYmluYXRvciBjYWNoaW5nCiAgICAgICAgaWYgKHhtbCkgewogICAgICAgICAgd2hpbGUgKGVsZW0gPSBlbGVtW2Rpcl0pIHsKICAgICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgY2hlY2tOb25FbGVtZW50cykgewogICAgICAgICAgICAgIGlmIChtYXRjaGVyKGVsZW0sIGNvbnRleHQsIHhtbCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGlsZSAoZWxlbSA9IGVsZW1bZGlyXSkgewogICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzKSB7CiAgICAgICAgICAgICAgb3V0ZXJDYWNoZSA9IGVsZW1bZXhwYW5kb10gfHwgKGVsZW1bZXhwYW5kb10gPSB7fSk7CgogICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDw5IG9ubHkKICAgICAgICAgICAgICAvLyBEZWZlbmQgYWdhaW5zdCBjbG9uZWQgYXR0cm9wZXJ0aWVzIChqUXVlcnkgZ2gtMTcwOSkKICAgICAgICAgICAgICB1bmlxdWVDYWNoZSA9IG91dGVyQ2FjaGVbZWxlbS51bmlxdWVJRF0gfHwgKG91dGVyQ2FjaGVbZWxlbS51bmlxdWVJRF0gPSB7fSk7CiAgICAgICAgICAgICAgaWYgKHNraXAgJiYgc2tpcCA9PT0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgICAgICBlbGVtID0gZWxlbVtkaXJdIHx8IGVsZW07CiAgICAgICAgICAgICAgfSBlbHNlIGlmICgob2xkQ2FjaGUgPSB1bmlxdWVDYWNoZVtrZXldKSAmJiBvbGRDYWNoZVswXSA9PT0gZGlycnVucyAmJiBvbGRDYWNoZVsxXSA9PT0gZG9uZU5hbWUpIHsKICAgICAgICAgICAgICAgIC8vIEFzc2lnbiB0byBuZXdDYWNoZSBzbyByZXN1bHRzIGJhY2stcHJvcGFnYXRlIHRvIHByZXZpb3VzIGVsZW1lbnRzCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q2FjaGVbMl0gPSBvbGRDYWNoZVsyXTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gUmV1c2UgbmV3Y2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50cwogICAgICAgICAgICAgICAgdW5pcXVlQ2FjaGVba2V5XSA9IG5ld0NhY2hlOwoKICAgICAgICAgICAgICAgIC8vIEEgbWF0Y2ggbWVhbnMgd2UncmUgZG9uZTsgYSBmYWlsIG1lYW5zIHdlIGhhdmUgdG8ga2VlcCBjaGVja2luZwogICAgICAgICAgICAgICAgaWYgKG5ld0NhY2hlWzJdID0gbWF0Y2hlcihlbGVtLCBjb250ZXh0LCB4bWwpKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH07CiAgICB9CiAgICBmdW5jdGlvbiBlbGVtZW50TWF0Y2hlcihtYXRjaGVycykgewogICAgICByZXR1cm4gbWF0Y2hlcnMubGVuZ3RoID4gMSA/IGZ1bmN0aW9uIChlbGVtLCBjb250ZXh0LCB4bWwpIHsKICAgICAgICB2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDsKICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICBpZiAoIW1hdGNoZXJzW2ldKGVsZW0sIGNvbnRleHQsIHhtbCkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSA6IG1hdGNoZXJzWzBdOwogICAgfQogICAgZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyhzZWxlY3RvciwgY29udGV4dHMsIHJlc3VsdHMpIHsKICAgICAgdmFyIGkgPSAwLAogICAgICAgIGxlbiA9IGNvbnRleHRzLmxlbmd0aDsKICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykgewogICAgICAgIFNpenpsZShzZWxlY3RvciwgY29udGV4dHNbaV0sIHJlc3VsdHMpOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHRzOwogICAgfQogICAgZnVuY3Rpb24gY29uZGVuc2UodW5tYXRjaGVkLCBtYXAsIGZpbHRlciwgY29udGV4dCwgeG1sKSB7CiAgICAgIHZhciBlbGVtLAogICAgICAgIG5ld1VubWF0Y2hlZCA9IFtdLAogICAgICAgIGkgPSAwLAogICAgICAgIGxlbiA9IHVubWF0Y2hlZC5sZW5ndGgsCiAgICAgICAgbWFwcGVkID0gbWFwICE9IG51bGw7CiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICBpZiAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgewogICAgICAgICAgaWYgKCFmaWx0ZXIgfHwgZmlsdGVyKGVsZW0sIGNvbnRleHQsIHhtbCkpIHsKICAgICAgICAgICAgbmV3VW5tYXRjaGVkLnB1c2goZWxlbSk7CiAgICAgICAgICAgIGlmIChtYXBwZWQpIHsKICAgICAgICAgICAgICBtYXAucHVzaChpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3VW5tYXRjaGVkOwogICAgfQogICAgZnVuY3Rpb24gc2V0TWF0Y2hlcihwcmVGaWx0ZXIsIHNlbGVjdG9yLCBtYXRjaGVyLCBwb3N0RmlsdGVyLCBwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IpIHsKICAgICAgaWYgKHBvc3RGaWx0ZXIgJiYgIXBvc3RGaWx0ZXJbZXhwYW5kb10pIHsKICAgICAgICBwb3N0RmlsdGVyID0gc2V0TWF0Y2hlcihwb3N0RmlsdGVyKTsKICAgICAgfQogICAgICBpZiAocG9zdEZpbmRlciAmJiAhcG9zdEZpbmRlcltleHBhbmRvXSkgewogICAgICAgIHBvc3RGaW5kZXIgPSBzZXRNYXRjaGVyKHBvc3RGaW5kZXIsIHBvc3RTZWxlY3Rvcik7CiAgICAgIH0KICAgICAgcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiAoc2VlZCwgcmVzdWx0cywgY29udGV4dCwgeG1sKSB7CiAgICAgICAgdmFyIHRlbXAsCiAgICAgICAgICBpLAogICAgICAgICAgZWxlbSwKICAgICAgICAgIHByZU1hcCA9IFtdLAogICAgICAgICAgcG9zdE1hcCA9IFtdLAogICAgICAgICAgcHJlZXhpc3RpbmcgPSByZXN1bHRzLmxlbmd0aCwKICAgICAgICAgIC8vIEdldCBpbml0aWFsIGVsZW1lbnRzIGZyb20gc2VlZCBvciBjb250ZXh0CiAgICAgICAgICBlbGVtcyA9IHNlZWQgfHwgbXVsdGlwbGVDb250ZXh0cyhzZWxlY3RvciB8fCAiKiIsIGNvbnRleHQubm9kZVR5cGUgPyBbY29udGV4dF0gOiBjb250ZXh0LCBbXSksCiAgICAgICAgICAvLyBQcmVmaWx0ZXIgdG8gZ2V0IG1hdGNoZXIgaW5wdXQsIHByZXNlcnZpbmcgYSBtYXAgZm9yIHNlZWQtcmVzdWx0cyBzeW5jaHJvbml6YXRpb24KICAgICAgICAgIG1hdGNoZXJJbiA9IHByZUZpbHRlciAmJiAoc2VlZCB8fCAhc2VsZWN0b3IpID8gY29uZGVuc2UoZWxlbXMsIHByZU1hcCwgcHJlRmlsdGVyLCBjb250ZXh0LCB4bWwpIDogZWxlbXMsCiAgICAgICAgICBtYXRjaGVyT3V0ID0gbWF0Y2hlciA/CiAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGEgcG9zdEZpbmRlciwgb3IgZmlsdGVyZWQgc2VlZCwgb3Igbm9uLXNlZWQgcG9zdEZpbHRlciBvciBwcmVleGlzdGluZyByZXN1bHRzLAogICAgICAgICAgcG9zdEZpbmRlciB8fCAoc2VlZCA/IHByZUZpbHRlciA6IHByZWV4aXN0aW5nIHx8IHBvc3RGaWx0ZXIpID8KICAgICAgICAgIC8vIC4uLmludGVybWVkaWF0ZSBwcm9jZXNzaW5nIGlzIG5lY2Vzc2FyeQogICAgICAgICAgW10gOgogICAgICAgICAgLy8gLi4ub3RoZXJ3aXNlIHVzZSByZXN1bHRzIGRpcmVjdGx5CiAgICAgICAgICByZXN1bHRzIDogbWF0Y2hlckluOwoKICAgICAgICAvLyBGaW5kIHByaW1hcnkgbWF0Y2hlcwogICAgICAgIGlmIChtYXRjaGVyKSB7CiAgICAgICAgICBtYXRjaGVyKG1hdGNoZXJJbiwgbWF0Y2hlck91dCwgY29udGV4dCwgeG1sKTsKICAgICAgICB9CgogICAgICAgIC8vIEFwcGx5IHBvc3RGaWx0ZXIKICAgICAgICBpZiAocG9zdEZpbHRlcikgewogICAgICAgICAgdGVtcCA9IGNvbmRlbnNlKG1hdGNoZXJPdXQsIHBvc3RNYXApOwogICAgICAgICAgcG9zdEZpbHRlcih0ZW1wLCBbXSwgY29udGV4dCwgeG1sKTsKCiAgICAgICAgICAvLyBVbi1tYXRjaCBmYWlsaW5nIGVsZW1lbnRzIGJ5IG1vdmluZyB0aGVtIGJhY2sgdG8gbWF0Y2hlckluCiAgICAgICAgICBpID0gdGVtcC5sZW5ndGg7CiAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgIGlmIChlbGVtID0gdGVtcFtpXSkgewogICAgICAgICAgICAgIG1hdGNoZXJPdXRbcG9zdE1hcFtpXV0gPSAhKG1hdGNoZXJJbltwb3N0TWFwW2ldXSA9IGVsZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChzZWVkKSB7CiAgICAgICAgICBpZiAocG9zdEZpbmRlciB8fCBwcmVGaWx0ZXIpIHsKICAgICAgICAgICAgaWYgKHBvc3RGaW5kZXIpIHsKICAgICAgICAgICAgICAvLyBHZXQgdGhlIGZpbmFsIG1hdGNoZXJPdXQgYnkgY29uZGVuc2luZyB0aGlzIGludGVybWVkaWF0ZSBpbnRvIHBvc3RGaW5kZXIgY29udGV4dHMKICAgICAgICAgICAgICB0ZW1wID0gW107CiAgICAgICAgICAgICAgaSA9IG1hdGNoZXJPdXQubGVuZ3RoOwogICAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICAgIGlmIChlbGVtID0gbWF0Y2hlck91dFtpXSkgewogICAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIG1hdGNoZXJJbiBzaW5jZSBlbGVtIGlzIG5vdCB5ZXQgYSBmaW5hbCBtYXRjaAogICAgICAgICAgICAgICAgICB0ZW1wLnB1c2gobWF0Y2hlckluW2ldID0gZWxlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHBvc3RGaW5kZXIobnVsbCwgbWF0Y2hlck91dCA9IFtdLCB0ZW1wLCB4bWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBNb3ZlIG1hdGNoZWQgZWxlbWVudHMgZnJvbSBzZWVkIHRvIHJlc3VsdHMgdG8ga2VlcCB0aGVtIHN5bmNocm9uaXplZAogICAgICAgICAgICBpID0gbWF0Y2hlck91dC5sZW5ndGg7CiAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICBpZiAoKGVsZW0gPSBtYXRjaGVyT3V0W2ldKSAmJiAodGVtcCA9IHBvc3RGaW5kZXIgPyBpbmRleE9mKHNlZWQsIGVsZW0pIDogcHJlTWFwW2ldKSA+IC0xKSB7CiAgICAgICAgICAgICAgICBzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQWRkIGVsZW1lbnRzIHRvIHJlc3VsdHMsIHRocm91Z2ggcG9zdEZpbmRlciBpZiBkZWZpbmVkCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1hdGNoZXJPdXQgPSBjb25kZW5zZShtYXRjaGVyT3V0ID09PSByZXN1bHRzID8gbWF0Y2hlck91dC5zcGxpY2UocHJlZXhpc3RpbmcsIG1hdGNoZXJPdXQubGVuZ3RoKSA6IG1hdGNoZXJPdXQpOwogICAgICAgICAgaWYgKHBvc3RGaW5kZXIpIHsKICAgICAgICAgICAgcG9zdEZpbmRlcihudWxsLCByZXN1bHRzLCBtYXRjaGVyT3V0LCB4bWwpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHVzaC5hcHBseShyZXN1bHRzLCBtYXRjaGVyT3V0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgZnVuY3Rpb24gbWF0Y2hlckZyb21Ub2tlbnModG9rZW5zKSB7CiAgICAgIHZhciBjaGVja0NvbnRleHQsCiAgICAgICAgbWF0Y2hlciwKICAgICAgICBqLAogICAgICAgIGxlbiA9IHRva2Vucy5sZW5ndGgsCiAgICAgICAgbGVhZGluZ1JlbGF0aXZlID0gRXhwci5yZWxhdGl2ZVt0b2tlbnNbMF0udHlwZV0sCiAgICAgICAgaW1wbGljaXRSZWxhdGl2ZSA9IGxlYWRpbmdSZWxhdGl2ZSB8fCBFeHByLnJlbGF0aXZlWyIgIl0sCiAgICAgICAgaSA9IGxlYWRpbmdSZWxhdGl2ZSA/IDEgOiAwLAogICAgICAgIC8vIFRoZSBmb3VuZGF0aW9uYWwgbWF0Y2hlciBlbnN1cmVzIHRoYXQgZWxlbWVudHMgYXJlIHJlYWNoYWJsZSBmcm9tIHRvcC1sZXZlbCBjb250ZXh0KHMpCiAgICAgICAgbWF0Y2hDb250ZXh0ID0gYWRkQ29tYmluYXRvcihmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgcmV0dXJuIGVsZW0gPT09IGNoZWNrQ29udGV4dDsKICAgICAgICB9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlKSwKICAgICAgICBtYXRjaEFueUNvbnRleHQgPSBhZGRDb21iaW5hdG9yKGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgICByZXR1cm4gaW5kZXhPZihjaGVja0NvbnRleHQsIGVsZW0pID4gLTE7CiAgICAgICAgfSwgaW1wbGljaXRSZWxhdGl2ZSwgdHJ1ZSksCiAgICAgICAgbWF0Y2hlcnMgPSBbZnVuY3Rpb24gKGVsZW0sIGNvbnRleHQsIHhtbCkgewogICAgICAgICAgdmFyIHJldCA9ICFsZWFkaW5nUmVsYXRpdmUgJiYgKHhtbCB8fCBjb250ZXh0ICE9PSBvdXRlcm1vc3RDb250ZXh0KSB8fCAoKGNoZWNrQ29udGV4dCA9IGNvbnRleHQpLm5vZGVUeXBlID8gbWF0Y2hDb250ZXh0KGVsZW0sIGNvbnRleHQsIHhtbCkgOiBtYXRjaEFueUNvbnRleHQoZWxlbSwgY29udGV4dCwgeG1sKSk7CgogICAgICAgICAgLy8gQXZvaWQgaGFuZ2luZyBvbnRvIGVsZW1lbnQgKGlzc3VlICMyOTkpCiAgICAgICAgICBjaGVja0NvbnRleHQgPSBudWxsOwogICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9XTsKICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykgewogICAgICAgIGlmIChtYXRjaGVyID0gRXhwci5yZWxhdGl2ZVt0b2tlbnNbaV0udHlwZV0pIHsKICAgICAgICAgIG1hdGNoZXJzID0gW2FkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpLCBtYXRjaGVyKV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1hdGNoZXIgPSBFeHByLmZpbHRlclt0b2tlbnNbaV0udHlwZV0uYXBwbHkobnVsbCwgdG9rZW5zW2ldLm1hdGNoZXMpOwoKICAgICAgICAgIC8vIFJldHVybiBzcGVjaWFsIHVwb24gc2VlaW5nIGEgcG9zaXRpb25hbCBtYXRjaGVyCiAgICAgICAgICBpZiAobWF0Y2hlcltleHBhbmRvXSkgewogICAgICAgICAgICAvLyBGaW5kIHRoZSBuZXh0IHJlbGF0aXZlIG9wZXJhdG9yIChpZiBhbnkpIGZvciBwcm9wZXIgaGFuZGxpbmcKICAgICAgICAgICAgaiA9ICsraTsKICAgICAgICAgICAgZm9yICg7IGogPCBsZW47IGorKykgewogICAgICAgICAgICAgIGlmIChFeHByLnJlbGF0aXZlW3Rva2Vuc1tqXS50eXBlXSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzZXRNYXRjaGVyKGkgPiAxICYmIGVsZW1lbnRNYXRjaGVyKG1hdGNoZXJzKSwgaSA+IDEgJiYgdG9TZWxlY3RvcigKICAgICAgICAgICAgLy8gSWYgdGhlIHByZWNlZGluZyB0b2tlbiB3YXMgYSBkZXNjZW5kYW50IGNvbWJpbmF0b3IsIGluc2VydCBhbiBpbXBsaWNpdCBhbnktZWxlbWVudCBgKmAKICAgICAgICAgICAgdG9rZW5zLnNsaWNlKDAsIGkgLSAxKS5jb25jYXQoewogICAgICAgICAgICAgIHZhbHVlOiB0b2tlbnNbaSAtIDJdLnR5cGUgPT09ICIgIiA/ICIqIiA6ICIiCiAgICAgICAgICAgIH0pKS5yZXBsYWNlKHJ0cmltLCAiJDEiKSwgbWF0Y2hlciwgaSA8IGogJiYgbWF0Y2hlckZyb21Ub2tlbnModG9rZW5zLnNsaWNlKGksIGopKSwgaiA8IGxlbiAmJiBtYXRjaGVyRnJvbVRva2Vucyh0b2tlbnMgPSB0b2tlbnMuc2xpY2UoaikpLCBqIDwgbGVuICYmIHRvU2VsZWN0b3IodG9rZW5zKSk7CiAgICAgICAgICB9CiAgICAgICAgICBtYXRjaGVycy5wdXNoKG1hdGNoZXIpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpOwogICAgfQogICAgZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKGVsZW1lbnRNYXRjaGVycywgc2V0TWF0Y2hlcnMpIHsKICAgICAgdmFyIGJ5U2V0ID0gc2V0TWF0Y2hlcnMubGVuZ3RoID4gMCwKICAgICAgICBieUVsZW1lbnQgPSBlbGVtZW50TWF0Y2hlcnMubGVuZ3RoID4gMCwKICAgICAgICBzdXBlck1hdGNoZXIgPSBmdW5jdGlvbiBzdXBlck1hdGNoZXIoc2VlZCwgY29udGV4dCwgeG1sLCByZXN1bHRzLCBvdXRlcm1vc3QpIHsKICAgICAgICAgIHZhciBlbGVtLAogICAgICAgICAgICBqLAogICAgICAgICAgICBtYXRjaGVyLAogICAgICAgICAgICBtYXRjaGVkQ291bnQgPSAwLAogICAgICAgICAgICBpID0gIjAiLAogICAgICAgICAgICB1bm1hdGNoZWQgPSBzZWVkICYmIFtdLAogICAgICAgICAgICBzZXRNYXRjaGVkID0gW10sCiAgICAgICAgICAgIGNvbnRleHRCYWNrdXAgPSBvdXRlcm1vc3RDb250ZXh0LAogICAgICAgICAgICAvLyBXZSBtdXN0IGFsd2F5cyBoYXZlIGVpdGhlciBzZWVkIGVsZW1lbnRzIG9yIG91dGVybW9zdCBjb250ZXh0CiAgICAgICAgICAgIGVsZW1zID0gc2VlZCB8fCBieUVsZW1lbnQgJiYgRXhwci5maW5kWyJUQUciXSgiKiIsIG91dGVybW9zdCksCiAgICAgICAgICAgIC8vIFVzZSBpbnRlZ2VyIGRpcnJ1bnMgaWZmIHRoaXMgaXMgdGhlIG91dGVybW9zdCBtYXRjaGVyCiAgICAgICAgICAgIGRpcnJ1bnNVbmlxdWUgPSBkaXJydW5zICs9IGNvbnRleHRCYWNrdXAgPT0gbnVsbCA/IDEgOiBNYXRoLnJhbmRvbSgpIHx8IDAuMSwKICAgICAgICAgICAgbGVuID0gZWxlbXMubGVuZ3RoOwogICAgICAgICAgaWYgKG91dGVybW9zdCkgewogICAgICAgICAgICAvLyBTdXBwb3J0OiBJRSAxMSssIEVkZ2UgMTcgLSAxOCsKICAgICAgICAgICAgLy8gSUUvRWRnZSBzb21ldGltZXMgdGhyb3cgYSAiUGVybWlzc2lvbiBkZW5pZWQiIGVycm9yIHdoZW4gc3RyaWN0LWNvbXBhcmluZwogICAgICAgICAgICAvLyB0d28gZG9jdW1lbnRzOyBzaGFsbG93IGNvbXBhcmlzb25zIHdvcmsuCiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXEKICAgICAgICAgICAgb3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHQgPT0gZG9jdW1lbnQgfHwgY29udGV4dCB8fCBvdXRlcm1vc3Q7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQWRkIGVsZW1lbnRzIHBhc3NpbmcgZWxlbWVudE1hdGNoZXJzIGRpcmVjdGx5IHRvIHJlc3VsdHMKICAgICAgICAgIC8vIFN1cHBvcnQ6IElFPDksIFNhZmFyaQogICAgICAgICAgLy8gVG9sZXJhdGUgTm9kZUxpc3QgcHJvcGVydGllcyAoSUU6ICJsZW5ndGgiOyBTYWZhcmk6IDxudW1iZXI+KSBtYXRjaGluZyBlbGVtZW50cyBieSBpZAogICAgICAgICAgZm9yICg7IGkgIT09IGxlbiAmJiAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKyspIHsKICAgICAgICAgICAgaWYgKGJ5RWxlbWVudCAmJiBlbGVtKSB7CiAgICAgICAgICAgICAgaiA9IDA7CgogICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDExKywgRWRnZSAxNyAtIDE4KwogICAgICAgICAgICAgIC8vIElFL0VkZ2Ugc29tZXRpbWVzIHRocm93IGEgIlBlcm1pc3Npb24gZGVuaWVkIiBlcnJvciB3aGVuIHN0cmljdC1jb21wYXJpbmcKICAgICAgICAgICAgICAvLyB0d28gZG9jdW1lbnRzOyBzaGFsbG93IGNvbXBhcmlzb25zIHdvcmsuCiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGVxZXFlcQogICAgICAgICAgICAgIGlmICghY29udGV4dCAmJiBlbGVtLm93bmVyRG9jdW1lbnQgIT0gZG9jdW1lbnQpIHsKICAgICAgICAgICAgICAgIHNldERvY3VtZW50KGVsZW0pOwogICAgICAgICAgICAgICAgeG1sID0gIWRvY3VtZW50SXNIVE1MOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB3aGlsZSAobWF0Y2hlciA9IGVsZW1lbnRNYXRjaGVyc1tqKytdKSB7CiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlcihlbGVtLCBjb250ZXh0IHx8IGRvY3VtZW50LCB4bWwpKSB7CiAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChlbGVtKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChvdXRlcm1vc3QpIHsKICAgICAgICAgICAgICAgIGRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVHJhY2sgdW5tYXRjaGVkIGVsZW1lbnRzIGZvciBzZXQgZmlsdGVycwogICAgICAgICAgICBpZiAoYnlTZXQpIHsKICAgICAgICAgICAgICAvLyBUaGV5IHdpbGwgaGF2ZSBnb25lIHRocm91Z2ggYWxsIHBvc3NpYmxlIG1hdGNoZXJzCiAgICAgICAgICAgICAgaWYgKGVsZW0gPSAhbWF0Y2hlciAmJiBlbGVtKSB7CiAgICAgICAgICAgICAgICBtYXRjaGVkQ291bnQtLTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIExlbmd0aGVuIHRoZSBhcnJheSBmb3IgZXZlcnkgZWxlbWVudCwgbWF0Y2hlZCBvciBub3QKICAgICAgICAgICAgICBpZiAoc2VlZCkgewogICAgICAgICAgICAgICAgdW5tYXRjaGVkLnB1c2goZWxlbSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gYGlgIGlzIG5vdyB0aGUgY291bnQgb2YgZWxlbWVudHMgdmlzaXRlZCBhYm92ZSwgYW5kIGFkZGluZyBpdCB0byBgbWF0Y2hlZENvdW50YAogICAgICAgICAgLy8gbWFrZXMgdGhlIGxhdHRlciBub25uZWdhdGl2ZS4KICAgICAgICAgIG1hdGNoZWRDb3VudCArPSBpOwoKICAgICAgICAgIC8vIEFwcGx5IHNldCBmaWx0ZXJzIHRvIHVubWF0Y2hlZCBlbGVtZW50cwogICAgICAgICAgLy8gTk9URTogVGhpcyBjYW4gYmUgc2tpcHBlZCBpZiB0aGVyZSBhcmUgbm8gdW5tYXRjaGVkIGVsZW1lbnRzIChpLmUuLCBgbWF0Y2hlZENvdW50YAogICAgICAgICAgLy8gZXF1YWxzIGBpYCksIHVubGVzcyB3ZSBkaWRuJ3QgdmlzaXQgX2FueV8gZWxlbWVudHMgaW4gdGhlIGFib3ZlIGxvb3AgYmVjYXVzZSB3ZSBoYXZlCiAgICAgICAgICAvLyBubyBlbGVtZW50IG1hdGNoZXJzIGFuZCBubyBzZWVkLgogICAgICAgICAgLy8gSW5jcmVtZW50aW5nIGFuIGluaXRpYWxseS1zdHJpbmcgIjAiIGBpYCBhbGxvd3MgYGlgIHRvIHJlbWFpbiBhIHN0cmluZyBvbmx5IGluIHRoYXQKICAgICAgICAgIC8vIGNhc2UsIHdoaWNoIHdpbGwgcmVzdWx0IGluIGEgIjAwIiBgbWF0Y2hlZENvdW50YCB0aGF0IGRpZmZlcnMgZnJvbSBgaWAgYnV0IGlzIGFsc28KICAgICAgICAgIC8vIG51bWVyaWNhbGx5IHplcm8uCiAgICAgICAgICBpZiAoYnlTZXQgJiYgaSAhPT0gbWF0Y2hlZENvdW50KSB7CiAgICAgICAgICAgIGogPSAwOwogICAgICAgICAgICB3aGlsZSAobWF0Y2hlciA9IHNldE1hdGNoZXJzW2orK10pIHsKICAgICAgICAgICAgICBtYXRjaGVyKHVubWF0Y2hlZCwgc2V0TWF0Y2hlZCwgY29udGV4dCwgeG1sKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2VlZCkgewogICAgICAgICAgICAgIC8vIFJlaW50ZWdyYXRlIGVsZW1lbnQgbWF0Y2hlcyB0byBlbGltaW5hdGUgdGhlIG5lZWQgZm9yIHNvcnRpbmcKICAgICAgICAgICAgICBpZiAobWF0Y2hlZENvdW50ID4gMCkgewogICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICBpZiAoISh1bm1hdGNoZWRbaV0gfHwgc2V0TWF0Y2hlZFtpXSkpIHsKICAgICAgICAgICAgICAgICAgICBzZXRNYXRjaGVkW2ldID0gcG9wLmNhbGwocmVzdWx0cyk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIERpc2NhcmQgaW5kZXggcGxhY2Vob2xkZXIgdmFsdWVzIHRvIGdldCBvbmx5IGFjdHVhbCBtYXRjaGVzCiAgICAgICAgICAgICAgc2V0TWF0Y2hlZCA9IGNvbmRlbnNlKHNldE1hdGNoZWQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBZGQgbWF0Y2hlcyB0byByZXN1bHRzCiAgICAgICAgICAgIHB1c2guYXBwbHkocmVzdWx0cywgc2V0TWF0Y2hlZCk7CgogICAgICAgICAgICAvLyBTZWVkbGVzcyBzZXQgbWF0Y2hlcyBzdWNjZWVkaW5nIG11bHRpcGxlIHN1Y2Nlc3NmdWwgbWF0Y2hlcnMgc3RpcHVsYXRlIHNvcnRpbmcKICAgICAgICAgICAgaWYgKG91dGVybW9zdCAmJiAhc2VlZCAmJiBzZXRNYXRjaGVkLmxlbmd0aCA+IDAgJiYgbWF0Y2hlZENvdW50ICsgc2V0TWF0Y2hlcnMubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgIFNpenpsZS51bmlxdWVTb3J0KHJlc3VsdHMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gT3ZlcnJpZGUgbWFuaXB1bGF0aW9uIG9mIGdsb2JhbHMgYnkgbmVzdGVkIG1hdGNoZXJzCiAgICAgICAgICBpZiAob3V0ZXJtb3N0KSB7CiAgICAgICAgICAgIGRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwogICAgICAgICAgICBvdXRlcm1vc3RDb250ZXh0ID0gY29udGV4dEJhY2t1cDsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB1bm1hdGNoZWQ7CiAgICAgICAgfTsKICAgICAgcmV0dXJuIGJ5U2V0ID8gbWFya0Z1bmN0aW9uKHN1cGVyTWF0Y2hlcikgOiBzdXBlck1hdGNoZXI7CiAgICB9CiAgICBjb21waWxlID0gU2l6emxlLmNvbXBpbGUgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIG1hdGNoIC8qIEludGVybmFsIFVzZSBPbmx5ICovKSB7CiAgICAgIHZhciBpLAogICAgICAgIHNldE1hdGNoZXJzID0gW10sCiAgICAgICAgZWxlbWVudE1hdGNoZXJzID0gW10sCiAgICAgICAgY2FjaGVkID0gY29tcGlsZXJDYWNoZVtzZWxlY3RvciArICIgIl07CiAgICAgIGlmICghY2FjaGVkKSB7CiAgICAgICAgLy8gR2VuZXJhdGUgYSBmdW5jdGlvbiBvZiByZWN1cnNpdmUgZnVuY3Rpb25zIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2hlY2sgZWFjaCBlbGVtZW50CiAgICAgICAgaWYgKCFtYXRjaCkgewogICAgICAgICAgbWF0Y2ggPSB0b2tlbml6ZShzZWxlY3Rvcik7CiAgICAgICAgfQogICAgICAgIGkgPSBtYXRjaC5sZW5ndGg7CiAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgY2FjaGVkID0gbWF0Y2hlckZyb21Ub2tlbnMobWF0Y2hbaV0pOwogICAgICAgICAgaWYgKGNhY2hlZFtleHBhbmRvXSkgewogICAgICAgICAgICBzZXRNYXRjaGVycy5wdXNoKGNhY2hlZCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbGVtZW50TWF0Y2hlcnMucHVzaChjYWNoZWQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gQ2FjaGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uCiAgICAgICAgY2FjaGVkID0gY29tcGlsZXJDYWNoZShzZWxlY3RvciwgbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKGVsZW1lbnRNYXRjaGVycywgc2V0TWF0Y2hlcnMpKTsKCiAgICAgICAgLy8gU2F2ZSBzZWxlY3RvciBhbmQgdG9rZW5pemF0aW9uCiAgICAgICAgY2FjaGVkLnNlbGVjdG9yID0gc2VsZWN0b3I7CiAgICAgIH0KICAgICAgcmV0dXJuIGNhY2hlZDsKICAgIH07CgogICAgLyoqCiAgICAgKiBBIGxvdy1sZXZlbCBzZWxlY3Rpb24gZnVuY3Rpb24gdGhhdCB3b3JrcyB3aXRoIFNpenpsZSdzIGNvbXBpbGVkCiAgICAgKiAgc2VsZWN0b3IgZnVuY3Rpb25zCiAgICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gc2VsZWN0b3IgQSBzZWxlY3RvciBvciBhIHByZS1jb21waWxlZAogICAgICogIHNlbGVjdG9yIGZ1bmN0aW9uIGJ1aWx0IHdpdGggU2l6emxlLmNvbXBpbGUKICAgICAqIEBwYXJhbSB7RWxlbWVudH0gY29udGV4dAogICAgICogQHBhcmFtIHtBcnJheX0gW3Jlc3VsdHNdCiAgICAgKiBAcGFyYW0ge0FycmF5fSBbc2VlZF0gQSBzZXQgb2YgZWxlbWVudHMgdG8gbWF0Y2ggYWdhaW5zdAogICAgICovCiAgICBzZWxlY3QgPSBTaXp6bGUuc2VsZWN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkKSB7CiAgICAgIHZhciBpLAogICAgICAgIHRva2VucywKICAgICAgICB0b2tlbiwKICAgICAgICB0eXBlLAogICAgICAgIGZpbmQsCiAgICAgICAgY29tcGlsZWQgPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICJmdW5jdGlvbiIgJiYgc2VsZWN0b3IsCiAgICAgICAgbWF0Y2ggPSAhc2VlZCAmJiB0b2tlbml6ZShzZWxlY3RvciA9IGNvbXBpbGVkLnNlbGVjdG9yIHx8IHNlbGVjdG9yKTsKICAgICAgcmVzdWx0cyA9IHJlc3VsdHMgfHwgW107CgogICAgICAvLyBUcnkgdG8gbWluaW1pemUgb3BlcmF0aW9ucyBpZiB0aGVyZSBpcyBvbmx5IG9uZSBzZWxlY3RvciBpbiB0aGUgbGlzdCBhbmQgbm8gc2VlZAogICAgICAvLyAodGhlIGxhdHRlciBvZiB3aGljaCBndWFyYW50ZWVzIHVzIGNvbnRleHQpCiAgICAgIGlmIChtYXRjaC5sZW5ndGggPT09IDEpIHsKICAgICAgICAvLyBSZWR1Y2UgY29udGV4dCBpZiB0aGUgbGVhZGluZyBjb21wb3VuZCBzZWxlY3RvciBpcyBhbiBJRAogICAgICAgIHRva2VucyA9IG1hdGNoWzBdID0gbWF0Y2hbMF0uc2xpY2UoMCk7CiAgICAgICAgaWYgKHRva2Vucy5sZW5ndGggPiAyICYmICh0b2tlbiA9IHRva2Vuc1swXSkudHlwZSA9PT0gIklEIiAmJiBjb250ZXh0Lm5vZGVUeXBlID09PSA5ICYmIGRvY3VtZW50SXNIVE1MICYmIEV4cHIucmVsYXRpdmVbdG9rZW5zWzFdLnR5cGVdKSB7CiAgICAgICAgICBjb250ZXh0ID0gKEV4cHIuZmluZFsiSUQiXSh0b2tlbi5tYXRjaGVzWzBdLnJlcGxhY2UocnVuZXNjYXBlLCBmdW5lc2NhcGUpLCBjb250ZXh0KSB8fCBbXSlbMF07CiAgICAgICAgICBpZiAoIWNvbnRleHQpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7CgogICAgICAgICAgICAvLyBQcmVjb21waWxlZCBtYXRjaGVycyB3aWxsIHN0aWxsIHZlcmlmeSBhbmNlc3RyeSwgc28gc3RlcCB1cCBhIGxldmVsCiAgICAgICAgICB9IGVsc2UgaWYgKGNvbXBpbGVkKSB7CiAgICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7CiAgICAgICAgICB9CiAgICAgICAgICBzZWxlY3RvciA9IHNlbGVjdG9yLnNsaWNlKHRva2Vucy5zaGlmdCgpLnZhbHVlLmxlbmd0aCk7CiAgICAgICAgfQoKICAgICAgICAvLyBGZXRjaCBhIHNlZWQgc2V0IGZvciByaWdodC10by1sZWZ0IG1hdGNoaW5nCiAgICAgICAgaSA9IG1hdGNoRXhwclsibmVlZHNDb250ZXh0Il0udGVzdChzZWxlY3RvcikgPyAwIDogdG9rZW5zLmxlbmd0aDsKICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICB0b2tlbiA9IHRva2Vuc1tpXTsKCiAgICAgICAgICAvLyBBYm9ydCBpZiB3ZSBoaXQgYSBjb21iaW5hdG9yCiAgICAgICAgICBpZiAoRXhwci5yZWxhdGl2ZVt0eXBlID0gdG9rZW4udHlwZV0pIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZmluZCA9IEV4cHIuZmluZFt0eXBlXSkgewogICAgICAgICAgICAvLyBTZWFyY2gsIGV4cGFuZGluZyBjb250ZXh0IGZvciBsZWFkaW5nIHNpYmxpbmcgY29tYmluYXRvcnMKICAgICAgICAgICAgaWYgKHNlZWQgPSBmaW5kKHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSksIHJzaWJsaW5nLnRlc3QodG9rZW5zWzBdLnR5cGUpICYmIHRlc3RDb250ZXh0KGNvbnRleHQucGFyZW50Tm9kZSkgfHwgY29udGV4dCkpIHsKICAgICAgICAgICAgICAvLyBJZiBzZWVkIGlzIGVtcHR5IG9yIG5vIHRva2VucyByZW1haW4sIHdlIGNhbiByZXR1cm4gZWFybHkKICAgICAgICAgICAgICB0b2tlbnMuc3BsaWNlKGksIDEpOwogICAgICAgICAgICAgIHNlbGVjdG9yID0gc2VlZC5sZW5ndGggJiYgdG9TZWxlY3Rvcih0b2tlbnMpOwogICAgICAgICAgICAgIGlmICghc2VsZWN0b3IpIHsKICAgICAgICAgICAgICAgIHB1c2guYXBwbHkocmVzdWx0cywgc2VlZCk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZAogICAgICAvLyBQcm92aWRlIGBtYXRjaGAgdG8gYXZvaWQgcmV0b2tlbml6YXRpb24gaWYgd2UgbW9kaWZpZWQgdGhlIHNlbGVjdG9yIGFib3ZlCiAgICAgIChjb21waWxlZCB8fCBjb21waWxlKHNlbGVjdG9yLCBtYXRjaCkpKHNlZWQsIGNvbnRleHQsICFkb2N1bWVudElzSFRNTCwgcmVzdWx0cywgIWNvbnRleHQgfHwgcnNpYmxpbmcudGVzdChzZWxlY3RvcikgJiYgdGVzdENvbnRleHQoY29udGV4dC5wYXJlbnROb2RlKSB8fCBjb250ZXh0KTsKICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICB9OwoKICAgIC8vIE9uZS10aW1lIGFzc2lnbm1lbnRzCgogICAgLy8gU29ydCBzdGFiaWxpdHkKICAgIHN1cHBvcnQuc29ydFN0YWJsZSA9IGV4cGFuZG8uc3BsaXQoIiIpLnNvcnQoc29ydE9yZGVyKS5qb2luKCIiKSA9PT0gZXhwYW5kbzsKCiAgICAvLyBTdXBwb3J0OiBDaHJvbWUgMTQtMzUrCiAgICAvLyBBbHdheXMgYXNzdW1lIGR1cGxpY2F0ZXMgaWYgdGhleSBhcmVuJ3QgcGFzc2VkIHRvIHRoZSBjb21wYXJpc29uIGZ1bmN0aW9uCiAgICBzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXMgPSAhIWhhc0R1cGxpY2F0ZTsKCiAgICAvLyBJbml0aWFsaXplIGFnYWluc3QgdGhlIGRlZmF1bHQgZG9jdW1lbnQKICAgIHNldERvY3VtZW50KCk7CgogICAgLy8gU3VwcG9ydDogV2Via2l0PDUzNy4zMiAtIFNhZmFyaSA2LjAuMy9DaHJvbWUgMjUgKGZpeGVkIGluIENocm9tZSAyNykKICAgIC8vIERldGFjaGVkIG5vZGVzIGNvbmZvdW5kaW5nbHkgZm9sbG93ICplYWNoIG90aGVyKgogICAgc3VwcG9ydC5zb3J0RGV0YWNoZWQgPSBhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgIC8vIFNob3VsZCByZXR1cm4gMSwgYnV0IHJldHVybnMgNCAoZm9sbG93aW5nKQogICAgICByZXR1cm4gZWwuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKSkgJiAxOwogICAgfSk7CgogICAgLy8gU3VwcG9ydDogSUU8OAogICAgLy8gUHJldmVudCBhdHRyaWJ1dGUvcHJvcGVydHkgImludGVycG9sYXRpb24iCiAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L21zNTM2NDI5JTI4VlMuODUlMjkuYXNweAogICAgaWYgKCFhc3NlcnQoZnVuY3Rpb24gKGVsKSB7CiAgICAgIGVsLmlubmVySFRNTCA9ICI8YSBocmVmPScjJz48L2E+IjsKICAgICAgcmV0dXJuIGVsLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIikgPT09ICIjIjsKICAgIH0pKSB7CiAgICAgIGFkZEhhbmRsZSgidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsIGZ1bmN0aW9uIChlbGVtLCBuYW1lLCBpc1hNTCkgewogICAgICAgIGlmICghaXNYTUwpIHsKICAgICAgICAgIHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZShuYW1lLCBuYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJ0eXBlIiA/IDEgOiAyKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8vIFN1cHBvcnQ6IElFPDkKICAgIC8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpCiAgICBpZiAoIXN1cHBvcnQuYXR0cmlidXRlcyB8fCAhYXNzZXJ0KGZ1bmN0aW9uIChlbCkgewogICAgICBlbC5pbm5lckhUTUwgPSAiPGlucHV0Lz4iOwogICAgICBlbC5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSgidmFsdWUiLCAiIik7CiAgICAgIHJldHVybiBlbC5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKSA9PT0gIiI7CiAgICB9KSkgewogICAgICBhZGRIYW5kbGUoInZhbHVlIiwgZnVuY3Rpb24gKGVsZW0sIF9uYW1lLCBpc1hNTCkgewogICAgICAgIGlmICghaXNYTUwgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiaW5wdXQiKSB7CiAgICAgICAgICByZXR1cm4gZWxlbS5kZWZhdWx0VmFsdWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvLyBTdXBwb3J0OiBJRTw5CiAgICAvLyBVc2UgZ2V0QXR0cmlidXRlTm9kZSB0byBmZXRjaCBib29sZWFucyB3aGVuIGdldEF0dHJpYnV0ZSBsaWVzCiAgICBpZiAoIWFzc2VydChmdW5jdGlvbiAoZWwpIHsKICAgICAgcmV0dXJuIGVsLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKSA9PSBudWxsOwogICAgfSkpIHsKICAgICAgYWRkSGFuZGxlKGJvb2xlYW5zLCBmdW5jdGlvbiAoZWxlbSwgbmFtZSwgaXNYTUwpIHsKICAgICAgICB2YXIgdmFsOwogICAgICAgIGlmICghaXNYTUwpIHsKICAgICAgICAgIHJldHVybiBlbGVtW25hbWVdID09PSB0cnVlID8gbmFtZS50b0xvd2VyQ2FzZSgpIDogKHZhbCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKSkgJiYgdmFsLnNwZWNpZmllZCA/IHZhbC52YWx1ZSA6IG51bGw7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIHJldHVybiBTaXp6bGU7CiAgfSh3aW5kb3cpOwogIGpRdWVyeS5maW5kID0gU2l6emxlOwogIGpRdWVyeS5leHByID0gU2l6emxlLnNlbGVjdG9yczsKCiAgLy8gRGVwcmVjYXRlZAogIGpRdWVyeS5leHByWyI6Il0gPSBqUXVlcnkuZXhwci5wc2V1ZG9zOwogIGpRdWVyeS51bmlxdWVTb3J0ID0galF1ZXJ5LnVuaXF1ZSA9IFNpenpsZS51bmlxdWVTb3J0OwogIGpRdWVyeS50ZXh0ID0gU2l6emxlLmdldFRleHQ7CiAgalF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MOwogIGpRdWVyeS5jb250YWlucyA9IFNpenpsZS5jb250YWluczsKICBqUXVlcnkuZXNjYXBlU2VsZWN0b3IgPSBTaXp6bGUuZXNjYXBlOwogIHZhciBkaXIgPSBmdW5jdGlvbiBkaXIoZWxlbSwgX2RpciwgdW50aWwpIHsKICAgIHZhciBtYXRjaGVkID0gW10sCiAgICAgIHRydW5jYXRlID0gdW50aWwgIT09IHVuZGVmaW5lZDsKICAgIHdoaWxlICgoZWxlbSA9IGVsZW1bX2Rpcl0pICYmIGVsZW0ubm9kZVR5cGUgIT09IDkpIHsKICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICBpZiAodHJ1bmNhdGUgJiYgalF1ZXJ5KGVsZW0pLmlzKHVudGlsKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIG1hdGNoZWQucHVzaChlbGVtKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIG1hdGNoZWQ7CiAgfTsKICB2YXIgX3NpYmxpbmdzID0gZnVuY3Rpb24gc2libGluZ3MobiwgZWxlbSkgewogICAgdmFyIG1hdGNoZWQgPSBbXTsKICAgIGZvciAoOyBuOyBuID0gbi5uZXh0U2libGluZykgewogICAgICBpZiAobi5ub2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtKSB7CiAgICAgICAgbWF0Y2hlZC5wdXNoKG4pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbWF0Y2hlZDsKICB9OwogIHZhciBybmVlZHNDb250ZXh0ID0galF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0OwogIGZ1bmN0aW9uIG5vZGVOYW1lKGVsZW0sIG5hbWUpIHsKICAgIHJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZS50b0xvd2VyQ2FzZSgpOwogIH0KICA7CiAgdmFyIHJzaW5nbGVUYWcgPSAvXjwoW2Etel1bXlwvXDA+Olx4MjBcdFxyXG5cZl0qKVtceDIwXHRcclxuXGZdKlwvPz4oPzo8XC9cMT58KSQvaTsKCiAgLy8gSW1wbGVtZW50IHRoZSBpZGVudGljYWwgZnVuY3Rpb25hbGl0eSBmb3IgZmlsdGVyIGFuZCBub3QKICBmdW5jdGlvbiB3aW5ub3coZWxlbWVudHMsIHF1YWxpZmllciwgbm90KSB7CiAgICBpZiAoaXNGdW5jdGlvbihxdWFsaWZpZXIpKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cywgZnVuY3Rpb24gKGVsZW0sIGkpIHsKICAgICAgICByZXR1cm4gISFxdWFsaWZpZXIuY2FsbChlbGVtLCBpLCBlbGVtKSAhPT0gbm90OwogICAgICB9KTsKICAgIH0KCiAgICAvLyBTaW5nbGUgZWxlbWVudAogICAgaWYgKHF1YWxpZmllci5ub2RlVHlwZSkgewogICAgICByZXR1cm4galF1ZXJ5LmdyZXAoZWxlbWVudHMsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgcmV0dXJuIGVsZW0gPT09IHF1YWxpZmllciAhPT0gbm90OwogICAgICB9KTsKICAgIH0KCiAgICAvLyBBcnJheWxpa2Ugb2YgZWxlbWVudHMgKGpRdWVyeSwgYXJndW1lbnRzLCBBcnJheSkKICAgIGlmICh0eXBlb2YgcXVhbGlmaWVyICE9PSAic3RyaW5nIikgewogICAgICByZXR1cm4galF1ZXJ5LmdyZXAoZWxlbWVudHMsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgcmV0dXJuIGluZGV4T2YuY2FsbChxdWFsaWZpZXIsIGVsZW0pID4gLTEgIT09IG5vdDsKICAgICAgfSk7CiAgICB9CgogICAgLy8gRmlsdGVyZWQgZGlyZWN0bHkgZm9yIGJvdGggc2ltcGxlIGFuZCBjb21wbGV4IHNlbGVjdG9ycwogICAgcmV0dXJuIGpRdWVyeS5maWx0ZXIocXVhbGlmaWVyLCBlbGVtZW50cywgbm90KTsKICB9CiAgalF1ZXJ5LmZpbHRlciA9IGZ1bmN0aW9uIChleHByLCBlbGVtcywgbm90KSB7CiAgICB2YXIgZWxlbSA9IGVsZW1zWzBdOwogICAgaWYgKG5vdCkgewogICAgICBleHByID0gIjpub3QoIiArIGV4cHIgKyAiKSI7CiAgICB9CiAgICBpZiAoZWxlbXMubGVuZ3RoID09PSAxICYmIGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgcmV0dXJuIGpRdWVyeS5maW5kLm1hdGNoZXNTZWxlY3RvcihlbGVtLCBleHByKSA/IFtlbGVtXSA6IFtdOwogICAgfQogICAgcmV0dXJuIGpRdWVyeS5maW5kLm1hdGNoZXMoZXhwciwgalF1ZXJ5LmdyZXAoZWxlbXMsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIHJldHVybiBlbGVtLm5vZGVUeXBlID09PSAxOwogICAgfSkpOwogIH07CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBmaW5kOiBmdW5jdGlvbiBmaW5kKHNlbGVjdG9yKSB7CiAgICAgIHZhciBpLAogICAgICAgIHJldCwKICAgICAgICBsZW4gPSB0aGlzLmxlbmd0aCwKICAgICAgICBzZWxmID0gdGhpczsKICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gInN0cmluZyIpIHsKICAgICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5KHNlbGVjdG9yKS5maWx0ZXIoZnVuY3Rpb24gKCkgewogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIGlmIChqUXVlcnkuY29udGFpbnMoc2VsZltpXSwgdGhpcykpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pKTsKICAgICAgfQogICAgICByZXQgPSB0aGlzLnB1c2hTdGFjayhbXSk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgIGpRdWVyeS5maW5kKHNlbGVjdG9yLCBzZWxmW2ldLCByZXQpOwogICAgICB9CiAgICAgIHJldHVybiBsZW4gPiAxID8galF1ZXJ5LnVuaXF1ZVNvcnQocmV0KSA6IHJldDsKICAgIH0sCiAgICBmaWx0ZXI6IGZ1bmN0aW9uIGZpbHRlcihzZWxlY3RvcikgewogICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2sod2lubm93KHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSkpOwogICAgfSwKICAgIG5vdDogZnVuY3Rpb24gbm90KHNlbGVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayh3aW5ub3codGhpcywgc2VsZWN0b3IgfHwgW10sIHRydWUpKTsKICAgIH0sCiAgICBpczogZnVuY3Rpb24gaXMoc2VsZWN0b3IpIHsKICAgICAgcmV0dXJuICEhd2lubm93KHRoaXMsCiAgICAgIC8vIElmIHRoaXMgaXMgYSBwb3NpdGlvbmFsL3JlbGF0aXZlIHNlbGVjdG9yLCBjaGVjayBtZW1iZXJzaGlwIGluIHRoZSByZXR1cm5lZCBzZXQKICAgICAgLy8gc28gJCgicDpmaXJzdCIpLmlzKCJwOmxhc3QiKSB3b24ndCByZXR1cm4gdHJ1ZSBmb3IgYSBkb2Mgd2l0aCB0d28gInAiLgogICAgICB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICYmIHJuZWVkc0NvbnRleHQudGVzdChzZWxlY3RvcikgPyBqUXVlcnkoc2VsZWN0b3IpIDogc2VsZWN0b3IgfHwgW10sIGZhbHNlKS5sZW5ndGg7CiAgICB9CiAgfSk7CgogIC8vIEluaXRpYWxpemUgYSBqUXVlcnkgb2JqZWN0CgogIC8vIEEgY2VudHJhbCByZWZlcmVuY2UgdG8gdGhlIHJvb3QgalF1ZXJ5KGRvY3VtZW50KQogIHZhciByb290alF1ZXJ5LAogICAgLy8gQSBzaW1wbGUgd2F5IHRvIGNoZWNrIGZvciBIVE1MIHN0cmluZ3MKICAgIC8vIFByaW9yaXRpemUgI2lkIG92ZXIgPHRhZz4gdG8gYXZvaWQgWFNTIHZpYSBsb2NhdGlvbi5oYXNoICgjOTUyMSkKICAgIC8vIFN0cmljdCBIVE1MIHJlY29nbml0aW9uICgjMTEyOTA6IG11c3Qgc3RhcnQgd2l0aCA8KQogICAgLy8gU2hvcnRjdXQgc2ltcGxlICNpZCBjYXNlIGZvciBzcGVlZAogICAgcnF1aWNrRXhwciA9IC9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKykpJC8sCiAgICBpbml0ID0galF1ZXJ5LmZuLmluaXQgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGNvbnRleHQsIHJvb3QpIHsKICAgICAgdmFyIG1hdGNoLCBlbGVtOwoKICAgICAgLy8gSEFORExFOiAkKCIiKSwgJChudWxsKSwgJCh1bmRlZmluZWQpLCAkKGZhbHNlKQogICAgICBpZiAoIXNlbGVjdG9yKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIC8vIE1ldGhvZCBpbml0KCkgYWNjZXB0cyBhbiBhbHRlcm5hdGUgcm9vdGpRdWVyeQogICAgICAvLyBzbyBtaWdyYXRlIGNhbiBzdXBwb3J0IGpRdWVyeS5zdWIgKGdoLTIxMDEpCiAgICAgIHJvb3QgPSByb290IHx8IHJvb3RqUXVlcnk7CgogICAgICAvLyBIYW5kbGUgSFRNTCBzdHJpbmdzCiAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciKSB7CiAgICAgICAgaWYgKHNlbGVjdG9yWzBdID09PSAiPCIgJiYgc2VsZWN0b3Jbc2VsZWN0b3IubGVuZ3RoIC0gMV0gPT09ICI+IiAmJiBzZWxlY3Rvci5sZW5ndGggPj0gMykgewogICAgICAgICAgLy8gQXNzdW1lIHRoYXQgc3RyaW5ncyB0aGF0IHN0YXJ0IGFuZCBlbmQgd2l0aCA8PiBhcmUgSFRNTCBhbmQgc2tpcCB0aGUgcmVnZXggY2hlY2sKICAgICAgICAgIG1hdGNoID0gW251bGwsIHNlbGVjdG9yLCBudWxsXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoc2VsZWN0b3IpOwogICAgICAgIH0KCiAgICAgICAgLy8gTWF0Y2ggaHRtbCBvciBtYWtlIHN1cmUgbm8gY29udGV4dCBpcyBzcGVjaWZpZWQgZm9yICNpZAogICAgICAgIGlmIChtYXRjaCAmJiAobWF0Y2hbMV0gfHwgIWNvbnRleHQpKSB7CiAgICAgICAgICAvLyBIQU5ETEU6ICQoaHRtbCkgLT4gJChhcnJheSkKICAgICAgICAgIGlmIChtYXRjaFsxXSkgewogICAgICAgICAgICBjb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRleHRbMF0gOiBjb250ZXh0OwoKICAgICAgICAgICAgLy8gT3B0aW9uIHRvIHJ1biBzY3JpcHRzIGlzIHRydWUgZm9yIGJhY2stY29tcGF0CiAgICAgICAgICAgIC8vIEludGVudGlvbmFsbHkgbGV0IHRoZSBlcnJvciBiZSB0aHJvd24gaWYgcGFyc2VIVE1MIGlzIG5vdCBwcmVzZW50CiAgICAgICAgICAgIGpRdWVyeS5tZXJnZSh0aGlzLCBqUXVlcnkucGFyc2VIVE1MKG1hdGNoWzFdLCBjb250ZXh0ICYmIGNvbnRleHQubm9kZVR5cGUgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IGRvY3VtZW50LCB0cnVlKSk7CgogICAgICAgICAgICAvLyBIQU5ETEU6ICQoaHRtbCwgcHJvcHMpCiAgICAgICAgICAgIGlmIChyc2luZ2xlVGFnLnRlc3QobWF0Y2hbMV0pICYmIGpRdWVyeS5pc1BsYWluT2JqZWN0KGNvbnRleHQpKSB7CiAgICAgICAgICAgICAgZm9yIChtYXRjaCBpbiBjb250ZXh0KSB7CiAgICAgICAgICAgICAgICAvLyBQcm9wZXJ0aWVzIG9mIGNvbnRleHQgYXJlIGNhbGxlZCBhcyBtZXRob2RzIGlmIHBvc3NpYmxlCiAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbih0aGlzW21hdGNoXSkpIHsKICAgICAgICAgICAgICAgICAgdGhpc1ttYXRjaF0oY29udGV4dFttYXRjaF0pOwoKICAgICAgICAgICAgICAgICAgLy8gLi4uYW5kIG90aGVyd2lzZSBzZXQgYXMgYXR0cmlidXRlcwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyKG1hdGNoLCBjb250ZXh0W21hdGNoXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0aGlzOwoKICAgICAgICAgICAgLy8gSEFORExFOiAkKCNpZCkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtYXRjaFsyXSk7CiAgICAgICAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgICAgICAgLy8gSW5qZWN0IHRoZSBlbGVtZW50IGRpcmVjdGx5IGludG8gdGhlIGpRdWVyeSBvYmplY3QKICAgICAgICAgICAgICB0aGlzWzBdID0gZWxlbTsKICAgICAgICAgICAgICB0aGlzLmxlbmd0aCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gSEFORExFOiAkKGV4cHIsICQoLi4uKSkKICAgICAgICB9IGVsc2UgaWYgKCFjb250ZXh0IHx8IGNvbnRleHQuanF1ZXJ5KSB7CiAgICAgICAgICByZXR1cm4gKGNvbnRleHQgfHwgcm9vdCkuZmluZChzZWxlY3Rvcik7CgogICAgICAgICAgLy8gSEFORExFOiAkKGV4cHIsIGNvbnRleHQpCiAgICAgICAgICAvLyAod2hpY2ggaXMganVzdCBlcXVpdmFsZW50IHRvOiAkKGNvbnRleHQpLmZpbmQoZXhwcikKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IoY29udGV4dCkuZmluZChzZWxlY3Rvcik7CiAgICAgICAgfQoKICAgICAgICAvLyBIQU5ETEU6ICQoRE9NRWxlbWVudCkKICAgICAgfSBlbHNlIGlmIChzZWxlY3Rvci5ub2RlVHlwZSkgewogICAgICAgIHRoaXNbMF0gPSBzZWxlY3RvcjsKICAgICAgICB0aGlzLmxlbmd0aCA9IDE7CiAgICAgICAgcmV0dXJuIHRoaXM7CgogICAgICAgIC8vIEhBTkRMRTogJChmdW5jdGlvbikKICAgICAgICAvLyBTaG9ydGN1dCBmb3IgZG9jdW1lbnQgcmVhZHkKICAgICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSkgewogICAgICAgIHJldHVybiByb290LnJlYWR5ICE9PSB1bmRlZmluZWQgPyByb290LnJlYWR5KHNlbGVjdG9yKSA6CiAgICAgICAgLy8gRXhlY3V0ZSBpbW1lZGlhdGVseSBpZiByZWFkeSBpcyBub3QgcHJlc2VudAogICAgICAgIHNlbGVjdG9yKGpRdWVyeSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoc2VsZWN0b3IsIHRoaXMpOwogICAgfTsKCiAgLy8gR2l2ZSB0aGUgaW5pdCBmdW5jdGlvbiB0aGUgalF1ZXJ5IHByb3RvdHlwZSBmb3IgbGF0ZXIgaW5zdGFudGlhdGlvbgogIGluaXQucHJvdG90eXBlID0galF1ZXJ5LmZuOwoKICAvLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlCiAgcm9vdGpRdWVyeSA9IGpRdWVyeShkb2N1bWVudCk7CiAgdmFyIHJwYXJlbnRzcHJldiA9IC9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLAogICAgLy8gTWV0aG9kcyBndWFyYW50ZWVkIHRvIHByb2R1Y2UgYSB1bmlxdWUgc2V0IHdoZW4gc3RhcnRpbmcgZnJvbSBhIHVuaXF1ZSBzZXQKICAgIGd1YXJhbnRlZWRVbmlxdWUgPSB7CiAgICAgIGNoaWxkcmVuOiB0cnVlLAogICAgICBjb250ZW50czogdHJ1ZSwKICAgICAgbmV4dDogdHJ1ZSwKICAgICAgcHJldjogdHJ1ZQogICAgfTsKICBqUXVlcnkuZm4uZXh0ZW5kKHsKICAgIGhhczogZnVuY3Rpb24gaGFzKHRhcmdldCkgewogICAgICB2YXIgdGFyZ2V0cyA9IGpRdWVyeSh0YXJnZXQsIHRoaXMpLAogICAgICAgIGwgPSB0YXJnZXRzLmxlbmd0aDsKICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgaSA9IDA7CiAgICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgIGlmIChqUXVlcnkuY29udGFpbnModGhpcywgdGFyZ2V0c1tpXSkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjbG9zZXN0OiBmdW5jdGlvbiBjbG9zZXN0KHNlbGVjdG9ycywgY29udGV4dCkgewogICAgICB2YXIgY3VyLAogICAgICAgIGkgPSAwLAogICAgICAgIGwgPSB0aGlzLmxlbmd0aCwKICAgICAgICBtYXRjaGVkID0gW10sCiAgICAgICAgdGFyZ2V0cyA9IHR5cGVvZiBzZWxlY3RvcnMgIT09ICJzdHJpbmciICYmIGpRdWVyeShzZWxlY3RvcnMpOwoKICAgICAgLy8gUG9zaXRpb25hbCBzZWxlY3RvcnMgbmV2ZXIgbWF0Y2gsIHNpbmNlIHRoZXJlJ3Mgbm8gX3NlbGVjdGlvbl8gY29udGV4dAogICAgICBpZiAoIXJuZWVkc0NvbnRleHQudGVzdChzZWxlY3RvcnMpKSB7CiAgICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgIGZvciAoY3VyID0gdGhpc1tpXTsgY3VyICYmIGN1ciAhPT0gY29udGV4dDsgY3VyID0gY3VyLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgLy8gQWx3YXlzIHNraXAgZG9jdW1lbnQgZnJhZ21lbnRzCiAgICAgICAgICAgIGlmIChjdXIubm9kZVR5cGUgPCAxMSAmJiAodGFyZ2V0cyA/IHRhcmdldHMuaW5kZXgoY3VyKSA+IC0xIDoKICAgICAgICAgICAgLy8gRG9uJ3QgcGFzcyBub24tZWxlbWVudHMgdG8gU2l6emxlCiAgICAgICAgICAgIGN1ci5ub2RlVHlwZSA9PT0gMSAmJiBqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoY3VyLCBzZWxlY3RvcnMpKSkgewogICAgICAgICAgICAgIG1hdGNoZWQucHVzaChjdXIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhtYXRjaGVkLmxlbmd0aCA+IDEgPyBqUXVlcnkudW5pcXVlU29ydChtYXRjaGVkKSA6IG1hdGNoZWQpOwogICAgfSwKICAgIC8vIERldGVybWluZSB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCB3aXRoaW4gdGhlIHNldAogICAgaW5kZXg6IGZ1bmN0aW9uIGluZGV4KGVsZW0pIHsKICAgICAgLy8gTm8gYXJndW1lbnQsIHJldHVybiBpbmRleCBpbiBwYXJlbnQKICAgICAgaWYgKCFlbGVtKSB7CiAgICAgICAgcmV0dXJuIHRoaXNbMF0gJiYgdGhpc1swXS5wYXJlbnROb2RlID8gdGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGggOiAtMTsKICAgICAgfQoKICAgICAgLy8gSW5kZXggaW4gc2VsZWN0b3IKICAgICAgaWYgKHR5cGVvZiBlbGVtID09PSAic3RyaW5nIikgewogICAgICAgIHJldHVybiBpbmRleE9mLmNhbGwoalF1ZXJ5KGVsZW0pLCB0aGlzWzBdKTsKICAgICAgfQoKICAgICAgLy8gTG9jYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgZGVzaXJlZCBlbGVtZW50CiAgICAgIHJldHVybiBpbmRleE9mLmNhbGwodGhpcywKICAgICAgLy8gSWYgaXQgcmVjZWl2ZXMgYSBqUXVlcnkgb2JqZWN0LCB0aGUgZmlyc3QgZWxlbWVudCBpcyB1c2VkCiAgICAgIGVsZW0uanF1ZXJ5ID8gZWxlbVswXSA6IGVsZW0pOwogICAgfSwKICAgIGFkZDogZnVuY3Rpb24gYWRkKHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhqUXVlcnkudW5pcXVlU29ydChqUXVlcnkubWVyZ2UodGhpcy5nZXQoKSwgalF1ZXJ5KHNlbGVjdG9yLCBjb250ZXh0KSkpKTsKICAgIH0sCiAgICBhZGRCYWNrOiBmdW5jdGlvbiBhZGRCYWNrKHNlbGVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLmFkZChzZWxlY3RvciA9PSBudWxsID8gdGhpcy5wcmV2T2JqZWN0IDogdGhpcy5wcmV2T2JqZWN0LmZpbHRlcihzZWxlY3RvcikpOwogICAgfQogIH0pOwogIGZ1bmN0aW9uIHNpYmxpbmcoY3VyLCBkaXIpIHsKICAgIHdoaWxlICgoY3VyID0gY3VyW2Rpcl0pICYmIGN1ci5ub2RlVHlwZSAhPT0gMSkge30KICAgIHJldHVybiBjdXI7CiAgfQogIGpRdWVyeS5lYWNoKHsKICAgIHBhcmVudDogZnVuY3Rpb24gcGFyZW50KGVsZW0pIHsKICAgICAgdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgIT09IDExID8gcGFyZW50IDogbnVsbDsKICAgIH0sCiAgICBwYXJlbnRzOiBmdW5jdGlvbiBwYXJlbnRzKGVsZW0pIHsKICAgICAgcmV0dXJuIGRpcihlbGVtLCAicGFyZW50Tm9kZSIpOwogICAgfSwKICAgIHBhcmVudHNVbnRpbDogZnVuY3Rpb24gcGFyZW50c1VudGlsKGVsZW0sIF9pLCB1bnRpbCkgewogICAgICByZXR1cm4gZGlyKGVsZW0sICJwYXJlbnROb2RlIiwgdW50aWwpOwogICAgfSwKICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoZWxlbSkgewogICAgICByZXR1cm4gc2libGluZyhlbGVtLCAibmV4dFNpYmxpbmciKTsKICAgIH0sCiAgICBwcmV2OiBmdW5jdGlvbiBwcmV2KGVsZW0pIHsKICAgICAgcmV0dXJuIHNpYmxpbmcoZWxlbSwgInByZXZpb3VzU2libGluZyIpOwogICAgfSwKICAgIG5leHRBbGw6IGZ1bmN0aW9uIG5leHRBbGwoZWxlbSkgewogICAgICByZXR1cm4gZGlyKGVsZW0sICJuZXh0U2libGluZyIpOwogICAgfSwKICAgIHByZXZBbGw6IGZ1bmN0aW9uIHByZXZBbGwoZWxlbSkgewogICAgICByZXR1cm4gZGlyKGVsZW0sICJwcmV2aW91c1NpYmxpbmciKTsKICAgIH0sCiAgICBuZXh0VW50aWw6IGZ1bmN0aW9uIG5leHRVbnRpbChlbGVtLCBfaSwgdW50aWwpIHsKICAgICAgcmV0dXJuIGRpcihlbGVtLCAibmV4dFNpYmxpbmciLCB1bnRpbCk7CiAgICB9LAogICAgcHJldlVudGlsOiBmdW5jdGlvbiBwcmV2VW50aWwoZWxlbSwgX2ksIHVudGlsKSB7CiAgICAgIHJldHVybiBkaXIoZWxlbSwgInByZXZpb3VzU2libGluZyIsIHVudGlsKTsKICAgIH0sCiAgICBzaWJsaW5nczogZnVuY3Rpb24gc2libGluZ3MoZWxlbSkgewogICAgICByZXR1cm4gX3NpYmxpbmdzKChlbGVtLnBhcmVudE5vZGUgfHwge30pLmZpcnN0Q2hpbGQsIGVsZW0pOwogICAgfSwKICAgIGNoaWxkcmVuOiBmdW5jdGlvbiBjaGlsZHJlbihlbGVtKSB7CiAgICAgIHJldHVybiBfc2libGluZ3MoZWxlbS5maXJzdENoaWxkKTsKICAgIH0sCiAgICBjb250ZW50czogZnVuY3Rpb24gY29udGVudHMoZWxlbSkgewogICAgICBpZiAoZWxlbS5jb250ZW50RG9jdW1lbnQgIT0gbnVsbCAmJgogICAgICAvLyBTdXBwb3J0OiBJRSAxMSsKICAgICAgLy8gPG9iamVjdD4gZWxlbWVudHMgd2l0aCBubyBgZGF0YWAgYXR0cmlidXRlIGhhcyBhbiBvYmplY3QKICAgICAgLy8gYGNvbnRlbnREb2N1bWVudGAgd2l0aCBhIGBudWxsYCBwcm90b3R5cGUuCiAgICAgIGdldFByb3RvKGVsZW0uY29udGVudERvY3VtZW50KSkgewogICAgICAgIHJldHVybiBlbGVtLmNvbnRlbnREb2N1bWVudDsKICAgICAgfQoKICAgICAgLy8gU3VwcG9ydDogSUUgOSAtIDExIG9ubHksIGlPUyA3IG9ubHksIEFuZHJvaWQgQnJvd3NlciA8PTQuMyBvbmx5CiAgICAgIC8vIFRyZWF0IHRoZSB0ZW1wbGF0ZSBlbGVtZW50IGFzIGEgcmVndWxhciBvbmUgaW4gYnJvd3NlcnMgdGhhdAogICAgICAvLyBkb24ndCBzdXBwb3J0IGl0LgogICAgICBpZiAobm9kZU5hbWUoZWxlbSwgInRlbXBsYXRlIikpIHsKICAgICAgICBlbGVtID0gZWxlbS5jb250ZW50IHx8IGVsZW07CiAgICAgIH0KICAgICAgcmV0dXJuIGpRdWVyeS5tZXJnZShbXSwgZWxlbS5jaGlsZE5vZGVzKTsKICAgIH0KICB9LCBmdW5jdGlvbiAobmFtZSwgZm4pIHsKICAgIGpRdWVyeS5mbltuYW1lXSA9IGZ1bmN0aW9uICh1bnRpbCwgc2VsZWN0b3IpIHsKICAgICAgdmFyIG1hdGNoZWQgPSBqUXVlcnkubWFwKHRoaXMsIGZuLCB1bnRpbCk7CiAgICAgIGlmIChuYW1lLnNsaWNlKC01KSAhPT0gIlVudGlsIikgewogICAgICAgIHNlbGVjdG9yID0gdW50aWw7CiAgICAgIH0KICAgICAgaWYgKHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIpIHsKICAgICAgICBtYXRjaGVkID0galF1ZXJ5LmZpbHRlcihzZWxlY3RvciwgbWF0Y2hlZCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMubGVuZ3RoID4gMSkgewogICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzCiAgICAgICAgaWYgKCFndWFyYW50ZWVkVW5pcXVlW25hbWVdKSB7CiAgICAgICAgICBqUXVlcnkudW5pcXVlU29ydChtYXRjaGVkKTsKICAgICAgICB9CgogICAgICAgIC8vIFJldmVyc2Ugb3JkZXIgZm9yIHBhcmVudHMqIGFuZCBwcmV2LWRlcml2YXRpdmVzCiAgICAgICAgaWYgKHJwYXJlbnRzcHJldi50ZXN0KG5hbWUpKSB7CiAgICAgICAgICBtYXRjaGVkLnJldmVyc2UoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKG1hdGNoZWQpOwogICAgfTsKICB9KTsKICB2YXIgcm5vdGh0bWx3aGl0ZSA9IC9bXlx4MjBcdFxyXG5cZl0rL2c7CgogIC8vIENvbnZlcnQgU3RyaW5nLWZvcm1hdHRlZCBvcHRpb25zIGludG8gT2JqZWN0LWZvcm1hdHRlZCBvbmVzCiAgZnVuY3Rpb24gY3JlYXRlT3B0aW9ucyhvcHRpb25zKSB7CiAgICB2YXIgb2JqZWN0ID0ge307CiAgICBqUXVlcnkuZWFjaChvcHRpb25zLm1hdGNoKHJub3RodG1sd2hpdGUpIHx8IFtdLCBmdW5jdGlvbiAoXywgZmxhZykgewogICAgICBvYmplY3RbZmxhZ10gPSB0cnVlOwogICAgfSk7CiAgICByZXR1cm4gb2JqZWN0OwogIH0KCiAgLyoKICAqIENyZWF0ZSBhIGNhbGxiYWNrIGxpc3QgdXNpbmcgdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgogICoKICAqCW9wdGlvbnM6IGFuIG9wdGlvbmFsIGxpc3Qgb2Ygc3BhY2Utc2VwYXJhdGVkIG9wdGlvbnMgdGhhdCB3aWxsIGNoYW5nZSBob3cKICAqCQkJdGhlIGNhbGxiYWNrIGxpc3QgYmVoYXZlcyBvciBhIG1vcmUgdHJhZGl0aW9uYWwgb3B0aW9uIG9iamVjdAogICoKICAqIEJ5IGRlZmF1bHQgYSBjYWxsYmFjayBsaXN0IHdpbGwgYWN0IGxpa2UgYW4gZXZlbnQgY2FsbGJhY2sgbGlzdCBhbmQgY2FuIGJlCiAgKiAiZmlyZWQiIG11bHRpcGxlIHRpbWVzLgogICoKICAqIFBvc3NpYmxlIG9wdGlvbnM6CiAgKgogICoJb25jZToJCQl3aWxsIGVuc3VyZSB0aGUgY2FsbGJhY2sgbGlzdCBjYW4gb25seSBiZSBmaXJlZCBvbmNlIChsaWtlIGEgRGVmZXJyZWQpCiAgKgogICoJbWVtb3J5OgkJCXdpbGwga2VlcCB0cmFjayBvZiBwcmV2aW91cyB2YWx1ZXMgYW5kIHdpbGwgY2FsbCBhbnkgY2FsbGJhY2sgYWRkZWQKICAqCQkJCQlhZnRlciB0aGUgbGlzdCBoYXMgYmVlbiBmaXJlZCByaWdodCBhd2F5IHdpdGggdGhlIGxhdGVzdCAibWVtb3JpemVkIgogICoJCQkJCXZhbHVlcyAobGlrZSBhIERlZmVycmVkKQogICoKICAqCXVuaXF1ZToJCQl3aWxsIGVuc3VyZSBhIGNhbGxiYWNrIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UgKG5vIGR1cGxpY2F0ZSBpbiB0aGUgbGlzdCkKICAqCiAgKglzdG9wT25GYWxzZToJaW50ZXJydXB0IGNhbGxpbmdzIHdoZW4gYSBjYWxsYmFjayByZXR1cm5zIGZhbHNlCiAgKgogICovCiAgalF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAvLyBDb252ZXJ0IG9wdGlvbnMgZnJvbSBTdHJpbmctZm9ybWF0dGVkIHRvIE9iamVjdC1mb3JtYXR0ZWQgaWYgbmVlZGVkCiAgICAvLyAod2UgY2hlY2sgaW4gY2FjaGUgZmlyc3QpCiAgICBvcHRpb25zID0gdHlwZW9mIG9wdGlvbnMgPT09ICJzdHJpbmciID8gY3JlYXRlT3B0aW9ucyhvcHRpb25zKSA6IGpRdWVyeS5leHRlbmQoe30sIG9wdGlvbnMpOwogICAgdmFyCiAgICAgIC8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IGlzIGN1cnJlbnRseSBmaXJpbmcKICAgICAgZmlyaW5nLAogICAgICAvLyBMYXN0IGZpcmUgdmFsdWUgZm9yIG5vbi1mb3JnZXR0YWJsZSBsaXN0cwogICAgICBtZW1vcnksCiAgICAgIC8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IHdhcyBhbHJlYWR5IGZpcmVkCiAgICAgIF9maXJlZCwKICAgICAgLy8gRmxhZyB0byBwcmV2ZW50IGZpcmluZwogICAgICBfbG9ja2VkLAogICAgICAvLyBBY3R1YWwgY2FsbGJhY2sgbGlzdAogICAgICBsaXN0ID0gW10sCiAgICAgIC8vIFF1ZXVlIG9mIGV4ZWN1dGlvbiBkYXRhIGZvciByZXBlYXRhYmxlIGxpc3RzCiAgICAgIHF1ZXVlID0gW10sCiAgICAgIC8vIEluZGV4IG9mIGN1cnJlbnRseSBmaXJpbmcgY2FsbGJhY2sgKG1vZGlmaWVkIGJ5IGFkZC9yZW1vdmUgYXMgbmVlZGVkKQogICAgICBmaXJpbmdJbmRleCA9IC0xLAogICAgICAvLyBGaXJlIGNhbGxiYWNrcwogICAgICBmaXJlID0gZnVuY3Rpb24gZmlyZSgpIHsKICAgICAgICAvLyBFbmZvcmNlIHNpbmdsZS1maXJpbmcKICAgICAgICBfbG9ja2VkID0gX2xvY2tlZCB8fCBvcHRpb25zLm9uY2U7CgogICAgICAgIC8vIEV4ZWN1dGUgY2FsbGJhY2tzIGZvciBhbGwgcGVuZGluZyBleGVjdXRpb25zLAogICAgICAgIC8vIHJlc3BlY3RpbmcgZmlyaW5nSW5kZXggb3ZlcnJpZGVzIGFuZCBydW50aW1lIGNoYW5nZXMKICAgICAgICBfZmlyZWQgPSBmaXJpbmcgPSB0cnVlOwogICAgICAgIGZvciAoOyBxdWV1ZS5sZW5ndGg7IGZpcmluZ0luZGV4ID0gLTEpIHsKICAgICAgICAgIG1lbW9yeSA9IHF1ZXVlLnNoaWZ0KCk7CiAgICAgICAgICB3aGlsZSAoKytmaXJpbmdJbmRleCA8IGxpc3QubGVuZ3RoKSB7CiAgICAgICAgICAgIC8vIFJ1biBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGVhcmx5IHRlcm1pbmF0aW9uCiAgICAgICAgICAgIGlmIChsaXN0W2ZpcmluZ0luZGV4XS5hcHBseShtZW1vcnlbMF0sIG1lbW9yeVsxXSkgPT09IGZhbHNlICYmIG9wdGlvbnMuc3RvcE9uRmFsc2UpIHsKICAgICAgICAgICAgICAvLyBKdW1wIHRvIGVuZCBhbmQgZm9yZ2V0IHRoZSBkYXRhIHNvIC5hZGQgZG9lc24ndCByZS1maXJlCiAgICAgICAgICAgICAgZmlyaW5nSW5kZXggPSBsaXN0Lmxlbmd0aDsKICAgICAgICAgICAgICBtZW1vcnkgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gRm9yZ2V0IHRoZSBkYXRhIGlmIHdlJ3JlIGRvbmUgd2l0aCBpdAogICAgICAgIGlmICghb3B0aW9ucy5tZW1vcnkpIHsKICAgICAgICAgIG1lbW9yeSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBmaXJpbmcgPSBmYWxzZTsKCiAgICAgICAgLy8gQ2xlYW4gdXAgaWYgd2UncmUgZG9uZSBmaXJpbmcgZm9yIGdvb2QKICAgICAgICBpZiAoX2xvY2tlZCkgewogICAgICAgICAgLy8gS2VlcCBhbiBlbXB0eSBsaXN0IGlmIHdlIGhhdmUgZGF0YSBmb3IgZnV0dXJlIGFkZCBjYWxscwogICAgICAgICAgaWYgKG1lbW9yeSkgewogICAgICAgICAgICBsaXN0ID0gW107CgogICAgICAgICAgICAvLyBPdGhlcndpc2UsIHRoaXMgb2JqZWN0IGlzIHNwZW50CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaXN0ID0gIiI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBBY3R1YWwgQ2FsbGJhY2tzIG9iamVjdAogICAgICBzZWxmID0gewogICAgICAgIC8vIEFkZCBhIGNhbGxiYWNrIG9yIGEgY29sbGVjdGlvbiBvZiBjYWxsYmFja3MgdG8gdGhlIGxpc3QKICAgICAgICBhZGQ6IGZ1bmN0aW9uIGFkZCgpIHsKICAgICAgICAgIGlmIChsaXN0KSB7CiAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgbWVtb3J5IGZyb20gYSBwYXN0IHJ1biwgd2Ugc2hvdWxkIGZpcmUgYWZ0ZXIgYWRkaW5nCiAgICAgICAgICAgIGlmIChtZW1vcnkgJiYgIWZpcmluZykgewogICAgICAgICAgICAgIGZpcmluZ0luZGV4ID0gbGlzdC5sZW5ndGggLSAxOwogICAgICAgICAgICAgIHF1ZXVlLnB1c2gobWVtb3J5KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAoZnVuY3Rpb24gYWRkKGFyZ3MpIHsKICAgICAgICAgICAgICBqUXVlcnkuZWFjaChhcmdzLCBmdW5jdGlvbiAoXywgYXJnKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihhcmcpKSB7CiAgICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy51bmlxdWUgfHwgIXNlbGYuaGFzKGFyZykpIHsKICAgICAgICAgICAgICAgICAgICBsaXN0LnB1c2goYXJnKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcmcgJiYgYXJnLmxlbmd0aCAmJiB0b1R5cGUoYXJnKSAhPT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICAgICAgLy8gSW5zcGVjdCByZWN1cnNpdmVseQogICAgICAgICAgICAgICAgICBhZGQoYXJnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkoYXJndW1lbnRzKTsKICAgICAgICAgICAgaWYgKG1lbW9yeSAmJiAhZmlyaW5nKSB7CiAgICAgICAgICAgICAgZmlyZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIC8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3QKICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHsKICAgICAgICAgIGpRdWVyeS5lYWNoKGFyZ3VtZW50cywgZnVuY3Rpb24gKF8sIGFyZykgewogICAgICAgICAgICB2YXIgaW5kZXg7CiAgICAgICAgICAgIHdoaWxlICgoaW5kZXggPSBqUXVlcnkuaW5BcnJheShhcmcsIGxpc3QsIGluZGV4KSkgPiAtMSkgewogICAgICAgICAgICAgIGxpc3Quc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgICAgICAgLy8gSGFuZGxlIGZpcmluZyBpbmRleGVzCiAgICAgICAgICAgICAgaWYgKGluZGV4IDw9IGZpcmluZ0luZGV4KSB7CiAgICAgICAgICAgICAgICBmaXJpbmdJbmRleC0tOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIC8vIENoZWNrIGlmIGEgZ2l2ZW4gY2FsbGJhY2sgaXMgaW4gdGhlIGxpc3QuCiAgICAgICAgLy8gSWYgbm8gYXJndW1lbnQgaXMgZ2l2ZW4sIHJldHVybiB3aGV0aGVyIG9yIG5vdCBsaXN0IGhhcyBjYWxsYmFja3MgYXR0YWNoZWQuCiAgICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoZm4pIHsKICAgICAgICAgIHJldHVybiBmbiA/IGpRdWVyeS5pbkFycmF5KGZuLCBsaXN0KSA+IC0xIDogbGlzdC5sZW5ndGggPiAwOwogICAgICAgIH0sCiAgICAgICAgLy8gUmVtb3ZlIGFsbCBjYWxsYmFja3MgZnJvbSB0aGUgbGlzdAogICAgICAgIGVtcHR5OiBmdW5jdGlvbiBlbXB0eSgpIHsKICAgICAgICAgIGlmIChsaXN0KSB7CiAgICAgICAgICAgIGxpc3QgPSBbXTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0sCiAgICAgICAgLy8gRGlzYWJsZSAuZmlyZSBhbmQgLmFkZAogICAgICAgIC8vIEFib3J0IGFueSBjdXJyZW50L3BlbmRpbmcgZXhlY3V0aW9ucwogICAgICAgIC8vIENsZWFyIGFsbCBjYWxsYmFja3MgYW5kIHZhbHVlcwogICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uIGRpc2FibGUoKSB7CiAgICAgICAgICBfbG9ja2VkID0gcXVldWUgPSBbXTsKICAgICAgICAgIGxpc3QgPSBtZW1vcnkgPSAiIjsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0sCiAgICAgICAgZGlzYWJsZWQ6IGZ1bmN0aW9uIGRpc2FibGVkKCkgewogICAgICAgICAgcmV0dXJuICFsaXN0OwogICAgICAgIH0sCiAgICAgICAgLy8gRGlzYWJsZSAuZmlyZQogICAgICAgIC8vIEFsc28gZGlzYWJsZSAuYWRkIHVubGVzcyB3ZSBoYXZlIG1lbW9yeSAoc2luY2UgaXQgd291bGQgaGF2ZSBubyBlZmZlY3QpCiAgICAgICAgLy8gQWJvcnQgYW55IHBlbmRpbmcgZXhlY3V0aW9ucwogICAgICAgIGxvY2s6IGZ1bmN0aW9uIGxvY2soKSB7CiAgICAgICAgICBfbG9ja2VkID0gcXVldWUgPSBbXTsKICAgICAgICAgIGlmICghbWVtb3J5ICYmICFmaXJpbmcpIHsKICAgICAgICAgICAgbGlzdCA9IG1lbW9yeSA9ICIiOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSwKICAgICAgICBsb2NrZWQ6IGZ1bmN0aW9uIGxvY2tlZCgpIHsKICAgICAgICAgIHJldHVybiAhIV9sb2NrZWQ7CiAgICAgICAgfSwKICAgICAgICAvLyBDYWxsIGFsbCBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gY29udGV4dCBhbmQgYXJndW1lbnRzCiAgICAgICAgZmlyZVdpdGg6IGZ1bmN0aW9uIGZpcmVXaXRoKGNvbnRleHQsIGFyZ3MpIHsKICAgICAgICAgIGlmICghX2xvY2tlZCkgewogICAgICAgICAgICBhcmdzID0gYXJncyB8fCBbXTsKICAgICAgICAgICAgYXJncyA9IFtjb250ZXh0LCBhcmdzLnNsaWNlID8gYXJncy5zbGljZSgpIDogYXJnc107CiAgICAgICAgICAgIHF1ZXVlLnB1c2goYXJncyk7CiAgICAgICAgICAgIGlmICghZmlyaW5nKSB7CiAgICAgICAgICAgICAgZmlyZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIC8vIENhbGwgYWxsIHRoZSBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzCiAgICAgICAgZmlyZTogZnVuY3Rpb24gZmlyZSgpIHsKICAgICAgICAgIHNlbGYuZmlyZVdpdGgodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0sCiAgICAgICAgLy8gVG8ga25vdyBpZiB0aGUgY2FsbGJhY2tzIGhhdmUgYWxyZWFkeSBiZWVuIGNhbGxlZCBhdCBsZWFzdCBvbmNlCiAgICAgICAgZmlyZWQ6IGZ1bmN0aW9uIGZpcmVkKCkgewogICAgICAgICAgcmV0dXJuICEhX2ZpcmVkOwogICAgICAgIH0KICAgICAgfTsKICAgIHJldHVybiBzZWxmOwogIH07CiAgZnVuY3Rpb24gSWRlbnRpdHkodikgewogICAgcmV0dXJuIHY7CiAgfQogIGZ1bmN0aW9uIFRocm93ZXIoZXgpIHsKICAgIHRocm93IGV4OwogIH0KICBmdW5jdGlvbiBhZG9wdFZhbHVlKHZhbHVlLCByZXNvbHZlLCByZWplY3QsIG5vVmFsdWUpIHsKICAgIHZhciBtZXRob2Q7CiAgICB0cnkgewogICAgICAvLyBDaGVjayBmb3IgcHJvbWlzZSBhc3BlY3QgZmlyc3QgdG8gcHJpdmlsZWdlIHN5bmNocm9ub3VzIGJlaGF2aW9yCiAgICAgIGlmICh2YWx1ZSAmJiBpc0Z1bmN0aW9uKG1ldGhvZCA9IHZhbHVlLnByb21pc2UpKSB7CiAgICAgICAgbWV0aG9kLmNhbGwodmFsdWUpLmRvbmUocmVzb2x2ZSkuZmFpbChyZWplY3QpOwoKICAgICAgICAvLyBPdGhlciB0aGVuYWJsZXMKICAgICAgfSBlbHNlIGlmICh2YWx1ZSAmJiBpc0Z1bmN0aW9uKG1ldGhvZCA9IHZhbHVlLnRoZW4pKSB7CiAgICAgICAgbWV0aG9kLmNhbGwodmFsdWUsIHJlc29sdmUsIHJlamVjdCk7CgogICAgICAgIC8vIE90aGVyIG5vbi10aGVuYWJsZXMKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDb250cm9sIGByZXNvbHZlYCBhcmd1bWVudHMgYnkgbGV0dGluZyBBcnJheSNzbGljZSBjYXN0IGJvb2xlYW4gYG5vVmFsdWVgIHRvIGludGVnZXI6CiAgICAgICAgLy8gKiBmYWxzZTogWyB2YWx1ZSBdLnNsaWNlKCAwICkgPT4gcmVzb2x2ZSggdmFsdWUgKQogICAgICAgIC8vICogdHJ1ZTogWyB2YWx1ZSBdLnNsaWNlKCAxICkgPT4gcmVzb2x2ZSgpCiAgICAgICAgcmVzb2x2ZS5hcHBseSh1bmRlZmluZWQsIFt2YWx1ZV0uc2xpY2Uobm9WYWx1ZSkpOwogICAgICB9CgogICAgICAvLyBGb3IgUHJvbWlzZXMvQSssIGNvbnZlcnQgZXhjZXB0aW9ucyBpbnRvIHJlamVjdGlvbnMKICAgICAgLy8gU2luY2UgalF1ZXJ5LndoZW4gZG9lc24ndCB1bndyYXAgdGhlbmFibGVzLCB3ZSBjYW4gc2tpcCB0aGUgZXh0cmEgY2hlY2tzIGFwcGVhcmluZyBpbgogICAgICAvLyBEZWZlcnJlZCN0aGVuIHRvIGNvbmRpdGlvbmFsbHkgc3VwcHJlc3MgcmVqZWN0aW9uLgogICAgfSBjYXRjaCAodmFsdWUpIHsKICAgICAgLy8gU3VwcG9ydDogQW5kcm9pZCA0LjAgb25seQogICAgICAvLyBTdHJpY3QgbW9kZSBmdW5jdGlvbnMgaW52b2tlZCB3aXRob3V0IC5jYWxsLy5hcHBseSBnZXQgZ2xvYmFsLW9iamVjdCBjb250ZXh0CiAgICAgIHJlamVjdC5hcHBseSh1bmRlZmluZWQsIFt2YWx1ZV0pOwogICAgfQogIH0KICBqUXVlcnkuZXh0ZW5kKHsKICAgIERlZmVycmVkOiBmdW5jdGlvbiBEZWZlcnJlZChmdW5jKSB7CiAgICAgIHZhciB0dXBsZXMgPSBbCiAgICAgICAgLy8gYWN0aW9uLCBhZGQgbGlzdGVuZXIsIGNhbGxiYWNrcywKICAgICAgICAvLyAuLi4gLnRoZW4gaGFuZGxlcnMsIGFyZ3VtZW50IGluZGV4LCBbZmluYWwgc3RhdGVdCiAgICAgICAgWyJub3RpZnkiLCAicHJvZ3Jlc3MiLCBqUXVlcnkuQ2FsbGJhY2tzKCJtZW1vcnkiKSwgalF1ZXJ5LkNhbGxiYWNrcygibWVtb3J5IiksIDJdLCBbInJlc29sdmUiLCAiZG9uZSIsIGpRdWVyeS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksIGpRdWVyeS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksIDAsICJyZXNvbHZlZCJdLCBbInJlamVjdCIsICJmYWlsIiwgalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgMSwgInJlamVjdGVkIl1dLAogICAgICAgIF9zdGF0ZSA9ICJwZW5kaW5nIiwKICAgICAgICBfcHJvbWlzZSA9IHsKICAgICAgICAgIHN0YXRlOiBmdW5jdGlvbiBzdGF0ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIF9zdGF0ZTsKICAgICAgICAgIH0sCiAgICAgICAgICBhbHdheXM6IGZ1bmN0aW9uIGFsd2F5cygpIHsKICAgICAgICAgICAgZGVmZXJyZWQuZG9uZShhcmd1bWVudHMpLmZhaWwoYXJndW1lbnRzKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9LAogICAgICAgICAgImNhdGNoIjogZnVuY3Rpb24gX2NhdGNoKGZuKSB7CiAgICAgICAgICAgIHJldHVybiBfcHJvbWlzZS50aGVuKG51bGwsIGZuKTsKICAgICAgICAgIH0sCiAgICAgICAgICAvLyBLZWVwIHBpcGUgZm9yIGJhY2stY29tcGF0CiAgICAgICAgICBwaXBlOiBmdW5jdGlvbiBwaXBlKCAvKiBmbkRvbmUsIGZuRmFpbCwgZm5Qcm9ncmVzcyAqLwogICAgICAgICAgKSB7CiAgICAgICAgICAgIHZhciBmbnMgPSBhcmd1bWVudHM7CiAgICAgICAgICAgIHJldHVybiBqUXVlcnkuRGVmZXJyZWQoZnVuY3Rpb24gKG5ld0RlZmVyKSB7CiAgICAgICAgICAgICAgalF1ZXJ5LmVhY2godHVwbGVzLCBmdW5jdGlvbiAoX2ksIHR1cGxlKSB7CiAgICAgICAgICAgICAgICAvLyBNYXAgdHVwbGVzIChwcm9ncmVzcywgZG9uZSwgZmFpbCkgdG8gYXJndW1lbnRzIChkb25lLCBmYWlsLCBwcm9ncmVzcykKICAgICAgICAgICAgICAgIHZhciBmbiA9IGlzRnVuY3Rpb24oZm5zW3R1cGxlWzRdXSkgJiYgZm5zW3R1cGxlWzRdXTsKCiAgICAgICAgICAgICAgICAvLyBkZWZlcnJlZC5wcm9ncmVzcyhmdW5jdGlvbigpIHsgYmluZCB0byBuZXdEZWZlciBvciBuZXdEZWZlci5ub3RpZnkgfSkKICAgICAgICAgICAgICAgIC8vIGRlZmVycmVkLmRvbmUoZnVuY3Rpb24oKSB7IGJpbmQgdG8gbmV3RGVmZXIgb3IgbmV3RGVmZXIucmVzb2x2ZSB9KQogICAgICAgICAgICAgICAgLy8gZGVmZXJyZWQuZmFpbChmdW5jdGlvbigpIHsgYmluZCB0byBuZXdEZWZlciBvciBuZXdEZWZlci5yZWplY3QgfSkKICAgICAgICAgICAgICAgIGRlZmVycmVkW3R1cGxlWzFdXShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5lZCA9IGZuICYmIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIGlmIChyZXR1cm5lZCAmJiBpc0Z1bmN0aW9uKHJldHVybmVkLnByb21pc2UpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuZWQucHJvbWlzZSgpLnByb2dyZXNzKG5ld0RlZmVyLm5vdGlmeSkuZG9uZShuZXdEZWZlci5yZXNvbHZlKS5mYWlsKG5ld0RlZmVyLnJlamVjdCk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbmV3RGVmZXJbdHVwbGVbMF0gKyAiV2l0aCJdKHRoaXMsIGZuID8gW3JldHVybmVkXSA6IGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGZucyA9IG51bGw7CiAgICAgICAgICAgIH0pLnByb21pc2UoKTsKICAgICAgICAgIH0sCiAgICAgICAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBvblByb2dyZXNzKSB7CiAgICAgICAgICAgIHZhciBtYXhEZXB0aCA9IDA7CiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc29sdmUoZGVwdGgsIGRlZmVycmVkLCBoYW5kbGVyLCBzcGVjaWFsKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcywKICAgICAgICAgICAgICAgICAgYXJncyA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgICAgbWlnaHRUaHJvdyA9IGZ1bmN0aW9uIG1pZ2h0VGhyb3coKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJldHVybmVkLCB0aGVuOwoKICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBQcm9taXNlcy9BKyBzZWN0aW9uIDIuMy4zLjMuMwogICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vcHJvbWlzZXNhcGx1cy5jb20vI3BvaW50LTU5CiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIGRvdWJsZS1yZXNvbHV0aW9uIGF0dGVtcHRzCiAgICAgICAgICAgICAgICAgICAgaWYgKGRlcHRoIDwgbWF4RGVwdGgpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuZWQgPSBoYW5kbGVyLmFwcGx5KHRoYXQsIGFyZ3MpOwoKICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBQcm9taXNlcy9BKyBzZWN0aW9uIDIuMy4xCiAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9wcm9taXNlc2FwbHVzLmNvbS8jcG9pbnQtNDgKICAgICAgICAgICAgICAgICAgICBpZiAocmV0dXJuZWQgPT09IGRlZmVycmVkLnByb21pc2UoKSkgewogICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhlbmFibGUgc2VsZi1yZXNvbHV0aW9uIik7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBQcm9taXNlcy9BKyBzZWN0aW9ucyAyLjMuMy4xLCAzLjUKICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL3Byb21pc2VzYXBsdXMuY29tLyNwb2ludC01NAogICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vcHJvbWlzZXNhcGx1cy5jb20vI3BvaW50LTc1CiAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgYHRoZW5gIG9ubHkgb25jZQogICAgICAgICAgICAgICAgICAgIHRoZW4gPSByZXR1cm5lZCAmJiAoCiAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogUHJvbWlzZXMvQSsgc2VjdGlvbiAyLjMuNAogICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vcHJvbWlzZXNhcGx1cy5jb20vI3BvaW50LTY0CiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBjaGVjayBvYmplY3RzIGFuZCBmdW5jdGlvbnMgZm9yIHRoZW5hYmlsaXR5CiAgICAgICAgICAgICAgICAgICAgX3R5cGVvZihyZXR1cm5lZCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiByZXR1cm5lZCA9PT0gImZ1bmN0aW9uIikgJiYgcmV0dXJuZWQudGhlbjsKCiAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGEgcmV0dXJuZWQgdGhlbmFibGUKICAgICAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbih0aGVuKSkgewogICAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBwcm9jZXNzb3JzIChub3RpZnkpIGp1c3Qgd2FpdCBmb3IgcmVzb2x1dGlvbgogICAgICAgICAgICAgICAgICAgICAgaWYgKHNwZWNpYWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhlbi5jYWxsKHJldHVybmVkLCByZXNvbHZlKG1heERlcHRoLCBkZWZlcnJlZCwgSWRlbnRpdHksIHNwZWNpYWwpLCByZXNvbHZlKG1heERlcHRoLCBkZWZlcnJlZCwgVGhyb3dlciwgc3BlY2lhbCkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9ybWFsIHByb2Nlc3NvcnMgKHJlc29sdmUpIGFsc28gaG9vayBpbnRvIHByb2dyZXNzCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyAuLi5hbmQgZGlzcmVnYXJkIG9sZGVyIHJlc29sdXRpb24gdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgICAgIG1heERlcHRoKys7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4uY2FsbChyZXR1cm5lZCwgcmVzb2x2ZShtYXhEZXB0aCwgZGVmZXJyZWQsIElkZW50aXR5LCBzcGVjaWFsKSwgcmVzb2x2ZShtYXhEZXB0aCwgZGVmZXJyZWQsIFRocm93ZXIsIHNwZWNpYWwpLCByZXNvbHZlKG1heERlcHRoLCBkZWZlcnJlZCwgSWRlbnRpdHksIGRlZmVycmVkLm5vdGlmeVdpdGgpKTsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgYWxsIG90aGVyIHJldHVybmVkIHZhbHVlcwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHN1YnN0aXR1dGUgaGFuZGxlcnMgcGFzcyBvbiBjb250ZXh0CiAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgbXVsdGlwbGUgdmFsdWVzIChub24tc3BlYyBiZWhhdmlvcikKICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyICE9PSBJZGVudGl0eSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGF0ID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gW3JldHVybmVkXTsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIHRoZSB2YWx1ZShzKQogICAgICAgICAgICAgICAgICAgICAgLy8gRGVmYXVsdCBwcm9jZXNzIGlzIHJlc29sdmUKICAgICAgICAgICAgICAgICAgICAgIChzcGVjaWFsIHx8IGRlZmVycmVkLnJlc29sdmVXaXRoKSh0aGF0LCBhcmdzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIC8vIE9ubHkgbm9ybWFsIHByb2Nlc3NvcnMgKHJlc29sdmUpIGNhdGNoIGFuZCByZWplY3QgZXhjZXB0aW9ucwogICAgICAgICAgICAgICAgICBwcm9jZXNzID0gc3BlY2lhbCA/IG1pZ2h0VGhyb3cgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgIG1pZ2h0VGhyb3coKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoalF1ZXJ5LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2spIHsKICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2soZSwgcHJvY2Vzcy5zdGFja1RyYWNlKTsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBQcm9taXNlcy9BKyBzZWN0aW9uIDIuMy4zLjMuNC4xCiAgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL3Byb21pc2VzYXBsdXMuY29tLyNwb2ludC02MQogICAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIHBvc3QtcmVzb2x1dGlvbiBleGNlcHRpb25zCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVwdGggKyAxID49IG1heERlcHRoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgc3Vic3RpdHV0ZSBoYW5kbGVycyBwYXNzIG9uIGNvbnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIG11bHRpcGxlIHZhbHVlcyAobm9uLXNwZWMgYmVoYXZpb3IpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyICE9PSBUaHJvd2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gW2VdOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdFdpdGgodGhhdCwgYXJncyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IFByb21pc2VzL0ErIHNlY3Rpb24gMi4zLjMuMy4xCiAgICAgICAgICAgICAgICAvLyBodHRwczovL3Byb21pc2VzYXBsdXMuY29tLyNwb2ludC01NwogICAgICAgICAgICAgICAgLy8gUmUtcmVzb2x2ZSBwcm9taXNlcyBpbW1lZGlhdGVseSB0byBkb2RnZSBmYWxzZSByZWplY3Rpb24gZnJvbQogICAgICAgICAgICAgICAgLy8gc3Vic2VxdWVudCBlcnJvcnMKICAgICAgICAgICAgICAgIGlmIChkZXB0aCkgewogICAgICAgICAgICAgICAgICBwcm9jZXNzKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAvLyBDYWxsIGFuIG9wdGlvbmFsIGhvb2sgdG8gcmVjb3JkIHRoZSBzdGFjaywgaW4gY2FzZSBvZiBleGNlcHRpb24KICAgICAgICAgICAgICAgICAgLy8gc2luY2UgaXQncyBvdGhlcndpc2UgbG9zdCB3aGVuIGV4ZWN1dGlvbiBnb2VzIGFzeW5jCiAgICAgICAgICAgICAgICAgIGlmIChqUXVlcnkuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKSB7CiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5zdGFja1RyYWNlID0galF1ZXJ5LkRlZmVycmVkLmdldFN0YWNrSG9vaygpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHByb2Nlc3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS5EZWZlcnJlZChmdW5jdGlvbiAobmV3RGVmZXIpIHsKICAgICAgICAgICAgICAvLyBwcm9ncmVzc19oYW5kbGVycy5hZGQoIC4uLiApCiAgICAgICAgICAgICAgdHVwbGVzWzBdWzNdLmFkZChyZXNvbHZlKDAsIG5ld0RlZmVyLCBpc0Z1bmN0aW9uKG9uUHJvZ3Jlc3MpID8gb25Qcm9ncmVzcyA6IElkZW50aXR5LCBuZXdEZWZlci5ub3RpZnlXaXRoKSk7CgogICAgICAgICAgICAgIC8vIGZ1bGZpbGxlZF9oYW5kbGVycy5hZGQoIC4uLiApCiAgICAgICAgICAgICAgdHVwbGVzWzFdWzNdLmFkZChyZXNvbHZlKDAsIG5ld0RlZmVyLCBpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSA/IG9uRnVsZmlsbGVkIDogSWRlbnRpdHkpKTsKCiAgICAgICAgICAgICAgLy8gcmVqZWN0ZWRfaGFuZGxlcnMuYWRkKCAuLi4gKQogICAgICAgICAgICAgIHR1cGxlc1syXVszXS5hZGQocmVzb2x2ZSgwLCBuZXdEZWZlciwgaXNGdW5jdGlvbihvblJlamVjdGVkKSA/IG9uUmVqZWN0ZWQgOiBUaHJvd2VyKSk7CiAgICAgICAgICAgIH0pLnByb21pc2UoKTsKICAgICAgICAgIH0sCiAgICAgICAgICAvLyBHZXQgYSBwcm9taXNlIGZvciB0aGlzIGRlZmVycmVkCiAgICAgICAgICAvLyBJZiBvYmogaXMgcHJvdmlkZWQsIHRoZSBwcm9taXNlIGFzcGVjdCBpcyBhZGRlZCB0byB0aGUgb2JqZWN0CiAgICAgICAgICBwcm9taXNlOiBmdW5jdGlvbiBwcm9taXNlKG9iaikgewogICAgICAgICAgICByZXR1cm4gb2JqICE9IG51bGwgPyBqUXVlcnkuZXh0ZW5kKG9iaiwgX3Byb21pc2UpIDogX3Byb21pc2U7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkZWZlcnJlZCA9IHt9OwoKICAgICAgLy8gQWRkIGxpc3Qtc3BlY2lmaWMgbWV0aG9kcwogICAgICBqUXVlcnkuZWFjaCh0dXBsZXMsIGZ1bmN0aW9uIChpLCB0dXBsZSkgewogICAgICAgIHZhciBsaXN0ID0gdHVwbGVbMl0sCiAgICAgICAgICBzdGF0ZVN0cmluZyA9IHR1cGxlWzVdOwoKICAgICAgICAvLyBwcm9taXNlLnByb2dyZXNzID0gbGlzdC5hZGQKICAgICAgICAvLyBwcm9taXNlLmRvbmUgPSBsaXN0LmFkZAogICAgICAgIC8vIHByb21pc2UuZmFpbCA9IGxpc3QuYWRkCiAgICAgICAgX3Byb21pc2VbdHVwbGVbMV1dID0gbGlzdC5hZGQ7CgogICAgICAgIC8vIEhhbmRsZSBzdGF0ZQogICAgICAgIGlmIChzdGF0ZVN0cmluZykgewogICAgICAgICAgbGlzdC5hZGQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyBzdGF0ZSA9ICJyZXNvbHZlZCIgKGkuZS4sIGZ1bGZpbGxlZCkKICAgICAgICAgICAgLy8gc3RhdGUgPSAicmVqZWN0ZWQiCiAgICAgICAgICAgIF9zdGF0ZSA9IHN0YXRlU3RyaW5nOwogICAgICAgICAgfSwKICAgICAgICAgIC8vIHJlamVjdGVkX2NhbGxiYWNrcy5kaXNhYmxlCiAgICAgICAgICAvLyBmdWxmaWxsZWRfY2FsbGJhY2tzLmRpc2FibGUKICAgICAgICAgIHR1cGxlc1szIC0gaV1bMl0uZGlzYWJsZSwKICAgICAgICAgIC8vIHJlamVjdGVkX2hhbmRsZXJzLmRpc2FibGUKICAgICAgICAgIC8vIGZ1bGZpbGxlZF9oYW5kbGVycy5kaXNhYmxlCiAgICAgICAgICB0dXBsZXNbMyAtIGldWzNdLmRpc2FibGUsCiAgICAgICAgICAvLyBwcm9ncmVzc19jYWxsYmFja3MubG9jawogICAgICAgICAgdHVwbGVzWzBdWzJdLmxvY2ssCiAgICAgICAgICAvLyBwcm9ncmVzc19oYW5kbGVycy5sb2NrCiAgICAgICAgICB0dXBsZXNbMF1bM10ubG9jayk7CiAgICAgICAgfQoKICAgICAgICAvLyBwcm9ncmVzc19oYW5kbGVycy5maXJlCiAgICAgICAgLy8gZnVsZmlsbGVkX2hhbmRsZXJzLmZpcmUKICAgICAgICAvLyByZWplY3RlZF9oYW5kbGVycy5maXJlCiAgICAgICAgbGlzdC5hZGQodHVwbGVbM10uZmlyZSk7CgogICAgICAgIC8vIGRlZmVycmVkLm5vdGlmeSA9IGZ1bmN0aW9uKCkgeyBkZWZlcnJlZC5ub3RpZnlXaXRoKC4uLikgfQogICAgICAgIC8vIGRlZmVycmVkLnJlc29sdmUgPSBmdW5jdGlvbigpIHsgZGVmZXJyZWQucmVzb2x2ZVdpdGgoLi4uKSB9CiAgICAgICAgLy8gZGVmZXJyZWQucmVqZWN0ID0gZnVuY3Rpb24oKSB7IGRlZmVycmVkLnJlamVjdFdpdGgoLi4uKSB9CiAgICAgICAgZGVmZXJyZWRbdHVwbGVbMF1dID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgZGVmZXJyZWRbdHVwbGVbMF0gKyAiV2l0aCJdKHRoaXMgPT09IGRlZmVycmVkID8gdW5kZWZpbmVkIDogdGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH07CgogICAgICAgIC8vIGRlZmVycmVkLm5vdGlmeVdpdGggPSBsaXN0LmZpcmVXaXRoCiAgICAgICAgLy8gZGVmZXJyZWQucmVzb2x2ZVdpdGggPSBsaXN0LmZpcmVXaXRoCiAgICAgICAgLy8gZGVmZXJyZWQucmVqZWN0V2l0aCA9IGxpc3QuZmlyZVdpdGgKICAgICAgICBkZWZlcnJlZFt0dXBsZVswXSArICJXaXRoIl0gPSBsaXN0LmZpcmVXaXRoOwogICAgICB9KTsKCiAgICAgIC8vIE1ha2UgdGhlIGRlZmVycmVkIGEgcHJvbWlzZQogICAgICBfcHJvbWlzZS5wcm9taXNlKGRlZmVycmVkKTsKCiAgICAgIC8vIENhbGwgZ2l2ZW4gZnVuYyBpZiBhbnkKICAgICAgaWYgKGZ1bmMpIHsKICAgICAgICBmdW5jLmNhbGwoZGVmZXJyZWQsIGRlZmVycmVkKTsKICAgICAgfQoKICAgICAgLy8gQWxsIGRvbmUhCiAgICAgIHJldHVybiBkZWZlcnJlZDsKICAgIH0sCiAgICAvLyBEZWZlcnJlZCBoZWxwZXIKICAgIHdoZW46IGZ1bmN0aW9uIHdoZW4oc2luZ2xlVmFsdWUpIHsKICAgICAgdmFyCiAgICAgICAgLy8gY291bnQgb2YgdW5jb21wbGV0ZWQgc3Vib3JkaW5hdGVzCiAgICAgICAgcmVtYWluaW5nID0gYXJndW1lbnRzLmxlbmd0aCwKICAgICAgICAvLyBjb3VudCBvZiB1bnByb2Nlc3NlZCBhcmd1bWVudHMKICAgICAgICBpID0gcmVtYWluaW5nLAogICAgICAgIC8vIHN1Ym9yZGluYXRlIGZ1bGZpbGxtZW50IGRhdGEKICAgICAgICByZXNvbHZlQ29udGV4dHMgPSBBcnJheShpKSwKICAgICAgICByZXNvbHZlVmFsdWVzID0gX3NsaWNlLmNhbGwoYXJndW1lbnRzKSwKICAgICAgICAvLyB0aGUgbWFzdGVyIERlZmVycmVkCiAgICAgICAgbWFzdGVyID0galF1ZXJ5LkRlZmVycmVkKCksCiAgICAgICAgLy8gc3Vib3JkaW5hdGUgY2FsbGJhY2sgZmFjdG9yeQogICAgICAgIHVwZGF0ZUZ1bmMgPSBmdW5jdGlvbiB1cGRhdGVGdW5jKGkpIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgcmVzb2x2ZUNvbnRleHRzW2ldID0gdGhpczsKICAgICAgICAgICAgcmVzb2x2ZVZhbHVlc1tpXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gX3NsaWNlLmNhbGwoYXJndW1lbnRzKSA6IHZhbHVlOwogICAgICAgICAgICBpZiAoISAtLXJlbWFpbmluZykgewogICAgICAgICAgICAgIG1hc3Rlci5yZXNvbHZlV2l0aChyZXNvbHZlQ29udGV4dHMsIHJlc29sdmVWYWx1ZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH07CgogICAgICAvLyBTaW5nbGUtIGFuZCBlbXB0eSBhcmd1bWVudHMgYXJlIGFkb3B0ZWQgbGlrZSBQcm9taXNlLnJlc29sdmUKICAgICAgaWYgKHJlbWFpbmluZyA8PSAxKSB7CiAgICAgICAgYWRvcHRWYWx1ZShzaW5nbGVWYWx1ZSwgbWFzdGVyLmRvbmUodXBkYXRlRnVuYyhpKSkucmVzb2x2ZSwgbWFzdGVyLnJlamVjdCwgIXJlbWFpbmluZyk7CgogICAgICAgIC8vIFVzZSAudGhlbigpIHRvIHVud3JhcCBzZWNvbmRhcnkgdGhlbmFibGVzIChjZi4gZ2gtMzAwMCkKICAgICAgICBpZiAobWFzdGVyLnN0YXRlKCkgPT09ICJwZW5kaW5nIiB8fCBpc0Z1bmN0aW9uKHJlc29sdmVWYWx1ZXNbaV0gJiYgcmVzb2x2ZVZhbHVlc1tpXS50aGVuKSkgewogICAgICAgICAgcmV0dXJuIG1hc3Rlci50aGVuKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBNdWx0aXBsZSBhcmd1bWVudHMgYXJlIGFnZ3JlZ2F0ZWQgbGlrZSBQcm9taXNlLmFsbCBhcnJheSBlbGVtZW50cwogICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgYWRvcHRWYWx1ZShyZXNvbHZlVmFsdWVzW2ldLCB1cGRhdGVGdW5jKGkpLCBtYXN0ZXIucmVqZWN0KTsKICAgICAgfQogICAgICByZXR1cm4gbWFzdGVyLnByb21pc2UoKTsKICAgIH0KICB9KTsKCiAgLy8gVGhlc2UgdXN1YWxseSBpbmRpY2F0ZSBhIHByb2dyYW1tZXIgbWlzdGFrZSBkdXJpbmcgZGV2ZWxvcG1lbnQsCiAgLy8gd2FybiBhYm91dCB0aGVtIEFTQVAgcmF0aGVyIHRoYW4gc3dhbGxvd2luZyB0aGVtIGJ5IGRlZmF1bHQuCiAgdmFyIHJlcnJvck5hbWVzID0gL14oRXZhbHxJbnRlcm5hbHxSYW5nZXxSZWZlcmVuY2V8U3ludGF4fFR5cGV8VVJJKUVycm9yJC87CiAgalF1ZXJ5LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2sgPSBmdW5jdGlvbiAoZXJyb3IsIHN0YWNrKSB7CiAgICAvLyBTdXBwb3J0OiBJRSA4IC0gOSBvbmx5CiAgICAvLyBDb25zb2xlIGV4aXN0cyB3aGVuIGRldiB0b29scyBhcmUgb3Blbiwgd2hpY2ggY2FuIGhhcHBlbiBhdCBhbnkgdGltZQogICAgaWYgKHdpbmRvdy5jb25zb2xlICYmIHdpbmRvdy5jb25zb2xlLndhcm4gJiYgZXJyb3IgJiYgcmVycm9yTmFtZXMudGVzdChlcnJvci5uYW1lKSkgewogICAgICB3aW5kb3cuY29uc29sZS53YXJuKCJqUXVlcnkuRGVmZXJyZWQgZXhjZXB0aW9uOiAiICsgZXJyb3IubWVzc2FnZSwgZXJyb3Iuc3RhY2ssIHN0YWNrKTsKICAgIH0KICB9OwogIGpRdWVyeS5yZWFkeUV4Y2VwdGlvbiA9IGZ1bmN0aW9uIChlcnJvcikgewogICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICB0aHJvdyBlcnJvcjsKICAgIH0pOwogIH07CgogIC8vIFRoZSBkZWZlcnJlZCB1c2VkIG9uIERPTSByZWFkeQogIHZhciByZWFkeUxpc3QgPSBqUXVlcnkuRGVmZXJyZWQoKTsKICBqUXVlcnkuZm4ucmVhZHkgPSBmdW5jdGlvbiAoZm4pIHsKICAgIHJlYWR5TGlzdC50aGVuKGZuKQoKICAgIC8vIFdyYXAgalF1ZXJ5LnJlYWR5RXhjZXB0aW9uIGluIGEgZnVuY3Rpb24gc28gdGhhdCB0aGUgbG9va3VwCiAgICAvLyBoYXBwZW5zIGF0IHRoZSB0aW1lIG9mIGVycm9yIGhhbmRsaW5nIGluc3RlYWQgb2YgY2FsbGJhY2sKICAgIC8vIHJlZ2lzdHJhdGlvbi4KICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgalF1ZXJ5LnJlYWR5RXhjZXB0aW9uKGVycm9yKTsKICAgIH0pOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKICBqUXVlcnkuZXh0ZW5kKHsKICAgIC8vIElzIHRoZSBET00gcmVhZHkgdG8gYmUgdXNlZD8gU2V0IHRvIHRydWUgb25jZSBpdCBvY2N1cnMuCiAgICBpc1JlYWR5OiBmYWxzZSwKICAgIC8vIEEgY291bnRlciB0byB0cmFjayBob3cgbWFueSBpdGVtcyB0byB3YWl0IGZvciBiZWZvcmUKICAgIC8vIHRoZSByZWFkeSBldmVudCBmaXJlcy4gU2VlICM2NzgxCiAgICByZWFkeVdhaXQ6IDEsCiAgICAvLyBIYW5kbGUgd2hlbiB0aGUgRE9NIGlzIHJlYWR5CiAgICByZWFkeTogZnVuY3Rpb24gcmVhZHkod2FpdCkgewogICAgICAvLyBBYm9ydCBpZiB0aGVyZSBhcmUgcGVuZGluZyBob2xkcyBvciB3ZSdyZSBhbHJlYWR5IHJlYWR5CiAgICAgIGlmICh3YWl0ID09PSB0cnVlID8gLS1qUXVlcnkucmVhZHlXYWl0IDogalF1ZXJ5LmlzUmVhZHkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIFJlbWVtYmVyIHRoYXQgdGhlIERPTSBpcyByZWFkeQogICAgICBqUXVlcnkuaXNSZWFkeSA9IHRydWU7CgogICAgICAvLyBJZiBhIG5vcm1hbCBET00gUmVhZHkgZXZlbnQgZmlyZWQsIGRlY3JlbWVudCwgYW5kIHdhaXQgaWYgbmVlZCBiZQogICAgICBpZiAod2FpdCAhPT0gdHJ1ZSAmJiAtLWpRdWVyeS5yZWFkeVdhaXQgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyBJZiB0aGVyZSBhcmUgZnVuY3Rpb25zIGJvdW5kLCB0byBleGVjdXRlCiAgICAgIHJlYWR5TGlzdC5yZXNvbHZlV2l0aChkb2N1bWVudCwgW2pRdWVyeV0pOwogICAgfQogIH0pOwogIGpRdWVyeS5yZWFkeS50aGVuID0gcmVhZHlMaXN0LnRoZW47CgogIC8vIFRoZSByZWFkeSBldmVudCBoYW5kbGVyIGFuZCBzZWxmIGNsZWFudXAgbWV0aG9kCiAgZnVuY3Rpb24gY29tcGxldGVkKCkgewogICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGNvbXBsZXRlZCk7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigibG9hZCIsIGNvbXBsZXRlZCk7CiAgICBqUXVlcnkucmVhZHkoKTsKICB9CgogIC8vIENhdGNoIGNhc2VzIHdoZXJlICQoZG9jdW1lbnQpLnJlYWR5KCkgaXMgY2FsbGVkCiAgLy8gYWZ0ZXIgdGhlIGJyb3dzZXIgZXZlbnQgaGFzIGFscmVhZHkgb2NjdXJyZWQuCiAgLy8gU3VwcG9ydDogSUUgPD05IC0gMTAgb25seQogIC8vIE9sZGVyIElFIHNvbWV0aW1lcyBzaWduYWxzICJpbnRlcmFjdGl2ZSIgdG9vIHNvb24KICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gImNvbXBsZXRlIiB8fCBkb2N1bWVudC5yZWFkeVN0YXRlICE9PSAibG9hZGluZyIgJiYgIWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCkgewogICAgLy8gSGFuZGxlIGl0IGFzeW5jaHJvbm91c2x5IHRvIGFsbG93IHNjcmlwdHMgdGhlIG9wcG9ydHVuaXR5IHRvIGRlbGF5IHJlYWR5CiAgICB3aW5kb3cuc2V0VGltZW91dChqUXVlcnkucmVhZHkpOwogIH0gZWxzZSB7CiAgICAvLyBVc2UgdGhlIGhhbmR5IGV2ZW50IGNhbGxiYWNrCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgY29tcGxldGVkKTsKCiAgICAvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29yawogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBjb21wbGV0ZWQpOwogIH0KCiAgLy8gTXVsdGlmdW5jdGlvbmFsIG1ldGhvZCB0byBnZXQgYW5kIHNldCB2YWx1ZXMgb2YgYSBjb2xsZWN0aW9uCiAgLy8gVGhlIHZhbHVlL3MgY2FuIG9wdGlvbmFsbHkgYmUgZXhlY3V0ZWQgaWYgaXQncyBhIGZ1bmN0aW9uCiAgdmFyIGFjY2VzcyA9IGZ1bmN0aW9uIGFjY2VzcyhlbGVtcywgZm4sIGtleSwgdmFsdWUsIGNoYWluYWJsZSwgZW1wdHlHZXQsIHJhdykgewogICAgdmFyIGkgPSAwLAogICAgICBsZW4gPSBlbGVtcy5sZW5ndGgsCiAgICAgIGJ1bGsgPSBrZXkgPT0gbnVsbDsKCiAgICAvLyBTZXRzIG1hbnkgdmFsdWVzCiAgICBpZiAodG9UeXBlKGtleSkgPT09ICJvYmplY3QiKSB7CiAgICAgIGNoYWluYWJsZSA9IHRydWU7CiAgICAgIGZvciAoaSBpbiBrZXkpIHsKICAgICAgICBhY2Nlc3MoZWxlbXMsIGZuLCBpLCBrZXlbaV0sIHRydWUsIGVtcHR5R2V0LCByYXcpOwogICAgICB9CgogICAgICAvLyBTZXRzIG9uZSB2YWx1ZQogICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGNoYWluYWJsZSA9IHRydWU7CiAgICAgIGlmICghaXNGdW5jdGlvbih2YWx1ZSkpIHsKICAgICAgICByYXcgPSB0cnVlOwogICAgICB9CiAgICAgIGlmIChidWxrKSB7CiAgICAgICAgLy8gQnVsayBvcGVyYXRpb25zIHJ1biBhZ2FpbnN0IHRoZSBlbnRpcmUgc2V0CiAgICAgICAgaWYgKHJhdykgewogICAgICAgICAgZm4uY2FsbChlbGVtcywgdmFsdWUpOwogICAgICAgICAgZm4gPSBudWxsOwoKICAgICAgICAgIC8vIC4uLmV4Y2VwdCB3aGVuIGV4ZWN1dGluZyBmdW5jdGlvbiB2YWx1ZXMKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYnVsayA9IGZuOwogICAgICAgICAgZm4gPSBmdW5jdGlvbiBmbihlbGVtLCBfa2V5LCB2YWx1ZSkgewogICAgICAgICAgICByZXR1cm4gYnVsay5jYWxsKGpRdWVyeShlbGVtKSwgdmFsdWUpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGZuKSB7CiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgZm4oZWxlbXNbaV0sIGtleSwgcmF3ID8gdmFsdWUgOiB2YWx1ZS5jYWxsKGVsZW1zW2ldLCBpLCBmbihlbGVtc1tpXSwga2V5KSkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKGNoYWluYWJsZSkgewogICAgICByZXR1cm4gZWxlbXM7CiAgICB9CgogICAgLy8gR2V0cwogICAgaWYgKGJ1bGspIHsKICAgICAgcmV0dXJuIGZuLmNhbGwoZWxlbXMpOwogICAgfQogICAgcmV0dXJuIGxlbiA/IGZuKGVsZW1zWzBdLCBrZXkpIDogZW1wdHlHZXQ7CiAgfTsKCiAgLy8gTWF0Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nCiAgdmFyIHJtc1ByZWZpeCA9IC9eLW1zLS8sCiAgICByZGFzaEFscGhhID0gLy0oW2Etel0pL2c7CgogIC8vIFVzZWQgYnkgY2FtZWxDYXNlIGFzIGNhbGxiYWNrIHRvIHJlcGxhY2UoKQogIGZ1bmN0aW9uIGZjYW1lbENhc2UoX2FsbCwgbGV0dGVyKSB7CiAgICByZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CiAgfQoKICAvLyBDb252ZXJ0IGRhc2hlZCB0byBjYW1lbENhc2U7IHVzZWQgYnkgdGhlIGNzcyBhbmQgZGF0YSBtb2R1bGVzCiAgLy8gU3VwcG9ydDogSUUgPD05IC0gMTEsIEVkZ2UgMTIgLSAxNQogIC8vIE1pY3Jvc29mdCBmb3Jnb3QgdG8gaHVtcCB0aGVpciB2ZW5kb3IgcHJlZml4ICgjOTU3MikKICBmdW5jdGlvbiBjYW1lbENhc2Uoc3RyaW5nKSB7CiAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2Uocm1zUHJlZml4LCAibXMtIikucmVwbGFjZShyZGFzaEFscGhhLCBmY2FtZWxDYXNlKTsKICB9CiAgdmFyIGFjY2VwdERhdGEgPSBmdW5jdGlvbiBhY2NlcHREYXRhKG93bmVyKSB7CiAgICAvLyBBY2NlcHRzIG9ubHk6CiAgICAvLyAgLSBOb2RlCiAgICAvLyAgICAtIE5vZGUuRUxFTUVOVF9OT0RFCiAgICAvLyAgICAtIE5vZGUuRE9DVU1FTlRfTk9ERQogICAgLy8gIC0gT2JqZWN0CiAgICAvLyAgICAtIEFueQogICAgcmV0dXJuIG93bmVyLm5vZGVUeXBlID09PSAxIHx8IG93bmVyLm5vZGVUeXBlID09PSA5IHx8ICErb3duZXIubm9kZVR5cGU7CiAgfTsKICBmdW5jdGlvbiBEYXRhKCkgewogICAgdGhpcy5leHBhbmRvID0galF1ZXJ5LmV4cGFuZG8gKyBEYXRhLnVpZCsrOwogIH0KICBEYXRhLnVpZCA9IDE7CiAgRGF0YS5wcm90b3R5cGUgPSB7CiAgICBjYWNoZTogZnVuY3Rpb24gY2FjaGUob3duZXIpIHsKICAgICAgLy8gQ2hlY2sgaWYgdGhlIG93bmVyIG9iamVjdCBhbHJlYWR5IGhhcyBhIGNhY2hlCiAgICAgIHZhciB2YWx1ZSA9IG93bmVyW3RoaXMuZXhwYW5kb107CgogICAgICAvLyBJZiBub3QsIGNyZWF0ZSBvbmUKICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgIHZhbHVlID0ge307CgogICAgICAgIC8vIFdlIGNhbiBhY2NlcHQgZGF0YSBmb3Igbm9uLWVsZW1lbnQgbm9kZXMgaW4gbW9kZXJuIGJyb3dzZXJzLAogICAgICAgIC8vIGJ1dCB3ZSBzaG91bGQgbm90LCBzZWUgIzgzMzUuCiAgICAgICAgLy8gQWx3YXlzIHJldHVybiBhbiBlbXB0eSBvYmplY3QuCiAgICAgICAgaWYgKGFjY2VwdERhdGEob3duZXIpKSB7CiAgICAgICAgICAvLyBJZiBpdCBpcyBhIG5vZGUgdW5saWtlbHkgdG8gYmUgc3RyaW5naWZ5LWVkIG9yIGxvb3BlZCBvdmVyCiAgICAgICAgICAvLyB1c2UgcGxhaW4gYXNzaWdubWVudAogICAgICAgICAgaWYgKG93bmVyLm5vZGVUeXBlKSB7CiAgICAgICAgICAgIG93bmVyW3RoaXMuZXhwYW5kb10gPSB2YWx1ZTsKCiAgICAgICAgICAgIC8vIE90aGVyd2lzZSBzZWN1cmUgaXQgaW4gYSBub24tZW51bWVyYWJsZSBwcm9wZXJ0eQogICAgICAgICAgICAvLyBjb25maWd1cmFibGUgbXVzdCBiZSB0cnVlIHRvIGFsbG93IHRoZSBwcm9wZXJ0eSB0byBiZQogICAgICAgICAgICAvLyBkZWxldGVkIHdoZW4gZGF0YSBpcyByZW1vdmVkCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob3duZXIsIHRoaXMuZXhwYW5kbywgewogICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChvd25lciwgZGF0YSwgdmFsdWUpIHsKICAgICAgdmFyIHByb3AsCiAgICAgICAgY2FjaGUgPSB0aGlzLmNhY2hlKG93bmVyKTsKCiAgICAgIC8vIEhhbmRsZTogWyBvd25lciwga2V5LCB2YWx1ZSBdIGFyZ3MKICAgICAgLy8gQWx3YXlzIHVzZSBjYW1lbENhc2Uga2V5IChnaC0yMjU3KQogICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICJzdHJpbmciKSB7CiAgICAgICAgY2FjaGVbY2FtZWxDYXNlKGRhdGEpXSA9IHZhbHVlOwoKICAgICAgICAvLyBIYW5kbGU6IFsgb3duZXIsIHsgcHJvcGVydGllcyB9IF0gYXJncwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENvcHkgdGhlIHByb3BlcnRpZXMgb25lLWJ5LW9uZSB0byB0aGUgY2FjaGUgb2JqZWN0CiAgICAgICAgZm9yIChwcm9wIGluIGRhdGEpIHsKICAgICAgICAgIGNhY2hlW2NhbWVsQ2FzZShwcm9wKV0gPSBkYXRhW3Byb3BdOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gY2FjaGU7CiAgICB9LAogICAgZ2V0OiBmdW5jdGlvbiBnZXQob3duZXIsIGtleSkgewogICAgICByZXR1cm4ga2V5ID09PSB1bmRlZmluZWQgPyB0aGlzLmNhY2hlKG93bmVyKSA6CiAgICAgIC8vIEFsd2F5cyB1c2UgY2FtZWxDYXNlIGtleSAoZ2gtMjI1NykKICAgICAgb3duZXJbdGhpcy5leHBhbmRvXSAmJiBvd25lclt0aGlzLmV4cGFuZG9dW2NhbWVsQ2FzZShrZXkpXTsKICAgIH0sCiAgICBhY2Nlc3M6IGZ1bmN0aW9uIGFjY2Vzcyhvd25lciwga2V5LCB2YWx1ZSkgewogICAgICAvLyBJbiBjYXNlcyB3aGVyZSBlaXRoZXI6CiAgICAgIC8vCiAgICAgIC8vICAgMS4gTm8ga2V5IHdhcyBzcGVjaWZpZWQKICAgICAgLy8gICAyLiBBIHN0cmluZyBrZXkgd2FzIHNwZWNpZmllZCwgYnV0IG5vIHZhbHVlIHByb3ZpZGVkCiAgICAgIC8vCiAgICAgIC8vIFRha2UgdGhlICJyZWFkIiBwYXRoIGFuZCBhbGxvdyB0aGUgZ2V0IG1ldGhvZCB0byBkZXRlcm1pbmUKICAgICAgLy8gd2hpY2ggdmFsdWUgdG8gcmV0dXJuLCByZXNwZWN0aXZlbHkgZWl0aGVyOgogICAgICAvLwogICAgICAvLyAgIDEuIFRoZSBlbnRpcmUgY2FjaGUgb2JqZWN0CiAgICAgIC8vICAgMi4gVGhlIGRhdGEgc3RvcmVkIGF0IHRoZSBrZXkKICAgICAgLy8KICAgICAgaWYgKGtleSA9PT0gdW5kZWZpbmVkIHx8IGtleSAmJiB0eXBlb2Yga2V5ID09PSAic3RyaW5nIiAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KG93bmVyLCBrZXkpOwogICAgICB9CgogICAgICAvLyBXaGVuIHRoZSBrZXkgaXMgbm90IGEgc3RyaW5nLCBvciBib3RoIGEga2V5IGFuZCB2YWx1ZQogICAgICAvLyBhcmUgc3BlY2lmaWVkLCBzZXQgb3IgZXh0ZW5kIChleGlzdGluZyBvYmplY3RzKSB3aXRoIGVpdGhlcjoKICAgICAgLy8KICAgICAgLy8gICAxLiBBbiBvYmplY3Qgb2YgcHJvcGVydGllcwogICAgICAvLyAgIDIuIEEga2V5IGFuZCB2YWx1ZQogICAgICAvLwogICAgICB0aGlzLnNldChvd25lciwga2V5LCB2YWx1ZSk7CgogICAgICAvLyBTaW5jZSB0aGUgInNldCIgcGF0aCBjYW4gaGF2ZSB0d28gcG9zc2libGUgZW50cnkgcG9pbnRzCiAgICAgIC8vIHJldHVybiB0aGUgZXhwZWN0ZWQgZGF0YSBiYXNlZCBvbiB3aGljaCBwYXRoIHdhcyB0YWtlblsqXQogICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDoga2V5OwogICAgfSwKICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKG93bmVyLCBrZXkpIHsKICAgICAgdmFyIGksCiAgICAgICAgY2FjaGUgPSBvd25lclt0aGlzLmV4cGFuZG9dOwogICAgICBpZiAoY2FjaGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoa2V5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBTdXBwb3J0IGFycmF5IG9yIHNwYWNlIHNlcGFyYXRlZCBzdHJpbmcgb2Yga2V5cwogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGtleSkpIHsKICAgICAgICAgIC8vIElmIGtleSBpcyBhbiBhcnJheSBvZiBrZXlzLi4uCiAgICAgICAgICAvLyBXZSBhbHdheXMgc2V0IGNhbWVsQ2FzZSBrZXlzLCBzbyByZW1vdmUgdGhhdC4KICAgICAgICAgIGtleSA9IGtleS5tYXAoY2FtZWxDYXNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAga2V5ID0gY2FtZWxDYXNlKGtleSk7CgogICAgICAgICAgLy8gSWYgYSBrZXkgd2l0aCB0aGUgc3BhY2VzIGV4aXN0cywgdXNlIGl0LgogICAgICAgICAgLy8gT3RoZXJ3aXNlLCBjcmVhdGUgYW4gYXJyYXkgYnkgbWF0Y2hpbmcgbm9uLXdoaXRlc3BhY2UKICAgICAgICAgIGtleSA9IGtleSBpbiBjYWNoZSA/IFtrZXldIDoga2V5Lm1hdGNoKHJub3RodG1sd2hpdGUpIHx8IFtdOwogICAgICAgIH0KICAgICAgICBpID0ga2V5Lmxlbmd0aDsKICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICBkZWxldGUgY2FjaGVba2V5W2ldXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIFJlbW92ZSB0aGUgZXhwYW5kbyBpZiB0aGVyZSdzIG5vIG1vcmUgZGF0YQogICAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQgfHwgalF1ZXJ5LmlzRW1wdHlPYmplY3QoY2FjaGUpKSB7CiAgICAgICAgLy8gU3VwcG9ydDogQ2hyb21lIDw9MzUgLSA0NQogICAgICAgIC8vIFdlYmtpdCAmIEJsaW5rIHBlcmZvcm1hbmNlIHN1ZmZlcnMgd2hlbiBkZWxldGluZyBwcm9wZXJ0aWVzCiAgICAgICAgLy8gZnJvbSBET00gbm9kZXMsIHNvIHNldCB0byB1bmRlZmluZWQgaW5zdGVhZAogICAgICAgIC8vIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTM3ODYwNyAoYnVnIHJlc3RyaWN0ZWQpCiAgICAgICAgaWYgKG93bmVyLm5vZGVUeXBlKSB7CiAgICAgICAgICBvd25lclt0aGlzLmV4cGFuZG9dID0gdW5kZWZpbmVkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkZWxldGUgb3duZXJbdGhpcy5leHBhbmRvXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBoYXNEYXRhOiBmdW5jdGlvbiBoYXNEYXRhKG93bmVyKSB7CiAgICAgIHZhciBjYWNoZSA9IG93bmVyW3RoaXMuZXhwYW5kb107CiAgICAgIHJldHVybiBjYWNoZSAhPT0gdW5kZWZpbmVkICYmICFqUXVlcnkuaXNFbXB0eU9iamVjdChjYWNoZSk7CiAgICB9CiAgfTsKICB2YXIgZGF0YVByaXYgPSBuZXcgRGF0YSgpOwogIHZhciBkYXRhVXNlciA9IG5ldyBEYXRhKCk7CgogIC8vCUltcGxlbWVudGF0aW9uIFN1bW1hcnkKICAvLwogIC8vCTEuIEVuZm9yY2UgQVBJIHN1cmZhY2UgYW5kIHNlbWFudGljIGNvbXBhdGliaWxpdHkgd2l0aCAxLjkueCBicmFuY2gKICAvLwkyLiBJbXByb3ZlIHRoZSBtb2R1bGUncyBtYWludGFpbmFiaWxpdHkgYnkgcmVkdWNpbmcgdGhlIHN0b3JhZ2UKICAvLwkJcGF0aHMgdG8gYSBzaW5nbGUgbWVjaGFuaXNtLgogIC8vCTMuIFVzZSB0aGUgc2FtZSBzaW5nbGUgbWVjaGFuaXNtIHRvIHN1cHBvcnQgInByaXZhdGUiIGFuZCAidXNlciIgZGF0YS4KICAvLwk0LiBfTmV2ZXJfIGV4cG9zZSAicHJpdmF0ZSIgZGF0YSB0byB1c2VyIGNvZGUgKFRPRE86IERyb3AgX2RhdGEsIF9yZW1vdmVEYXRhKQogIC8vCTUuIEF2b2lkIGV4cG9zaW5nIGltcGxlbWVudGF0aW9uIGRldGFpbHMgb24gdXNlciBvYmplY3RzIChlZy4gZXhwYW5kbyBwcm9wZXJ0aWVzKQogIC8vCTYuIFByb3ZpZGUgYSBjbGVhciBwYXRoIGZvciBpbXBsZW1lbnRhdGlvbiB1cGdyYWRlIHRvIFdlYWtNYXAgaW4gMjAxNAoKICB2YXIgcmJyYWNlID0gL14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLywKICAgIHJtdWx0aURhc2ggPSAvW0EtWl0vZzsKICBmdW5jdGlvbiBnZXREYXRhKGRhdGEpIHsKICAgIGlmIChkYXRhID09PSAidHJ1ZSIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBpZiAoZGF0YSA9PT0gImZhbHNlIikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoZGF0YSA9PT0gIm51bGwiKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8vIE9ubHkgY29udmVydCB0byBhIG51bWJlciBpZiBpdCBkb2Vzbid0IGNoYW5nZSB0aGUgc3RyaW5nCiAgICBpZiAoZGF0YSA9PT0gK2RhdGEgKyAiIikgewogICAgICByZXR1cm4gK2RhdGE7CiAgICB9CiAgICBpZiAocmJyYWNlLnRlc3QoZGF0YSkpIHsKICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSk7CiAgICB9CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnVuY3Rpb24gZGF0YUF0dHIoZWxlbSwga2V5LCBkYXRhKSB7CiAgICB2YXIgbmFtZTsKCiAgICAvLyBJZiBub3RoaW5nIHdhcyBmb3VuZCBpbnRlcm5hbGx5LCB0cnkgdG8gZmV0Y2ggYW55CiAgICAvLyBkYXRhIGZyb20gdGhlIEhUTUw1IGRhdGEtKiBhdHRyaWJ1dGUKICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSkgewogICAgICBuYW1lID0gImRhdGEtIiArIGtleS5yZXBsYWNlKHJtdWx0aURhc2gsICItJCYiKS50b0xvd2VyQ2FzZSgpOwogICAgICBkYXRhID0gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSk7CiAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gInN0cmluZyIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgZGF0YSA9IGdldERhdGEoZGF0YSk7CiAgICAgICAgfSBjYXRjaCAoZSkge30KCiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIHNldCB0aGUgZGF0YSBzbyBpdCBpc24ndCBjaGFuZ2VkIGxhdGVyCiAgICAgICAgZGF0YVVzZXIuc2V0KGVsZW0sIGtleSwgZGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGRhdGE7CiAgfQogIGpRdWVyeS5leHRlbmQoewogICAgaGFzRGF0YTogZnVuY3Rpb24gaGFzRGF0YShlbGVtKSB7CiAgICAgIHJldHVybiBkYXRhVXNlci5oYXNEYXRhKGVsZW0pIHx8IGRhdGFQcml2Lmhhc0RhdGEoZWxlbSk7CiAgICB9LAogICAgZGF0YTogZnVuY3Rpb24gZGF0YShlbGVtLCBuYW1lLCBfZGF0YSkgewogICAgICByZXR1cm4gZGF0YVVzZXIuYWNjZXNzKGVsZW0sIG5hbWUsIF9kYXRhKTsKICAgIH0sCiAgICByZW1vdmVEYXRhOiBmdW5jdGlvbiByZW1vdmVEYXRhKGVsZW0sIG5hbWUpIHsKICAgICAgZGF0YVVzZXIucmVtb3ZlKGVsZW0sIG5hbWUpOwogICAgfSwKICAgIC8vIFRPRE86IE5vdyB0aGF0IGFsbCBjYWxscyB0byBfZGF0YSBhbmQgX3JlbW92ZURhdGEgaGF2ZSBiZWVuIHJlcGxhY2VkCiAgICAvLyB3aXRoIGRpcmVjdCBjYWxscyB0byBkYXRhUHJpdiBtZXRob2RzLCB0aGVzZSBjYW4gYmUgZGVwcmVjYXRlZC4KICAgIF9kYXRhOiBmdW5jdGlvbiBfZGF0YShlbGVtLCBuYW1lLCBkYXRhKSB7CiAgICAgIHJldHVybiBkYXRhUHJpdi5hY2Nlc3MoZWxlbSwgbmFtZSwgZGF0YSk7CiAgICB9LAogICAgX3JlbW92ZURhdGE6IGZ1bmN0aW9uIF9yZW1vdmVEYXRhKGVsZW0sIG5hbWUpIHsKICAgICAgZGF0YVByaXYucmVtb3ZlKGVsZW0sIG5hbWUpOwogICAgfQogIH0pOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgZGF0YTogZnVuY3Rpb24gZGF0YShrZXksIHZhbHVlKSB7CiAgICAgIHZhciBpLAogICAgICAgIG5hbWUsCiAgICAgICAgZGF0YSwKICAgICAgICBlbGVtID0gdGhpc1swXSwKICAgICAgICBhdHRycyA9IGVsZW0gJiYgZWxlbS5hdHRyaWJ1dGVzOwoKICAgICAgLy8gR2V0cyBhbGwgdmFsdWVzCiAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmICh0aGlzLmxlbmd0aCkgewogICAgICAgICAgZGF0YSA9IGRhdGFVc2VyLmdldChlbGVtKTsKICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxICYmICFkYXRhUHJpdi5nZXQoZWxlbSwgImhhc0RhdGFBdHRycyIpKSB7CiAgICAgICAgICAgIGkgPSBhdHRycy5sZW5ndGg7CiAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBJRSAxMSBvbmx5CiAgICAgICAgICAgICAgLy8gVGhlIGF0dHJzIGVsZW1lbnRzIGNhbiBiZSBudWxsICgjMTQ4OTQpCiAgICAgICAgICAgICAgaWYgKGF0dHJzW2ldKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gYXR0cnNbaV0ubmFtZTsKICAgICAgICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YoImRhdGEtIikgPT09IDApIHsKICAgICAgICAgICAgICAgICAgbmFtZSA9IGNhbWVsQ2FzZShuYW1lLnNsaWNlKDUpKTsKICAgICAgICAgICAgICAgICAgZGF0YUF0dHIoZWxlbSwgbmFtZSwgZGF0YVtuYW1lXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRhdGFQcml2LnNldChlbGVtLCAiaGFzRGF0YUF0dHJzIiwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBkYXRhOwogICAgICB9CgogICAgICAvLyBTZXRzIG11bHRpcGxlIHZhbHVlcwogICAgICBpZiAoX3R5cGVvZihrZXkpID09PSAib2JqZWN0IikgewogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgZGF0YVVzZXIuc2V0KHRoaXMsIGtleSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGFjY2Vzcyh0aGlzLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB2YXIgZGF0YTsKCiAgICAgICAgLy8gVGhlIGNhbGxpbmcgalF1ZXJ5IG9iamVjdCAoZWxlbWVudCBtYXRjaGVzKSBpcyBub3QgZW1wdHkKICAgICAgICAvLyAoYW5kIHRoZXJlZm9yZSBoYXMgYW4gZWxlbWVudCBhcHBlYXJzIGF0IHRoaXNbIDAgXSkgYW5kIHRoZQogICAgICAgIC8vIGB2YWx1ZWAgcGFyYW1ldGVyIHdhcyBub3QgdW5kZWZpbmVkLiBBbiBlbXB0eSBqUXVlcnkgb2JqZWN0CiAgICAgICAgLy8gd2lsbCByZXN1bHQgaW4gYHVuZGVmaW5lZGAgZm9yIGVsZW0gPSB0aGlzWyAwIF0gd2hpY2ggd2lsbAogICAgICAgIC8vIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhbiBhdHRlbXB0IHRvIHJlYWQgYSBkYXRhIGNhY2hlIGlzIG1hZGUuCiAgICAgICAgaWYgKGVsZW0gJiYgdmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gQXR0ZW1wdCB0byBnZXQgZGF0YSBmcm9tIHRoZSBjYWNoZQogICAgICAgICAgLy8gVGhlIGtleSB3aWxsIGFsd2F5cyBiZSBjYW1lbENhc2VkIGluIERhdGEKICAgICAgICAgIGRhdGEgPSBkYXRhVXNlci5nZXQoZWxlbSwga2V5KTsKICAgICAgICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQXR0ZW1wdCB0byAiZGlzY292ZXIiIHRoZSBkYXRhIGluCiAgICAgICAgICAvLyBIVE1MNSBjdXN0b20gZGF0YS0qIGF0dHJzCiAgICAgICAgICBkYXRhID0gZGF0YUF0dHIoZWxlbSwga2V5KTsKICAgICAgICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gV2UgdHJpZWQgcmVhbGx5IGhhcmQsIGJ1dCB0aGUgZGF0YSBkb2Vzbid0IGV4aXN0LgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gU2V0IHRoZSBkYXRhLi4uCiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIFdlIGFsd2F5cyBzdG9yZSB0aGUgY2FtZWxDYXNlZCBrZXkKICAgICAgICAgIGRhdGFVc2VyLnNldCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgICB9KTsKICAgICAgfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxLCBudWxsLCB0cnVlKTsKICAgIH0sCiAgICByZW1vdmVEYXRhOiBmdW5jdGlvbiByZW1vdmVEYXRhKGtleSkgewogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBkYXRhVXNlci5yZW1vdmUodGhpcywga2V5KTsKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgalF1ZXJ5LmV4dGVuZCh7CiAgICBxdWV1ZTogZnVuY3Rpb24gcXVldWUoZWxlbSwgdHlwZSwgZGF0YSkgewogICAgICB2YXIgcXVldWU7CiAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgdHlwZSA9ICh0eXBlIHx8ICJmeCIpICsgInF1ZXVlIjsKICAgICAgICBxdWV1ZSA9IGRhdGFQcml2LmdldChlbGVtLCB0eXBlKTsKCiAgICAgICAgLy8gU3BlZWQgdXAgZGVxdWV1ZSBieSBnZXR0aW5nIG91dCBxdWlja2x5IGlmIHRoaXMgaXMganVzdCBhIGxvb2t1cAogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICBpZiAoIXF1ZXVlIHx8IEFycmF5LmlzQXJyYXkoZGF0YSkpIHsKICAgICAgICAgICAgcXVldWUgPSBkYXRhUHJpdi5hY2Nlc3MoZWxlbSwgdHlwZSwgalF1ZXJ5Lm1ha2VBcnJheShkYXRhKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBxdWV1ZS5wdXNoKGRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gcXVldWUgfHwgW107CiAgICAgIH0KICAgIH0sCiAgICBkZXF1ZXVlOiBmdW5jdGlvbiBkZXF1ZXVlKGVsZW0sIHR5cGUpIHsKICAgICAgdHlwZSA9IHR5cGUgfHwgImZ4IjsKICAgICAgdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKGVsZW0sIHR5cGUpLAogICAgICAgIHN0YXJ0TGVuZ3RoID0gcXVldWUubGVuZ3RoLAogICAgICAgIGZuID0gcXVldWUuc2hpZnQoKSwKICAgICAgICBob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyhlbGVtLCB0eXBlKSwKICAgICAgICBuZXh0ID0gZnVuY3Rpb24gbmV4dCgpIHsKICAgICAgICAgIGpRdWVyeS5kZXF1ZXVlKGVsZW0sIHR5cGUpOwogICAgICAgIH07CgogICAgICAvLyBJZiB0aGUgZnggcXVldWUgaXMgZGVxdWV1ZWQsIGFsd2F5cyByZW1vdmUgdGhlIHByb2dyZXNzIHNlbnRpbmVsCiAgICAgIGlmIChmbiA9PT0gImlucHJvZ3Jlc3MiKSB7CiAgICAgICAgZm4gPSBxdWV1ZS5zaGlmdCgpOwogICAgICAgIHN0YXJ0TGVuZ3RoLS07CiAgICAgIH0KICAgICAgaWYgKGZuKSB7CiAgICAgICAgLy8gQWRkIGEgcHJvZ3Jlc3Mgc2VudGluZWwgdG8gcHJldmVudCB0aGUgZnggcXVldWUgZnJvbSBiZWluZwogICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWQKICAgICAgICBpZiAodHlwZSA9PT0gImZ4IikgewogICAgICAgICAgcXVldWUudW5zaGlmdCgiaW5wcm9ncmVzcyIpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2xlYXIgdXAgdGhlIGxhc3QgcXVldWUgc3RvcCBmdW5jdGlvbgogICAgICAgIGRlbGV0ZSBob29rcy5zdG9wOwogICAgICAgIGZuLmNhbGwoZWxlbSwgbmV4dCwgaG9va3MpOwogICAgICB9CiAgICAgIGlmICghc3RhcnRMZW5ndGggJiYgaG9va3MpIHsKICAgICAgICBob29rcy5lbXB0eS5maXJlKCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBOb3QgcHVibGljIC0gZ2VuZXJhdGUgYSBxdWV1ZUhvb2tzIG9iamVjdCwgb3IgcmV0dXJuIHRoZSBjdXJyZW50IG9uZQogICAgX3F1ZXVlSG9va3M6IGZ1bmN0aW9uIF9xdWV1ZUhvb2tzKGVsZW0sIHR5cGUpIHsKICAgICAgdmFyIGtleSA9IHR5cGUgKyAicXVldWVIb29rcyI7CiAgICAgIHJldHVybiBkYXRhUHJpdi5nZXQoZWxlbSwga2V5KSB8fCBkYXRhUHJpdi5hY2Nlc3MoZWxlbSwga2V5LCB7CiAgICAgICAgZW1wdHk6IGpRdWVyeS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IikuYWRkKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGRhdGFQcml2LnJlbW92ZShlbGVtLCBbdHlwZSArICJxdWV1ZSIsIGtleV0pOwogICAgICAgIH0pCiAgICAgIH0pOwogICAgfQogIH0pOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgcXVldWU6IGZ1bmN0aW9uIHF1ZXVlKHR5cGUsIGRhdGEpIHsKICAgICAgdmFyIHNldHRlciA9IDI7CiAgICAgIGlmICh0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIpIHsKICAgICAgICBkYXRhID0gdHlwZTsKICAgICAgICB0eXBlID0gImZ4IjsKICAgICAgICBzZXR0ZXItLTsKICAgICAgfQogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IHNldHRlcikgewogICAgICAgIHJldHVybiBqUXVlcnkucXVldWUodGhpc1swXSwgdHlwZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/IHRoaXMgOiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSh0aGlzLCB0eXBlLCBkYXRhKTsKCiAgICAgICAgLy8gRW5zdXJlIGEgaG9va3MgZm9yIHRoaXMgcXVldWUKICAgICAgICBqUXVlcnkuX3F1ZXVlSG9va3ModGhpcywgdHlwZSk7CiAgICAgICAgaWYgKHR5cGUgPT09ICJmeCIgJiYgcXVldWVbMF0gIT09ICJpbnByb2dyZXNzIikgewogICAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZXF1ZXVlOiBmdW5jdGlvbiBkZXF1ZXVlKHR5cGUpIHsKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7CiAgICAgIH0pOwogICAgfSwKICAgIGNsZWFyUXVldWU6IGZ1bmN0aW9uIGNsZWFyUXVldWUodHlwZSkgewogICAgICByZXR1cm4gdGhpcy5xdWV1ZSh0eXBlIHx8ICJmeCIsIFtdKTsKICAgIH0sCiAgICAvLyBHZXQgYSBwcm9taXNlIHJlc29sdmVkIHdoZW4gcXVldWVzIG9mIGEgY2VydGFpbiB0eXBlCiAgICAvLyBhcmUgZW1wdGllZCAoZnggaXMgdGhlIHR5cGUgYnkgZGVmYXVsdCkKICAgIHByb21pc2U6IGZ1bmN0aW9uIHByb21pc2UodHlwZSwgb2JqKSB7CiAgICAgIHZhciB0bXAsCiAgICAgICAgY291bnQgPSAxLAogICAgICAgIGRlZmVyID0galF1ZXJ5LkRlZmVycmVkKCksCiAgICAgICAgZWxlbWVudHMgPSB0aGlzLAogICAgICAgIGkgPSB0aGlzLmxlbmd0aCwKICAgICAgICByZXNvbHZlID0gZnVuY3Rpb24gcmVzb2x2ZSgpIHsKICAgICAgICAgIGlmICghIC0tY291bnQpIHsKICAgICAgICAgICAgZGVmZXIucmVzb2x2ZVdpdGgoZWxlbWVudHMsIFtlbGVtZW50c10pOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIGlmICh0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIpIHsKICAgICAgICBvYmogPSB0eXBlOwogICAgICAgIHR5cGUgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgdHlwZSA9IHR5cGUgfHwgImZ4IjsKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIHRtcCA9IGRhdGFQcml2LmdldChlbGVtZW50c1tpXSwgdHlwZSArICJxdWV1ZUhvb2tzIik7CiAgICAgICAgaWYgKHRtcCAmJiB0bXAuZW1wdHkpIHsKICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgICB0bXAuZW1wdHkuYWRkKHJlc29sdmUpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXNvbHZlKCk7CiAgICAgIHJldHVybiBkZWZlci5wcm9taXNlKG9iaik7CiAgICB9CiAgfSk7CiAgdmFyIHBudW0gPSAvWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvLnNvdXJjZTsKICB2YXIgcmNzc051bSA9IG5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIiArIHBudW0gKyAiKShbYS16JV0qKSQiLCAiaSIpOwogIHZhciBjc3NFeHBhbmQgPSBbIlRvcCIsICJSaWdodCIsICJCb3R0b20iLCAiTGVmdCJdOwogIHZhciBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CiAgdmFyIGlzQXR0YWNoZWQgPSBmdW5jdGlvbiBpc0F0dGFjaGVkKGVsZW0pIHsKICAgICAgcmV0dXJuIGpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0pOwogICAgfSwKICAgIGNvbXBvc2VkID0gewogICAgICBjb21wb3NlZDogdHJ1ZQogICAgfTsKCiAgLy8gU3VwcG9ydDogSUUgOSAtIDExKywgRWRnZSAxMiAtIDE4KywgaU9TIDEwLjAgLSAxMC4yIG9ubHkKICAvLyBDaGVjayBhdHRhY2htZW50IGFjcm9zcyBzaGFkb3cgRE9NIGJvdW5kYXJpZXMgd2hlbiBwb3NzaWJsZSAoZ2gtMzUwNCkKICAvLyBTdXBwb3J0OiBpT1MgMTAuMC0xMC4yIG9ubHkKICAvLyBFYXJseSBpT1MgMTAgdmVyc2lvbnMgc3VwcG9ydCBgYXR0YWNoU2hhZG93YCBidXQgbm90IGBnZXRSb290Tm9kZWAsCiAgLy8gbGVhZGluZyB0byBlcnJvcnMuIFdlIG5lZWQgdG8gY2hlY2sgZm9yIGBnZXRSb290Tm9kZWAuCiAgaWYgKGRvY3VtZW50RWxlbWVudC5nZXRSb290Tm9kZSkgewogICAgaXNBdHRhY2hlZCA9IGZ1bmN0aW9uIGlzQXR0YWNoZWQoZWxlbSkgewogICAgICByZXR1cm4galF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSkgfHwgZWxlbS5nZXRSb290Tm9kZShjb21wb3NlZCkgPT09IGVsZW0ub3duZXJEb2N1bWVudDsKICAgIH07CiAgfQogIHZhciBpc0hpZGRlbldpdGhpblRyZWUgPSBmdW5jdGlvbiBpc0hpZGRlbldpdGhpblRyZWUoZWxlbSwgZWwpIHsKICAgIC8vIGlzSGlkZGVuV2l0aGluVHJlZSBtaWdodCBiZSBjYWxsZWQgZnJvbSBqUXVlcnkjZmlsdGVyIGZ1bmN0aW9uOwogICAgLy8gaW4gdGhhdCBjYXNlLCBlbGVtZW50IHdpbGwgYmUgc2Vjb25kIGFyZ3VtZW50CiAgICBlbGVtID0gZWwgfHwgZWxlbTsKCiAgICAvLyBJbmxpbmUgc3R5bGUgdHJ1bXBzIGFsbAogICAgcmV0dXJuIGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gIm5vbmUiIHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gIiIgJiYKICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgY29tcHV0ZWQgc3R5bGUKICAgIC8vIFN1cHBvcnQ6IEZpcmVmb3ggPD00MyAtIDQ1CiAgICAvLyBEaXNjb25uZWN0ZWQgZWxlbWVudHMgY2FuIGhhdmUgY29tcHV0ZWQgZGlzcGxheTogbm9uZSwgc28gZmlyc3QgY29uZmlybSB0aGF0IGVsZW0gaXMKICAgIC8vIGluIHRoZSBkb2N1bWVudC4KICAgIGlzQXR0YWNoZWQoZWxlbSkgJiYgalF1ZXJ5LmNzcyhlbGVtLCAiZGlzcGxheSIpID09PSAibm9uZSI7CiAgfTsKICBmdW5jdGlvbiBhZGp1c3RDU1MoZWxlbSwgcHJvcCwgdmFsdWVQYXJ0cywgdHdlZW4pIHsKICAgIHZhciBhZGp1c3RlZCwKICAgICAgc2NhbGUsCiAgICAgIG1heEl0ZXJhdGlvbnMgPSAyMCwKICAgICAgY3VycmVudFZhbHVlID0gdHdlZW4gPyBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHR3ZWVuLmN1cigpOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBqUXVlcnkuY3NzKGVsZW0sIHByb3AsICIiKTsKICAgICAgfSwKICAgICAgaW5pdGlhbCA9IGN1cnJlbnRWYWx1ZSgpLAogICAgICB1bml0ID0gdmFsdWVQYXJ0cyAmJiB2YWx1ZVBhcnRzWzNdIHx8IChqUXVlcnkuY3NzTnVtYmVyW3Byb3BdID8gIiIgOiAicHgiKSwKICAgICAgLy8gU3RhcnRpbmcgdmFsdWUgY29tcHV0YXRpb24gaXMgcmVxdWlyZWQgZm9yIHBvdGVudGlhbCB1bml0IG1pc21hdGNoZXMKICAgICAgaW5pdGlhbEluVW5pdCA9IGVsZW0ubm9kZVR5cGUgJiYgKGpRdWVyeS5jc3NOdW1iZXJbcHJvcF0gfHwgdW5pdCAhPT0gInB4IiAmJiAraW5pdGlhbCkgJiYgcmNzc051bS5leGVjKGpRdWVyeS5jc3MoZWxlbSwgcHJvcCkpOwogICAgaWYgKGluaXRpYWxJblVuaXQgJiYgaW5pdGlhbEluVW5pdFszXSAhPT0gdW5pdCkgewogICAgICAvLyBTdXBwb3J0OiBGaXJlZm94IDw9NTQKICAgICAgLy8gSGFsdmUgdGhlIGl0ZXJhdGlvbiB0YXJnZXQgdmFsdWUgdG8gcHJldmVudCBpbnRlcmZlcmVuY2UgZnJvbSBDU1MgdXBwZXIgYm91bmRzIChnaC0yMTQ0KQogICAgICBpbml0aWFsID0gaW5pdGlhbCAvIDI7CgogICAgICAvLyBUcnVzdCB1bml0cyByZXBvcnRlZCBieSBqUXVlcnkuY3NzCiAgICAgIHVuaXQgPSB1bml0IHx8IGluaXRpYWxJblVuaXRbM107CgogICAgICAvLyBJdGVyYXRpdmVseSBhcHByb3hpbWF0ZSBmcm9tIGEgbm9uemVybyBzdGFydGluZyBwb2ludAogICAgICBpbml0aWFsSW5Vbml0ID0gK2luaXRpYWwgfHwgMTsKICAgICAgd2hpbGUgKG1heEl0ZXJhdGlvbnMtLSkgewogICAgICAgIC8vIEV2YWx1YXRlIGFuZCB1cGRhdGUgb3VyIGJlc3QgZ3Vlc3MgKGRvdWJsaW5nIGd1ZXNzZXMgdGhhdCB6ZXJvIG91dCkuCiAgICAgICAgLy8gRmluaXNoIGlmIHRoZSBzY2FsZSBlcXVhbHMgb3IgY3Jvc3NlcyAxIChtYWtpbmcgdGhlIG9sZCpuZXcgcHJvZHVjdCBub24tcG9zaXRpdmUpLgogICAgICAgIGpRdWVyeS5zdHlsZShlbGVtLCBwcm9wLCBpbml0aWFsSW5Vbml0ICsgdW5pdCk7CiAgICAgICAgaWYgKCgxIC0gc2NhbGUpICogKDEgLSAoc2NhbGUgPSBjdXJyZW50VmFsdWUoKSAvIGluaXRpYWwgfHwgMC41KSkgPD0gMCkgewogICAgICAgICAgbWF4SXRlcmF0aW9ucyA9IDA7CiAgICAgICAgfQogICAgICAgIGluaXRpYWxJblVuaXQgPSBpbml0aWFsSW5Vbml0IC8gc2NhbGU7CiAgICAgIH0KICAgICAgaW5pdGlhbEluVW5pdCA9IGluaXRpYWxJblVuaXQgKiAyOwogICAgICBqUXVlcnkuc3R5bGUoZWxlbSwgcHJvcCwgaW5pdGlhbEluVW5pdCArIHVuaXQpOwoKICAgICAgLy8gTWFrZSBzdXJlIHdlIHVwZGF0ZSB0aGUgdHdlZW4gcHJvcGVydGllcyBsYXRlciBvbgogICAgICB2YWx1ZVBhcnRzID0gdmFsdWVQYXJ0cyB8fCBbXTsKICAgIH0KICAgIGlmICh2YWx1ZVBhcnRzKSB7CiAgICAgIGluaXRpYWxJblVuaXQgPSAraW5pdGlhbEluVW5pdCB8fCAraW5pdGlhbCB8fCAwOwoKICAgICAgLy8gQXBwbHkgcmVsYXRpdmUgb2Zmc2V0ICgrPS8tPSkgaWYgc3BlY2lmaWVkCiAgICAgIGFkanVzdGVkID0gdmFsdWVQYXJ0c1sxXSA/IGluaXRpYWxJblVuaXQgKyAodmFsdWVQYXJ0c1sxXSArIDEpICogdmFsdWVQYXJ0c1syXSA6ICt2YWx1ZVBhcnRzWzJdOwogICAgICBpZiAodHdlZW4pIHsKICAgICAgICB0d2Vlbi51bml0ID0gdW5pdDsKICAgICAgICB0d2Vlbi5zdGFydCA9IGluaXRpYWxJblVuaXQ7CiAgICAgICAgdHdlZW4uZW5kID0gYWRqdXN0ZWQ7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBhZGp1c3RlZDsKICB9CiAgdmFyIGRlZmF1bHREaXNwbGF5TWFwID0ge307CiAgZnVuY3Rpb24gZ2V0RGVmYXVsdERpc3BsYXkoZWxlbSkgewogICAgdmFyIHRlbXAsCiAgICAgIGRvYyA9IGVsZW0ub3duZXJEb2N1bWVudCwKICAgICAgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLAogICAgICBkaXNwbGF5ID0gZGVmYXVsdERpc3BsYXlNYXBbbm9kZU5hbWVdOwogICAgaWYgKGRpc3BsYXkpIHsKICAgICAgcmV0dXJuIGRpc3BsYXk7CiAgICB9CiAgICB0ZW1wID0gZG9jLmJvZHkuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpKTsKICAgIGRpc3BsYXkgPSBqUXVlcnkuY3NzKHRlbXAsICJkaXNwbGF5Iik7CiAgICB0ZW1wLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGVtcCk7CiAgICBpZiAoZGlzcGxheSA9PT0gIm5vbmUiKSB7CiAgICAgIGRpc3BsYXkgPSAiYmxvY2siOwogICAgfQogICAgZGVmYXVsdERpc3BsYXlNYXBbbm9kZU5hbWVdID0gZGlzcGxheTsKICAgIHJldHVybiBkaXNwbGF5OwogIH0KICBmdW5jdGlvbiBzaG93SGlkZShlbGVtZW50cywgc2hvdykgewogICAgdmFyIGRpc3BsYXksCiAgICAgIGVsZW0sCiAgICAgIHZhbHVlcyA9IFtdLAogICAgICBpbmRleCA9IDAsCiAgICAgIGxlbmd0aCA9IGVsZW1lbnRzLmxlbmd0aDsKCiAgICAvLyBEZXRlcm1pbmUgbmV3IGRpc3BsYXkgdmFsdWUgZm9yIGVsZW1lbnRzIHRoYXQgbmVlZCB0byBjaGFuZ2UKICAgIGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICBlbGVtID0gZWxlbWVudHNbaW5kZXhdOwogICAgICBpZiAoIWVsZW0uc3R5bGUpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBkaXNwbGF5ID0gZWxlbS5zdHlsZS5kaXNwbGF5OwogICAgICBpZiAoc2hvdykgewogICAgICAgIC8vIFNpbmNlIHdlIGZvcmNlIHZpc2liaWxpdHkgdXBvbiBjYXNjYWRlLWhpZGRlbiBlbGVtZW50cywgYW4gaW1tZWRpYXRlIChhbmQgc2xvdykKICAgICAgICAvLyBjaGVjayBpcyByZXF1aXJlZCBpbiB0aGlzIGZpcnN0IGxvb3AgdW5sZXNzIHdlIGhhdmUgYSBub25lbXB0eSBkaXNwbGF5IHZhbHVlIChlaXRoZXIKICAgICAgICAvLyBpbmxpbmUgb3IgYWJvdXQtdG8tYmUtcmVzdG9yZWQpCiAgICAgICAgaWYgKGRpc3BsYXkgPT09ICJub25lIikgewogICAgICAgICAgdmFsdWVzW2luZGV4XSA9IGRhdGFQcml2LmdldChlbGVtLCAiZGlzcGxheSIpIHx8IG51bGw7CiAgICAgICAgICBpZiAoIXZhbHVlc1tpbmRleF0pIHsKICAgICAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gIiI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChlbGVtLnN0eWxlLmRpc3BsYXkgPT09ICIiICYmIGlzSGlkZGVuV2l0aGluVHJlZShlbGVtKSkgewogICAgICAgICAgdmFsdWVzW2luZGV4XSA9IGdldERlZmF1bHREaXNwbGF5KGVsZW0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoZGlzcGxheSAhPT0gIm5vbmUiKSB7CiAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gIm5vbmUiOwoKICAgICAgICAgIC8vIFJlbWVtYmVyIHdoYXQgd2UncmUgb3ZlcndyaXRpbmcKICAgICAgICAgIGRhdGFQcml2LnNldChlbGVtLCAiZGlzcGxheSIsIGRpc3BsYXkpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIFNldCB0aGUgZGlzcGxheSBvZiB0aGUgZWxlbWVudHMgaW4gYSBzZWNvbmQgbG9vcCB0byBhdm9pZCBjb25zdGFudCByZWZsb3cKICAgIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICBpZiAodmFsdWVzW2luZGV4XSAhPSBudWxsKSB7CiAgICAgICAgZWxlbWVudHNbaW5kZXhdLnN0eWxlLmRpc3BsYXkgPSB2YWx1ZXNbaW5kZXhdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZWxlbWVudHM7CiAgfQogIGpRdWVyeS5mbi5leHRlbmQoewogICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHsKICAgICAgcmV0dXJuIHNob3dIaWRlKHRoaXMsIHRydWUpOwogICAgfSwKICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoKSB7CiAgICAgIHJldHVybiBzaG93SGlkZSh0aGlzKTsKICAgIH0sCiAgICB0b2dnbGU6IGZ1bmN0aW9uIHRvZ2dsZShzdGF0ZSkgewogICAgICBpZiAodHlwZW9mIHN0YXRlID09PSAiYm9vbGVhbiIpIHsKICAgICAgICByZXR1cm4gc3RhdGUgPyB0aGlzLnNob3coKSA6IHRoaXMuaGlkZSgpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChpc0hpZGRlbldpdGhpblRyZWUodGhpcykpIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS5zaG93KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS5oaWRlKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9KTsKICB2YXIgcmNoZWNrYWJsZVR5cGUgPSAvXig/OmNoZWNrYm94fHJhZGlvKSQvaTsKICB2YXIgcnRhZ05hbWUgPSAvPChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKikvaTsKICB2YXIgcnNjcmlwdFR5cGUgPSAvXiR8Xm1vZHVsZSR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2k7CiAgKGZ1bmN0aW9uICgpIHsKICAgIHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwKICAgICAgZGl2ID0gZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLAogICAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CgogICAgLy8gU3VwcG9ydDogQW5kcm9pZCA0LjAgLSA0LjMgb25seQogICAgLy8gQ2hlY2sgc3RhdGUgbG9zdCBpZiB0aGUgbmFtZSBpcyBzZXQgKCMxMTIxNykKICAgIC8vIFN1cHBvcnQ6IFdpbmRvd3MgV2ViIEFwcHMgKFdXQSkKICAgIC8vIGBuYW1lYCBhbmQgYHR5cGVgIG11c3QgdXNlIC5zZXRBdHRyaWJ1dGUgZm9yIFdXQSAoIzE0OTAxKQogICAgaW5wdXQuc2V0QXR0cmlidXRlKCJ0eXBlIiwgInJhZGlvIik7CiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCAiY2hlY2tlZCIpOwogICAgaW5wdXQuc2V0QXR0cmlidXRlKCJuYW1lIiwgInQiKTsKICAgIGRpdi5hcHBlbmRDaGlsZChpbnB1dCk7CgogICAgLy8gU3VwcG9ydDogQW5kcm9pZCA8PTQuMSBvbmx5CiAgICAvLyBPbGRlciBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHMKICAgIHN1cHBvcnQuY2hlY2tDbG9uZSA9IGRpdi5jbG9uZU5vZGUodHJ1ZSkuY2xvbmVOb2RlKHRydWUpLmxhc3RDaGlsZC5jaGVja2VkOwoKICAgIC8vIFN1cHBvcnQ6IElFIDw9MTEgb25seQogICAgLy8gTWFrZSBzdXJlIHRleHRhcmVhIChhbmQgY2hlY2tib3gpIGRlZmF1bHRWYWx1ZSBpcyBwcm9wZXJseSBjbG9uZWQKICAgIGRpdi5pbm5lckhUTUwgPSAiPHRleHRhcmVhPng8L3RleHRhcmVhPiI7CiAgICBzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkID0gISFkaXYuY2xvbmVOb2RlKHRydWUpLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWU7CgogICAgLy8gU3VwcG9ydDogSUUgPD05IG9ubHkKICAgIC8vIElFIDw9OSByZXBsYWNlcyA8b3B0aW9uPiB0YWdzIHdpdGggdGhlaXIgY29udGVudHMgd2hlbiBpbnNlcnRlZCBvdXRzaWRlIG9mCiAgICAvLyB0aGUgc2VsZWN0IGVsZW1lbnQuCiAgICBkaXYuaW5uZXJIVE1MID0gIjxvcHRpb24+PC9vcHRpb24+IjsKICAgIHN1cHBvcnQub3B0aW9uID0gISFkaXYubGFzdENoaWxkOwogIH0pKCk7CgogIC8vIFdlIGhhdmUgdG8gY2xvc2UgdGhlc2UgdGFncyB0byBzdXBwb3J0IFhIVE1MICgjMTMyMDApCiAgdmFyIHdyYXBNYXAgPSB7CiAgICAvLyBYSFRNTCBwYXJzZXJzIGRvIG5vdCBtYWdpY2FsbHkgaW5zZXJ0IGVsZW1lbnRzIGluIHRoZQogICAgLy8gc2FtZSB3YXkgdGhhdCB0YWcgc291cCBwYXJzZXJzIGRvLiBTbyB3ZSBjYW5ub3Qgc2hvcnRlbgogICAgLy8gdGhpcyBieSBvbWl0dGluZyA8dGJvZHk+IG9yIG90aGVyIHJlcXVpcmVkIGVsZW1lbnRzLgogICAgdGhlYWQ6IFsxLCAiPHRhYmxlPiIsICI8L3RhYmxlPiJdLAogICAgY29sOiBbMiwgIjx0YWJsZT48Y29sZ3JvdXA+IiwgIjwvY29sZ3JvdXA+PC90YWJsZT4iXSwKICAgIHRyOiBbMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+PC90YWJsZT4iXSwKICAgIHRkOiBbMywgIjx0YWJsZT48dGJvZHk+PHRyPiIsICI8L3RyPjwvdGJvZHk+PC90YWJsZT4iXSwKICAgIF9kZWZhdWx0OiBbMCwgIiIsICIiXQogIH07CiAgd3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDsKICB3cmFwTWFwLnRoID0gd3JhcE1hcC50ZDsKCiAgLy8gU3VwcG9ydDogSUUgPD05IG9ubHkKICBpZiAoIXN1cHBvcnQub3B0aW9uKSB7CiAgICB3cmFwTWFwLm9wdGdyb3VwID0gd3JhcE1hcC5vcHRpb24gPSBbMSwgIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCAiPC9zZWxlY3Q+Il07CiAgfQogIGZ1bmN0aW9uIGdldEFsbChjb250ZXh0LCB0YWcpIHsKICAgIC8vIFN1cHBvcnQ6IElFIDw9OSAtIDExIG9ubHkKICAgIC8vIFVzZSB0eXBlb2YgdG8gYXZvaWQgemVyby1hcmd1bWVudCBtZXRob2QgaW52b2NhdGlvbiBvbiBob3N0IG9iamVjdHMgKCMxNTE1MSkKICAgIHZhciByZXQ7CiAgICBpZiAodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHJldCA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnIHx8ICIqIik7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHJldCA9IGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCh0YWcgfHwgIioiKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldCA9IFtdOwogICAgfQogICAgaWYgKHRhZyA9PT0gdW5kZWZpbmVkIHx8IHRhZyAmJiBub2RlTmFtZShjb250ZXh0LCB0YWcpKSB7CiAgICAgIHJldHVybiBqUXVlcnkubWVyZ2UoW2NvbnRleHRdLCByZXQpOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9CgogIC8vIE1hcmsgc2NyaXB0cyBhcyBoYXZpbmcgYWxyZWFkeSBiZWVuIGV2YWx1YXRlZAogIGZ1bmN0aW9uIHNldEdsb2JhbEV2YWwoZWxlbXMsIHJlZkVsZW1lbnRzKSB7CiAgICB2YXIgaSA9IDAsCiAgICAgIGwgPSBlbGVtcy5sZW5ndGg7CiAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICBkYXRhUHJpdi5zZXQoZWxlbXNbaV0sICJnbG9iYWxFdmFsIiwgIXJlZkVsZW1lbnRzIHx8IGRhdGFQcml2LmdldChyZWZFbGVtZW50c1tpXSwgImdsb2JhbEV2YWwiKSk7CiAgICB9CiAgfQogIHZhciByaHRtbCA9IC88fCYjP1x3KzsvOwogIGZ1bmN0aW9uIGJ1aWxkRnJhZ21lbnQoZWxlbXMsIGNvbnRleHQsIHNjcmlwdHMsIHNlbGVjdGlvbiwgaWdub3JlZCkgewogICAgdmFyIGVsZW0sCiAgICAgIHRtcCwKICAgICAgdGFnLAogICAgICB3cmFwLAogICAgICBhdHRhY2hlZCwKICAgICAgaiwKICAgICAgZnJhZ21lbnQgPSBjb250ZXh0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwKICAgICAgbm9kZXMgPSBbXSwKICAgICAgaSA9IDAsCiAgICAgIGwgPSBlbGVtcy5sZW5ndGg7CiAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICBlbGVtID0gZWxlbXNbaV07CiAgICAgIGlmIChlbGVtIHx8IGVsZW0gPT09IDApIHsKICAgICAgICAvLyBBZGQgbm9kZXMgZGlyZWN0bHkKICAgICAgICBpZiAodG9UeXBlKGVsZW0pID09PSAib2JqZWN0IikgewogICAgICAgICAgLy8gU3VwcG9ydDogQW5kcm9pZCA8PTQuMCBvbmx5LCBQaGFudG9tSlMgMSBvbmx5CiAgICAgICAgICAvLyBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzIG9uIGFuY2llbnQgV2ViS2l0CiAgICAgICAgICBqUXVlcnkubWVyZ2Uobm9kZXMsIGVsZW0ubm9kZVR5cGUgPyBbZWxlbV0gOiBlbGVtKTsKCiAgICAgICAgICAvLyBDb252ZXJ0IG5vbi1odG1sIGludG8gYSB0ZXh0IG5vZGUKICAgICAgICB9IGVsc2UgaWYgKCFyaHRtbC50ZXN0KGVsZW0pKSB7CiAgICAgICAgICBub2Rlcy5wdXNoKGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoZWxlbSkpOwoKICAgICAgICAgIC8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2RlcwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0bXAgPSB0bXAgfHwgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoY29udGV4dC5jcmVhdGVFbGVtZW50KCJkaXYiKSk7CgogICAgICAgICAgLy8gRGVzZXJpYWxpemUgYSBzdGFuZGFyZCByZXByZXNlbnRhdGlvbgogICAgICAgICAgdGFnID0gKHJ0YWdOYW1lLmV4ZWMoZWxlbSkgfHwgWyIiLCAiIl0pWzFdLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICB3cmFwID0gd3JhcE1hcFt0YWddIHx8IHdyYXBNYXAuX2RlZmF1bHQ7CiAgICAgICAgICB0bXAuaW5uZXJIVE1MID0gd3JhcFsxXSArIGpRdWVyeS5odG1sUHJlZmlsdGVyKGVsZW0pICsgd3JhcFsyXTsKCiAgICAgICAgICAvLyBEZXNjZW5kIHRocm91Z2ggd3JhcHBlcnMgdG8gdGhlIHJpZ2h0IGNvbnRlbnQKICAgICAgICAgIGogPSB3cmFwWzBdOwogICAgICAgICAgd2hpbGUgKGotLSkgewogICAgICAgICAgICB0bXAgPSB0bXAubGFzdENoaWxkOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFN1cHBvcnQ6IEFuZHJvaWQgPD00LjAgb25seSwgUGhhbnRvbUpTIDEgb25seQogICAgICAgICAgLy8gcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdAogICAgICAgICAgalF1ZXJ5Lm1lcmdlKG5vZGVzLCB0bXAuY2hpbGROb2Rlcyk7CgogICAgICAgICAgLy8gUmVtZW1iZXIgdGhlIHRvcC1sZXZlbCBjb250YWluZXIKICAgICAgICAgIHRtcCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7CgogICAgICAgICAgLy8gRW5zdXJlIHRoZSBjcmVhdGVkIG5vZGVzIGFyZSBvcnBoYW5lZCAoIzEyMzkyKQogICAgICAgICAgdG1wLnRleHRDb250ZW50ID0gIiI7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgLy8gUmVtb3ZlIHdyYXBwZXIgZnJvbSBmcmFnbWVudAogICAgZnJhZ21lbnQudGV4dENvbnRlbnQgPSAiIjsKICAgIGkgPSAwOwogICAgd2hpbGUgKGVsZW0gPSBub2Rlc1tpKytdKSB7CiAgICAgIC8vIFNraXAgZWxlbWVudHMgYWxyZWFkeSBpbiB0aGUgY29udGV4dCBjb2xsZWN0aW9uICh0cmFjLTQwODcpCiAgICAgIGlmIChzZWxlY3Rpb24gJiYgalF1ZXJ5LmluQXJyYXkoZWxlbSwgc2VsZWN0aW9uKSA+IC0xKSB7CiAgICAgICAgaWYgKGlnbm9yZWQpIHsKICAgICAgICAgIGlnbm9yZWQucHVzaChlbGVtKTsKICAgICAgICB9CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgYXR0YWNoZWQgPSBpc0F0dGFjaGVkKGVsZW0pOwoKICAgICAgLy8gQXBwZW5kIHRvIGZyYWdtZW50CiAgICAgIHRtcCA9IGdldEFsbChmcmFnbWVudC5hcHBlbmRDaGlsZChlbGVtKSwgInNjcmlwdCIpOwoKICAgICAgLy8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeQogICAgICBpZiAoYXR0YWNoZWQpIHsKICAgICAgICBzZXRHbG9iYWxFdmFsKHRtcCk7CiAgICAgIH0KCiAgICAgIC8vIENhcHR1cmUgZXhlY3V0YWJsZXMKICAgICAgaWYgKHNjcmlwdHMpIHsKICAgICAgICBqID0gMDsKICAgICAgICB3aGlsZSAoZWxlbSA9IHRtcFtqKytdKSB7CiAgICAgICAgICBpZiAocnNjcmlwdFR5cGUudGVzdChlbGVtLnR5cGUgfHwgIiIpKSB7CiAgICAgICAgICAgIHNjcmlwdHMucHVzaChlbGVtKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBmcmFnbWVudDsKICB9CiAgdmFyIHJrZXlFdmVudCA9IC9ea2V5LywKICAgIHJtb3VzZUV2ZW50ID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLAogICAgcnR5cGVuYW1lc3BhY2UgPSAvXihbXi5dKikoPzpcLiguKyl8KS87CiAgZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KICBmdW5jdGlvbiByZXR1cm5GYWxzZSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIC8vIFN1cHBvcnQ6IElFIDw9OSAtIDExKwogIC8vIGZvY3VzKCkgYW5kIGJsdXIoKSBhcmUgYXN5bmNocm9ub3VzLCBleGNlcHQgd2hlbiB0aGV5IGFyZSBuby1vcC4KICAvLyBTbyBleHBlY3QgZm9jdXMgdG8gYmUgc3luY2hyb25vdXMgd2hlbiB0aGUgZWxlbWVudCBpcyBhbHJlYWR5IGFjdGl2ZSwKICAvLyBhbmQgYmx1ciB0byBiZSBzeW5jaHJvbm91cyB3aGVuIHRoZSBlbGVtZW50IGlzIG5vdCBhbHJlYWR5IGFjdGl2ZS4KICAvLyAoZm9jdXMgYW5kIGJsdXIgYXJlIGFsd2F5cyBzeW5jaHJvbm91cyBpbiBvdGhlciBzdXBwb3J0ZWQgYnJvd3NlcnMsCiAgLy8gdGhpcyBqdXN0IGRlZmluZXMgd2hlbiB3ZSBjYW4gY291bnQgb24gaXQpLgogIGZ1bmN0aW9uIGV4cGVjdFN5bmMoZWxlbSwgdHlwZSkgewogICAgcmV0dXJuIGVsZW0gPT09IHNhZmVBY3RpdmVFbGVtZW50KCkgPT09ICh0eXBlID09PSAiZm9jdXMiKTsKICB9CgogIC8vIFN1cHBvcnQ6IElFIDw9OSBvbmx5CiAgLy8gQWNjZXNzaW5nIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgY2FuIHRocm93IHVuZXhwZWN0ZWRseQogIC8vIGh0dHBzOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMzM5MwogIGZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICB9IGNhdGNoIChlcnIpIHt9CiAgfQogIGZ1bmN0aW9uIF9vbihlbGVtLCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCBvbmUpIHsKICAgIHZhciBvcmlnRm4sIHR5cGU7CgogICAgLy8gVHlwZXMgY2FuIGJlIGEgbWFwIG9mIHR5cGVzL2hhbmRsZXJzCiAgICBpZiAoX3R5cGVvZih0eXBlcykgPT09ICJvYmplY3QiKSB7CiAgICAgIC8vICggdHlwZXMtT2JqZWN0LCBzZWxlY3RvciwgZGF0YSApCiAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciKSB7CiAgICAgICAgLy8gKCB0eXBlcy1PYmplY3QsIGRhdGEgKQogICAgICAgIGRhdGEgPSBkYXRhIHx8IHNlbGVjdG9yOwogICAgICAgIHNlbGVjdG9yID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIGZvciAodHlwZSBpbiB0eXBlcykgewogICAgICAgIF9vbihlbGVtLCB0eXBlLCBzZWxlY3RvciwgZGF0YSwgdHlwZXNbdHlwZV0sIG9uZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGVsZW07CiAgICB9CiAgICBpZiAoZGF0YSA9PSBudWxsICYmIGZuID09IG51bGwpIHsKICAgICAgLy8gKCB0eXBlcywgZm4gKQogICAgICBmbiA9IHNlbGVjdG9yOwogICAgICBkYXRhID0gc2VsZWN0b3IgPSB1bmRlZmluZWQ7CiAgICB9IGVsc2UgaWYgKGZuID09IG51bGwpIHsKICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIpIHsKICAgICAgICAvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKQogICAgICAgIGZuID0gZGF0YTsKICAgICAgICBkYXRhID0gdW5kZWZpbmVkOwogICAgICB9IGVsc2UgewogICAgICAgIC8vICggdHlwZXMsIGRhdGEsIGZuICkKICAgICAgICBmbiA9IGRhdGE7CiAgICAgICAgZGF0YSA9IHNlbGVjdG9yOwogICAgICAgIHNlbGVjdG9yID0gdW5kZWZpbmVkOwogICAgICB9CiAgICB9CiAgICBpZiAoZm4gPT09IGZhbHNlKSB7CiAgICAgIGZuID0gcmV0dXJuRmFsc2U7CiAgICB9IGVsc2UgaWYgKCFmbikgewogICAgICByZXR1cm4gZWxlbTsKICAgIH0KICAgIGlmIChvbmUgPT09IDEpIHsKICAgICAgb3JpZ0ZuID0gZm47CiAgICAgIGZuID0gZnVuY3Rpb24gZm4oZXZlbnQpIHsKICAgICAgICAvLyBDYW4gdXNlIGFuIGVtcHR5IHNldCwgc2luY2UgZXZlbnQgY29udGFpbnMgdGhlIGluZm8KICAgICAgICBqUXVlcnkoKS5vZmYoZXZlbnQpOwogICAgICAgIHJldHVybiBvcmlnRm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKCiAgICAgIC8vIFVzZSBzYW1lIGd1aWQgc28gY2FsbGVyIGNhbiByZW1vdmUgdXNpbmcgb3JpZ0ZuCiAgICAgIGZuLmd1aWQgPSBvcmlnRm4uZ3VpZCB8fCAob3JpZ0ZuLmd1aWQgPSBqUXVlcnkuZ3VpZCsrKTsKICAgIH0KICAgIHJldHVybiBlbGVtLmVhY2goZnVuY3Rpb24gKCkgewogICAgICBqUXVlcnkuZXZlbnQuYWRkKHRoaXMsIHR5cGVzLCBmbiwgZGF0YSwgc2VsZWN0b3IpOwogICAgfSk7CiAgfQoKICAvKgogICogSGVscGVyIGZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgZXZlbnRzIC0tIG5vdCBwYXJ0IG9mIHRoZSBwdWJsaWMgaW50ZXJmYWNlLgogICogUHJvcHMgdG8gRGVhbiBFZHdhcmRzJyBhZGRFdmVudCBsaWJyYXJ5IGZvciBtYW55IG9mIHRoZSBpZGVhcy4KICAqLwogIGpRdWVyeS5ldmVudCA9IHsKICAgIGdsb2JhbDoge30sCiAgICBhZGQ6IGZ1bmN0aW9uIGFkZChlbGVtLCB0eXBlcywgaGFuZGxlciwgZGF0YSwgc2VsZWN0b3IpIHsKICAgICAgdmFyIGhhbmRsZU9iakluLAogICAgICAgIGV2ZW50SGFuZGxlLAogICAgICAgIHRtcCwKICAgICAgICBldmVudHMsCiAgICAgICAgdCwKICAgICAgICBoYW5kbGVPYmosCiAgICAgICAgc3BlY2lhbCwKICAgICAgICBoYW5kbGVycywKICAgICAgICB0eXBlLAogICAgICAgIG5hbWVzcGFjZXMsCiAgICAgICAgb3JpZ1R5cGUsCiAgICAgICAgZWxlbURhdGEgPSBkYXRhUHJpdi5nZXQoZWxlbSk7CgogICAgICAvLyBPbmx5IGF0dGFjaCBldmVudHMgdG8gb2JqZWN0cyB0aGF0IGFjY2VwdCBkYXRhCiAgICAgIGlmICghYWNjZXB0RGF0YShlbGVtKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gQ2FsbGVyIGNhbiBwYXNzIGluIGFuIG9iamVjdCBvZiBjdXN0b20gZGF0YSBpbiBsaWV1IG9mIHRoZSBoYW5kbGVyCiAgICAgIGlmIChoYW5kbGVyLmhhbmRsZXIpIHsKICAgICAgICBoYW5kbGVPYmpJbiA9IGhhbmRsZXI7CiAgICAgICAgaGFuZGxlciA9IGhhbmRsZU9iakluLmhhbmRsZXI7CiAgICAgICAgc2VsZWN0b3IgPSBoYW5kbGVPYmpJbi5zZWxlY3RvcjsKICAgICAgfQoKICAgICAgLy8gRW5zdXJlIHRoYXQgaW52YWxpZCBzZWxlY3RvcnMgdGhyb3cgZXhjZXB0aW9ucyBhdCBhdHRhY2ggdGltZQogICAgICAvLyBFdmFsdWF0ZSBhZ2FpbnN0IGRvY3VtZW50RWxlbWVudCBpbiBjYXNlIGVsZW0gaXMgYSBub24tZWxlbWVudCBub2RlIChlLmcuLCBkb2N1bWVudCkKICAgICAgaWYgKHNlbGVjdG9yKSB7CiAgICAgICAgalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGRvY3VtZW50RWxlbWVudCwgc2VsZWN0b3IpOwogICAgICB9CgogICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgaGFuZGxlciBoYXMgYSB1bmlxdWUgSUQsIHVzZWQgdG8gZmluZC9yZW1vdmUgaXQgbGF0ZXIKICAgICAgaWYgKCFoYW5kbGVyLmd1aWQpIHsKICAgICAgICBoYW5kbGVyLmd1aWQgPSBqUXVlcnkuZ3VpZCsrOwogICAgICB9CgogICAgICAvLyBJbml0IHRoZSBlbGVtZW50J3MgZXZlbnQgc3RydWN0dXJlIGFuZCBtYWluIGhhbmRsZXIsIGlmIHRoaXMgaXMgdGhlIGZpcnN0CiAgICAgIGlmICghKGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cykpIHsKICAgICAgICBldmVudHMgPSBlbGVtRGF0YS5ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB9CiAgICAgIGlmICghKGV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlKSkgewogICAgICAgIGV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIC8vIERpc2NhcmQgdGhlIHNlY29uZCBldmVudCBvZiBhIGpRdWVyeS5ldmVudC50cmlnZ2VyKCkgYW5kCiAgICAgICAgICAvLyB3aGVuIGFuIGV2ZW50IGlzIGNhbGxlZCBhZnRlciBhIHBhZ2UgaGFzIHVubG9hZGVkCiAgICAgICAgICByZXR1cm4gdHlwZW9mIGpRdWVyeSAhPT0gInVuZGVmaW5lZCIgJiYgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCAhPT0gZS50eXBlID8galF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmFwcGx5KGVsZW0sIGFyZ3VtZW50cykgOiB1bmRlZmluZWQ7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgLy8gSGFuZGxlIG11bHRpcGxlIGV2ZW50cyBzZXBhcmF0ZWQgYnkgYSBzcGFjZQogICAgICB0eXBlcyA9ICh0eXBlcyB8fCAiIikubWF0Y2gocm5vdGh0bWx3aGl0ZSkgfHwgWyIiXTsKICAgICAgdCA9IHR5cGVzLmxlbmd0aDsKICAgICAgd2hpbGUgKHQtLSkgewogICAgICAgIHRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWModHlwZXNbdF0pIHx8IFtdOwogICAgICAgIHR5cGUgPSBvcmlnVHlwZSA9IHRtcFsxXTsKICAgICAgICBuYW1lc3BhY2VzID0gKHRtcFsyXSB8fCAiIikuc3BsaXQoIi4iKS5zb3J0KCk7CgogICAgICAgIC8vIFRoZXJlICptdXN0KiBiZSBhIHR5cGUsIG5vIGF0dGFjaGluZyBuYW1lc3BhY2Utb25seSBoYW5kbGVycwogICAgICAgIGlmICghdHlwZSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICAvLyBJZiBldmVudCBjaGFuZ2VzIGl0cyB0eXBlLCB1c2UgdGhlIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBjaGFuZ2VkIHR5cGUKICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307CgogICAgICAgIC8vIElmIHNlbGVjdG9yIGRlZmluZWQsIGRldGVybWluZSBzcGVjaWFsIGV2ZW50IGFwaSB0eXBlLCBvdGhlcndpc2UgZ2l2ZW4gdHlwZQogICAgICAgIHR5cGUgPSAoc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUpIHx8IHR5cGU7CgogICAgICAgIC8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGUKICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307CgogICAgICAgIC8vIGhhbmRsZU9iaiBpcyBwYXNzZWQgdG8gYWxsIGV2ZW50IGhhbmRsZXJzCiAgICAgICAgaGFuZGxlT2JqID0galF1ZXJ5LmV4dGVuZCh7CiAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgb3JpZ1R5cGU6IG9yaWdUeXBlLAogICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgIGhhbmRsZXI6IGhhbmRsZXIsCiAgICAgICAgICBndWlkOiBoYW5kbGVyLmd1aWQsCiAgICAgICAgICBzZWxlY3Rvcjogc2VsZWN0b3IsCiAgICAgICAgICBuZWVkc0NvbnRleHQ6IHNlbGVjdG9yICYmIGpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KHNlbGVjdG9yKSwKICAgICAgICAgIG5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKCIuIikKICAgICAgICB9LCBoYW5kbGVPYmpJbik7CgogICAgICAgIC8vIEluaXQgdGhlIGV2ZW50IGhhbmRsZXIgcXVldWUgaWYgd2UncmUgdGhlIGZpcnN0CiAgICAgICAgaWYgKCEoaGFuZGxlcnMgPSBldmVudHNbdHlwZV0pKSB7CiAgICAgICAgICBoYW5kbGVycyA9IGV2ZW50c1t0eXBlXSA9IFtdOwogICAgICAgICAgaGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7CgogICAgICAgICAgLy8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lciBpZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlCiAgICAgICAgICBpZiAoIXNwZWNpYWwuc2V0dXAgfHwgc3BlY2lhbC5zZXR1cC5jYWxsKGVsZW0sIGRhdGEsIG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgaWYgKGVsZW0uYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBldmVudEhhbmRsZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHNwZWNpYWwuYWRkKSB7CiAgICAgICAgICBzcGVjaWFsLmFkZC5jYWxsKGVsZW0sIGhhbmRsZU9iaik7CiAgICAgICAgICBpZiAoIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQpIHsKICAgICAgICAgICAgaGFuZGxlT2JqLmhhbmRsZXIuZ3VpZCA9IGhhbmRsZXIuZ3VpZDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250CiAgICAgICAgaWYgKHNlbGVjdG9yKSB7CiAgICAgICAgICBoYW5kbGVycy5zcGxpY2UoaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLCAwLCBoYW5kbGVPYmopOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoYW5kbGVycy5wdXNoKGhhbmRsZU9iaik7CiAgICAgICAgfQoKICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHdoaWNoIGV2ZW50cyBoYXZlIGV2ZXIgYmVlbiB1c2VkLCBmb3IgZXZlbnQgb3B0aW1pemF0aW9uCiAgICAgICAgalF1ZXJ5LmV2ZW50Lmdsb2JhbFt0eXBlXSA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICAvLyBEZXRhY2ggYW4gZXZlbnQgb3Igc2V0IG9mIGV2ZW50cyBmcm9tIGFuIGVsZW1lbnQKICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBzZWxlY3RvciwgbWFwcGVkVHlwZXMpIHsKICAgICAgdmFyIGosCiAgICAgICAgb3JpZ0NvdW50LAogICAgICAgIHRtcCwKICAgICAgICBldmVudHMsCiAgICAgICAgdCwKICAgICAgICBoYW5kbGVPYmosCiAgICAgICAgc3BlY2lhbCwKICAgICAgICBoYW5kbGVycywKICAgICAgICB0eXBlLAogICAgICAgIG5hbWVzcGFjZXMsCiAgICAgICAgb3JpZ1R5cGUsCiAgICAgICAgZWxlbURhdGEgPSBkYXRhUHJpdi5oYXNEYXRhKGVsZW0pICYmIGRhdGFQcml2LmdldChlbGVtKTsKICAgICAgaWYgKCFlbGVtRGF0YSB8fCAhKGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIE9uY2UgZm9yIGVhY2ggdHlwZS5uYW1lc3BhY2UgaW4gdHlwZXM7IHR5cGUgbWF5IGJlIG9taXR0ZWQKICAgICAgdHlwZXMgPSAodHlwZXMgfHwgIiIpLm1hdGNoKHJub3RodG1sd2hpdGUpIHx8IFsiIl07CiAgICAgIHQgPSB0eXBlcy5sZW5ndGg7CiAgICAgIHdoaWxlICh0LS0pIHsKICAgICAgICB0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKHR5cGVzW3RdKSB8fCBbXTsKICAgICAgICB0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07CiAgICAgICAgbmFtZXNwYWNlcyA9ICh0bXBbMl0gfHwgIiIpLnNwbGl0KCIuIikuc29ydCgpOwoKICAgICAgICAvLyBVbmJpbmQgYWxsIGV2ZW50cyAob24gdGhpcyBuYW1lc3BhY2UsIGlmIHByb3ZpZGVkKSBmb3IgdGhlIGVsZW1lbnQKICAgICAgICBpZiAoIXR5cGUpIHsKICAgICAgICAgIGZvciAodHlwZSBpbiBldmVudHMpIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnJlbW92ZShlbGVtLCB0eXBlICsgdHlwZXNbdF0sIGhhbmRsZXIsIHNlbGVjdG9yLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307CiAgICAgICAgdHlwZSA9IChzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSkgfHwgdHlwZTsKICAgICAgICBoYW5kbGVycyA9IGV2ZW50c1t0eXBlXSB8fCBbXTsKICAgICAgICB0bXAgPSB0bXBbMl0gJiYgbmV3IFJlZ0V4cCgiKF58XFwuKSIgKyBuYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSArICIoXFwufCQpIik7CgogICAgICAgIC8vIFJlbW92ZSBtYXRjaGluZyBldmVudHMKICAgICAgICBvcmlnQ291bnQgPSBqID0gaGFuZGxlcnMubGVuZ3RoOwogICAgICAgIHdoaWxlIChqLS0pIHsKICAgICAgICAgIGhhbmRsZU9iaiA9IGhhbmRsZXJzW2pdOwogICAgICAgICAgaWYgKChtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlKSAmJiAoIWhhbmRsZXIgfHwgaGFuZGxlci5ndWlkID09PSBoYW5kbGVPYmouZ3VpZCkgJiYgKCF0bXAgfHwgdG1wLnRlc3QoaGFuZGxlT2JqLm5hbWVzcGFjZSkpICYmICghc2VsZWN0b3IgfHwgc2VsZWN0b3IgPT09IGhhbmRsZU9iai5zZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gIioqIiAmJiBoYW5kbGVPYmouc2VsZWN0b3IpKSB7CiAgICAgICAgICAgIGhhbmRsZXJzLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgaWYgKGhhbmRsZU9iai5zZWxlY3RvcikgewogICAgICAgICAgICAgIGhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc3BlY2lhbC5yZW1vdmUpIHsKICAgICAgICAgICAgICBzcGVjaWFsLnJlbW92ZS5jYWxsKGVsZW0sIGhhbmRsZU9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFJlbW92ZSBnZW5lcmljIGV2ZW50IGhhbmRsZXIgaWYgd2UgcmVtb3ZlZCBzb21ldGhpbmcgYW5kIG5vIG1vcmUgaGFuZGxlcnMgZXhpc3QKICAgICAgICAvLyAoYXZvaWRzIHBvdGVudGlhbCBmb3IgZW5kbGVzcyByZWN1cnNpb24gZHVyaW5nIHJlbW92YWwgb2Ygc3BlY2lhbCBldmVudCBoYW5kbGVycykKICAgICAgICBpZiAob3JpZ0NvdW50ICYmICFoYW5kbGVycy5sZW5ndGgpIHsKICAgICAgICAgIGlmICghc3BlY2lhbC50ZWFyZG93biB8fCBzcGVjaWFsLnRlYXJkb3duLmNhbGwoZWxlbSwgbmFtZXNwYWNlcywgZWxlbURhdGEuaGFuZGxlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgalF1ZXJ5LnJlbW92ZUV2ZW50KGVsZW0sIHR5cGUsIGVsZW1EYXRhLmhhbmRsZSk7CiAgICAgICAgICB9CiAgICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8gUmVtb3ZlIGRhdGEgYW5kIHRoZSBleHBhbmRvIGlmIGl0J3Mgbm8gbG9uZ2VyIHVzZWQKICAgICAgaWYgKGpRdWVyeS5pc0VtcHR5T2JqZWN0KGV2ZW50cykpIHsKICAgICAgICBkYXRhUHJpdi5yZW1vdmUoZWxlbSwgImhhbmRsZSBldmVudHMiKTsKICAgICAgfQogICAgfSwKICAgIGRpc3BhdGNoOiBmdW5jdGlvbiBkaXNwYXRjaChuYXRpdmVFdmVudCkgewogICAgICB2YXIgaSwKICAgICAgICBqLAogICAgICAgIHJldCwKICAgICAgICBtYXRjaGVkLAogICAgICAgIGhhbmRsZU9iaiwKICAgICAgICBoYW5kbGVyUXVldWUsCiAgICAgICAgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSwKICAgICAgICAvLyBNYWtlIGEgd3JpdGFibGUgalF1ZXJ5LkV2ZW50IGZyb20gdGhlIG5hdGl2ZSBldmVudCBvYmplY3QKICAgICAgICBldmVudCA9IGpRdWVyeS5ldmVudC5maXgobmF0aXZlRXZlbnQpLAogICAgICAgIGhhbmRsZXJzID0gKGRhdGFQcml2LmdldCh0aGlzLCAiZXZlbnRzIikgfHwgT2JqZWN0LmNyZWF0ZShudWxsKSlbZXZlbnQudHlwZV0gfHwgW10sCiAgICAgICAgc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsW2V2ZW50LnR5cGVdIHx8IHt9OwoKICAgICAgLy8gVXNlIHRoZSBmaXgtZWQgalF1ZXJ5LkV2ZW50IHJhdGhlciB0aGFuIHRoZSAocmVhZC1vbmx5KSBuYXRpdmUgZXZlbnQKICAgICAgYXJnc1swXSA9IGV2ZW50OwogICAgICBmb3IgKGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsKICAgICAgfQogICAgICBldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7CgogICAgICAvLyBDYWxsIHRoZSBwcmVEaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUsIGFuZCBsZXQgaXQgYmFpbCBpZiBkZXNpcmVkCiAgICAgIGlmIChzcGVjaWFsLnByZURpc3BhdGNoICYmIHNwZWNpYWwucHJlRGlzcGF0Y2guY2FsbCh0aGlzLCBldmVudCkgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyBEZXRlcm1pbmUgaGFuZGxlcnMKICAgICAgaGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwodGhpcywgZXZlbnQsIGhhbmRsZXJzKTsKCiAgICAgIC8vIFJ1biBkZWxlZ2F0ZXMgZmlyc3Q7IHRoZXkgbWF5IHdhbnQgdG8gc3RvcCBwcm9wYWdhdGlvbiBiZW5lYXRoIHVzCiAgICAgIGkgPSAwOwogICAgICB3aGlsZSAoKG1hdGNoZWQgPSBoYW5kbGVyUXVldWVbaSsrXSkgJiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHsKICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0ID0gbWF0Y2hlZC5lbGVtOwogICAgICAgIGogPSAwOwogICAgICAgIHdoaWxlICgoaGFuZGxlT2JqID0gbWF0Y2hlZC5oYW5kbGVyc1tqKytdKSAmJiAhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSkgewogICAgICAgICAgLy8gSWYgdGhlIGV2ZW50IGlzIG5hbWVzcGFjZWQsIHRoZW4gZWFjaCBoYW5kbGVyIGlzIG9ubHkgaW52b2tlZCBpZiBpdCBpcwogICAgICAgICAgLy8gc3BlY2lhbGx5IHVuaXZlcnNhbCBvciBpdHMgbmFtZXNwYWNlcyBhcmUgYSBzdXBlcnNldCBvZiB0aGUgZXZlbnQncy4KICAgICAgICAgIGlmICghZXZlbnQucm5hbWVzcGFjZSB8fCBoYW5kbGVPYmoubmFtZXNwYWNlID09PSBmYWxzZSB8fCBldmVudC5ybmFtZXNwYWNlLnRlc3QoaGFuZGxlT2JqLm5hbWVzcGFjZSkpIHsKICAgICAgICAgICAgZXZlbnQuaGFuZGxlT2JqID0gaGFuZGxlT2JqOwogICAgICAgICAgICBldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7CiAgICAgICAgICAgIHJldCA9ICgoalF1ZXJ5LmV2ZW50LnNwZWNpYWxbaGFuZGxlT2JqLm9yaWdUeXBlXSB8fCB7fSkuaGFuZGxlIHx8IGhhbmRsZU9iai5oYW5kbGVyKS5hcHBseShtYXRjaGVkLmVsZW0sIGFyZ3MpOwogICAgICAgICAgICBpZiAocmV0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBpZiAoKGV2ZW50LnJlc3VsdCA9IHJldCkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBDYWxsIHRoZSBwb3N0RGlzcGF0Y2ggaG9vayBmb3IgdGhlIG1hcHBlZCB0eXBlCiAgICAgIGlmIChzcGVjaWFsLnBvc3REaXNwYXRjaCkgewogICAgICAgIHNwZWNpYWwucG9zdERpc3BhdGNoLmNhbGwodGhpcywgZXZlbnQpOwogICAgICB9CiAgICAgIHJldHVybiBldmVudC5yZXN1bHQ7CiAgICB9LAogICAgaGFuZGxlcnM6IGZ1bmN0aW9uIGhhbmRsZXJzKGV2ZW50LCBfaGFuZGxlcnMpIHsKICAgICAgdmFyIGksCiAgICAgICAgaGFuZGxlT2JqLAogICAgICAgIHNlbCwKICAgICAgICBtYXRjaGVkSGFuZGxlcnMsCiAgICAgICAgbWF0Y2hlZFNlbGVjdG9ycywKICAgICAgICBoYW5kbGVyUXVldWUgPSBbXSwKICAgICAgICBkZWxlZ2F0ZUNvdW50ID0gX2hhbmRsZXJzLmRlbGVnYXRlQ291bnQsCiAgICAgICAgY3VyID0gZXZlbnQudGFyZ2V0OwoKICAgICAgLy8gRmluZCBkZWxlZ2F0ZSBoYW5kbGVycwogICAgICBpZiAoZGVsZWdhdGVDb3VudCAmJgogICAgICAvLyBTdXBwb3J0OiBJRSA8PTkKICAgICAgLy8gQmxhY2staG9sZSBTVkcgPHVzZT4gaW5zdGFuY2UgdHJlZXMgKHRyYWMtMTMxODApCiAgICAgIGN1ci5ub2RlVHlwZSAmJgogICAgICAvLyBTdXBwb3J0OiBGaXJlZm94IDw9NDIKICAgICAgLy8gU3VwcHJlc3Mgc3BlYy12aW9sYXRpbmcgY2xpY2tzIGluZGljYXRpbmcgYSBub24tcHJpbWFyeSBwb2ludGVyIGJ1dHRvbiAodHJhYy0zODYxKQogICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvRE9NLUxldmVsLTMtRXZlbnRzLyNldmVudC10eXBlLWNsaWNrCiAgICAgIC8vIFN1cHBvcnQ6IElFIDExIG9ubHkKICAgICAgLy8gLi4uYnV0IG5vdCBhcnJvdyBrZXkgImNsaWNrcyIgb2YgcmFkaW8gaW5wdXRzLCB3aGljaCBjYW4gaGF2ZSBgYnV0dG9uYCAtMSAoZ2gtMjM0MykKICAgICAgIShldmVudC50eXBlID09PSAiY2xpY2siICYmIGV2ZW50LmJ1dHRvbiA+PSAxKSkgewogICAgICAgIGZvciAoOyBjdXIgIT09IHRoaXM7IGN1ciA9IGN1ci5wYXJlbnROb2RlIHx8IHRoaXMpIHsKICAgICAgICAgIC8vIERvbid0IGNoZWNrIG5vbi1lbGVtZW50cyAoIzEzMjA4KQogICAgICAgICAgLy8gRG9uJ3QgcHJvY2VzcyBjbGlja3Mgb24gZGlzYWJsZWQgZWxlbWVudHMgKCM2OTExLCAjODE2NSwgIzExMzgyLCAjMTE3NjQpCiAgICAgICAgICBpZiAoY3VyLm5vZGVUeXBlID09PSAxICYmICEoZXZlbnQudHlwZSA9PT0gImNsaWNrIiAmJiBjdXIuZGlzYWJsZWQgPT09IHRydWUpKSB7CiAgICAgICAgICAgIG1hdGNoZWRIYW5kbGVycyA9IFtdOwogICAgICAgICAgICBtYXRjaGVkU2VsZWN0b3JzID0ge307CiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBkZWxlZ2F0ZUNvdW50OyBpKyspIHsKICAgICAgICAgICAgICBoYW5kbGVPYmogPSBfaGFuZGxlcnNbaV07CgogICAgICAgICAgICAgIC8vIERvbid0IGNvbmZsaWN0IHdpdGggT2JqZWN0LnByb3RvdHlwZSBwcm9wZXJ0aWVzICgjMTMyMDMpCiAgICAgICAgICAgICAgc2VsID0gaGFuZGxlT2JqLnNlbGVjdG9yICsgIiAiOwogICAgICAgICAgICAgIGlmIChtYXRjaGVkU2VsZWN0b3JzW3NlbF0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbWF0Y2hlZFNlbGVjdG9yc1tzZWxdID0gaGFuZGxlT2JqLm5lZWRzQ29udGV4dCA/IGpRdWVyeShzZWwsIHRoaXMpLmluZGV4KGN1cikgPiAtMSA6IGpRdWVyeS5maW5kKHNlbCwgdGhpcywgbnVsbCwgW2N1cl0pLmxlbmd0aDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKG1hdGNoZWRTZWxlY3RvcnNbc2VsXSkgewogICAgICAgICAgICAgICAgbWF0Y2hlZEhhbmRsZXJzLnB1c2goaGFuZGxlT2JqKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1hdGNoZWRIYW5kbGVycy5sZW5ndGgpIHsKICAgICAgICAgICAgICBoYW5kbGVyUXVldWUucHVzaCh7CiAgICAgICAgICAgICAgICBlbGVtOiBjdXIsCiAgICAgICAgICAgICAgICBoYW5kbGVyczogbWF0Y2hlZEhhbmRsZXJzCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIEFkZCB0aGUgcmVtYWluaW5nIChkaXJlY3RseS1ib3VuZCkgaGFuZGxlcnMKICAgICAgY3VyID0gdGhpczsKICAgICAgaWYgKGRlbGVnYXRlQ291bnQgPCBfaGFuZGxlcnMubGVuZ3RoKSB7CiAgICAgICAgaGFuZGxlclF1ZXVlLnB1c2goewogICAgICAgICAgZWxlbTogY3VyLAogICAgICAgICAgaGFuZGxlcnM6IF9oYW5kbGVycy5zbGljZShkZWxlZ2F0ZUNvdW50KQogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBoYW5kbGVyUXVldWU7CiAgICB9LAogICAgYWRkUHJvcDogZnVuY3Rpb24gYWRkUHJvcChuYW1lLCBob29rKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShqUXVlcnkuRXZlbnQucHJvdG90eXBlLCBuYW1lLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZ2V0OiBpc0Z1bmN0aW9uKGhvb2spID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHRoaXMub3JpZ2luYWxFdmVudCkgewogICAgICAgICAgICByZXR1cm4gaG9vayh0aGlzLm9yaWdpbmFsRXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAodGhpcy5vcmlnaW5hbEV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnRbbmFtZV07CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIG5hbWUsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGZpeDogZnVuY3Rpb24gZml4KG9yaWdpbmFsRXZlbnQpIHsKICAgICAgcmV0dXJuIG9yaWdpbmFsRXZlbnRbalF1ZXJ5LmV4cGFuZG9dID8gb3JpZ2luYWxFdmVudCA6IG5ldyBqUXVlcnkuRXZlbnQob3JpZ2luYWxFdmVudCk7CiAgICB9LAogICAgc3BlY2lhbDogewogICAgICBsb2FkOiB7CiAgICAgICAgLy8gUHJldmVudCB0cmlnZ2VyZWQgaW1hZ2UubG9hZCBldmVudHMgZnJvbSBidWJibGluZyB0byB3aW5kb3cubG9hZAogICAgICAgIG5vQnViYmxlOiB0cnVlCiAgICAgIH0sCiAgICAgIGNsaWNrOiB7CiAgICAgICAgLy8gVXRpbGl6ZSBuYXRpdmUgZXZlbnQgdG8gZW5zdXJlIGNvcnJlY3Qgc3RhdGUgZm9yIGNoZWNrYWJsZSBpbnB1dHMKICAgICAgICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoZGF0YSkgewogICAgICAgICAgLy8gRm9yIG11dHVhbCBjb21wcmVzc2liaWxpdHkgd2l0aCBfZGVmYXVsdCwgcmVwbGFjZSBgdGhpc2AgYWNjZXNzIHdpdGggYSBsb2NhbCB2YXIuCiAgICAgICAgICAvLyBgfHwgZGF0YWAgaXMgZGVhZCBjb2RlIG1lYW50IG9ubHkgdG8gcHJlc2VydmUgdGhlIHZhcmlhYmxlIHRocm91Z2ggbWluaWZpY2F0aW9uLgogICAgICAgICAgdmFyIGVsID0gdGhpcyB8fCBkYXRhOwoKICAgICAgICAgIC8vIENsYWltIHRoZSBmaXJzdCBoYW5kbGVyCiAgICAgICAgICBpZiAocmNoZWNrYWJsZVR5cGUudGVzdChlbC50eXBlKSAmJiBlbC5jbGljayAmJiBub2RlTmFtZShlbCwgImlucHV0IikpIHsKICAgICAgICAgICAgLy8gZGF0YVByaXYuc2V0KCBlbCwgImNsaWNrIiwgLi4uICkKICAgICAgICAgICAgbGV2ZXJhZ2VOYXRpdmUoZWwsICJjbGljayIsIHJldHVyblRydWUpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFJldHVybiBmYWxzZSB0byBhbGxvdyBub3JtYWwgcHJvY2Vzc2luZyBpbiB0aGUgY2FsbGVyCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICB0cmlnZ2VyOiBmdW5jdGlvbiB0cmlnZ2VyKGRhdGEpIHsKICAgICAgICAgIC8vIEZvciBtdXR1YWwgY29tcHJlc3NpYmlsaXR5IHdpdGggX2RlZmF1bHQsIHJlcGxhY2UgYHRoaXNgIGFjY2VzcyB3aXRoIGEgbG9jYWwgdmFyLgogICAgICAgICAgLy8gYHx8IGRhdGFgIGlzIGRlYWQgY29kZSBtZWFudCBvbmx5IHRvIHByZXNlcnZlIHRoZSB2YXJpYWJsZSB0aHJvdWdoIG1pbmlmaWNhdGlvbi4KICAgICAgICAgIHZhciBlbCA9IHRoaXMgfHwgZGF0YTsKCiAgICAgICAgICAvLyBGb3JjZSBzZXR1cCBiZWZvcmUgdHJpZ2dlcmluZyBhIGNsaWNrCiAgICAgICAgICBpZiAocmNoZWNrYWJsZVR5cGUudGVzdChlbC50eXBlKSAmJiBlbC5jbGljayAmJiBub2RlTmFtZShlbCwgImlucHV0IikpIHsKICAgICAgICAgICAgbGV2ZXJhZ2VOYXRpdmUoZWwsICJjbGljayIpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFJldHVybiBub24tZmFsc2UgdG8gYWxsb3cgbm9ybWFsIGV2ZW50LXBhdGggcHJvcGFnYXRpb24KICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgLy8gRm9yIGNyb3NzLWJyb3dzZXIgY29uc2lzdGVuY3ksIHN1cHByZXNzIG5hdGl2ZSAuY2xpY2soKSBvbiBsaW5rcwogICAgICAgIC8vIEFsc28gcHJldmVudCBpdCBpZiB3ZSdyZSBjdXJyZW50bHkgaW5zaWRlIGEgbGV2ZXJhZ2VkIG5hdGl2ZS1ldmVudCBzdGFjawogICAgICAgIF9kZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdChldmVudCkgewogICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDsKICAgICAgICAgIHJldHVybiByY2hlY2thYmxlVHlwZS50ZXN0KHRhcmdldC50eXBlKSAmJiB0YXJnZXQuY2xpY2sgJiYgbm9kZU5hbWUodGFyZ2V0LCAiaW5wdXQiKSAmJiBkYXRhUHJpdi5nZXQodGFyZ2V0LCAiY2xpY2siKSB8fCBub2RlTmFtZSh0YXJnZXQsICJhIik7CiAgICAgICAgfQogICAgICB9LAogICAgICBiZWZvcmV1bmxvYWQ6IHsKICAgICAgICBwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uIHBvc3REaXNwYXRjaChldmVudCkgewogICAgICAgICAgLy8gU3VwcG9ydDogRmlyZWZveCAyMCsKICAgICAgICAgIC8vIEZpcmVmb3ggZG9lc24ndCBhbGVydCBpZiB0aGUgcmV0dXJuVmFsdWUgZmllbGQgaXMgbm90IHNldC4KICAgICAgICAgIGlmIChldmVudC5yZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBldmVudC5vcmlnaW5hbEV2ZW50KSB7CiAgICAgICAgICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWUgPSBldmVudC5yZXN1bHQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKCiAgLy8gRW5zdXJlIHRoZSBwcmVzZW5jZSBvZiBhbiBldmVudCBsaXN0ZW5lciB0aGF0IGhhbmRsZXMgbWFudWFsbHktdHJpZ2dlcmVkCiAgLy8gc3ludGhldGljIGV2ZW50cyBieSBpbnRlcnJ1cHRpbmcgcHJvZ3Jlc3MgdW50aWwgcmVpbnZva2VkIGluIHJlc3BvbnNlIHRvCiAgLy8gKm5hdGl2ZSogZXZlbnRzIHRoYXQgaXQgZmlyZXMgZGlyZWN0bHksIGVuc3VyaW5nIHRoYXQgc3RhdGUgY2hhbmdlcyBoYXZlCiAgLy8gYWxyZWFkeSBvY2N1cnJlZCBiZWZvcmUgb3RoZXIgbGlzdGVuZXJzIGFyZSBpbnZva2VkLgogIGZ1bmN0aW9uIGxldmVyYWdlTmF0aXZlKGVsLCB0eXBlLCBleHBlY3RTeW5jKSB7CiAgICAvLyBNaXNzaW5nIGV4cGVjdFN5bmMgaW5kaWNhdGVzIGEgdHJpZ2dlciBjYWxsLCB3aGljaCBtdXN0IGZvcmNlIHNldHVwIHRocm91Z2ggalF1ZXJ5LmV2ZW50LmFkZAogICAgaWYgKCFleHBlY3RTeW5jKSB7CiAgICAgIGlmIChkYXRhUHJpdi5nZXQoZWwsIHR5cGUpID09PSB1bmRlZmluZWQpIHsKICAgICAgICBqUXVlcnkuZXZlbnQuYWRkKGVsLCB0eXBlLCByZXR1cm5UcnVlKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUmVnaXN0ZXIgdGhlIGNvbnRyb2xsZXIgYXMgYSBzcGVjaWFsIHVuaXZlcnNhbCBoYW5kbGVyIGZvciBhbGwgZXZlbnQgbmFtZXNwYWNlcwogICAgZGF0YVByaXYuc2V0KGVsLCB0eXBlLCBmYWxzZSk7CiAgICBqUXVlcnkuZXZlbnQuYWRkKGVsLCB0eXBlLCB7CiAgICAgIG5hbWVzcGFjZTogZmFsc2UsCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoZXZlbnQpIHsKICAgICAgICB2YXIgbm90QXN5bmMsCiAgICAgICAgICByZXN1bHQsCiAgICAgICAgICBzYXZlZCA9IGRhdGFQcml2LmdldCh0aGlzLCB0eXBlKTsKICAgICAgICBpZiAoZXZlbnQuaXNUcmlnZ2VyICYgMSAmJiB0aGlzW3R5cGVdKSB7CiAgICAgICAgICAvLyBJbnRlcnJ1cHQgcHJvY2Vzc2luZyBvZiB0aGUgb3V0ZXIgc3ludGhldGljIC50cmlnZ2VyKCllZCBldmVudAogICAgICAgICAgLy8gU2F2ZWQgZGF0YSBzaG91bGQgYmUgZmFsc2UgaW4gc3VjaCBjYXNlcywgYnV0IG1pZ2h0IGJlIGEgbGVmdG92ZXIgY2FwdHVyZSBvYmplY3QKICAgICAgICAgIC8vIGZyb20gYW4gYXN5bmMgbmF0aXZlIGhhbmRsZXIgKGdoLTQzNTApCiAgICAgICAgICBpZiAoIXNhdmVkLmxlbmd0aCkgewogICAgICAgICAgICAvLyBTdG9yZSBhcmd1bWVudHMgZm9yIHVzZSB3aGVuIGhhbmRsaW5nIHRoZSBpbm5lciBuYXRpdmUgZXZlbnQKICAgICAgICAgICAgLy8gVGhlcmUgd2lsbCBhbHdheXMgYmUgYXQgbGVhc3Qgb25lIGFyZ3VtZW50IChhbiBldmVudCBvYmplY3QpLCBzbyB0aGlzIGFycmF5CiAgICAgICAgICAgIC8vIHdpbGwgbm90IGJlIGNvbmZ1c2VkIHdpdGggYSBsZWZ0b3ZlciBjYXB0dXJlIG9iamVjdC4KICAgICAgICAgICAgc2F2ZWQgPSBfc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgICAgICAgICBkYXRhUHJpdi5zZXQodGhpcywgdHlwZSwgc2F2ZWQpOwoKICAgICAgICAgICAgLy8gVHJpZ2dlciB0aGUgbmF0aXZlIGV2ZW50IGFuZCBjYXB0dXJlIGl0cyByZXN1bHQKICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUgPD05IC0gMTErCiAgICAgICAgICAgIC8vIGZvY3VzKCkgYW5kIGJsdXIoKSBhcmUgYXN5bmNocm9ub3VzCiAgICAgICAgICAgIG5vdEFzeW5jID0gZXhwZWN0U3luYyh0aGlzLCB0eXBlKTsKICAgICAgICAgICAgdGhpc1t0eXBlXSgpOwogICAgICAgICAgICByZXN1bHQgPSBkYXRhUHJpdi5nZXQodGhpcywgdHlwZSk7CiAgICAgICAgICAgIGlmIChzYXZlZCAhPT0gcmVzdWx0IHx8IG5vdEFzeW5jKSB7CiAgICAgICAgICAgICAgZGF0YVByaXYuc2V0KHRoaXMsIHR5cGUsIGZhbHNlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQgPSB7fTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2F2ZWQgIT09IHJlc3VsdCkgewogICAgICAgICAgICAgIC8vIENhbmNlbCB0aGUgb3V0ZXIgc3ludGhldGljIGV2ZW50CiAgICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBJZiB0aGlzIGlzIGFuIGlubmVyIHN5bnRoZXRpYyBldmVudCBmb3IgYW4gZXZlbnQgd2l0aCBhIGJ1YmJsaW5nIHN1cnJvZ2F0ZQogICAgICAgICAgICAvLyAoZm9jdXMgb3IgYmx1ciksIGFzc3VtZSB0aGF0IHRoZSBzdXJyb2dhdGUgYWxyZWFkeSBwcm9wYWdhdGVkIGZyb20gdHJpZ2dlcmluZyB0aGUKICAgICAgICAgICAgLy8gbmF0aXZlIGV2ZW50IGFuZCBwcmV2ZW50IHRoYXQgZnJvbSBoYXBwZW5pbmcgYWdhaW4gaGVyZS4KICAgICAgICAgICAgLy8gVGhpcyB0ZWNobmljYWxseSBnZXRzIHRoZSBvcmRlcmluZyB3cm9uZyB3LnIudC4gdG8gYC50cmlnZ2VyKClgIChpbiB3aGljaCB0aGUKICAgICAgICAgICAgLy8gYnViYmxpbmcgc3Vycm9nYXRlIHByb3BhZ2F0ZXMgKmFmdGVyKiB0aGUgbm9uLWJ1YmJsaW5nIGJhc2UpLCBidXQgdGhhdCBzZWVtcwogICAgICAgICAgICAvLyBsZXNzIGJhZCB0aGFuIGR1cGxpY2F0aW9uLgogICAgICAgICAgfSBlbHNlIGlmICgoalF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge30pLmRlbGVnYXRlVHlwZSkgewogICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiB0aGlzIGlzIGEgbmF0aXZlIGV2ZW50IHRyaWdnZXJlZCBhYm92ZSwgZXZlcnl0aGluZyBpcyBub3cgaW4gb3JkZXIKICAgICAgICAgIC8vIEZpcmUgYW4gaW5uZXIgc3ludGhldGljIGV2ZW50IHdpdGggdGhlIG9yaWdpbmFsIGFyZ3VtZW50cwogICAgICAgIH0gZWxzZSBpZiAoc2F2ZWQubGVuZ3RoKSB7CiAgICAgICAgICAvLyAuLi5hbmQgY2FwdHVyZSB0aGUgcmVzdWx0CiAgICAgICAgICBkYXRhUHJpdi5zZXQodGhpcywgdHlwZSwgewogICAgICAgICAgICB2YWx1ZTogalF1ZXJ5LmV2ZW50LnRyaWdnZXIoCiAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDw9OSAtIDExKwogICAgICAgICAgICAvLyBFeHRlbmQgd2l0aCB0aGUgcHJvdG90eXBlIHRvIHJlc2V0IHRoZSBhYm92ZSBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKQogICAgICAgICAgICBqUXVlcnkuZXh0ZW5kKHNhdmVkWzBdLCBqUXVlcnkuRXZlbnQucHJvdG90eXBlKSwgc2F2ZWQuc2xpY2UoMSksIHRoaXMpCiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBBYm9ydCBoYW5kbGluZyBvZiB0aGUgbmF0aXZlIGV2ZW50CiAgICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0KICBqUXVlcnkucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbiAoZWxlbSwgdHlwZSwgaGFuZGxlKSB7CiAgICAvLyBUaGlzICJpZiIgaXMgbmVlZGVkIGZvciBwbGFpbiBvYmplY3RzCiAgICBpZiAoZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKSB7CiAgICAgIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGUpOwogICAgfQogIH07CiAgalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24gKHNyYywgcHJvcHMpIHsKICAgIC8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCB0aGUgJ25ldycga2V5d29yZAogICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIGpRdWVyeS5FdmVudCkpIHsKICAgICAgcmV0dXJuIG5ldyBqUXVlcnkuRXZlbnQoc3JjLCBwcm9wcyk7CiAgICB9CgogICAgLy8gRXZlbnQgb2JqZWN0CiAgICBpZiAoc3JjICYmIHNyYy50eXBlKSB7CiAgICAgIHRoaXMub3JpZ2luYWxFdmVudCA9IHNyYzsKICAgICAgdGhpcy50eXBlID0gc3JjLnR5cGU7CgogICAgICAvLyBFdmVudHMgYnViYmxpbmcgdXAgdGhlIGRvY3VtZW50IG1heSBoYXZlIGJlZW4gbWFya2VkIGFzIHByZXZlbnRlZAogICAgICAvLyBieSBhIGhhbmRsZXIgbG93ZXIgZG93biB0aGUgdHJlZTsgcmVmbGVjdCB0aGUgY29ycmVjdCB2YWx1ZS4KICAgICAgdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fCBzcmMuZGVmYXVsdFByZXZlbnRlZCA9PT0gdW5kZWZpbmVkICYmCiAgICAgIC8vIFN1cHBvcnQ6IEFuZHJvaWQgPD0yLjMgb25seQogICAgICBzcmMucmV0dXJuVmFsdWUgPT09IGZhbHNlID8gcmV0dXJuVHJ1ZSA6IHJldHVybkZhbHNlOwoKICAgICAgLy8gQ3JlYXRlIHRhcmdldCBwcm9wZXJ0aWVzCiAgICAgIC8vIFN1cHBvcnQ6IFNhZmFyaSA8PTYgLSA3IG9ubHkKICAgICAgLy8gVGFyZ2V0IHNob3VsZCBub3QgYmUgYSB0ZXh0IG5vZGUgKCM1MDQsICMxMzE0MykKICAgICAgdGhpcy50YXJnZXQgPSBzcmMudGFyZ2V0ICYmIHNyYy50YXJnZXQubm9kZVR5cGUgPT09IDMgPyBzcmMudGFyZ2V0LnBhcmVudE5vZGUgOiBzcmMudGFyZ2V0OwogICAgICB0aGlzLmN1cnJlbnRUYXJnZXQgPSBzcmMuY3VycmVudFRhcmdldDsKICAgICAgdGhpcy5yZWxhdGVkVGFyZ2V0ID0gc3JjLnJlbGF0ZWRUYXJnZXQ7CgogICAgICAvLyBFdmVudCB0eXBlCiAgICB9IGVsc2UgewogICAgICB0aGlzLnR5cGUgPSBzcmM7CiAgICB9CgogICAgLy8gUHV0IGV4cGxpY2l0bHkgcHJvdmlkZWQgcHJvcGVydGllcyBvbnRvIHRoZSBldmVudCBvYmplY3QKICAgIGlmIChwcm9wcykgewogICAgICBqUXVlcnkuZXh0ZW5kKHRoaXMsIHByb3BzKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYSB0aW1lc3RhbXAgaWYgaW5jb21pbmcgZXZlbnQgZG9lc24ndCBoYXZlIG9uZQogICAgdGhpcy50aW1lU3RhbXAgPSBzcmMgJiYgc3JjLnRpbWVTdGFtcCB8fCBEYXRlLm5vdygpOwoKICAgIC8vIE1hcmsgaXQgYXMgZml4ZWQKICAgIHRoaXNbalF1ZXJ5LmV4cGFuZG9dID0gdHJ1ZTsKICB9OwoKICAvLyBqUXVlcnkuRXZlbnQgaXMgYmFzZWQgb24gRE9NMyBFdmVudHMgYXMgc3BlY2lmaWVkIGJ5IHRoZSBFQ01BU2NyaXB0IExhbmd1YWdlIEJpbmRpbmcKICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvMjAwMy9XRC1ET00tTGV2ZWwtMy1FdmVudHMtMjAwMzAzMzEvZWNtYS1zY3JpcHQtYmluZGluZy5odG1sCiAgalF1ZXJ5LkV2ZW50LnByb3RvdHlwZSA9IHsKICAgIGNvbnN0cnVjdG9yOiBqUXVlcnkuRXZlbnQsCiAgICBpc0RlZmF1bHRQcmV2ZW50ZWQ6IHJldHVybkZhbHNlLAogICAgaXNQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLAogICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLAogICAgaXNTaW11bGF0ZWQ6IGZhbHNlLAogICAgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KCkgewogICAgICB2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKICAgICAgdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSByZXR1cm5UcnVlOwogICAgICBpZiAoZSAmJiAhdGhpcy5pc1NpbXVsYXRlZCkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfSwKICAgIHN0b3BQcm9wYWdhdGlvbjogZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uKCkgewogICAgICB2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKICAgICAgdGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7CiAgICAgIGlmIChlICYmICF0aGlzLmlzU2ltdWxhdGVkKSB7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgfQogICAgfSwKICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24gc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkgewogICAgICB2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKICAgICAgdGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7CiAgICAgIGlmIChlICYmICF0aGlzLmlzU2ltdWxhdGVkKSB7CiAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgICAgfQogICAgICB0aGlzLnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQogIH07CgogIC8vIEluY2x1ZGVzIGFsbCBjb21tb24gZXZlbnQgcHJvcHMgaW5jbHVkaW5nIEtleUV2ZW50IGFuZCBNb3VzZUV2ZW50IHNwZWNpZmljIHByb3BzCiAgalF1ZXJ5LmVhY2goewogICAgYWx0S2V5OiB0cnVlLAogICAgYnViYmxlczogdHJ1ZSwKICAgIGNhbmNlbGFibGU6IHRydWUsCiAgICBjaGFuZ2VkVG91Y2hlczogdHJ1ZSwKICAgIGN0cmxLZXk6IHRydWUsCiAgICBkZXRhaWw6IHRydWUsCiAgICBldmVudFBoYXNlOiB0cnVlLAogICAgbWV0YUtleTogdHJ1ZSwKICAgIHBhZ2VYOiB0cnVlLAogICAgcGFnZVk6IHRydWUsCiAgICBzaGlmdEtleTogdHJ1ZSwKICAgIHZpZXc6IHRydWUsCiAgICAiY2hhciI6IHRydWUsCiAgICBjb2RlOiB0cnVlLAogICAgY2hhckNvZGU6IHRydWUsCiAgICBrZXk6IHRydWUsCiAgICBrZXlDb2RlOiB0cnVlLAogICAgYnV0dG9uOiB0cnVlLAogICAgYnV0dG9uczogdHJ1ZSwKICAgIGNsaWVudFg6IHRydWUsCiAgICBjbGllbnRZOiB0cnVlLAogICAgb2Zmc2V0WDogdHJ1ZSwKICAgIG9mZnNldFk6IHRydWUsCiAgICBwb2ludGVySWQ6IHRydWUsCiAgICBwb2ludGVyVHlwZTogdHJ1ZSwKICAgIHNjcmVlblg6IHRydWUsCiAgICBzY3JlZW5ZOiB0cnVlLAogICAgdGFyZ2V0VG91Y2hlczogdHJ1ZSwKICAgIHRvRWxlbWVudDogdHJ1ZSwKICAgIHRvdWNoZXM6IHRydWUsCiAgICB3aGljaDogZnVuY3Rpb24gd2hpY2goZXZlbnQpIHsKICAgICAgdmFyIGJ1dHRvbiA9IGV2ZW50LmJ1dHRvbjsKCiAgICAgIC8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50cwogICAgICBpZiAoZXZlbnQud2hpY2ggPT0gbnVsbCAmJiBya2V5RXZlbnQudGVzdChldmVudC50eXBlKSkgewogICAgICAgIHJldHVybiBldmVudC5jaGFyQ29kZSAhPSBudWxsID8gZXZlbnQuY2hhckNvZGUgOiBldmVudC5rZXlDb2RlOwogICAgICB9CgogICAgICAvLyBBZGQgd2hpY2ggZm9yIGNsaWNrOiAxID09PSBsZWZ0OyAyID09PSBtaWRkbGU7IDMgPT09IHJpZ2h0CiAgICAgIGlmICghZXZlbnQud2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgJiYgcm1vdXNlRXZlbnQudGVzdChldmVudC50eXBlKSkgewogICAgICAgIGlmIChidXR0b24gJiAxKSB7CiAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgaWYgKGJ1dHRvbiAmIDIpIHsKICAgICAgICAgIHJldHVybiAzOwogICAgICAgIH0KICAgICAgICBpZiAoYnV0dG9uICYgNCkgewogICAgICAgICAgcmV0dXJuIDI7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICAgIHJldHVybiBldmVudC53aGljaDsKICAgIH0KICB9LCBqUXVlcnkuZXZlbnQuYWRkUHJvcCk7CiAgalF1ZXJ5LmVhY2goewogICAgZm9jdXM6ICJmb2N1c2luIiwKICAgIGJsdXI6ICJmb2N1c291dCIKICB9LCBmdW5jdGlvbiAodHlwZSwgZGVsZWdhdGVUeXBlKSB7CiAgICBqUXVlcnkuZXZlbnQuc3BlY2lhbFt0eXBlXSA9IHsKICAgICAgLy8gVXRpbGl6ZSBuYXRpdmUgZXZlbnQgaWYgcG9zc2libGUgc28gYmx1ci9mb2N1cyBzZXF1ZW5jZSBpcyBjb3JyZWN0CiAgICAgIHNldHVwOiBmdW5jdGlvbiBzZXR1cCgpIHsKICAgICAgICAvLyBDbGFpbSB0aGUgZmlyc3QgaGFuZGxlcgogICAgICAgIC8vIGRhdGFQcml2LnNldCggdGhpcywgImZvY3VzIiwgLi4uICkKICAgICAgICAvLyBkYXRhUHJpdi5zZXQoIHRoaXMsICJibHVyIiwgLi4uICkKICAgICAgICBsZXZlcmFnZU5hdGl2ZSh0aGlzLCB0eXBlLCBleHBlY3RTeW5jKTsKCiAgICAgICAgLy8gUmV0dXJuIGZhbHNlIHRvIGFsbG93IG5vcm1hbCBwcm9jZXNzaW5nIGluIHRoZSBjYWxsZXIKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0sCiAgICAgIHRyaWdnZXI6IGZ1bmN0aW9uIHRyaWdnZXIoKSB7CiAgICAgICAgLy8gRm9yY2Ugc2V0dXAgYmVmb3JlIHRyaWdnZXIKICAgICAgICBsZXZlcmFnZU5hdGl2ZSh0aGlzLCB0eXBlKTsKCiAgICAgICAgLy8gUmV0dXJuIG5vbi1mYWxzZSB0byBhbGxvdyBub3JtYWwgZXZlbnQtcGF0aCBwcm9wYWdhdGlvbgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICBkZWxlZ2F0ZVR5cGU6IGRlbGVnYXRlVHlwZQogICAgfTsKICB9KTsKCiAgLy8gQ3JlYXRlIG1vdXNlZW50ZXIvbGVhdmUgZXZlbnRzIHVzaW5nIG1vdXNlb3Zlci9vdXQgYW5kIGV2ZW50LXRpbWUgY2hlY2tzCiAgLy8gc28gdGhhdCBldmVudCBkZWxlZ2F0aW9uIHdvcmtzIGluIGpRdWVyeS4KICAvLyBEbyB0aGUgc2FtZSBmb3IgcG9pbnRlcmVudGVyL3BvaW50ZXJsZWF2ZSBhbmQgcG9pbnRlcm92ZXIvcG9pbnRlcm91dAogIC8vCiAgLy8gU3VwcG9ydDogU2FmYXJpIDcgb25seQogIC8vIFNhZmFyaSBzZW5kcyBtb3VzZWVudGVyIHRvbyBvZnRlbjsgc2VlOgogIC8vIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTQ3MDI1OAogIC8vIGZvciB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIGJ1ZyAoaXQgZXhpc3RlZCBpbiBvbGRlciBDaHJvbWUgdmVyc2lvbnMgYXMgd2VsbCkuCiAgalF1ZXJ5LmVhY2goewogICAgbW91c2VlbnRlcjogIm1vdXNlb3ZlciIsCiAgICBtb3VzZWxlYXZlOiAibW91c2VvdXQiLAogICAgcG9pbnRlcmVudGVyOiAicG9pbnRlcm92ZXIiLAogICAgcG9pbnRlcmxlYXZlOiAicG9pbnRlcm91dCIKICB9LCBmdW5jdGlvbiAob3JpZywgZml4KSB7CiAgICBqUXVlcnkuZXZlbnQuc3BlY2lhbFtvcmlnXSA9IHsKICAgICAgZGVsZWdhdGVUeXBlOiBmaXgsCiAgICAgIGJpbmRUeXBlOiBmaXgsCiAgICAgIGhhbmRsZTogZnVuY3Rpb24gaGFuZGxlKGV2ZW50KSB7CiAgICAgICAgdmFyIHJldCwKICAgICAgICAgIHRhcmdldCA9IHRoaXMsCiAgICAgICAgICByZWxhdGVkID0gZXZlbnQucmVsYXRlZFRhcmdldCwKICAgICAgICAgIGhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iajsKCiAgICAgICAgLy8gRm9yIG1vdXNlZW50ZXIvbGVhdmUgY2FsbCB0aGUgaGFuZGxlciBpZiByZWxhdGVkIGlzIG91dHNpZGUgdGhlIHRhcmdldC4KICAgICAgICAvLyBOQjogTm8gcmVsYXRlZFRhcmdldCBpZiB0aGUgbW91c2UgbGVmdC9lbnRlcmVkIHRoZSBicm93c2VyIHdpbmRvdwogICAgICAgIGlmICghcmVsYXRlZCB8fCByZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyh0YXJnZXQsIHJlbGF0ZWQpKSB7CiAgICAgICAgICBldmVudC50eXBlID0gaGFuZGxlT2JqLm9yaWdUeXBlOwogICAgICAgICAgcmV0ID0gaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIGV2ZW50LnR5cGUgPSBmaXg7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0KICAgIH07CiAgfSk7CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBvbjogZnVuY3Rpb24gb24odHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbikgewogICAgICByZXR1cm4gX29uKHRoaXMsIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4pOwogICAgfSwKICAgIG9uZTogZnVuY3Rpb24gb25lKHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4pIHsKICAgICAgcmV0dXJuIF9vbih0aGlzLCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAxKTsKICAgIH0sCiAgICBvZmY6IGZ1bmN0aW9uIG9mZih0eXBlcywgc2VsZWN0b3IsIGZuKSB7CiAgICAgIHZhciBoYW5kbGVPYmosIHR5cGU7CiAgICAgIGlmICh0eXBlcyAmJiB0eXBlcy5wcmV2ZW50RGVmYXVsdCAmJiB0eXBlcy5oYW5kbGVPYmopIHsKICAgICAgICAvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50CiAgICAgICAgaGFuZGxlT2JqID0gdHlwZXMuaGFuZGxlT2JqOwogICAgICAgIGpRdWVyeSh0eXBlcy5kZWxlZ2F0ZVRhcmdldCkub2ZmKGhhbmRsZU9iai5uYW1lc3BhY2UgPyBoYW5kbGVPYmoub3JpZ1R5cGUgKyAiLiIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDogaGFuZGxlT2JqLm9yaWdUeXBlLCBoYW5kbGVPYmouc2VsZWN0b3IsIGhhbmRsZU9iai5oYW5kbGVyKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBpZiAoX3R5cGVvZih0eXBlcykgPT09ICJvYmplY3QiKSB7CiAgICAgICAgLy8gKCB0eXBlcy1vYmplY3QgWywgc2VsZWN0b3JdICkKICAgICAgICBmb3IgKHR5cGUgaW4gdHlwZXMpIHsKICAgICAgICAgIHRoaXMub2ZmKHR5cGUsIHNlbGVjdG9yLCB0eXBlc1t0eXBlXSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIGlmIChzZWxlY3RvciA9PT0gZmFsc2UgfHwgdHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgLy8gKCB0eXBlcyBbLCBmbl0gKQogICAgICAgIGZuID0gc2VsZWN0b3I7CiAgICAgICAgc2VsZWN0b3IgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgaWYgKGZuID09PSBmYWxzZSkgewogICAgICAgIGZuID0gcmV0dXJuRmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgalF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCB0eXBlcywgZm4sIHNlbGVjdG9yKTsKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgdmFyCiAgICAvLyBTdXBwb3J0OiBJRSA8PTEwIC0gMTEsIEVkZ2UgMTIgLSAxMyBvbmx5CiAgICAvLyBJbiBJRS9FZGdlIHVzaW5nIHJlZ2V4IGdyb3VwcyBoZXJlIGNhdXNlcyBzZXZlcmUgc2xvd2Rvd25zLgogICAgLy8gU2VlIGh0dHBzOi8vY29ubmVjdC5taWNyb3NvZnQuY29tL0lFL2ZlZWRiYWNrL2RldGFpbHMvMTczNjUxMi8KICAgIHJub0lubmVyaHRtbCA9IC88c2NyaXB0fDxzdHlsZXw8bGluay9pLAogICAgLy8gY2hlY2tlZD0iY2hlY2tlZCIgb3IgY2hlY2tlZAogICAgcmNoZWNrZWQgPSAvY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSwKICAgIHJjbGVhblNjcmlwdCA9IC9eXHMqPCEoPzpcW0NEQVRBXFt8LS0pfCg/OlxdXF18LS0pPlxzKiQvZzsKCiAgLy8gUHJlZmVyIGEgdGJvZHkgb3ZlciBpdHMgcGFyZW50IHRhYmxlIGZvciBjb250YWluaW5nIG5ldyByb3dzCiAgZnVuY3Rpb24gbWFuaXB1bGF0aW9uVGFyZ2V0KGVsZW0sIGNvbnRlbnQpIHsKICAgIGlmIChub2RlTmFtZShlbGVtLCAidGFibGUiKSAmJiBub2RlTmFtZShjb250ZW50Lm5vZGVUeXBlICE9PSAxMSA/IGNvbnRlbnQgOiBjb250ZW50LmZpcnN0Q2hpbGQsICJ0ciIpKSB7CiAgICAgIHJldHVybiBqUXVlcnkoZWxlbSkuY2hpbGRyZW4oInRib2R5IilbMF0gfHwgZWxlbTsKICAgIH0KICAgIHJldHVybiBlbGVtOwogIH0KCiAgLy8gUmVwbGFjZS9yZXN0b3JlIHRoZSB0eXBlIGF0dHJpYnV0ZSBvZiBzY3JpcHQgZWxlbWVudHMgZm9yIHNhZmUgRE9NIG1hbmlwdWxhdGlvbgogIGZ1bmN0aW9uIGRpc2FibGVTY3JpcHQoZWxlbSkgewogICAgZWxlbS50eXBlID0gKGVsZW0uZ2V0QXR0cmlidXRlKCJ0eXBlIikgIT09IG51bGwpICsgIi8iICsgZWxlbS50eXBlOwogICAgcmV0dXJuIGVsZW07CiAgfQogIGZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoZWxlbSkgewogICAgaWYgKChlbGVtLnR5cGUgfHwgIiIpLnNsaWNlKDAsIDUpID09PSAidHJ1ZS8iKSB7CiAgICAgIGVsZW0udHlwZSA9IGVsZW0udHlwZS5zbGljZSg1KTsKICAgIH0gZWxzZSB7CiAgICAgIGVsZW0ucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIik7CiAgICB9CiAgICByZXR1cm4gZWxlbTsKICB9CiAgZnVuY3Rpb24gY2xvbmVDb3B5RXZlbnQoc3JjLCBkZXN0KSB7CiAgICB2YXIgaSwgbCwgdHlwZSwgcGRhdGFPbGQsIHVkYXRhT2xkLCB1ZGF0YUN1ciwgZXZlbnRzOwogICAgaWYgKGRlc3Qubm9kZVR5cGUgIT09IDEpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIDEuIENvcHkgcHJpdmF0ZSBkYXRhOiBldmVudHMsIGhhbmRsZXJzLCBldGMuCiAgICBpZiAoZGF0YVByaXYuaGFzRGF0YShzcmMpKSB7CiAgICAgIHBkYXRhT2xkID0gZGF0YVByaXYuZ2V0KHNyYyk7CiAgICAgIGV2ZW50cyA9IHBkYXRhT2xkLmV2ZW50czsKICAgICAgaWYgKGV2ZW50cykgewogICAgICAgIGRhdGFQcml2LnJlbW92ZShkZXN0LCAiaGFuZGxlIGV2ZW50cyIpOwogICAgICAgIGZvciAodHlwZSBpbiBldmVudHMpIHsKICAgICAgICAgIGZvciAoaSA9IDAsIGwgPSBldmVudHNbdHlwZV0ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgIGpRdWVyeS5ldmVudC5hZGQoZGVzdCwgdHlwZSwgZXZlbnRzW3R5cGVdW2ldKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvLyAyLiBDb3B5IHVzZXIgZGF0YQogICAgaWYgKGRhdGFVc2VyLmhhc0RhdGEoc3JjKSkgewogICAgICB1ZGF0YU9sZCA9IGRhdGFVc2VyLmFjY2VzcyhzcmMpOwogICAgICB1ZGF0YUN1ciA9IGpRdWVyeS5leHRlbmQoe30sIHVkYXRhT2xkKTsKICAgICAgZGF0YVVzZXIuc2V0KGRlc3QsIHVkYXRhQ3VyKTsKICAgIH0KICB9CgogIC8vIEZpeCBJRSBidWdzLCBzZWUgc3VwcG9ydCB0ZXN0cwogIGZ1bmN0aW9uIGZpeElucHV0KHNyYywgZGVzdCkgewogICAgdmFyIG5vZGVOYW1lID0gZGVzdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoKICAgIC8vIEZhaWxzIHRvIHBlcnNpc3QgdGhlIGNoZWNrZWQgc3RhdGUgb2YgYSBjbG9uZWQgY2hlY2tib3ggb3IgcmFkaW8gYnV0dG9uLgogICAgaWYgKG5vZGVOYW1lID09PSAiaW5wdXQiICYmIHJjaGVja2FibGVUeXBlLnRlc3Qoc3JjLnR5cGUpKSB7CiAgICAgIGRlc3QuY2hlY2tlZCA9IHNyYy5jaGVja2VkOwoKICAgICAgLy8gRmFpbHMgdG8gcmV0dXJuIHRoZSBzZWxlY3RlZCBvcHRpb24gdG8gdGhlIGRlZmF1bHQgc2VsZWN0ZWQgc3RhdGUgd2hlbiBjbG9uaW5nIG9wdGlvbnMKICAgIH0gZWxzZSBpZiAobm9kZU5hbWUgPT09ICJpbnB1dCIgfHwgbm9kZU5hbWUgPT09ICJ0ZXh0YXJlYSIpIHsKICAgICAgZGVzdC5kZWZhdWx0VmFsdWUgPSBzcmMuZGVmYXVsdFZhbHVlOwogICAgfQogIH0KICBmdW5jdGlvbiBkb21NYW5pcChjb2xsZWN0aW9uLCBhcmdzLCBjYWxsYmFjaywgaWdub3JlZCkgewogICAgLy8gRmxhdHRlbiBhbnkgbmVzdGVkIGFycmF5cwogICAgYXJncyA9IGZsYXQoYXJncyk7CiAgICB2YXIgZnJhZ21lbnQsCiAgICAgIGZpcnN0LAogICAgICBzY3JpcHRzLAogICAgICBoYXNTY3JpcHRzLAogICAgICBub2RlLAogICAgICBkb2MsCiAgICAgIGkgPSAwLAogICAgICBsID0gY29sbGVjdGlvbi5sZW5ndGgsCiAgICAgIGlOb0Nsb25lID0gbCAtIDEsCiAgICAgIHZhbHVlID0gYXJnc1swXSwKICAgICAgdmFsdWVJc0Z1bmN0aW9uID0gaXNGdW5jdGlvbih2YWx1ZSk7CgogICAgLy8gV2UgY2FuJ3QgY2xvbmVOb2RlIGZyYWdtZW50cyB0aGF0IGNvbnRhaW4gY2hlY2tlZCwgaW4gV2ViS2l0CiAgICBpZiAodmFsdWVJc0Z1bmN0aW9uIHx8IGwgPiAxICYmIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgIXN1cHBvcnQuY2hlY2tDbG9uZSAmJiByY2hlY2tlZC50ZXN0KHZhbHVlKSkgewogICAgICByZXR1cm4gY29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgIHZhciBzZWxmID0gY29sbGVjdGlvbi5lcShpbmRleCk7CiAgICAgICAgaWYgKHZhbHVlSXNGdW5jdGlvbikgewogICAgICAgICAgYXJnc1swXSA9IHZhbHVlLmNhbGwodGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpKTsKICAgICAgICB9CiAgICAgICAgZG9tTWFuaXAoc2VsZiwgYXJncywgY2FsbGJhY2ssIGlnbm9yZWQpOwogICAgICB9KTsKICAgIH0KICAgIGlmIChsKSB7CiAgICAgIGZyYWdtZW50ID0gYnVpbGRGcmFnbWVudChhcmdzLCBjb2xsZWN0aW9uWzBdLm93bmVyRG9jdW1lbnQsIGZhbHNlLCBjb2xsZWN0aW9uLCBpZ25vcmVkKTsKICAgICAgZmlyc3QgPSBmcmFnbWVudC5maXJzdENoaWxkOwogICAgICBpZiAoZnJhZ21lbnQuY2hpbGROb2Rlcy5sZW5ndGggPT09IDEpIHsKICAgICAgICBmcmFnbWVudCA9IGZpcnN0OwogICAgICB9CgogICAgICAvLyBSZXF1aXJlIGVpdGhlciBuZXcgY29udGVudCBvciBhbiBpbnRlcmVzdCBpbiBpZ25vcmVkIGVsZW1lbnRzIHRvIGludm9rZSB0aGUgY2FsbGJhY2sKICAgICAgaWYgKGZpcnN0IHx8IGlnbm9yZWQpIHsKICAgICAgICBzY3JpcHRzID0galF1ZXJ5Lm1hcChnZXRBbGwoZnJhZ21lbnQsICJzY3JpcHQiKSwgZGlzYWJsZVNjcmlwdCk7CiAgICAgICAgaGFzU2NyaXB0cyA9IHNjcmlwdHMubGVuZ3RoOwoKICAgICAgICAvLyBVc2UgdGhlIG9yaWdpbmFsIGZyYWdtZW50IGZvciB0aGUgbGFzdCBpdGVtCiAgICAgICAgLy8gaW5zdGVhZCBvZiB0aGUgZmlyc3QgYmVjYXVzZSBpdCBjYW4gZW5kIHVwCiAgICAgICAgLy8gYmVpbmcgZW1wdGllZCBpbmNvcnJlY3RseSBpbiBjZXJ0YWluIHNpdHVhdGlvbnMgKCM4MDcwKS4KICAgICAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICAgICAgbm9kZSA9IGZyYWdtZW50OwogICAgICAgICAgaWYgKGkgIT09IGlOb0Nsb25lKSB7CiAgICAgICAgICAgIG5vZGUgPSBqUXVlcnkuY2xvbmUobm9kZSwgdHJ1ZSwgdHJ1ZSk7CgogICAgICAgICAgICAvLyBLZWVwIHJlZmVyZW5jZXMgdG8gY2xvbmVkIHNjcmlwdHMgZm9yIGxhdGVyIHJlc3RvcmF0aW9uCiAgICAgICAgICAgIGlmIChoYXNTY3JpcHRzKSB7CiAgICAgICAgICAgICAgLy8gU3VwcG9ydDogQW5kcm9pZCA8PTQuMCBvbmx5LCBQaGFudG9tSlMgMSBvbmx5CiAgICAgICAgICAgICAgLy8gcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdAogICAgICAgICAgICAgIGpRdWVyeS5tZXJnZShzY3JpcHRzLCBnZXRBbGwobm9kZSwgInNjcmlwdCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY2FsbGJhY2suY2FsbChjb2xsZWN0aW9uW2ldLCBub2RlLCBpKTsKICAgICAgICB9CiAgICAgICAgaWYgKGhhc1NjcmlwdHMpIHsKICAgICAgICAgIGRvYyA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5vd25lckRvY3VtZW50OwoKICAgICAgICAgIC8vIFJlZW5hYmxlIHNjcmlwdHMKICAgICAgICAgIGpRdWVyeS5tYXAoc2NyaXB0cywgcmVzdG9yZVNjcmlwdCk7CgogICAgICAgICAgLy8gRXZhbHVhdGUgZXhlY3V0YWJsZSBzY3JpcHRzIG9uIGZpcnN0IGRvY3VtZW50IGluc2VydGlvbgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGhhc1NjcmlwdHM7IGkrKykgewogICAgICAgICAgICBub2RlID0gc2NyaXB0c1tpXTsKICAgICAgICAgICAgaWYgKHJzY3JpcHRUeXBlLnRlc3Qobm9kZS50eXBlIHx8ICIiKSAmJiAhZGF0YVByaXYuYWNjZXNzKG5vZGUsICJnbG9iYWxFdmFsIikgJiYgalF1ZXJ5LmNvbnRhaW5zKGRvYywgbm9kZSkpIHsKICAgICAgICAgICAgICBpZiAobm9kZS5zcmMgJiYgKG5vZGUudHlwZSB8fCAiIikudG9Mb3dlckNhc2UoKSAhPT0gIm1vZHVsZSIpIHsKICAgICAgICAgICAgICAgIC8vIE9wdGlvbmFsIEFKQVggZGVwZW5kZW5jeSwgYnV0IHdvbid0IHJ1biBzY3JpcHRzIGlmIG5vdCBwcmVzZW50CiAgICAgICAgICAgICAgICBpZiAoalF1ZXJ5Ll9ldmFsVXJsICYmICFub2RlLm5vTW9kdWxlKSB7CiAgICAgICAgICAgICAgICAgIGpRdWVyeS5fZXZhbFVybChub2RlLnNyYywgewogICAgICAgICAgICAgICAgICAgIG5vbmNlOiBub2RlLm5vbmNlIHx8IG5vZGUuZ2V0QXR0cmlidXRlKCJub25jZSIpCiAgICAgICAgICAgICAgICAgIH0sIGRvYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIERPTUV2YWwobm9kZS50ZXh0Q29udGVudC5yZXBsYWNlKHJjbGVhblNjcmlwdCwgIiIpLCBub2RlLCBkb2MpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbGxlY3Rpb247CiAgfQogIGZ1bmN0aW9uIF9yZW1vdmUoZWxlbSwgc2VsZWN0b3IsIGtlZXBEYXRhKSB7CiAgICB2YXIgbm9kZSwKICAgICAgbm9kZXMgPSBzZWxlY3RvciA/IGpRdWVyeS5maWx0ZXIoc2VsZWN0b3IsIGVsZW0pIDogZWxlbSwKICAgICAgaSA9IDA7CiAgICBmb3IgKDsgKG5vZGUgPSBub2Rlc1tpXSkgIT0gbnVsbDsgaSsrKSB7CiAgICAgIGlmICgha2VlcERhdGEgJiYgbm9kZS5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgIGpRdWVyeS5jbGVhbkRhdGEoZ2V0QWxsKG5vZGUpKTsKICAgICAgfQogICAgICBpZiAobm9kZS5wYXJlbnROb2RlKSB7CiAgICAgICAgaWYgKGtlZXBEYXRhICYmIGlzQXR0YWNoZWQobm9kZSkpIHsKICAgICAgICAgIHNldEdsb2JhbEV2YWwoZ2V0QWxsKG5vZGUsICJzY3JpcHQiKSk7CiAgICAgICAgfQogICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGVsZW07CiAgfQogIGpRdWVyeS5leHRlbmQoewogICAgaHRtbFByZWZpbHRlcjogZnVuY3Rpb24gaHRtbFByZWZpbHRlcihodG1sKSB7CiAgICAgIHJldHVybiBodG1sOwogICAgfSwKICAgIGNsb25lOiBmdW5jdGlvbiBjbG9uZShlbGVtLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cykgewogICAgICB2YXIgaSwKICAgICAgICBsLAogICAgICAgIHNyY0VsZW1lbnRzLAogICAgICAgIGRlc3RFbGVtZW50cywKICAgICAgICBjbG9uZSA9IGVsZW0uY2xvbmVOb2RlKHRydWUpLAogICAgICAgIGluUGFnZSA9IGlzQXR0YWNoZWQoZWxlbSk7CgogICAgICAvLyBGaXggSUUgY2xvbmluZyBpc3N1ZXMKICAgICAgaWYgKCFzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkICYmIChlbGVtLm5vZGVUeXBlID09PSAxIHx8IGVsZW0ubm9kZVR5cGUgPT09IDExKSAmJiAhalF1ZXJ5LmlzWE1MRG9jKGVsZW0pKSB7CiAgICAgICAgLy8gV2UgZXNjaGV3IFNpenpsZSBoZXJlIGZvciBwZXJmb3JtYW5jZSByZWFzb25zOiBodHRwczovL2pzcGVyZi5jb20vZ2V0YWxsLXZzLXNpenpsZS8yCiAgICAgICAgZGVzdEVsZW1lbnRzID0gZ2V0QWxsKGNsb25lKTsKICAgICAgICBzcmNFbGVtZW50cyA9IGdldEFsbChlbGVtKTsKICAgICAgICBmb3IgKGkgPSAwLCBsID0gc3JjRWxlbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBmaXhJbnB1dChzcmNFbGVtZW50c1tpXSwgZGVzdEVsZW1lbnRzW2ldKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIENvcHkgdGhlIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCB0byB0aGUgY2xvbmUKICAgICAgaWYgKGRhdGFBbmRFdmVudHMpIHsKICAgICAgICBpZiAoZGVlcERhdGFBbmRFdmVudHMpIHsKICAgICAgICAgIHNyY0VsZW1lbnRzID0gc3JjRWxlbWVudHMgfHwgZ2V0QWxsKGVsZW0pOwogICAgICAgICAgZGVzdEVsZW1lbnRzID0gZGVzdEVsZW1lbnRzIHx8IGdldEFsbChjbG9uZSk7CiAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gc3JjRWxlbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgIGNsb25lQ29weUV2ZW50KHNyY0VsZW1lbnRzW2ldLCBkZXN0RWxlbWVudHNbaV0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjbG9uZUNvcHlFdmVudChlbGVtLCBjbG9uZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBQcmVzZXJ2ZSBzY3JpcHQgZXZhbHVhdGlvbiBoaXN0b3J5CiAgICAgIGRlc3RFbGVtZW50cyA9IGdldEFsbChjbG9uZSwgInNjcmlwdCIpOwogICAgICBpZiAoZGVzdEVsZW1lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICBzZXRHbG9iYWxFdmFsKGRlc3RFbGVtZW50cywgIWluUGFnZSAmJiBnZXRBbGwoZWxlbSwgInNjcmlwdCIpKTsKICAgICAgfQoKICAgICAgLy8gUmV0dXJuIHRoZSBjbG9uZWQgc2V0CiAgICAgIHJldHVybiBjbG9uZTsKICAgIH0sCiAgICBjbGVhbkRhdGE6IGZ1bmN0aW9uIGNsZWFuRGF0YShlbGVtcykgewogICAgICB2YXIgZGF0YSwKICAgICAgICBlbGVtLAogICAgICAgIHR5cGUsCiAgICAgICAgc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsLAogICAgICAgIGkgPSAwOwogICAgICBmb3IgKDsgKGVsZW0gPSBlbGVtc1tpXSkgIT09IHVuZGVmaW5lZDsgaSsrKSB7CiAgICAgICAgaWYgKGFjY2VwdERhdGEoZWxlbSkpIHsKICAgICAgICAgIGlmIChkYXRhID0gZWxlbVtkYXRhUHJpdi5leHBhbmRvXSkgewogICAgICAgICAgICBpZiAoZGF0YS5ldmVudHMpIHsKICAgICAgICAgICAgICBmb3IgKHR5cGUgaW4gZGF0YS5ldmVudHMpIHsKICAgICAgICAgICAgICAgIGlmIChzcGVjaWFsW3R5cGVdKSB7CiAgICAgICAgICAgICAgICAgIGpRdWVyeS5ldmVudC5yZW1vdmUoZWxlbSwgdHlwZSk7CgogICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgc2hvcnRjdXQgdG8gYXZvaWQgalF1ZXJ5LmV2ZW50LnJlbW92ZSdzIG92ZXJoZWFkCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBqUXVlcnkucmVtb3ZlRXZlbnQoZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3VwcG9ydDogQ2hyb21lIDw9MzUgLSA0NSsKICAgICAgICAgICAgLy8gQXNzaWduIHVuZGVmaW5lZCBpbnN0ZWFkIG9mIHVzaW5nIGRlbGV0ZSwgc2VlIERhdGEjcmVtb3ZlCiAgICAgICAgICAgIGVsZW1bZGF0YVByaXYuZXhwYW5kb10gPSB1bmRlZmluZWQ7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZWxlbVtkYXRhVXNlci5leHBhbmRvXSkgewogICAgICAgICAgICAvLyBTdXBwb3J0OiBDaHJvbWUgPD0zNSAtIDQ1KwogICAgICAgICAgICAvLyBBc3NpZ24gdW5kZWZpbmVkIGluc3RlYWQgb2YgdXNpbmcgZGVsZXRlLCBzZWUgRGF0YSNyZW1vdmUKICAgICAgICAgICAgZWxlbVtkYXRhVXNlci5leHBhbmRvXSA9IHVuZGVmaW5lZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKICBqUXVlcnkuZm4uZXh0ZW5kKHsKICAgIGRldGFjaDogZnVuY3Rpb24gZGV0YWNoKHNlbGVjdG9yKSB7CiAgICAgIHJldHVybiBfcmVtb3ZlKHRoaXMsIHNlbGVjdG9yLCB0cnVlKTsKICAgIH0sCiAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShzZWxlY3RvcikgewogICAgICByZXR1cm4gX3JlbW92ZSh0aGlzLCBzZWxlY3Rvcik7CiAgICB9LAogICAgdGV4dDogZnVuY3Rpb24gdGV4dCh2YWx1ZSkgewogICAgICByZXR1cm4gYWNjZXNzKHRoaXMsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8galF1ZXJ5LnRleHQodGhpcykgOiB0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5KSB7CiAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQgPSB2YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGgpOwogICAgfSwKICAgIGFwcGVuZDogZnVuY3Rpb24gYXBwZW5kKCkgewogICAgICByZXR1cm4gZG9tTWFuaXAodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIGlmICh0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkpIHsKICAgICAgICAgIHZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQodGhpcywgZWxlbSk7CiAgICAgICAgICB0YXJnZXQuYXBwZW5kQ2hpbGQoZWxlbSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBwcmVwZW5kOiBmdW5jdGlvbiBwcmVwZW5kKCkgewogICAgICByZXR1cm4gZG9tTWFuaXAodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIGlmICh0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkpIHsKICAgICAgICAgIHZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQodGhpcywgZWxlbSk7CiAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKGVsZW0sIHRhcmdldC5maXJzdENoaWxkKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGJlZm9yZTogZnVuY3Rpb24gYmVmb3JlKCkgewogICAgICByZXR1cm4gZG9tTWFuaXAodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIGlmICh0aGlzLnBhcmVudE5vZGUpIHsKICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZWxlbSwgdGhpcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBhZnRlcjogZnVuY3Rpb24gYWZ0ZXIoKSB7CiAgICAgIHJldHVybiBkb21NYW5pcCh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgaWYgKHRoaXMucGFyZW50Tm9kZSkgewogICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLCB0aGlzLm5leHRTaWJsaW5nKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGVtcHR5OiBmdW5jdGlvbiBlbXB0eSgpIHsKICAgICAgdmFyIGVsZW0sCiAgICAgICAgaSA9IDA7CiAgICAgIGZvciAoOyAoZWxlbSA9IHRoaXNbaV0pICE9IG51bGw7IGkrKykgewogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxKSB7CiAgICAgICAgICAvLyBQcmV2ZW50IG1lbW9yeSBsZWFrcwogICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSwgZmFsc2UpKTsKCiAgICAgICAgICAvLyBSZW1vdmUgYW55IHJlbWFpbmluZyBub2RlcwogICAgICAgICAgZWxlbS50ZXh0Q29udGVudCA9ICIiOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBjbG9uZTogZnVuY3Rpb24gY2xvbmUoZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMpIHsKICAgICAgZGF0YUFuZEV2ZW50cyA9IGRhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGZhbHNlIDogZGF0YUFuZEV2ZW50czsKICAgICAgZGVlcERhdGFBbmRFdmVudHMgPSBkZWVwRGF0YUFuZEV2ZW50cyA9PSBudWxsID8gZGF0YUFuZEV2ZW50cyA6IGRlZXBEYXRhQW5kRXZlbnRzOwogICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBqUXVlcnkuY2xvbmUodGhpcywgZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMpOwogICAgICB9KTsKICAgIH0sCiAgICBodG1sOiBmdW5jdGlvbiBodG1sKHZhbHVlKSB7CiAgICAgIHJldHVybiBhY2Nlc3ModGhpcywgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFyIGVsZW0gPSB0aGlzWzBdIHx8IHt9LAogICAgICAgICAgaSA9IDAsCiAgICAgICAgICBsID0gdGhpcy5sZW5ndGg7CiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgcmV0dXJuIGVsZW0uaW5uZXJIVE1MOwogICAgICAgIH0KCiAgICAgICAgLy8gU2VlIGlmIHdlIGNhbiB0YWtlIGEgc2hvcnRjdXQgYW5kIGp1c3QgdXNlIGlubmVySFRNTAogICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmICFybm9Jbm5lcmh0bWwudGVzdCh2YWx1ZSkgJiYgIXdyYXBNYXBbKHJ0YWdOYW1lLmV4ZWModmFsdWUpIHx8IFsiIiwgIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSkgewogICAgICAgICAgdmFsdWUgPSBqUXVlcnkuaHRtbFByZWZpbHRlcih2YWx1ZSk7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICAgIGVsZW0gPSB0aGlzW2ldIHx8IHt9OwoKICAgICAgICAgICAgICAvLyBSZW1vdmUgZWxlbWVudCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3MKICAgICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSwgZmFsc2UpKTsKICAgICAgICAgICAgICAgIGVsZW0uaW5uZXJIVE1MID0gdmFsdWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsZW0gPSAwOwoKICAgICAgICAgICAgLy8gSWYgdXNpbmcgaW5uZXJIVE1MIHRocm93cyBhbiBleGNlcHRpb24sIHVzZSB0aGUgZmFsbGJhY2sgbWV0aG9kCiAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH0KICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgdGhpcy5lbXB0eSgpLmFwcGVuZCh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCk7CiAgICB9LAogICAgcmVwbGFjZVdpdGg6IGZ1bmN0aW9uIHJlcGxhY2VXaXRoKCkgewogICAgICB2YXIgaWdub3JlZCA9IFtdOwoKICAgICAgLy8gTWFrZSB0aGUgY2hhbmdlcywgcmVwbGFjaW5nIGVhY2ggbm9uLWlnbm9yZWQgY29udGV4dCBlbGVtZW50IHdpdGggdGhlIG5ldyBjb250ZW50CiAgICAgIHJldHVybiBkb21NYW5pcCh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTsKICAgICAgICBpZiAoalF1ZXJ5LmluQXJyYXkodGhpcywgaWdub3JlZCkgPCAwKSB7CiAgICAgICAgICBqUXVlcnkuY2xlYW5EYXRhKGdldEFsbCh0aGlzKSk7CiAgICAgICAgICBpZiAocGFyZW50KSB7CiAgICAgICAgICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQoZWxlbSwgdGhpcyk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBGb3JjZSBjYWxsYmFjayBpbnZvY2F0aW9uCiAgICAgIH0sIGlnbm9yZWQpOwogICAgfQogIH0pOwogIGpRdWVyeS5lYWNoKHsKICAgIGFwcGVuZFRvOiAiYXBwZW5kIiwKICAgIHByZXBlbmRUbzogInByZXBlbmQiLAogICAgaW5zZXJ0QmVmb3JlOiAiYmVmb3JlIiwKICAgIGluc2VydEFmdGVyOiAiYWZ0ZXIiLAogICAgcmVwbGFjZUFsbDogInJlcGxhY2VXaXRoIgogIH0sIGZ1bmN0aW9uIChuYW1lLCBvcmlnaW5hbCkgewogICAgalF1ZXJ5LmZuW25hbWVdID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgIHZhciBlbGVtcywKICAgICAgICByZXQgPSBbXSwKICAgICAgICBpbnNlcnQgPSBqUXVlcnkoc2VsZWN0b3IpLAogICAgICAgIGxhc3QgPSBpbnNlcnQubGVuZ3RoIC0gMSwKICAgICAgICBpID0gMDsKICAgICAgZm9yICg7IGkgPD0gbGFzdDsgaSsrKSB7CiAgICAgICAgZWxlbXMgPSBpID09PSBsYXN0ID8gdGhpcyA6IHRoaXMuY2xvbmUodHJ1ZSk7CiAgICAgICAgalF1ZXJ5KGluc2VydFtpXSlbb3JpZ2luYWxdKGVsZW1zKTsKCiAgICAgICAgLy8gU3VwcG9ydDogQW5kcm9pZCA8PTQuMCBvbmx5LCBQaGFudG9tSlMgMSBvbmx5CiAgICAgICAgLy8gLmdldCgpIGJlY2F1c2UgcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdAogICAgICAgIHB1c2guYXBwbHkocmV0LCBlbGVtcy5nZXQoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHJldCk7CiAgICB9OwogIH0pOwogIHZhciBybnVtbm9ucHggPSBuZXcgUmVnRXhwKCJeKCIgKyBwbnVtICsgIikoPyFweClbYS16JV0rJCIsICJpIik7CiAgdmFyIGdldFN0eWxlcyA9IGZ1bmN0aW9uIGdldFN0eWxlcyhlbGVtKSB7CiAgICAvLyBTdXBwb3J0OiBJRSA8PTExIG9ubHksIEZpcmVmb3ggPD0zMCAoIzE1MDk4LCAjMTQxNTApCiAgICAvLyBJRSB0aHJvd3Mgb24gZWxlbWVudHMgY3JlYXRlZCBpbiBwb3B1cHMKICAgIC8vIEZGIG1lYW53aGlsZSB0aHJvd3Mgb24gZnJhbWUgZWxlbWVudHMgdGhyb3VnaCAiZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSIKICAgIHZhciB2aWV3ID0gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3OwogICAgaWYgKCF2aWV3IHx8ICF2aWV3Lm9wZW5lcikgewogICAgICB2aWV3ID0gd2luZG93OwogICAgfQogICAgcmV0dXJuIHZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtKTsKICB9OwogIHZhciBzd2FwID0gZnVuY3Rpb24gc3dhcChlbGVtLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgdmFyIHJldCwKICAgICAgbmFtZSwKICAgICAgb2xkID0ge307CgogICAgLy8gUmVtZW1iZXIgdGhlIG9sZCB2YWx1ZXMsIGFuZCBpbnNlcnQgdGhlIG5ldyBvbmVzCiAgICBmb3IgKG5hbWUgaW4gb3B0aW9ucykgewogICAgICBvbGRbbmFtZV0gPSBlbGVtLnN0eWxlW25hbWVdOwogICAgICBlbGVtLnN0eWxlW25hbWVdID0gb3B0aW9uc1tuYW1lXTsKICAgIH0KICAgIHJldCA9IGNhbGxiYWNrLmNhbGwoZWxlbSk7CgogICAgLy8gUmV2ZXJ0IHRoZSBvbGQgdmFsdWVzCiAgICBmb3IgKG5hbWUgaW4gb3B0aW9ucykgewogICAgICBlbGVtLnN0eWxlW25hbWVdID0gb2xkW25hbWVdOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9OwogIHZhciByYm94U3R5bGUgPSBuZXcgUmVnRXhwKGNzc0V4cGFuZC5qb2luKCJ8IiksICJpIik7CiAgKGZ1bmN0aW9uICgpIHsKICAgIC8vIEV4ZWN1dGluZyBib3RoIHBpeGVsUG9zaXRpb24gJiBib3hTaXppbmdSZWxpYWJsZSB0ZXN0cyByZXF1aXJlIG9ubHkgb25lIGxheW91dAogICAgLy8gc28gdGhleSdyZSBleGVjdXRlZCBhdCB0aGUgc2FtZSB0aW1lIHRvIHNhdmUgdGhlIHNlY29uZCBjb21wdXRhdGlvbi4KICAgIGZ1bmN0aW9uIGNvbXB1dGVTdHlsZVRlc3RzKCkgewogICAgICAvLyBUaGlzIGlzIGEgc2luZ2xldG9uLCB3ZSBuZWVkIHRvIGV4ZWN1dGUgaXQgb25seSBvbmNlCiAgICAgIGlmICghZGl2KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTExMTExcHg7d2lkdGg6NjBweDsiICsgIm1hcmdpbi10b3A6MXB4O3BhZGRpbmc6MDtib3JkZXI6MCI7CiAgICAgIGRpdi5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7Ym94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnNjcm9sbDsiICsgIm1hcmdpbjphdXRvO2JvcmRlcjoxcHg7cGFkZGluZzoxcHg7IiArICJ3aWR0aDo2MCU7dG9wOjElIjsKICAgICAgZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGNvbnRhaW5lcikuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgdmFyIGRpdlN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2KTsKICAgICAgcGl4ZWxQb3NpdGlvblZhbCA9IGRpdlN0eWxlLnRvcCAhPT0gIjElIjsKCiAgICAgIC8vIFN1cHBvcnQ6IEFuZHJvaWQgNC4wIC0gNC4zIG9ubHksIEZpcmVmb3ggPD0zIC0gNDQKICAgICAgcmVsaWFibGVNYXJnaW5MZWZ0VmFsID0gcm91bmRQaXhlbE1lYXN1cmVzKGRpdlN0eWxlLm1hcmdpbkxlZnQpID09PSAxMjsKCiAgICAgIC8vIFN1cHBvcnQ6IEFuZHJvaWQgNC4wIC0gNC4zIG9ubHksIFNhZmFyaSA8PTkuMSAtIDEwLjEsIGlPUyA8PTcuMCAtIDkuMwogICAgICAvLyBTb21lIHN0eWxlcyBjb21lIGJhY2sgd2l0aCBwZXJjZW50YWdlIHZhbHVlcywgZXZlbiB0aG91Z2ggdGhleSBzaG91bGRuJ3QKICAgICAgZGl2LnN0eWxlLnJpZ2h0ID0gIjYwJSI7CiAgICAgIHBpeGVsQm94U3R5bGVzVmFsID0gcm91bmRQaXhlbE1lYXN1cmVzKGRpdlN0eWxlLnJpZ2h0KSA9PT0gMzY7CgogICAgICAvLyBTdXBwb3J0OiBJRSA5IC0gMTEgb25seQogICAgICAvLyBEZXRlY3QgbWlzcmVwb3J0aW5nIG9mIGNvbnRlbnQgZGltZW5zaW9ucyBmb3IgYm94LXNpemluZzpib3JkZXItYm94IGVsZW1lbnRzCiAgICAgIGJveFNpemluZ1JlbGlhYmxlVmFsID0gcm91bmRQaXhlbE1lYXN1cmVzKGRpdlN0eWxlLndpZHRoKSA9PT0gMzY7CgogICAgICAvLyBTdXBwb3J0OiBJRSA5IG9ubHkKICAgICAgLy8gRGV0ZWN0IG92ZXJmbG93OnNjcm9sbCBzY3Jld2luZXNzIChnaC0zNjk5KQogICAgICAvLyBTdXBwb3J0OiBDaHJvbWUgPD02NAogICAgICAvLyBEb24ndCBnZXQgdHJpY2tlZCB3aGVuIHpvb20gYWZmZWN0cyBvZmZzZXRXaWR0aCAoZ2gtNDAyOSkKICAgICAgZGl2LnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsKICAgICAgc2Nyb2xsYm94U2l6ZVZhbCA9IHJvdW5kUGl4ZWxNZWFzdXJlcyhkaXYub2Zmc2V0V2lkdGggLyAzKSA9PT0gMTI7CiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVDaGlsZChjb250YWluZXIpOwoKICAgICAgLy8gTnVsbGlmeSB0aGUgZGl2IHNvIGl0IHdvdWxkbid0IGJlIHN0b3JlZCBpbiB0aGUgbWVtb3J5IGFuZAogICAgICAvLyBpdCB3aWxsIGFsc28gYmUgYSBzaWduIHRoYXQgY2hlY2tzIGFscmVhZHkgcGVyZm9ybWVkCiAgICAgIGRpdiA9IG51bGw7CiAgICB9CiAgICBmdW5jdGlvbiByb3VuZFBpeGVsTWVhc3VyZXMobWVhc3VyZSkgewogICAgICByZXR1cm4gTWF0aC5yb3VuZChwYXJzZUZsb2F0KG1lYXN1cmUpKTsKICAgIH0KICAgIHZhciBwaXhlbFBvc2l0aW9uVmFsLAogICAgICBib3hTaXppbmdSZWxpYWJsZVZhbCwKICAgICAgc2Nyb2xsYm94U2l6ZVZhbCwKICAgICAgcGl4ZWxCb3hTdHlsZXNWYWwsCiAgICAgIHJlbGlhYmxlVHJEaW1lbnNpb25zVmFsLAogICAgICByZWxpYWJsZU1hcmdpbkxlZnRWYWwsCiAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLAogICAgICBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKCiAgICAvLyBGaW5pc2ggZWFybHkgaW4gbGltaXRlZCAobm9uLWJyb3dzZXIpIGVudmlyb25tZW50cwogICAgaWYgKCFkaXYuc3R5bGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIFN1cHBvcnQ6IElFIDw9OSAtIDExIG9ubHkKICAgIC8vIFN0eWxlIG9mIGNsb25lZCBlbGVtZW50IGFmZmVjdHMgc291cmNlIGVsZW1lbnQgY2xvbmVkICgjODkwOCkKICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICJjb250ZW50LWJveCI7CiAgICBkaXYuY2xvbmVOb2RlKHRydWUpLnN0eWxlLmJhY2tncm91bmRDbGlwID0gIiI7CiAgICBzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSA9IGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9PT0gImNvbnRlbnQtYm94IjsKICAgIGpRdWVyeS5leHRlbmQoc3VwcG9ydCwgewogICAgICBib3hTaXppbmdSZWxpYWJsZTogZnVuY3Rpb24gYm94U2l6aW5nUmVsaWFibGUoKSB7CiAgICAgICAgY29tcHV0ZVN0eWxlVGVzdHMoKTsKICAgICAgICByZXR1cm4gYm94U2l6aW5nUmVsaWFibGVWYWw7CiAgICAgIH0sCiAgICAgIHBpeGVsQm94U3R5bGVzOiBmdW5jdGlvbiBwaXhlbEJveFN0eWxlcygpIHsKICAgICAgICBjb21wdXRlU3R5bGVUZXN0cygpOwogICAgICAgIHJldHVybiBwaXhlbEJveFN0eWxlc1ZhbDsKICAgICAgfSwKICAgICAgcGl4ZWxQb3NpdGlvbjogZnVuY3Rpb24gcGl4ZWxQb3NpdGlvbigpIHsKICAgICAgICBjb21wdXRlU3R5bGVUZXN0cygpOwogICAgICAgIHJldHVybiBwaXhlbFBvc2l0aW9uVmFsOwogICAgICB9LAogICAgICByZWxpYWJsZU1hcmdpbkxlZnQ6IGZ1bmN0aW9uIHJlbGlhYmxlTWFyZ2luTGVmdCgpIHsKICAgICAgICBjb21wdXRlU3R5bGVUZXN0cygpOwogICAgICAgIHJldHVybiByZWxpYWJsZU1hcmdpbkxlZnRWYWw7CiAgICAgIH0sCiAgICAgIHNjcm9sbGJveFNpemU6IGZ1bmN0aW9uIHNjcm9sbGJveFNpemUoKSB7CiAgICAgICAgY29tcHV0ZVN0eWxlVGVzdHMoKTsKICAgICAgICByZXR1cm4gc2Nyb2xsYm94U2l6ZVZhbDsKICAgICAgfSwKICAgICAgLy8gU3VwcG9ydDogSUUgOSAtIDExKywgRWRnZSAxNSAtIDE4KwogICAgICAvLyBJRS9FZGdlIG1pc3JlcG9ydCBgZ2V0Q29tcHV0ZWRTdHlsZWAgb2YgdGFibGUgcm93cyB3aXRoIHdpZHRoL2hlaWdodAogICAgICAvLyBzZXQgaW4gQ1NTIHdoaWxlIGBvZmZzZXQqYCBwcm9wZXJ0aWVzIHJlcG9ydCBjb3JyZWN0IHZhbHVlcy4KICAgICAgLy8gQmVoYXZpb3IgaW4gSUUgOSBpcyBtb3JlIHN1YnRsZSB0aGFuIGluIG5ld2VyIHZlcnNpb25zICYgaXQgcGFzc2VzCiAgICAgIC8vIHNvbWUgdmVyc2lvbnMgb2YgdGhpcyB0ZXN0OyBtYWtlIHN1cmUgbm90IHRvIG1ha2UgaXQgcGFzcyB0aGVyZSEKICAgICAgcmVsaWFibGVUckRpbWVuc2lvbnM6IGZ1bmN0aW9uIHJlbGlhYmxlVHJEaW1lbnNpb25zKCkgewogICAgICAgIHZhciB0YWJsZSwgdHIsIHRyQ2hpbGQsIHRyU3R5bGU7CiAgICAgICAgaWYgKHJlbGlhYmxlVHJEaW1lbnNpb25zVmFsID09IG51bGwpIHsKICAgICAgICAgIHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGFibGUiKTsKICAgICAgICAgIHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKTsKICAgICAgICAgIHRyQ2hpbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIHRhYmxlLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7bGVmdDotMTExMTFweCI7CiAgICAgICAgICB0ci5zdHlsZS5oZWlnaHQgPSAiMXB4IjsKICAgICAgICAgIHRyQ2hpbGQuc3R5bGUuaGVpZ2h0ID0gIjlweCI7CiAgICAgICAgICBkb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGFibGUpLmFwcGVuZENoaWxkKHRyKS5hcHBlbmRDaGlsZCh0ckNoaWxkKTsKICAgICAgICAgIHRyU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0cik7CiAgICAgICAgICByZWxpYWJsZVRyRGltZW5zaW9uc1ZhbCA9IHBhcnNlSW50KHRyU3R5bGUuaGVpZ2h0KSA+IDM7CiAgICAgICAgICBkb2N1bWVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGFibGUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVsaWFibGVUckRpbWVuc2lvbnNWYWw7CiAgICAgIH0KICAgIH0pOwogIH0pKCk7CiAgZnVuY3Rpb24gY3VyQ1NTKGVsZW0sIG5hbWUsIGNvbXB1dGVkKSB7CiAgICB2YXIgd2lkdGgsCiAgICAgIG1pbldpZHRoLAogICAgICBtYXhXaWR0aCwKICAgICAgcmV0LAogICAgICAvLyBTdXBwb3J0OiBGaXJlZm94IDUxKwogICAgICAvLyBSZXRyaWV2aW5nIHN0eWxlIGJlZm9yZSBjb21wdXRlZCBzb21laG93CiAgICAgIC8vIGZpeGVzIGFuIGlzc3VlIHdpdGggZ2V0dGluZyB3cm9uZyB2YWx1ZXMKICAgICAgLy8gb24gZGV0YWNoZWQgZWxlbWVudHMKICAgICAgc3R5bGUgPSBlbGVtLnN0eWxlOwogICAgY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoZWxlbSk7CgogICAgLy8gZ2V0UHJvcGVydHlWYWx1ZSBpcyBuZWVkZWQgZm9yOgogICAgLy8gICAuY3NzKCdmaWx0ZXInKSAoSUUgOSBvbmx5LCAjMTI1MzcpCiAgICAvLyAgIC5jc3MoJy0tY3VzdG9tUHJvcGVydHkpICgjMzE0NCkKICAgIGlmIChjb21wdXRlZCkgewogICAgICByZXQgPSBjb21wdXRlZC5nZXRQcm9wZXJ0eVZhbHVlKG5hbWUpIHx8IGNvbXB1dGVkW25hbWVdOwogICAgICBpZiAocmV0ID09PSAiIiAmJiAhaXNBdHRhY2hlZChlbGVtKSkgewogICAgICAgIHJldCA9IGpRdWVyeS5zdHlsZShlbGVtLCBuYW1lKTsKICAgICAgfQoKICAgICAgLy8gQSB0cmlidXRlIHRvIHRoZSAiYXdlc29tZSBoYWNrIGJ5IERlYW4gRWR3YXJkcyIKICAgICAgLy8gQW5kcm9pZCBCcm93c2VyIHJldHVybnMgcGVyY2VudGFnZSBmb3Igc29tZSB2YWx1ZXMsCiAgICAgIC8vIGJ1dCB3aWR0aCBzZWVtcyB0byBiZSByZWxpYWJseSBwaXhlbHMuCiAgICAgIC8vIFRoaXMgaXMgYWdhaW5zdCB0aGUgQ1NTT00gZHJhZnQgc3BlYzoKICAgICAgLy8gaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzc29tLyNyZXNvbHZlZC12YWx1ZXMKICAgICAgaWYgKCFzdXBwb3J0LnBpeGVsQm94U3R5bGVzKCkgJiYgcm51bW5vbnB4LnRlc3QocmV0KSAmJiByYm94U3R5bGUudGVzdChuYW1lKSkgewogICAgICAgIC8vIFJlbWVtYmVyIHRoZSBvcmlnaW5hbCB2YWx1ZXMKICAgICAgICB3aWR0aCA9IHN0eWxlLndpZHRoOwogICAgICAgIG1pbldpZHRoID0gc3R5bGUubWluV2lkdGg7CiAgICAgICAgbWF4V2lkdGggPSBzdHlsZS5tYXhXaWR0aDsKCiAgICAgICAgLy8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dAogICAgICAgIHN0eWxlLm1pbldpZHRoID0gc3R5bGUubWF4V2lkdGggPSBzdHlsZS53aWR0aCA9IHJldDsKICAgICAgICByZXQgPSBjb21wdXRlZC53aWR0aDsKCiAgICAgICAgLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwogICAgICAgIHN0eWxlLndpZHRoID0gd2lkdGg7CiAgICAgICAgc3R5bGUubWluV2lkdGggPSBtaW5XaWR0aDsKICAgICAgICBzdHlsZS5tYXhXaWR0aCA9IG1heFdpZHRoOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcmV0ICE9PSB1bmRlZmluZWQgPwogICAgLy8gU3VwcG9ydDogSUUgPD05IC0gMTEgb25seQogICAgLy8gSUUgcmV0dXJucyB6SW5kZXggdmFsdWUgYXMgYW4gaW50ZWdlci4KICAgIHJldCArICIiIDogcmV0OwogIH0KICBmdW5jdGlvbiBhZGRHZXRIb29rSWYoY29uZGl0aW9uRm4sIGhvb2tGbikgewogICAgLy8gRGVmaW5lIHRoZSBob29rLCB3ZSdsbCBjaGVjayBvbiB0aGUgZmlyc3QgcnVuIGlmIGl0J3MgcmVhbGx5IG5lZWRlZC4KICAgIHJldHVybiB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIGlmIChjb25kaXRpb25GbigpKSB7CiAgICAgICAgICAvLyBIb29rIG5vdCBuZWVkZWQgKG9yIGl0J3Mgbm90IHBvc3NpYmxlIHRvIHVzZSBpdCBkdWUKICAgICAgICAgIC8vIHRvIG1pc3NpbmcgZGVwZW5kZW5jeSksIHJlbW92ZSBpdC4KICAgICAgICAgIGRlbGV0ZSB0aGlzLmdldDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIEhvb2sgbmVlZGVkOyByZWRlZmluZSBpdCBzbyB0aGF0IHRoZSBzdXBwb3J0IHRlc3QgaXMgbm90IGV4ZWN1dGVkIGFnYWluLgogICAgICAgIHJldHVybiAodGhpcy5nZXQgPSBob29rRm4pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgIH07CiAgfQogIHZhciBjc3NQcmVmaXhlcyA9IFsiV2Via2l0IiwgIk1veiIsICJtcyJdLAogICAgZW1wdHlTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLnN0eWxlLAogICAgdmVuZG9yUHJvcHMgPSB7fTsKCiAgLy8gUmV0dXJuIGEgdmVuZG9yLXByZWZpeGVkIHByb3BlcnR5IG9yIHVuZGVmaW5lZAogIGZ1bmN0aW9uIHZlbmRvclByb3BOYW1lKG5hbWUpIHsKICAgIC8vIENoZWNrIGZvciB2ZW5kb3IgcHJlZml4ZWQgbmFtZXMKICAgIHZhciBjYXBOYW1lID0gbmFtZVswXS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKSwKICAgICAgaSA9IGNzc1ByZWZpeGVzLmxlbmd0aDsKICAgIHdoaWxlIChpLS0pIHsKICAgICAgbmFtZSA9IGNzc1ByZWZpeGVzW2ldICsgY2FwTmFtZTsKICAgICAgaWYgKG5hbWUgaW4gZW1wdHlTdHlsZSkgewogICAgICAgIHJldHVybiBuYW1lOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBSZXR1cm4gYSBwb3RlbnRpYWxseS1tYXBwZWQgalF1ZXJ5LmNzc1Byb3BzIG9yIHZlbmRvciBwcmVmaXhlZCBwcm9wZXJ0eQogIGZ1bmN0aW9uIGZpbmFsUHJvcE5hbWUobmFtZSkgewogICAgdmFyIGZpbmFsID0galF1ZXJ5LmNzc1Byb3BzW25hbWVdIHx8IHZlbmRvclByb3BzW25hbWVdOwogICAgaWYgKGZpbmFsKSB7CiAgICAgIHJldHVybiBmaW5hbDsKICAgIH0KICAgIGlmIChuYW1lIGluIGVtcHR5U3R5bGUpIHsKICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CiAgICByZXR1cm4gdmVuZG9yUHJvcHNbbmFtZV0gPSB2ZW5kb3JQcm9wTmFtZShuYW1lKSB8fCBuYW1lOwogIH0KICB2YXIKICAgIC8vIFN3YXBwYWJsZSBpZiBkaXNwbGF5IGlzIG5vbmUgb3Igc3RhcnRzIHdpdGggdGFibGUKICAgIC8vIGV4Y2VwdCAidGFibGUiLCAidGFibGUtY2VsbCIsIG9yICJ0YWJsZS1jYXB0aW9uIgogICAgLy8gU2VlIGhlcmUgZm9yIGRpc3BsYXkgdmFsdWVzOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0NTUy9kaXNwbGF5CiAgICByZGlzcGxheXN3YXAgPSAvXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sCiAgICByY3VzdG9tUHJvcCA9IC9eLS0vLAogICAgY3NzU2hvdyA9IHsKICAgICAgcG9zaXRpb246ICJhYnNvbHV0ZSIsCiAgICAgIHZpc2liaWxpdHk6ICJoaWRkZW4iLAogICAgICBkaXNwbGF5OiAiYmxvY2siCiAgICB9LAogICAgY3NzTm9ybWFsVHJhbnNmb3JtID0gewogICAgICBsZXR0ZXJTcGFjaW5nOiAiMCIsCiAgICAgIGZvbnRXZWlnaHQ6ICI0MDAiCiAgICB9OwogIGZ1bmN0aW9uIHNldFBvc2l0aXZlTnVtYmVyKF9lbGVtLCB2YWx1ZSwgc3VidHJhY3QpIHsKICAgIC8vIEFueSByZWxhdGl2ZSAoKy8tKSB2YWx1ZXMgaGF2ZSBhbHJlYWR5IGJlZW4KICAgIC8vIG5vcm1hbGl6ZWQgYXQgdGhpcyBwb2ludAogICAgdmFyIG1hdGNoZXMgPSByY3NzTnVtLmV4ZWModmFsdWUpOwogICAgcmV0dXJuIG1hdGNoZXMgPwogICAgLy8gR3VhcmQgYWdhaW5zdCB1bmRlZmluZWQgInN1YnRyYWN0IiwgZS5nLiwgd2hlbiB1c2VkIGFzIGluIGNzc0hvb2tzCiAgICBNYXRoLm1heCgwLCBtYXRjaGVzWzJdIC0gKHN1YnRyYWN0IHx8IDApKSArIChtYXRjaGVzWzNdIHx8ICJweCIpIDogdmFsdWU7CiAgfQogIGZ1bmN0aW9uIGJveE1vZGVsQWRqdXN0bWVudChlbGVtLCBkaW1lbnNpb24sIGJveCwgaXNCb3JkZXJCb3gsIHN0eWxlcywgY29tcHV0ZWRWYWwpIHsKICAgIHZhciBpID0gZGltZW5zaW9uID09PSAid2lkdGgiID8gMSA6IDAsCiAgICAgIGV4dHJhID0gMCwKICAgICAgZGVsdGEgPSAwOwoKICAgIC8vIEFkanVzdG1lbnQgbWF5IG5vdCBiZSBuZWNlc3NhcnkKICAgIGlmIChib3ggPT09IChpc0JvcmRlckJveCA/ICJib3JkZXIiIDogImNvbnRlbnQiKSkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIGZvciAoOyBpIDwgNDsgaSArPSAyKSB7CiAgICAgIC8vIEJvdGggYm94IG1vZGVscyBleGNsdWRlIG1hcmdpbgogICAgICBpZiAoYm94ID09PSAibWFyZ2luIikgewogICAgICAgIGRlbHRhICs9IGpRdWVyeS5jc3MoZWxlbSwgYm94ICsgY3NzRXhwYW5kW2ldLCB0cnVlLCBzdHlsZXMpOwogICAgICB9CgogICAgICAvLyBJZiB3ZSBnZXQgaGVyZSB3aXRoIGEgY29udGVudC1ib3gsIHdlJ3JlIHNlZWtpbmcgInBhZGRpbmciIG9yICJib3JkZXIiIG9yICJtYXJnaW4iCiAgICAgIGlmICghaXNCb3JkZXJCb3gpIHsKICAgICAgICAvLyBBZGQgcGFkZGluZwogICAgICAgIGRlbHRhICs9IGpRdWVyeS5jc3MoZWxlbSwgInBhZGRpbmciICsgY3NzRXhwYW5kW2ldLCB0cnVlLCBzdHlsZXMpOwoKICAgICAgICAvLyBGb3IgImJvcmRlciIgb3IgIm1hcmdpbiIsIGFkZCBib3JkZXIKICAgICAgICBpZiAoYm94ICE9PSAicGFkZGluZyIpIHsKICAgICAgICAgIGRlbHRhICs9IGpRdWVyeS5jc3MoZWxlbSwgImJvcmRlciIgKyBjc3NFeHBhbmRbaV0gKyAiV2lkdGgiLCB0cnVlLCBzdHlsZXMpOwoKICAgICAgICAgIC8vIEJ1dCBzdGlsbCBrZWVwIHRyYWNrIG9mIGl0IG90aGVyd2lzZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBleHRyYSArPSBqUXVlcnkuY3NzKGVsZW0sICJib3JkZXIiICsgY3NzRXhwYW5kW2ldICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzKTsKICAgICAgICB9CgogICAgICAgIC8vIElmIHdlIGdldCBoZXJlIHdpdGggYSBib3JkZXItYm94IChjb250ZW50ICsgcGFkZGluZyArIGJvcmRlciksIHdlJ3JlIHNlZWtpbmcgImNvbnRlbnQiIG9yCiAgICAgICAgLy8gInBhZGRpbmciIG9yICJtYXJnaW4iCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRm9yICJjb250ZW50Iiwgc3VidHJhY3QgcGFkZGluZwogICAgICAgIGlmIChib3ggPT09ICJjb250ZW50IikgewogICAgICAgICAgZGVsdGEgLT0galF1ZXJ5LmNzcyhlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbaV0sIHRydWUsIHN0eWxlcyk7CiAgICAgICAgfQoKICAgICAgICAvLyBGb3IgImNvbnRlbnQiIG9yICJwYWRkaW5nIiwgc3VidHJhY3QgYm9yZGVyCiAgICAgICAgaWYgKGJveCAhPT0gIm1hcmdpbiIpIHsKICAgICAgICAgIGRlbHRhIC09IGpRdWVyeS5jc3MoZWxlbSwgImJvcmRlciIgKyBjc3NFeHBhbmRbaV0gKyAiV2lkdGgiLCB0cnVlLCBzdHlsZXMpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIEFjY291bnQgZm9yIHBvc2l0aXZlIGNvbnRlbnQtYm94IHNjcm9sbCBndXR0ZXIgd2hlbiByZXF1ZXN0ZWQgYnkgcHJvdmlkaW5nIGNvbXB1dGVkVmFsCiAgICBpZiAoIWlzQm9yZGVyQm94ICYmIGNvbXB1dGVkVmFsID49IDApIHsKICAgICAgLy8gb2Zmc2V0V2lkdGgvb2Zmc2V0SGVpZ2h0IGlzIGEgcm91bmRlZCBzdW0gb2YgY29udGVudCwgcGFkZGluZywgc2Nyb2xsIGd1dHRlciwgYW5kIGJvcmRlcgogICAgICAvLyBBc3N1bWluZyBpbnRlZ2VyIHNjcm9sbCBndXR0ZXIsIHN1YnRyYWN0IHRoZSByZXN0IGFuZCByb3VuZCBkb3duCiAgICAgIGRlbHRhICs9IE1hdGgubWF4KDAsIE1hdGguY2VpbChlbGVtWyJvZmZzZXQiICsgZGltZW5zaW9uWzBdLnRvVXBwZXJDYXNlKCkgKyBkaW1lbnNpb24uc2xpY2UoMSldIC0gY29tcHV0ZWRWYWwgLSBkZWx0YSAtIGV4dHJhIC0gMC41CgogICAgICAvLyBJZiBvZmZzZXRXaWR0aC9vZmZzZXRIZWlnaHQgaXMgdW5rbm93biwgdGhlbiB3ZSBjYW4ndCBkZXRlcm1pbmUgY29udGVudC1ib3ggc2Nyb2xsIGd1dHRlcgogICAgICAvLyBVc2UgYW4gZXhwbGljaXQgemVybyB0byBhdm9pZCBOYU4gKGdoLTM5NjQpCiAgICAgICkpIHx8IDA7CiAgICB9CiAgICByZXR1cm4gZGVsdGE7CiAgfQogIGZ1bmN0aW9uIGdldFdpZHRoT3JIZWlnaHQoZWxlbSwgZGltZW5zaW9uLCBleHRyYSkgewogICAgLy8gU3RhcnQgd2l0aCBjb21wdXRlZCBzdHlsZQogICAgdmFyIHN0eWxlcyA9IGdldFN0eWxlcyhlbGVtKSwKICAgICAgLy8gVG8gYXZvaWQgZm9yY2luZyBhIHJlZmxvdywgb25seSBmZXRjaCBib3hTaXppbmcgaWYgd2UgbmVlZCBpdCAoZ2gtNDMyMikuCiAgICAgIC8vIEZha2UgY29udGVudC1ib3ggdW50aWwgd2Uga25vdyBpdCdzIG5lZWRlZCB0byBrbm93IHRoZSB0cnVlIHZhbHVlLgogICAgICBib3hTaXppbmdOZWVkZWQgPSAhc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IGV4dHJhLAogICAgICBpc0JvcmRlckJveCA9IGJveFNpemluZ05lZWRlZCAmJiBqUXVlcnkuY3NzKGVsZW0sICJib3hTaXppbmciLCBmYWxzZSwgc3R5bGVzKSA9PT0gImJvcmRlci1ib3giLAogICAgICB2YWx1ZUlzQm9yZGVyQm94ID0gaXNCb3JkZXJCb3gsCiAgICAgIHZhbCA9IGN1ckNTUyhlbGVtLCBkaW1lbnNpb24sIHN0eWxlcyksCiAgICAgIG9mZnNldFByb3AgPSAib2Zmc2V0IiArIGRpbWVuc2lvblswXS50b1VwcGVyQ2FzZSgpICsgZGltZW5zaW9uLnNsaWNlKDEpOwoKICAgIC8vIFN1cHBvcnQ6IEZpcmVmb3ggPD01NAogICAgLy8gUmV0dXJuIGEgY29uZm91bmRpbmcgbm9uLXBpeGVsIHZhbHVlIG9yIGZlaWduIGlnbm9yYW5jZSwgYXMgYXBwcm9wcmlhdGUuCiAgICBpZiAocm51bW5vbnB4LnRlc3QodmFsKSkgewogICAgICBpZiAoIWV4dHJhKSB7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgfQogICAgICB2YWwgPSAiYXV0byI7CiAgICB9CgogICAgLy8gU3VwcG9ydDogSUUgOSAtIDExIG9ubHkKICAgIC8vIFVzZSBvZmZzZXRXaWR0aC9vZmZzZXRIZWlnaHQgZm9yIHdoZW4gYm94IHNpemluZyBpcyB1bnJlbGlhYmxlLgogICAgLy8gSW4gdGhvc2UgY2FzZXMsIHRoZSBjb21wdXRlZCB2YWx1ZSBjYW4gYmUgdHJ1c3RlZCB0byBiZSBib3JkZXItYm94LgogICAgaWYgKCghc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpICYmIGlzQm9yZGVyQm94IHx8CiAgICAvLyBTdXBwb3J0OiBJRSAxMCAtIDExKywgRWRnZSAxNSAtIDE4KwogICAgLy8gSUUvRWRnZSBtaXNyZXBvcnQgYGdldENvbXB1dGVkU3R5bGVgIG9mIHRhYmxlIHJvd3Mgd2l0aCB3aWR0aC9oZWlnaHQKICAgIC8vIHNldCBpbiBDU1Mgd2hpbGUgYG9mZnNldCpgIHByb3BlcnRpZXMgcmVwb3J0IGNvcnJlY3QgdmFsdWVzLgogICAgLy8gSW50ZXJlc3RpbmdseSwgaW4gc29tZSBjYXNlcyBJRSA5IGRvZXNuJ3Qgc3VmZmVyIGZyb20gdGhpcyBpc3N1ZS4KICAgICFzdXBwb3J0LnJlbGlhYmxlVHJEaW1lbnNpb25zKCkgJiYgbm9kZU5hbWUoZWxlbSwgInRyIikgfHwKICAgIC8vIEZhbGwgYmFjayB0byBvZmZzZXRXaWR0aC9vZmZzZXRIZWlnaHQgd2hlbiB2YWx1ZSBpcyAiYXV0byIKICAgIC8vIFRoaXMgaGFwcGVucyBmb3IgaW5saW5lIGVsZW1lbnRzIHdpdGggbm8gZXhwbGljaXQgc2V0dGluZyAoZ2gtMzU3MSkKICAgIHZhbCA9PT0gImF1dG8iIHx8CiAgICAvLyBTdXBwb3J0OiBBbmRyb2lkIDw9NC4xIC0gNC4zIG9ubHkKICAgIC8vIEFsc28gdXNlIG9mZnNldFdpZHRoL29mZnNldEhlaWdodCBmb3IgbWlzcmVwb3J0ZWQgaW5saW5lIGRpbWVuc2lvbnMgKGdoLTM2MDIpCiAgICAhcGFyc2VGbG9hdCh2YWwpICYmIGpRdWVyeS5jc3MoZWxlbSwgImRpc3BsYXkiLCBmYWxzZSwgc3R5bGVzKSA9PT0gImlubGluZSIpICYmCiAgICAvLyBNYWtlIHN1cmUgdGhlIGVsZW1lbnQgaXMgdmlzaWJsZSAmIGNvbm5lY3RlZAogICAgZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCkgewogICAgICBpc0JvcmRlckJveCA9IGpRdWVyeS5jc3MoZWxlbSwgImJveFNpemluZyIsIGZhbHNlLCBzdHlsZXMpID09PSAiYm9yZGVyLWJveCI7CgogICAgICAvLyBXaGVyZSBhdmFpbGFibGUsIG9mZnNldFdpZHRoL29mZnNldEhlaWdodCBhcHByb3hpbWF0ZSBib3JkZXIgYm94IGRpbWVuc2lvbnMuCiAgICAgIC8vIFdoZXJlIG5vdCBhdmFpbGFibGUgKGUuZy4sIFNWRyksIGFzc3VtZSB1bnJlbGlhYmxlIGJveC1zaXppbmcgYW5kIGludGVycHJldCB0aGUKICAgICAgLy8gcmV0cmlldmVkIHZhbHVlIGFzIGEgY29udGVudCBib3ggZGltZW5zaW9uLgogICAgICB2YWx1ZUlzQm9yZGVyQm94ID0gb2Zmc2V0UHJvcCBpbiBlbGVtOwogICAgICBpZiAodmFsdWVJc0JvcmRlckJveCkgewogICAgICAgIHZhbCA9IGVsZW1bb2Zmc2V0UHJvcF07CiAgICAgIH0KICAgIH0KCiAgICAvLyBOb3JtYWxpemUgIiIgYW5kIGF1dG8KICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsKSB8fCAwOwoKICAgIC8vIEFkanVzdCBmb3IgdGhlIGVsZW1lbnQncyBib3ggbW9kZWwKICAgIHJldHVybiB2YWwgKyBib3hNb2RlbEFkanVzdG1lbnQoZWxlbSwgZGltZW5zaW9uLCBleHRyYSB8fCAoaXNCb3JkZXJCb3ggPyAiYm9yZGVyIiA6ICJjb250ZW50IiksIHZhbHVlSXNCb3JkZXJCb3gsIHN0eWxlcywKICAgIC8vIFByb3ZpZGUgdGhlIGN1cnJlbnQgY29tcHV0ZWQgc2l6ZSB0byByZXF1ZXN0IHNjcm9sbCBndXR0ZXIgY2FsY3VsYXRpb24gKGdoLTM1ODkpCiAgICB2YWwpICsgInB4IjsKICB9CiAgalF1ZXJ5LmV4dGVuZCh7CiAgICAvLyBBZGQgaW4gc3R5bGUgcHJvcGVydHkgaG9va3MgZm9yIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHQKICAgIC8vIGJlaGF2aW9yIG9mIGdldHRpbmcgYW5kIHNldHRpbmcgYSBzdHlsZSBwcm9wZXJ0eQogICAgY3NzSG9va3M6IHsKICAgICAgb3BhY2l0eTogewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0sIGNvbXB1dGVkKSB7CiAgICAgICAgICBpZiAoY29tcHV0ZWQpIHsKICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIGFsd2F5cyBnZXQgYSBudW1iZXIgYmFjayBmcm9tIG9wYWNpdHkKICAgICAgICAgICAgdmFyIHJldCA9IGN1ckNTUyhlbGVtLCAib3BhY2l0eSIpOwogICAgICAgICAgICByZXR1cm4gcmV0ID09PSAiIiA/ICIxIiA6IHJldDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyBEb24ndCBhdXRvbWF0aWNhbGx5IGFkZCAicHgiIHRvIHRoZXNlIHBvc3NpYmx5LXVuaXRsZXNzIHByb3BlcnRpZXMKICAgIGNzc051bWJlcjogewogICAgICAiYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQiOiB0cnVlLAogICAgICAiY29sdW1uQ291bnQiOiB0cnVlLAogICAgICAiZmlsbE9wYWNpdHkiOiB0cnVlLAogICAgICAiZmxleEdyb3ciOiB0cnVlLAogICAgICAiZmxleFNocmluayI6IHRydWUsCiAgICAgICJmb250V2VpZ2h0IjogdHJ1ZSwKICAgICAgImdyaWRBcmVhIjogdHJ1ZSwKICAgICAgImdyaWRDb2x1bW4iOiB0cnVlLAogICAgICAiZ3JpZENvbHVtbkVuZCI6IHRydWUsCiAgICAgICJncmlkQ29sdW1uU3RhcnQiOiB0cnVlLAogICAgICAiZ3JpZFJvdyI6IHRydWUsCiAgICAgICJncmlkUm93RW5kIjogdHJ1ZSwKICAgICAgImdyaWRSb3dTdGFydCI6IHRydWUsCiAgICAgICJsaW5lSGVpZ2h0IjogdHJ1ZSwKICAgICAgIm9wYWNpdHkiOiB0cnVlLAogICAgICAib3JkZXIiOiB0cnVlLAogICAgICAib3JwaGFucyI6IHRydWUsCiAgICAgICJ3aWRvd3MiOiB0cnVlLAogICAgICAiekluZGV4IjogdHJ1ZSwKICAgICAgInpvb20iOiB0cnVlCiAgICB9LAogICAgLy8gQWRkIGluIHByb3BlcnRpZXMgd2hvc2UgbmFtZXMgeW91IHdpc2ggdG8gZml4IGJlZm9yZQogICAgLy8gc2V0dGluZyBvciBnZXR0aW5nIHRoZSB2YWx1ZQogICAgY3NzUHJvcHM6IHt9LAogICAgLy8gR2V0IGFuZCBzZXQgdGhlIHN0eWxlIHByb3BlcnR5IG9uIGEgRE9NIE5vZGUKICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShlbGVtLCBuYW1lLCB2YWx1ZSwgZXh0cmEpIHsKICAgICAgLy8gRG9uJ3Qgc2V0IHN0eWxlcyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzCiAgICAgIGlmICghZWxlbSB8fCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwgIWVsZW0uc3R5bGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQogICAgICB2YXIgcmV0LAogICAgICAgIHR5cGUsCiAgICAgICAgaG9va3MsCiAgICAgICAgb3JpZ05hbWUgPSBjYW1lbENhc2UobmFtZSksCiAgICAgICAgaXNDdXN0b21Qcm9wID0gcmN1c3RvbVByb3AudGVzdChuYW1lKSwKICAgICAgICBzdHlsZSA9IGVsZW0uc3R5bGU7CgogICAgICAvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdpdGggdGhlIHJpZ2h0IG5hbWUuIFdlIGRvbid0CiAgICAgIC8vIHdhbnQgdG8gcXVlcnkgdGhlIHZhbHVlIGlmIGl0IGlzIGEgQ1NTIGN1c3RvbSBwcm9wZXJ0eQogICAgICAvLyBzaW5jZSB0aGV5IGFyZSB1c2VyLWRlZmluZWQuCiAgICAgIGlmICghaXNDdXN0b21Qcm9wKSB7CiAgICAgICAgbmFtZSA9IGZpbmFsUHJvcE5hbWUob3JpZ05hbWUpOwogICAgICB9CgogICAgICAvLyBHZXRzIGhvb2sgZm9yIHRoZSBwcmVmaXhlZCB2ZXJzaW9uLCB0aGVuIHVucHJlZml4ZWQgdmVyc2lvbgogICAgICBob29rcyA9IGpRdWVyeS5jc3NIb29rc1tuYW1lXSB8fCBqUXVlcnkuY3NzSG9va3Nbb3JpZ05hbWVdOwoKICAgICAgLy8gQ2hlY2sgaWYgd2UncmUgc2V0dGluZyBhIHZhbHVlCiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdHlwZSA9IF90eXBlb2YodmFsdWUpOwoKICAgICAgICAvLyBDb252ZXJ0ICIrPSIgb3IgIi09IiB0byByZWxhdGl2ZSBudW1iZXJzICgjNzM0NSkKICAgICAgICBpZiAodHlwZSA9PT0gInN0cmluZyIgJiYgKHJldCA9IHJjc3NOdW0uZXhlYyh2YWx1ZSkpICYmIHJldFsxXSkgewogICAgICAgICAgdmFsdWUgPSBhZGp1c3RDU1MoZWxlbSwgbmFtZSwgcmV0KTsKCiAgICAgICAgICAvLyBGaXhlcyBidWcgIzkyMzcKICAgICAgICAgIHR5cGUgPSAibnVtYmVyIjsKICAgICAgICB9CgogICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IG51bGwgYW5kIE5hTiB2YWx1ZXMgYXJlbid0IHNldCAoIzcxMTYpCiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBJZiBhIG51bWJlciB3YXMgcGFzc2VkIGluLCBhZGQgdGhlIHVuaXQgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcykKICAgICAgICAvLyBUaGUgaXNDdXN0b21Qcm9wIGNoZWNrIGNhbiBiZSByZW1vdmVkIGluIGpRdWVyeSA0LjAgd2hlbiB3ZSBvbmx5IGF1dG8tYXBwZW5kCiAgICAgICAgLy8gInB4IiB0byBhIGZldyBoYXJkY29kZWQgdmFsdWVzLgogICAgICAgIGlmICh0eXBlID09PSAibnVtYmVyIiAmJiAhaXNDdXN0b21Qcm9wKSB7CiAgICAgICAgICB2YWx1ZSArPSByZXQgJiYgcmV0WzNdIHx8IChqUXVlcnkuY3NzTnVtYmVyW29yaWdOYW1lXSA/ICIiIDogInB4Iik7CiAgICAgICAgfQoKICAgICAgICAvLyBiYWNrZ3JvdW5kLSogcHJvcHMgYWZmZWN0IG9yaWdpbmFsIGNsb25lJ3MgdmFsdWVzCiAgICAgICAgaWYgKCFzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSAmJiB2YWx1ZSA9PT0gIiIgJiYgbmFtZS5pbmRleE9mKCJiYWNrZ3JvdW5kIikgPT09IDApIHsKICAgICAgICAgIHN0eWxlW25hbWVdID0gImluaGVyaXQiOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCwgdXNlIHRoYXQgdmFsdWUsIG90aGVyd2lzZSBqdXN0IHNldCB0aGUgc3BlY2lmaWVkIHZhbHVlCiAgICAgICAgaWYgKCFob29rcyB8fCAhKCJzZXQiIGluIGhvb2tzKSB8fCAodmFsdWUgPSBob29rcy5zZXQoZWxlbSwgdmFsdWUsIGV4dHJhKSkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaWYgKGlzQ3VzdG9tUHJvcCkgewogICAgICAgICAgICBzdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdHlsZVtuYW1lXSA9IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkIGdldCB0aGUgbm9uLWNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmUKICAgICAgICBpZiAoaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCBmYWxzZSwgZXh0cmEpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0KCiAgICAgICAgLy8gT3RoZXJ3aXNlIGp1c3QgZ2V0IHRoZSB2YWx1ZSBmcm9tIHRoZSBzdHlsZSBvYmplY3QKICAgICAgICByZXR1cm4gc3R5bGVbbmFtZV07CiAgICAgIH0KICAgIH0sCiAgICBjc3M6IGZ1bmN0aW9uIGNzcyhlbGVtLCBuYW1lLCBleHRyYSwgc3R5bGVzKSB7CiAgICAgIHZhciB2YWwsCiAgICAgICAgbnVtLAogICAgICAgIGhvb2tzLAogICAgICAgIG9yaWdOYW1lID0gY2FtZWxDYXNlKG5hbWUpLAogICAgICAgIGlzQ3VzdG9tUHJvcCA9IHJjdXN0b21Qcm9wLnRlc3QobmFtZSk7CgogICAgICAvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdpdGggdGhlIHJpZ2h0IG5hbWUuIFdlIGRvbid0CiAgICAgIC8vIHdhbnQgdG8gbW9kaWZ5IHRoZSB2YWx1ZSBpZiBpdCBpcyBhIENTUyBjdXN0b20gcHJvcGVydHkKICAgICAgLy8gc2luY2UgdGhleSBhcmUgdXNlci1kZWZpbmVkLgogICAgICBpZiAoIWlzQ3VzdG9tUHJvcCkgewogICAgICAgIG5hbWUgPSBmaW5hbFByb3BOYW1lKG9yaWdOYW1lKTsKICAgICAgfQoKICAgICAgLy8gVHJ5IHByZWZpeGVkIG5hbWUgZm9sbG93ZWQgYnkgdGhlIHVucHJlZml4ZWQgbmFtZQogICAgICBob29rcyA9IGpRdWVyeS5jc3NIb29rc1tuYW1lXSB8fCBqUXVlcnkuY3NzSG9va3Nbb3JpZ05hbWVdOwoKICAgICAgLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmUKICAgICAgaWYgKGhvb2tzICYmICJnZXQiIGluIGhvb2tzKSB7CiAgICAgICAgdmFsID0gaG9va3MuZ2V0KGVsZW0sIHRydWUsIGV4dHJhKTsKICAgICAgfQoKICAgICAgLy8gT3RoZXJ3aXNlLCBpZiBhIHdheSB0byBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGV4aXN0cywgdXNlIHRoYXQKICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsID0gY3VyQ1NTKGVsZW0sIG5hbWUsIHN0eWxlcyk7CiAgICAgIH0KCiAgICAgIC8vIENvbnZlcnQgIm5vcm1hbCIgdG8gY29tcHV0ZWQgdmFsdWUKICAgICAgaWYgKHZhbCA9PT0gIm5vcm1hbCIgJiYgbmFtZSBpbiBjc3NOb3JtYWxUcmFuc2Zvcm0pIHsKICAgICAgICB2YWwgPSBjc3NOb3JtYWxUcmFuc2Zvcm1bbmFtZV07CiAgICAgIH0KCiAgICAgIC8vIE1ha2UgbnVtZXJpYyBpZiBmb3JjZWQgb3IgYSBxdWFsaWZpZXIgd2FzIHByb3ZpZGVkIGFuZCB2YWwgbG9va3MgbnVtZXJpYwogICAgICBpZiAoZXh0cmEgPT09ICIiIHx8IGV4dHJhKSB7CiAgICAgICAgbnVtID0gcGFyc2VGbG9hdCh2YWwpOwogICAgICAgIHJldHVybiBleHRyYSA9PT0gdHJ1ZSB8fCBpc0Zpbml0ZShudW0pID8gbnVtIHx8IDAgOiB2YWw7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbDsKICAgIH0KICB9KTsKICBqUXVlcnkuZWFjaChbImhlaWdodCIsICJ3aWR0aCJdLCBmdW5jdGlvbiAoX2ksIGRpbWVuc2lvbikgewogICAgalF1ZXJ5LmNzc0hvb2tzW2RpbWVuc2lvbl0gPSB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0sIGNvbXB1dGVkLCBleHRyYSkgewogICAgICAgIGlmIChjb21wdXRlZCkgewogICAgICAgICAgLy8gQ2VydGFpbiBlbGVtZW50cyBjYW4gaGF2ZSBkaW1lbnNpb24gaW5mbyBpZiB3ZSBpbnZpc2libHkgc2hvdyB0aGVtCiAgICAgICAgICAvLyBidXQgaXQgbXVzdCBoYXZlIGEgY3VycmVudCBkaXNwbGF5IHN0eWxlIHRoYXQgd291bGQgYmVuZWZpdAogICAgICAgICAgcmV0dXJuIHJkaXNwbGF5c3dhcC50ZXN0KGpRdWVyeS5jc3MoZWxlbSwgImRpc3BsYXkiKSkgJiYgKAogICAgICAgICAgLy8gU3VwcG9ydDogU2FmYXJpIDgrCiAgICAgICAgICAvLyBUYWJsZSBjb2x1bW5zIGluIFNhZmFyaSBoYXZlIG5vbi16ZXJvIG9mZnNldFdpZHRoICYgemVybwogICAgICAgICAgLy8gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggdW5sZXNzIGRpc3BsYXkgaXMgY2hhbmdlZC4KICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDw9MTEgb25seQogICAgICAgICAgLy8gUnVubmluZyBnZXRCb3VuZGluZ0NsaWVudFJlY3Qgb24gYSBkaXNjb25uZWN0ZWQgbm9kZQogICAgICAgICAgLy8gaW4gSUUgdGhyb3dzIGFuIGVycm9yLgogICAgICAgICAgIWVsZW0uZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggfHwgIWVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgpID8gc3dhcChlbGVtLCBjc3NTaG93LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRXaWR0aE9ySGVpZ2h0KGVsZW0sIGRpbWVuc2lvbiwgZXh0cmEpOwogICAgICAgICAgfSkgOiBnZXRXaWR0aE9ySGVpZ2h0KGVsZW0sIGRpbWVuc2lvbiwgZXh0cmEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUsIGV4dHJhKSB7CiAgICAgICAgdmFyIG1hdGNoZXMsCiAgICAgICAgICBzdHlsZXMgPSBnZXRTdHlsZXMoZWxlbSksCiAgICAgICAgICAvLyBPbmx5IHJlYWQgc3R5bGVzLnBvc2l0aW9uIGlmIHRoZSB0ZXN0IGhhcyBhIGNoYW5jZSB0byBmYWlsCiAgICAgICAgICAvLyB0byBhdm9pZCBmb3JjaW5nIGEgcmVmbG93LgogICAgICAgICAgc2Nyb2xsYm94U2l6ZUJ1Z2d5ID0gIXN1cHBvcnQuc2Nyb2xsYm94U2l6ZSgpICYmIHN0eWxlcy5wb3NpdGlvbiA9PT0gImFic29sdXRlIiwKICAgICAgICAgIC8vIFRvIGF2b2lkIGZvcmNpbmcgYSByZWZsb3csIG9ubHkgZmV0Y2ggYm94U2l6aW5nIGlmIHdlIG5lZWQgaXQgKGdoLTM5OTEpCiAgICAgICAgICBib3hTaXppbmdOZWVkZWQgPSBzY3JvbGxib3hTaXplQnVnZ3kgfHwgZXh0cmEsCiAgICAgICAgICBpc0JvcmRlckJveCA9IGJveFNpemluZ05lZWRlZCAmJiBqUXVlcnkuY3NzKGVsZW0sICJib3hTaXppbmciLCBmYWxzZSwgc3R5bGVzKSA9PT0gImJvcmRlci1ib3giLAogICAgICAgICAgc3VidHJhY3QgPSBleHRyYSA/IGJveE1vZGVsQWRqdXN0bWVudChlbGVtLCBkaW1lbnNpb24sIGV4dHJhLCBpc0JvcmRlckJveCwgc3R5bGVzKSA6IDA7CgogICAgICAgIC8vIEFjY291bnQgZm9yIHVucmVsaWFibGUgYm9yZGVyLWJveCBkaW1lbnNpb25zIGJ5IGNvbXBhcmluZyBvZmZzZXQqIHRvIGNvbXB1dGVkIGFuZAogICAgICAgIC8vIGZha2luZyBhIGNvbnRlbnQtYm94IHRvIGdldCBib3JkZXIgYW5kIHBhZGRpbmcgKGdoLTM2OTkpCiAgICAgICAgaWYgKGlzQm9yZGVyQm94ICYmIHNjcm9sbGJveFNpemVCdWdneSkgewogICAgICAgICAgc3VidHJhY3QgLT0gTWF0aC5jZWlsKGVsZW1bIm9mZnNldCIgKyBkaW1lbnNpb25bMF0udG9VcHBlckNhc2UoKSArIGRpbWVuc2lvbi5zbGljZSgxKV0gLSBwYXJzZUZsb2F0KHN0eWxlc1tkaW1lbnNpb25dKSAtIGJveE1vZGVsQWRqdXN0bWVudChlbGVtLCBkaW1lbnNpb24sICJib3JkZXIiLCBmYWxzZSwgc3R5bGVzKSAtIDAuNSk7CiAgICAgICAgfQoKICAgICAgICAvLyBDb252ZXJ0IHRvIHBpeGVscyBpZiB2YWx1ZSBhZGp1c3RtZW50IGlzIG5lZWRlZAogICAgICAgIGlmIChzdWJ0cmFjdCAmJiAobWF0Y2hlcyA9IHJjc3NOdW0uZXhlYyh2YWx1ZSkpICYmIChtYXRjaGVzWzNdIHx8ICJweCIpICE9PSAicHgiKSB7CiAgICAgICAgICBlbGVtLnN0eWxlW2RpbWVuc2lvbl0gPSB2YWx1ZTsKICAgICAgICAgIHZhbHVlID0galF1ZXJ5LmNzcyhlbGVtLCBkaW1lbnNpb24pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2V0UG9zaXRpdmVOdW1iZXIoZWxlbSwgdmFsdWUsIHN1YnRyYWN0KTsKICAgICAgfQogICAgfTsKICB9KTsKICBqUXVlcnkuY3NzSG9va3MubWFyZ2luTGVmdCA9IGFkZEdldEhvb2tJZihzdXBwb3J0LnJlbGlhYmxlTWFyZ2luTGVmdCwgZnVuY3Rpb24gKGVsZW0sIGNvbXB1dGVkKSB7CiAgICBpZiAoY29tcHV0ZWQpIHsKICAgICAgcmV0dXJuIChwYXJzZUZsb2F0KGN1ckNTUyhlbGVtLCAibWFyZ2luTGVmdCIpKSB8fCBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLSBzd2FwKGVsZW0sIHsKICAgICAgICBtYXJnaW5MZWZ0OiAwCiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0OwogICAgICB9KSkgKyAicHgiOwogICAgfQogIH0pOwoKICAvLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzCiAgalF1ZXJ5LmVhY2goewogICAgbWFyZ2luOiAiIiwKICAgIHBhZGRpbmc6ICIiLAogICAgYm9yZGVyOiAiV2lkdGgiCiAgfSwgZnVuY3Rpb24gKHByZWZpeCwgc3VmZml4KSB7CiAgICBqUXVlcnkuY3NzSG9va3NbcHJlZml4ICsgc3VmZml4XSA9IHsKICAgICAgZXhwYW5kOiBmdW5jdGlvbiBleHBhbmQodmFsdWUpIHsKICAgICAgICB2YXIgaSA9IDAsCiAgICAgICAgICBleHBhbmRlZCA9IHt9LAogICAgICAgICAgLy8gQXNzdW1lcyBhIHNpbmdsZSBudW1iZXIgaWYgbm90IGEgc3RyaW5nCiAgICAgICAgICBwYXJ0cyA9IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgPyB2YWx1ZS5zcGxpdCgiICIpIDogW3ZhbHVlXTsKICAgICAgICBmb3IgKDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgZXhwYW5kZWRbcHJlZml4ICsgY3NzRXhwYW5kW2ldICsgc3VmZml4XSA9IHBhcnRzW2ldIHx8IHBhcnRzW2kgLSAyXSB8fCBwYXJ0c1swXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGV4cGFuZGVkOwogICAgICB9CiAgICB9OwogICAgaWYgKHByZWZpeCAhPT0gIm1hcmdpbiIpIHsKICAgICAgalF1ZXJ5LmNzc0hvb2tzW3ByZWZpeCArIHN1ZmZpeF0uc2V0ID0gc2V0UG9zaXRpdmVOdW1iZXI7CiAgICB9CiAgfSk7CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBjc3M6IGZ1bmN0aW9uIGNzcyhuYW1lLCB2YWx1ZSkgewogICAgICByZXR1cm4gYWNjZXNzKHRoaXMsIGZ1bmN0aW9uIChlbGVtLCBuYW1lLCB2YWx1ZSkgewogICAgICAgIHZhciBzdHlsZXMsCiAgICAgICAgICBsZW4sCiAgICAgICAgICBtYXAgPSB7fSwKICAgICAgICAgIGkgPSAwOwogICAgICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWUpKSB7CiAgICAgICAgICBzdHlsZXMgPSBnZXRTdHlsZXMoZWxlbSk7CiAgICAgICAgICBsZW4gPSBuYW1lLmxlbmd0aDsKICAgICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgbWFwW25hbWVbaV1dID0galF1ZXJ5LmNzcyhlbGVtLCBuYW1lW2ldLCBmYWxzZSwgc3R5bGVzKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBtYXA7CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8galF1ZXJ5LnN0eWxlKGVsZW0sIG5hbWUsIHZhbHVlKSA6IGpRdWVyeS5jc3MoZWxlbSwgbmFtZSk7CiAgICAgIH0sIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSk7CiAgICB9CiAgfSk7CiAgZnVuY3Rpb24gVHdlZW4oZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcpIHsKICAgIHJldHVybiBuZXcgVHdlZW4ucHJvdG90eXBlLmluaXQoZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcpOwogIH0KICBqUXVlcnkuVHdlZW4gPSBUd2VlbjsKICBUd2Vlbi5wcm90b3R5cGUgPSB7CiAgICBjb25zdHJ1Y3RvcjogVHdlZW4sCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nLCB1bml0KSB7CiAgICAgIHRoaXMuZWxlbSA9IGVsZW07CiAgICAgIHRoaXMucHJvcCA9IHByb3A7CiAgICAgIHRoaXMuZWFzaW5nID0gZWFzaW5nIHx8IGpRdWVyeS5lYXNpbmcuX2RlZmF1bHQ7CiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLm5vdyA9IHRoaXMuY3VyKCk7CiAgICAgIHRoaXMuZW5kID0gZW5kOwogICAgICB0aGlzLnVuaXQgPSB1bml0IHx8IChqUXVlcnkuY3NzTnVtYmVyW3Byb3BdID8gIiIgOiAicHgiKTsKICAgIH0sCiAgICBjdXI6IGZ1bmN0aW9uIGN1cigpIHsKICAgICAgdmFyIGhvb2tzID0gVHdlZW4ucHJvcEhvb2tzW3RoaXMucHJvcF07CiAgICAgIHJldHVybiBob29rcyAmJiBob29rcy5nZXQgPyBob29rcy5nZXQodGhpcykgOiBUd2Vlbi5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpOwogICAgfSwKICAgIHJ1bjogZnVuY3Rpb24gcnVuKHBlcmNlbnQpIHsKICAgICAgdmFyIGVhc2VkLAogICAgICAgIGhvb2tzID0gVHdlZW4ucHJvcEhvb2tzW3RoaXMucHJvcF07CiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHVyYXRpb24pIHsKICAgICAgICB0aGlzLnBvcyA9IGVhc2VkID0galF1ZXJ5LmVhc2luZ1t0aGlzLmVhc2luZ10ocGVyY2VudCwgdGhpcy5vcHRpb25zLmR1cmF0aW9uICogcGVyY2VudCwgMCwgMSwgdGhpcy5vcHRpb25zLmR1cmF0aW9uKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBvcyA9IGVhc2VkID0gcGVyY2VudDsKICAgICAgfQogICAgICB0aGlzLm5vdyA9ICh0aGlzLmVuZCAtIHRoaXMuc3RhcnQpICogZWFzZWQgKyB0aGlzLnN0YXJ0OwogICAgICBpZiAodGhpcy5vcHRpb25zLnN0ZXApIHsKICAgICAgICB0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMpOwogICAgICB9CiAgICAgIGlmIChob29rcyAmJiBob29rcy5zZXQpIHsKICAgICAgICBob29rcy5zZXQodGhpcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgVHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIFR3ZWVuLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZSA9IFR3ZWVuLnByb3RvdHlwZTsKICBUd2Vlbi5wcm9wSG9va3MgPSB7CiAgICBfZGVmYXVsdDogewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCh0d2VlbikgewogICAgICAgIHZhciByZXN1bHQ7CgogICAgICAgIC8vIFVzZSBhIHByb3BlcnR5IG9uIHRoZSBlbGVtZW50IGRpcmVjdGx5IHdoZW4gaXQgaXMgbm90IGEgRE9NIGVsZW1lbnQsCiAgICAgICAgLy8gb3Igd2hlbiB0aGVyZSBpcyBubyBtYXRjaGluZyBzdHlsZSBwcm9wZXJ0eSB0aGF0IGV4aXN0cy4KICAgICAgICBpZiAodHdlZW4uZWxlbS5ub2RlVHlwZSAhPT0gMSB8fCB0d2Vlbi5lbGVtW3R3ZWVuLnByb3BdICE9IG51bGwgJiYgdHdlZW4uZWxlbS5zdHlsZVt0d2Vlbi5wcm9wXSA9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gdHdlZW4uZWxlbVt0d2Vlbi5wcm9wXTsKICAgICAgICB9CgogICAgICAgIC8vIFBhc3NpbmcgYW4gZW1wdHkgc3RyaW5nIGFzIGEgM3JkIHBhcmFtZXRlciB0byAuY3NzIHdpbGwgYXV0b21hdGljYWxseQogICAgICAgIC8vIGF0dGVtcHQgYSBwYXJzZUZsb2F0IGFuZCBmYWxsYmFjayB0byBhIHN0cmluZyBpZiB0aGUgcGFyc2UgZmFpbHMuCiAgICAgICAgLy8gU2ltcGxlIHZhbHVlcyBzdWNoIGFzICIxMHB4IiBhcmUgcGFyc2VkIHRvIEZsb2F0OwogICAgICAgIC8vIGNvbXBsZXggdmFsdWVzIHN1Y2ggYXMgInJvdGF0ZSgxcmFkKSIgYXJlIHJldHVybmVkIGFzLWlzLgogICAgICAgIHJlc3VsdCA9IGpRdWVyeS5jc3ModHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgIiIpOwoKICAgICAgICAvLyBFbXB0eSBzdHJpbmdzLCBudWxsLCB1bmRlZmluZWQgYW5kICJhdXRvIiBhcmUgY29udmVydGVkIHRvIDAuCiAgICAgICAgcmV0dXJuICFyZXN1bHQgfHwgcmVzdWx0ID09PSAiYXV0byIgPyAwIDogcmVzdWx0OwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh0d2VlbikgewogICAgICAgIC8vIFVzZSBzdGVwIGhvb2sgZm9yIGJhY2sgY29tcGF0LgogICAgICAgIC8vIFVzZSBjc3NIb29rIGlmIGl0cyB0aGVyZS4KICAgICAgICAvLyBVc2UgLnN0eWxlIGlmIGF2YWlsYWJsZSBhbmQgdXNlIHBsYWluIHByb3BlcnRpZXMgd2hlcmUgYXZhaWxhYmxlLgogICAgICAgIGlmIChqUXVlcnkuZnguc3RlcFt0d2Vlbi5wcm9wXSkgewogICAgICAgICAgalF1ZXJ5LmZ4LnN0ZXBbdHdlZW4ucHJvcF0odHdlZW4pOwogICAgICAgIH0gZWxzZSBpZiAodHdlZW4uZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoalF1ZXJ5LmNzc0hvb2tzW3R3ZWVuLnByb3BdIHx8IHR3ZWVuLmVsZW0uc3R5bGVbZmluYWxQcm9wTmFtZSh0d2Vlbi5wcm9wKV0gIT0gbnVsbCkpIHsKICAgICAgICAgIGpRdWVyeS5zdHlsZSh0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCB0d2Vlbi5ub3cgKyB0d2Vlbi51bml0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdHdlZW4uZWxlbVt0d2Vlbi5wcm9wXSA9IHR3ZWVuLm5vdzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBTdXBwb3J0OiBJRSA8PTkgb25seQogIC8vIFBhbmljIGJhc2VkIGFwcHJvYWNoIHRvIHNldHRpbmcgdGhpbmdzIG9uIGRpc2Nvbm5lY3RlZCBub2RlcwogIFR3ZWVuLnByb3BIb29rcy5zY3JvbGxUb3AgPSBUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsTGVmdCA9IHsKICAgIHNldDogZnVuY3Rpb24gc2V0KHR3ZWVuKSB7CiAgICAgIGlmICh0d2Vlbi5lbGVtLm5vZGVUeXBlICYmIHR3ZWVuLmVsZW0ucGFyZW50Tm9kZSkgewogICAgICAgIHR3ZWVuLmVsZW1bdHdlZW4ucHJvcF0gPSB0d2Vlbi5ub3c7CiAgICAgIH0KICAgIH0KICB9OwogIGpRdWVyeS5lYXNpbmcgPSB7CiAgICBsaW5lYXI6IGZ1bmN0aW9uIGxpbmVhcihwKSB7CiAgICAgIHJldHVybiBwOwogICAgfSwKICAgIHN3aW5nOiBmdW5jdGlvbiBzd2luZyhwKSB7CiAgICAgIHJldHVybiAwLjUgLSBNYXRoLmNvcyhwICogTWF0aC5QSSkgLyAyOwogICAgfSwKICAgIF9kZWZhdWx0OiAic3dpbmciCiAgfTsKICBqUXVlcnkuZnggPSBUd2Vlbi5wcm90b3R5cGUuaW5pdDsKCiAgLy8gQmFjayBjb21wYXQgPDEuOCBleHRlbnNpb24gcG9pbnQKICBqUXVlcnkuZnguc3RlcCA9IHt9OwogIHZhciBmeE5vdywKICAgIGluUHJvZ3Jlc3MsCiAgICByZnh0eXBlcyA9IC9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLywKICAgIHJydW4gPSAvcXVldWVIb29rcyQvOwogIGZ1bmN0aW9uIHNjaGVkdWxlKCkgewogICAgaWYgKGluUHJvZ3Jlc3MpIHsKICAgICAgaWYgKGRvY3VtZW50LmhpZGRlbiA9PT0gZmFsc2UgJiYgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSkgewogICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2NoZWR1bGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHNjaGVkdWxlLCBqUXVlcnkuZnguaW50ZXJ2YWwpOwogICAgICB9CiAgICAgIGpRdWVyeS5meC50aWNrKCk7CiAgICB9CiAgfQoKICAvLyBBbmltYXRpb25zIGNyZWF0ZWQgc3luY2hyb25vdXNseSB3aWxsIHJ1biBzeW5jaHJvbm91c2x5CiAgZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7CiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIGZ4Tm93ID0gdW5kZWZpbmVkOwogICAgfSk7CiAgICByZXR1cm4gZnhOb3cgPSBEYXRlLm5vdygpOwogIH0KCiAgLy8gR2VuZXJhdGUgcGFyYW1ldGVycyB0byBjcmVhdGUgYSBzdGFuZGFyZCBhbmltYXRpb24KICBmdW5jdGlvbiBnZW5GeCh0eXBlLCBpbmNsdWRlV2lkdGgpIHsKICAgIHZhciB3aGljaCwKICAgICAgaSA9IDAsCiAgICAgIGF0dHJzID0gewogICAgICAgIGhlaWdodDogdHlwZQogICAgICB9OwoKICAgIC8vIElmIHdlIGluY2x1ZGUgd2lkdGgsIHN0ZXAgdmFsdWUgaXMgMSB0byBkbyBhbGwgY3NzRXhwYW5kIHZhbHVlcywKICAgIC8vIG90aGVyd2lzZSBzdGVwIHZhbHVlIGlzIDIgdG8gc2tpcCBvdmVyIExlZnQgYW5kIFJpZ2h0CiAgICBpbmNsdWRlV2lkdGggPSBpbmNsdWRlV2lkdGggPyAxIDogMDsKICAgIGZvciAoOyBpIDwgNDsgaSArPSAyIC0gaW5jbHVkZVdpZHRoKSB7CiAgICAgIHdoaWNoID0gY3NzRXhwYW5kW2ldOwogICAgICBhdHRyc1sibWFyZ2luIiArIHdoaWNoXSA9IGF0dHJzWyJwYWRkaW5nIiArIHdoaWNoXSA9IHR5cGU7CiAgICB9CiAgICBpZiAoaW5jbHVkZVdpZHRoKSB7CiAgICAgIGF0dHJzLm9wYWNpdHkgPSBhdHRycy53aWR0aCA9IHR5cGU7CiAgICB9CiAgICByZXR1cm4gYXR0cnM7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKHZhbHVlLCBwcm9wLCBhbmltYXRpb24pIHsKICAgIHZhciB0d2VlbiwKICAgICAgY29sbGVjdGlvbiA9IChBbmltYXRpb24udHdlZW5lcnNbcHJvcF0gfHwgW10pLmNvbmNhdChBbmltYXRpb24udHdlZW5lcnNbIioiXSksCiAgICAgIGluZGV4ID0gMCwKICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbi5sZW5ndGg7CiAgICBmb3IgKDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKICAgICAgaWYgKHR3ZWVuID0gY29sbGVjdGlvbltpbmRleF0uY2FsbChhbmltYXRpb24sIHByb3AsIHZhbHVlKSkgewogICAgICAgIC8vIFdlJ3JlIGRvbmUgd2l0aCB0aGlzIHByb3BlcnR5CiAgICAgICAgcmV0dXJuIHR3ZWVuOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGRlZmF1bHRQcmVmaWx0ZXIoZWxlbSwgcHJvcHMsIG9wdHMpIHsKICAgIHZhciBwcm9wLAogICAgICB2YWx1ZSwKICAgICAgdG9nZ2xlLAogICAgICBob29rcywKICAgICAgb2xkZmlyZSwKICAgICAgcHJvcFR3ZWVuLAogICAgICByZXN0b3JlRGlzcGxheSwKICAgICAgZGlzcGxheSwKICAgICAgaXNCb3ggPSAid2lkdGgiIGluIHByb3BzIHx8ICJoZWlnaHQiIGluIHByb3BzLAogICAgICBhbmltID0gdGhpcywKICAgICAgb3JpZyA9IHt9LAogICAgICBzdHlsZSA9IGVsZW0uc3R5bGUsCiAgICAgIGhpZGRlbiA9IGVsZW0ubm9kZVR5cGUgJiYgaXNIaWRkZW5XaXRoaW5UcmVlKGVsZW0pLAogICAgICBkYXRhU2hvdyA9IGRhdGFQcml2LmdldChlbGVtLCAiZnhzaG93Iik7CgogICAgLy8gUXVldWUtc2tpcHBpbmcgYW5pbWF0aW9ucyBoaWphY2sgdGhlIGZ4IGhvb2tzCiAgICBpZiAoIW9wdHMucXVldWUpIHsKICAgICAgaG9va3MgPSBqUXVlcnkuX3F1ZXVlSG9va3MoZWxlbSwgImZ4Iik7CiAgICAgIGlmIChob29rcy51bnF1ZXVlZCA9PSBudWxsKSB7CiAgICAgICAgaG9va3MudW5xdWV1ZWQgPSAwOwogICAgICAgIG9sZGZpcmUgPSBob29rcy5lbXB0eS5maXJlOwogICAgICAgIGhvb2tzLmVtcHR5LmZpcmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoIWhvb2tzLnVucXVldWVkKSB7CiAgICAgICAgICAgIG9sZGZpcmUoKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CiAgICAgIGhvb2tzLnVucXVldWVkKys7CiAgICAgIGFuaW0uYWx3YXlzKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBFbnN1cmUgdGhlIGNvbXBsZXRlIGhhbmRsZXIgaXMgY2FsbGVkIGJlZm9yZSB0aGlzIGNvbXBsZXRlcwogICAgICAgIGFuaW0uYWx3YXlzKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGhvb2tzLnVucXVldWVkLS07CiAgICAgICAgICBpZiAoIWpRdWVyeS5xdWV1ZShlbGVtLCAiZngiKS5sZW5ndGgpIHsKICAgICAgICAgICAgaG9va3MuZW1wdHkuZmlyZSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvLyBEZXRlY3Qgc2hvdy9oaWRlIGFuaW1hdGlvbnMKICAgIGZvciAocHJvcCBpbiBwcm9wcykgewogICAgICB2YWx1ZSA9IHByb3BzW3Byb3BdOwogICAgICBpZiAocmZ4dHlwZXMudGVzdCh2YWx1ZSkpIHsKICAgICAgICBkZWxldGUgcHJvcHNbcHJvcF07CiAgICAgICAgdG9nZ2xlID0gdG9nZ2xlIHx8IHZhbHVlID09PSAidG9nZ2xlIjsKICAgICAgICBpZiAodmFsdWUgPT09IChoaWRkZW4gPyAiaGlkZSIgOiAic2hvdyIpKSB7CiAgICAgICAgICAvLyBQcmV0ZW5kIHRvIGJlIGhpZGRlbiBpZiB0aGlzIGlzIGEgInNob3ciIGFuZAogICAgICAgICAgLy8gdGhlcmUgaXMgc3RpbGwgZGF0YSBmcm9tIGEgc3RvcHBlZCBzaG93L2hpZGUKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gInNob3ciICYmIGRhdGFTaG93ICYmIGRhdGFTaG93W3Byb3BdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaGlkZGVuID0gdHJ1ZTsKCiAgICAgICAgICAgIC8vIElnbm9yZSBhbGwgb3RoZXIgbm8tb3Agc2hvdy9oaWRlIGRhdGEKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBvcmlnW3Byb3BdID0gZGF0YVNob3cgJiYgZGF0YVNob3dbcHJvcF0gfHwgalF1ZXJ5LnN0eWxlKGVsZW0sIHByb3ApOwogICAgICB9CiAgICB9CgogICAgLy8gQmFpbCBvdXQgaWYgdGhpcyBpcyBhIG5vLW9wIGxpa2UgLmhpZGUoKS5oaWRlKCkKICAgIHByb3BUd2VlbiA9ICFqUXVlcnkuaXNFbXB0eU9iamVjdChwcm9wcyk7CiAgICBpZiAoIXByb3BUd2VlbiAmJiBqUXVlcnkuaXNFbXB0eU9iamVjdChvcmlnKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUmVzdHJpY3QgIm92ZXJmbG93IiBhbmQgImRpc3BsYXkiIHN0eWxlcyBkdXJpbmcgYm94IGFuaW1hdGlvbnMKICAgIGlmIChpc0JveCAmJiBlbGVtLm5vZGVUeXBlID09PSAxKSB7CiAgICAgIC8vIFN1cHBvcnQ6IElFIDw9OSAtIDExLCBFZGdlIDEyIC0gMTUKICAgICAgLy8gUmVjb3JkIGFsbCAzIG92ZXJmbG93IGF0dHJpYnV0ZXMgYmVjYXVzZSBJRSBkb2VzIG5vdCBpbmZlciB0aGUgc2hvcnRoYW5kCiAgICAgIC8vIGZyb20gaWRlbnRpY2FsbHktdmFsdWVkIG92ZXJmbG93WCBhbmQgb3ZlcmZsb3dZIGFuZCBFZGdlIGp1c3QgbWlycm9ycwogICAgICAvLyB0aGUgb3ZlcmZsb3dYIHZhbHVlIHRoZXJlLgogICAgICBvcHRzLm92ZXJmbG93ID0gW3N0eWxlLm92ZXJmbG93LCBzdHlsZS5vdmVyZmxvd1gsIHN0eWxlLm92ZXJmbG93WV07CgogICAgICAvLyBJZGVudGlmeSBhIGRpc3BsYXkgdHlwZSwgcHJlZmVycmluZyBvbGQgc2hvdy9oaWRlIGRhdGEgb3ZlciB0aGUgQ1NTIGNhc2NhZGUKICAgICAgcmVzdG9yZURpc3BsYXkgPSBkYXRhU2hvdyAmJiBkYXRhU2hvdy5kaXNwbGF5OwogICAgICBpZiAocmVzdG9yZURpc3BsYXkgPT0gbnVsbCkgewogICAgICAgIHJlc3RvcmVEaXNwbGF5ID0gZGF0YVByaXYuZ2V0KGVsZW0sICJkaXNwbGF5Iik7CiAgICAgIH0KICAgICAgZGlzcGxheSA9IGpRdWVyeS5jc3MoZWxlbSwgImRpc3BsYXkiKTsKICAgICAgaWYgKGRpc3BsYXkgPT09ICJub25lIikgewogICAgICAgIGlmIChyZXN0b3JlRGlzcGxheSkgewogICAgICAgICAgZGlzcGxheSA9IHJlc3RvcmVEaXNwbGF5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBHZXQgbm9uZW1wdHkgdmFsdWUocykgYnkgdGVtcG9yYXJpbHkgZm9yY2luZyB2aXNpYmlsaXR5CiAgICAgICAgICBzaG93SGlkZShbZWxlbV0sIHRydWUpOwogICAgICAgICAgcmVzdG9yZURpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXkgfHwgcmVzdG9yZURpc3BsYXk7CiAgICAgICAgICBkaXNwbGF5ID0galF1ZXJ5LmNzcyhlbGVtLCAiZGlzcGxheSIpOwogICAgICAgICAgc2hvd0hpZGUoW2VsZW1dKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIEFuaW1hdGUgaW5saW5lIGVsZW1lbnRzIGFzIGlubGluZS1ibG9jawogICAgICBpZiAoZGlzcGxheSA9PT0gImlubGluZSIgfHwgZGlzcGxheSA9PT0gImlubGluZS1ibG9jayIgJiYgcmVzdG9yZURpc3BsYXkgIT0gbnVsbCkgewogICAgICAgIGlmIChqUXVlcnkuY3NzKGVsZW0sICJmbG9hdCIpID09PSAibm9uZSIpIHsKICAgICAgICAgIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIGRpc3BsYXkgdmFsdWUgYXQgdGhlIGVuZCBvZiBwdXJlIHNob3cvaGlkZSBhbmltYXRpb25zCiAgICAgICAgICBpZiAoIXByb3BUd2VlbikgewogICAgICAgICAgICBhbmltLmRvbmUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHN0eWxlLmRpc3BsYXkgPSByZXN0b3JlRGlzcGxheTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChyZXN0b3JlRGlzcGxheSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgZGlzcGxheSA9IHN0eWxlLmRpc3BsYXk7CiAgICAgICAgICAgICAgcmVzdG9yZURpc3BsYXkgPSBkaXNwbGF5ID09PSAibm9uZSIgPyAiIiA6IGRpc3BsYXk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmIChvcHRzLm92ZXJmbG93KSB7CiAgICAgIHN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgIGFuaW0uYWx3YXlzKGZ1bmN0aW9uICgpIHsKICAgICAgICBzdHlsZS5vdmVyZmxvdyA9IG9wdHMub3ZlcmZsb3dbMF07CiAgICAgICAgc3R5bGUub3ZlcmZsb3dYID0gb3B0cy5vdmVyZmxvd1sxXTsKICAgICAgICBzdHlsZS5vdmVyZmxvd1kgPSBvcHRzLm92ZXJmbG93WzJdOwogICAgICB9KTsKICAgIH0KCiAgICAvLyBJbXBsZW1lbnQgc2hvdy9oaWRlIGFuaW1hdGlvbnMKICAgIHByb3BUd2VlbiA9IGZhbHNlOwogICAgZm9yIChwcm9wIGluIG9yaWcpIHsKICAgICAgLy8gR2VuZXJhbCBzaG93L2hpZGUgc2V0dXAgZm9yIHRoaXMgZWxlbWVudCBhbmltYXRpb24KICAgICAgaWYgKCFwcm9wVHdlZW4pIHsKICAgICAgICBpZiAoZGF0YVNob3cpIHsKICAgICAgICAgIGlmICgiaGlkZGVuIiBpbiBkYXRhU2hvdykgewogICAgICAgICAgICBoaWRkZW4gPSBkYXRhU2hvdy5oaWRkZW47CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRhdGFTaG93ID0gZGF0YVByaXYuYWNjZXNzKGVsZW0sICJmeHNob3ciLCB7CiAgICAgICAgICAgIGRpc3BsYXk6IHJlc3RvcmVEaXNwbGF5CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIFN0b3JlIGhpZGRlbi92aXNpYmxlIGZvciB0b2dnbGUgc28gYC5zdG9wKCkudG9nZ2xlKClgICJyZXZlcnNlcyIKICAgICAgICBpZiAodG9nZ2xlKSB7CiAgICAgICAgICBkYXRhU2hvdy5oaWRkZW4gPSAhaGlkZGVuOwogICAgICAgIH0KCiAgICAgICAgLy8gU2hvdyBlbGVtZW50cyBiZWZvcmUgYW5pbWF0aW5nIHRoZW0KICAgICAgICBpZiAoaGlkZGVuKSB7CiAgICAgICAgICBzaG93SGlkZShbZWxlbV0sIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tbG9vcC1mdW5jICovCgogICAgICAgIGFuaW0uZG9uZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLWxvb3AtZnVuYyAqLwoKICAgICAgICAgIC8vIFRoZSBmaW5hbCBzdGVwIG9mIGEgImhpZGUiIGFuaW1hdGlvbiBpcyBhY3R1YWxseSBoaWRpbmcgdGhlIGVsZW1lbnQKICAgICAgICAgIGlmICghaGlkZGVuKSB7CiAgICAgICAgICAgIHNob3dIaWRlKFtlbGVtXSk7CiAgICAgICAgICB9CiAgICAgICAgICBkYXRhUHJpdi5yZW1vdmUoZWxlbSwgImZ4c2hvdyIpOwogICAgICAgICAgZm9yIChwcm9wIGluIG9yaWcpIHsKICAgICAgICAgICAgalF1ZXJ5LnN0eWxlKGVsZW0sIHByb3AsIG9yaWdbcHJvcF0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyBQZXItcHJvcGVydHkgc2V0dXAKICAgICAgcHJvcFR3ZWVuID0gY3JlYXRlVHdlZW4oaGlkZGVuID8gZGF0YVNob3dbcHJvcF0gOiAwLCBwcm9wLCBhbmltKTsKICAgICAgaWYgKCEocHJvcCBpbiBkYXRhU2hvdykpIHsKICAgICAgICBkYXRhU2hvd1twcm9wXSA9IHByb3BUd2Vlbi5zdGFydDsKICAgICAgICBpZiAoaGlkZGVuKSB7CiAgICAgICAgICBwcm9wVHdlZW4uZW5kID0gcHJvcFR3ZWVuLnN0YXJ0OwogICAgICAgICAgcHJvcFR3ZWVuLnN0YXJ0ID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gcHJvcEZpbHRlcihwcm9wcywgc3BlY2lhbEVhc2luZykgewogICAgdmFyIGluZGV4LCBuYW1lLCBlYXNpbmcsIHZhbHVlLCBob29rczsKCiAgICAvLyBjYW1lbENhc2UsIHNwZWNpYWxFYXNpbmcgYW5kIGV4cGFuZCBjc3NIb29rIHBhc3MKICAgIGZvciAoaW5kZXggaW4gcHJvcHMpIHsKICAgICAgbmFtZSA9IGNhbWVsQ2FzZShpbmRleCk7CiAgICAgIGVhc2luZyA9IHNwZWNpYWxFYXNpbmdbbmFtZV07CiAgICAgIHZhbHVlID0gcHJvcHNbaW5kZXhdOwogICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICBlYXNpbmcgPSB2YWx1ZVsxXTsKICAgICAgICB2YWx1ZSA9IHByb3BzW2luZGV4XSA9IHZhbHVlWzBdOwogICAgICB9CiAgICAgIGlmIChpbmRleCAhPT0gbmFtZSkgewogICAgICAgIHByb3BzW25hbWVdID0gdmFsdWU7CiAgICAgICAgZGVsZXRlIHByb3BzW2luZGV4XTsKICAgICAgfQogICAgICBob29rcyA9IGpRdWVyeS5jc3NIb29rc1tuYW1lXTsKICAgICAgaWYgKGhvb2tzICYmICJleHBhbmQiIGluIGhvb2tzKSB7CiAgICAgICAgdmFsdWUgPSBob29rcy5leHBhbmQodmFsdWUpOwogICAgICAgIGRlbGV0ZSBwcm9wc1tuYW1lXTsKCiAgICAgICAgLy8gTm90IHF1aXRlICQuZXh0ZW5kLCB0aGlzIHdvbid0IG92ZXJ3cml0ZSBleGlzdGluZyBrZXlzLgogICAgICAgIC8vIFJldXNpbmcgJ2luZGV4JyBiZWNhdXNlIHdlIGhhdmUgdGhlIGNvcnJlY3QgIm5hbWUiCiAgICAgICAgZm9yIChpbmRleCBpbiB2YWx1ZSkgewogICAgICAgICAgaWYgKCEoaW5kZXggaW4gcHJvcHMpKSB7CiAgICAgICAgICAgIHByb3BzW2luZGV4XSA9IHZhbHVlW2luZGV4XTsKICAgICAgICAgICAgc3BlY2lhbEVhc2luZ1tpbmRleF0gPSBlYXNpbmc7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHNwZWNpYWxFYXNpbmdbbmFtZV0gPSBlYXNpbmc7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gQW5pbWF0aW9uKGVsZW0sIHByb3BlcnRpZXMsIG9wdGlvbnMpIHsKICAgIHZhciByZXN1bHQsCiAgICAgIHN0b3BwZWQsCiAgICAgIGluZGV4ID0gMCwKICAgICAgbGVuZ3RoID0gQW5pbWF0aW9uLnByZWZpbHRlcnMubGVuZ3RoLAogICAgICBkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gRG9uJ3QgbWF0Y2ggZWxlbSBpbiB0aGUgOmFuaW1hdGVkIHNlbGVjdG9yCiAgICAgICAgZGVsZXRlIHRpY2suZWxlbTsKICAgICAgfSksCiAgICAgIHRpY2sgPSBmdW5jdGlvbiB0aWNrKCkgewogICAgICAgIGlmIChzdG9wcGVkKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHZhciBjdXJyZW50VGltZSA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksCiAgICAgICAgICByZW1haW5pbmcgPSBNYXRoLm1heCgwLCBhbmltYXRpb24uc3RhcnRUaW1lICsgYW5pbWF0aW9uLmR1cmF0aW9uIC0gY3VycmVudFRpbWUpLAogICAgICAgICAgLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMgb25seQogICAgICAgICAgLy8gQXJjaGFpYyBjcmFzaCBidWcgd29uJ3QgYWxsb3cgdXMgdG8gdXNlIGAxIC0gKCAwLjUgfHwgMCApYCAoIzEyNDk3KQogICAgICAgICAgdGVtcCA9IHJlbWFpbmluZyAvIGFuaW1hdGlvbi5kdXJhdGlvbiB8fCAwLAogICAgICAgICAgcGVyY2VudCA9IDEgLSB0ZW1wLAogICAgICAgICAgaW5kZXggPSAwLAogICAgICAgICAgbGVuZ3RoID0gYW5pbWF0aW9uLnR3ZWVucy5sZW5ndGg7CiAgICAgICAgZm9yICg7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICBhbmltYXRpb24udHdlZW5zW2luZGV4XS5ydW4ocGVyY2VudCk7CiAgICAgICAgfQogICAgICAgIGRlZmVycmVkLm5vdGlmeVdpdGgoZWxlbSwgW2FuaW1hdGlvbiwgcGVyY2VudCwgcmVtYWluaW5nXSk7CgogICAgICAgIC8vIElmIHRoZXJlJ3MgbW9yZSB0byBkbywgeWllbGQKICAgICAgICBpZiAocGVyY2VudCA8IDEgJiYgbGVuZ3RoKSB7CiAgICAgICAgICByZXR1cm4gcmVtYWluaW5nOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgdGhpcyB3YXMgYW4gZW1wdHkgYW5pbWF0aW9uLCBzeW50aGVzaXplIGEgZmluYWwgcHJvZ3Jlc3Mgbm90aWZpY2F0aW9uCiAgICAgICAgaWYgKCFsZW5ndGgpIHsKICAgICAgICAgIGRlZmVycmVkLm5vdGlmeVdpdGgoZWxlbSwgW2FuaW1hdGlvbiwgMSwgMF0pOwogICAgICAgIH0KCiAgICAgICAgLy8gUmVzb2x2ZSB0aGUgYW5pbWF0aW9uIGFuZCByZXBvcnQgaXRzIGNvbmNsdXNpb24KICAgICAgICBkZWZlcnJlZC5yZXNvbHZlV2l0aChlbGVtLCBbYW5pbWF0aW9uXSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9LAogICAgICBhbmltYXRpb24gPSBkZWZlcnJlZC5wcm9taXNlKHsKICAgICAgICBlbGVtOiBlbGVtLAogICAgICAgIHByb3BzOiBqUXVlcnkuZXh0ZW5kKHt9LCBwcm9wZXJ0aWVzKSwKICAgICAgICBvcHRzOiBqUXVlcnkuZXh0ZW5kKHRydWUsIHsKICAgICAgICAgIHNwZWNpYWxFYXNpbmc6IHt9LAogICAgICAgICAgZWFzaW5nOiBqUXVlcnkuZWFzaW5nLl9kZWZhdWx0CiAgICAgICAgfSwgb3B0aW9ucyksCiAgICAgICAgb3JpZ2luYWxQcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAogICAgICAgIG9yaWdpbmFsT3B0aW9uczogb3B0aW9ucywKICAgICAgICBzdGFydFRpbWU6IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksCiAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sCiAgICAgICAgdHdlZW5zOiBbXSwKICAgICAgICBjcmVhdGVUd2VlbjogZnVuY3Rpb24gY3JlYXRlVHdlZW4ocHJvcCwgZW5kKSB7CiAgICAgICAgICB2YXIgdHdlZW4gPSBqUXVlcnkuVHdlZW4oZWxlbSwgYW5pbWF0aW9uLm9wdHMsIHByb3AsIGVuZCwgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZ1twcm9wXSB8fCBhbmltYXRpb24ub3B0cy5lYXNpbmcpOwogICAgICAgICAgYW5pbWF0aW9uLnR3ZWVucy5wdXNoKHR3ZWVuKTsKICAgICAgICAgIHJldHVybiB0d2VlbjsKICAgICAgICB9LAogICAgICAgIHN0b3A6IGZ1bmN0aW9uIHN0b3AoZ290b0VuZCkgewogICAgICAgICAgdmFyIGluZGV4ID0gMCwKICAgICAgICAgICAgLy8gSWYgd2UgYXJlIGdvaW5nIHRvIHRoZSBlbmQsIHdlIHdhbnQgdG8gcnVuIGFsbCB0aGUgdHdlZW5zCiAgICAgICAgICAgIC8vIG90aGVyd2lzZSB3ZSBza2lwIHRoaXMgcGFydAogICAgICAgICAgICBsZW5ndGggPSBnb3RvRW5kID8gYW5pbWF0aW9uLnR3ZWVucy5sZW5ndGggOiAwOwogICAgICAgICAgaWYgKHN0b3BwZWQpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9CiAgICAgICAgICBzdG9wcGVkID0gdHJ1ZTsKICAgICAgICAgIGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICBhbmltYXRpb24udHdlZW5zW2luZGV4XS5ydW4oMSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gUmVzb2x2ZSB3aGVuIHdlIHBsYXllZCB0aGUgbGFzdCBmcmFtZTsgb3RoZXJ3aXNlLCByZWplY3QKICAgICAgICAgIGlmIChnb3RvRW5kKSB7CiAgICAgICAgICAgIGRlZmVycmVkLm5vdGlmeVdpdGgoZWxlbSwgW2FuaW1hdGlvbiwgMSwgMF0pOwogICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlV2l0aChlbGVtLCBbYW5pbWF0aW9uLCBnb3RvRW5kXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZWZlcnJlZC5yZWplY3RXaXRoKGVsZW0sIFthbmltYXRpb24sIGdvdG9FbmRdKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KICAgICAgfSksCiAgICAgIHByb3BzID0gYW5pbWF0aW9uLnByb3BzOwogICAgcHJvcEZpbHRlcihwcm9wcywgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZyk7CiAgICBmb3IgKDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKICAgICAgcmVzdWx0ID0gQW5pbWF0aW9uLnByZWZpbHRlcnNbaW5kZXhdLmNhbGwoYW5pbWF0aW9uLCBlbGVtLCBwcm9wcywgYW5pbWF0aW9uLm9wdHMpOwogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgaWYgKGlzRnVuY3Rpb24ocmVzdWx0LnN0b3ApKSB7CiAgICAgICAgICBqUXVlcnkuX3F1ZXVlSG9va3MoYW5pbWF0aW9uLmVsZW0sIGFuaW1hdGlvbi5vcHRzLnF1ZXVlKS5zdG9wID0gcmVzdWx0LnN0b3AuYmluZChyZXN1bHQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICB9CiAgICBqUXVlcnkubWFwKHByb3BzLCBjcmVhdGVUd2VlbiwgYW5pbWF0aW9uKTsKICAgIGlmIChpc0Z1bmN0aW9uKGFuaW1hdGlvbi5vcHRzLnN0YXJ0KSkgewogICAgICBhbmltYXRpb24ub3B0cy5zdGFydC5jYWxsKGVsZW0sIGFuaW1hdGlvbik7CiAgICB9CgogICAgLy8gQXR0YWNoIGNhbGxiYWNrcyBmcm9tIG9wdGlvbnMKICAgIGFuaW1hdGlvbi5wcm9ncmVzcyhhbmltYXRpb24ub3B0cy5wcm9ncmVzcykuZG9uZShhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSkuZmFpbChhbmltYXRpb24ub3B0cy5mYWlsKS5hbHdheXMoYW5pbWF0aW9uLm9wdHMuYWx3YXlzKTsKICAgIGpRdWVyeS5meC50aW1lcihqUXVlcnkuZXh0ZW5kKHRpY2ssIHsKICAgICAgZWxlbTogZWxlbSwKICAgICAgYW5pbTogYW5pbWF0aW9uLAogICAgICBxdWV1ZTogYW5pbWF0aW9uLm9wdHMucXVldWUKICAgIH0pKTsKICAgIHJldHVybiBhbmltYXRpb247CiAgfQogIGpRdWVyeS5BbmltYXRpb24gPSBqUXVlcnkuZXh0ZW5kKEFuaW1hdGlvbiwgewogICAgdHdlZW5lcnM6IHsKICAgICAgIioiOiBbZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7CiAgICAgICAgdmFyIHR3ZWVuID0gdGhpcy5jcmVhdGVUd2Vlbihwcm9wLCB2YWx1ZSk7CiAgICAgICAgYWRqdXN0Q1NTKHR3ZWVuLmVsZW0sIHByb3AsIHJjc3NOdW0uZXhlYyh2YWx1ZSksIHR3ZWVuKTsKICAgICAgICByZXR1cm4gdHdlZW47CiAgICAgIH1dCiAgICB9LAogICAgdHdlZW5lcjogZnVuY3Rpb24gdHdlZW5lcihwcm9wcywgY2FsbGJhY2spIHsKICAgICAgaWYgKGlzRnVuY3Rpb24ocHJvcHMpKSB7CiAgICAgICAgY2FsbGJhY2sgPSBwcm9wczsKICAgICAgICBwcm9wcyA9IFsiKiJdOwogICAgICB9IGVsc2UgewogICAgICAgIHByb3BzID0gcHJvcHMubWF0Y2gocm5vdGh0bWx3aGl0ZSk7CiAgICAgIH0KICAgICAgdmFyIHByb3AsCiAgICAgICAgaW5kZXggPSAwLAogICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDsKICAgICAgZm9yICg7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgcHJvcCA9IHByb3BzW2luZGV4XTsKICAgICAgICBBbmltYXRpb24udHdlZW5lcnNbcHJvcF0gPSBBbmltYXRpb24udHdlZW5lcnNbcHJvcF0gfHwgW107CiAgICAgICAgQW5pbWF0aW9uLnR3ZWVuZXJzW3Byb3BdLnVuc2hpZnQoY2FsbGJhY2spOwogICAgICB9CiAgICB9LAogICAgcHJlZmlsdGVyczogW2RlZmF1bHRQcmVmaWx0ZXJdLAogICAgcHJlZmlsdGVyOiBmdW5jdGlvbiBwcmVmaWx0ZXIoY2FsbGJhY2ssIHByZXBlbmQpIHsKICAgICAgaWYgKHByZXBlbmQpIHsKICAgICAgICBBbmltYXRpb24ucHJlZmlsdGVycy51bnNoaWZ0KGNhbGxiYWNrKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBBbmltYXRpb24ucHJlZmlsdGVycy5wdXNoKGNhbGxiYWNrKTsKICAgICAgfQogICAgfQogIH0pOwogIGpRdWVyeS5zcGVlZCA9IGZ1bmN0aW9uIChzcGVlZCwgZWFzaW5nLCBmbikgewogICAgdmFyIG9wdCA9IHNwZWVkICYmIF90eXBlb2Yoc3BlZWQpID09PSAib2JqZWN0IiA/IGpRdWVyeS5leHRlbmQoe30sIHNwZWVkKSA6IHsKICAgICAgY29tcGxldGU6IGZuIHx8ICFmbiAmJiBlYXNpbmcgfHwgaXNGdW5jdGlvbihzcGVlZCkgJiYgc3BlZWQsCiAgICAgIGR1cmF0aW9uOiBzcGVlZCwKICAgICAgZWFzaW5nOiBmbiAmJiBlYXNpbmcgfHwgZWFzaW5nICYmICFpc0Z1bmN0aW9uKGVhc2luZykgJiYgZWFzaW5nCiAgICB9OwoKICAgIC8vIEdvIHRvIHRoZSBlbmQgc3RhdGUgaWYgZnggYXJlIG9mZgogICAgaWYgKGpRdWVyeS5meC5vZmYpIHsKICAgICAgb3B0LmR1cmF0aW9uID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGlmICh0eXBlb2Ygb3B0LmR1cmF0aW9uICE9PSAibnVtYmVyIikgewogICAgICAgIGlmIChvcHQuZHVyYXRpb24gaW4galF1ZXJ5LmZ4LnNwZWVkcykgewogICAgICAgICAgb3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4LnNwZWVkc1tvcHQuZHVyYXRpb25dOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBvcHQuZHVyYXRpb24gPSBqUXVlcnkuZnguc3BlZWRzLl9kZWZhdWx0OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIE5vcm1hbGl6ZSBvcHQucXVldWUgLSB0cnVlL3VuZGVmaW5lZC9udWxsIC0+ICJmeCIKICAgIGlmIChvcHQucXVldWUgPT0gbnVsbCB8fCBvcHQucXVldWUgPT09IHRydWUpIHsKICAgICAgb3B0LnF1ZXVlID0gImZ4IjsKICAgIH0KCiAgICAvLyBRdWV1ZWluZwogICAgb3B0Lm9sZCA9IG9wdC5jb21wbGV0ZTsKICAgIG9wdC5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0Lm9sZCkpIHsKICAgICAgICBvcHQub2xkLmNhbGwodGhpcyk7CiAgICAgIH0KICAgICAgaWYgKG9wdC5xdWV1ZSkgewogICAgICAgIGpRdWVyeS5kZXF1ZXVlKHRoaXMsIG9wdC5xdWV1ZSk7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gb3B0OwogIH07CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBmYWRlVG86IGZ1bmN0aW9uIGZhZGVUbyhzcGVlZCwgdG8sIGVhc2luZywgY2FsbGJhY2spIHsKICAgICAgLy8gU2hvdyBhbnkgaGlkZGVuIGVsZW1lbnRzIGFmdGVyIHNldHRpbmcgb3BhY2l0eSB0byAwCiAgICAgIHJldHVybiB0aGlzLmZpbHRlcihpc0hpZGRlbldpdGhpblRyZWUpLmNzcygib3BhY2l0eSIsIDApLnNob3coKQoKICAgICAgLy8gQW5pbWF0ZSB0byB0aGUgdmFsdWUgc3BlY2lmaWVkCiAgICAgIC5lbmQoKS5hbmltYXRlKHsKICAgICAgICBvcGFjaXR5OiB0bwogICAgICB9LCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayk7CiAgICB9LAogICAgYW5pbWF0ZTogZnVuY3Rpb24gYW5pbWF0ZShwcm9wLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjaykgewogICAgICB2YXIgZW1wdHkgPSBqUXVlcnkuaXNFbXB0eU9iamVjdChwcm9wKSwKICAgICAgICBvcHRhbGwgPSBqUXVlcnkuc3BlZWQoc3BlZWQsIGVhc2luZywgY2FsbGJhY2spLAogICAgICAgIGRvQW5pbWF0aW9uID0gZnVuY3Rpb24gZG9BbmltYXRpb24oKSB7CiAgICAgICAgICAvLyBPcGVyYXRlIG9uIGEgY29weSBvZiBwcm9wIHNvIHBlci1wcm9wZXJ0eSBlYXNpbmcgd29uJ3QgYmUgbG9zdAogICAgICAgICAgdmFyIGFuaW0gPSBBbmltYXRpb24odGhpcywgalF1ZXJ5LmV4dGVuZCh7fSwgcHJvcCksIG9wdGFsbCk7CgogICAgICAgICAgLy8gRW1wdHkgYW5pbWF0aW9ucywgb3IgZmluaXNoaW5nIHJlc29sdmVzIGltbWVkaWF0ZWx5CiAgICAgICAgICBpZiAoZW1wdHkgfHwgZGF0YVByaXYuZ2V0KHRoaXMsICJmaW5pc2giKSkgewogICAgICAgICAgICBhbmltLnN0b3AodHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgZG9BbmltYXRpb24uZmluaXNoID0gZG9BbmltYXRpb247CiAgICAgIHJldHVybiBlbXB0eSB8fCBvcHRhbGwucXVldWUgPT09IGZhbHNlID8gdGhpcy5lYWNoKGRvQW5pbWF0aW9uKSA6IHRoaXMucXVldWUob3B0YWxsLnF1ZXVlLCBkb0FuaW1hdGlvbik7CiAgICB9LAogICAgc3RvcDogZnVuY3Rpb24gc3RvcCh0eXBlLCBjbGVhclF1ZXVlLCBnb3RvRW5kKSB7CiAgICAgIHZhciBzdG9wUXVldWUgPSBmdW5jdGlvbiBzdG9wUXVldWUoaG9va3MpIHsKICAgICAgICB2YXIgc3RvcCA9IGhvb2tzLnN0b3A7CiAgICAgICAgZGVsZXRlIGhvb2tzLnN0b3A7CiAgICAgICAgc3RvcChnb3RvRW5kKTsKICAgICAgfTsKICAgICAgaWYgKHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIikgewogICAgICAgIGdvdG9FbmQgPSBjbGVhclF1ZXVlOwogICAgICAgIGNsZWFyUXVldWUgPSB0eXBlOwogICAgICAgIHR5cGUgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgaWYgKGNsZWFyUXVldWUpIHsKICAgICAgICB0aGlzLnF1ZXVlKHR5cGUgfHwgImZ4IiwgW10pOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBkZXF1ZXVlID0gdHJ1ZSwKICAgICAgICAgIGluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyAicXVldWVIb29rcyIsCiAgICAgICAgICB0aW1lcnMgPSBqUXVlcnkudGltZXJzLAogICAgICAgICAgZGF0YSA9IGRhdGFQcml2LmdldCh0aGlzKTsKICAgICAgICBpZiAoaW5kZXgpIHsKICAgICAgICAgIGlmIChkYXRhW2luZGV4XSAmJiBkYXRhW2luZGV4XS5zdG9wKSB7CiAgICAgICAgICAgIHN0b3BRdWV1ZShkYXRhW2luZGV4XSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAoaW5kZXggaW4gZGF0YSkgewogICAgICAgICAgICBpZiAoZGF0YVtpbmRleF0gJiYgZGF0YVtpbmRleF0uc3RvcCAmJiBycnVuLnRlc3QoaW5kZXgpKSB7CiAgICAgICAgICAgICAgc3RvcFF1ZXVlKGRhdGFbaW5kZXhdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmb3IgKGluZGV4ID0gdGltZXJzLmxlbmd0aDsgaW5kZXgtLTspIHsKICAgICAgICAgIGlmICh0aW1lcnNbaW5kZXhdLmVsZW0gPT09IHRoaXMgJiYgKHR5cGUgPT0gbnVsbCB8fCB0aW1lcnNbaW5kZXhdLnF1ZXVlID09PSB0eXBlKSkgewogICAgICAgICAgICB0aW1lcnNbaW5kZXhdLmFuaW0uc3RvcChnb3RvRW5kKTsKICAgICAgICAgICAgZGVxdWV1ZSA9IGZhbHNlOwogICAgICAgICAgICB0aW1lcnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFN0YXJ0IHRoZSBuZXh0IGluIHRoZSBxdWV1ZSBpZiB0aGUgbGFzdCBzdGVwIHdhc24ndCBmb3JjZWQuCiAgICAgICAgLy8gVGltZXJzIGN1cnJlbnRseSB3aWxsIGNhbGwgdGhlaXIgY29tcGxldGUgY2FsbGJhY2tzLCB3aGljaAogICAgICAgIC8vIHdpbGwgZGVxdWV1ZSBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZC4KICAgICAgICBpZiAoZGVxdWV1ZSB8fCAhZ290b0VuZCkgewogICAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBmaW5pc2g6IGZ1bmN0aW9uIGZpbmlzaCh0eXBlKSB7CiAgICAgIGlmICh0eXBlICE9PSBmYWxzZSkgewogICAgICAgIHR5cGUgPSB0eXBlIHx8ICJmeCI7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGluZGV4LAogICAgICAgICAgZGF0YSA9IGRhdGFQcml2LmdldCh0aGlzKSwKICAgICAgICAgIHF1ZXVlID0gZGF0YVt0eXBlICsgInF1ZXVlIl0sCiAgICAgICAgICBob29rcyA9IGRhdGFbdHlwZSArICJxdWV1ZUhvb2tzIl0sCiAgICAgICAgICB0aW1lcnMgPSBqUXVlcnkudGltZXJzLAogICAgICAgICAgbGVuZ3RoID0gcXVldWUgPyBxdWV1ZS5sZW5ndGggOiAwOwoKICAgICAgICAvLyBFbmFibGUgZmluaXNoaW5nIGZsYWcgb24gcHJpdmF0ZSBkYXRhCiAgICAgICAgZGF0YS5maW5pc2ggPSB0cnVlOwoKICAgICAgICAvLyBFbXB0eSB0aGUgcXVldWUgZmlyc3QKICAgICAgICBqUXVlcnkucXVldWUodGhpcywgdHlwZSwgW10pOwogICAgICAgIGlmIChob29rcyAmJiBob29rcy5zdG9wKSB7CiAgICAgICAgICBob29rcy5zdG9wLmNhbGwodGhpcywgdHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBMb29rIGZvciBhbnkgYWN0aXZlIGFuaW1hdGlvbnMsIGFuZCBmaW5pc2ggdGhlbQogICAgICAgIGZvciAoaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOykgewogICAgICAgICAgaWYgKHRpbWVyc1tpbmRleF0uZWxlbSA9PT0gdGhpcyAmJiB0aW1lcnNbaW5kZXhdLnF1ZXVlID09PSB0eXBlKSB7CiAgICAgICAgICAgIHRpbWVyc1tpbmRleF0uYW5pbS5zdG9wKHRydWUpOwogICAgICAgICAgICB0aW1lcnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIExvb2sgZm9yIGFueSBhbmltYXRpb25zIGluIHRoZSBvbGQgcXVldWUgYW5kIGZpbmlzaCB0aGVtCiAgICAgICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICBpZiAocXVldWVbaW5kZXhdICYmIHF1ZXVlW2luZGV4XS5maW5pc2gpIHsKICAgICAgICAgICAgcXVldWVbaW5kZXhdLmZpbmlzaC5jYWxsKHRoaXMpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVHVybiBvZmYgZmluaXNoaW5nIGZsYWcKICAgICAgICBkZWxldGUgZGF0YS5maW5pc2g7CiAgICAgIH0pOwogICAgfQogIH0pOwogIGpRdWVyeS5lYWNoKFsidG9nZ2xlIiwgInNob3ciLCAiaGlkZSJdLCBmdW5jdGlvbiAoX2ksIG5hbWUpIHsKICAgIHZhciBjc3NGbiA9IGpRdWVyeS5mbltuYW1lXTsKICAgIGpRdWVyeS5mbltuYW1lXSA9IGZ1bmN0aW9uIChzcGVlZCwgZWFzaW5nLCBjYWxsYmFjaykgewogICAgICByZXR1cm4gc3BlZWQgPT0gbnVsbCB8fCB0eXBlb2Ygc3BlZWQgPT09ICJib29sZWFuIiA/IGNzc0ZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiB0aGlzLmFuaW1hdGUoZ2VuRngobmFtZSwgdHJ1ZSksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrKTsKICAgIH07CiAgfSk7CgogIC8vIEdlbmVyYXRlIHNob3J0Y3V0cyBmb3IgY3VzdG9tIGFuaW1hdGlvbnMKICBqUXVlcnkuZWFjaCh7CiAgICBzbGlkZURvd246IGdlbkZ4KCJzaG93IiksCiAgICBzbGlkZVVwOiBnZW5GeCgiaGlkZSIpLAogICAgc2xpZGVUb2dnbGU6IGdlbkZ4KCJ0b2dnbGUiKSwKICAgIGZhZGVJbjogewogICAgICBvcGFjaXR5OiAic2hvdyIKICAgIH0sCiAgICBmYWRlT3V0OiB7CiAgICAgIG9wYWNpdHk6ICJoaWRlIgogICAgfSwKICAgIGZhZGVUb2dnbGU6IHsKICAgICAgb3BhY2l0eTogInRvZ2dsZSIKICAgIH0KICB9LCBmdW5jdGlvbiAobmFtZSwgcHJvcHMpIHsKICAgIGpRdWVyeS5mbltuYW1lXSA9IGZ1bmN0aW9uIChzcGVlZCwgZWFzaW5nLCBjYWxsYmFjaykgewogICAgICByZXR1cm4gdGhpcy5hbmltYXRlKHByb3BzLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayk7CiAgICB9OwogIH0pOwogIGpRdWVyeS50aW1lcnMgPSBbXTsKICBqUXVlcnkuZngudGljayA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB0aW1lciwKICAgICAgaSA9IDAsCiAgICAgIHRpbWVycyA9IGpRdWVyeS50aW1lcnM7CiAgICBmeE5vdyA9IERhdGUubm93KCk7CiAgICBmb3IgKDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKykgewogICAgICB0aW1lciA9IHRpbWVyc1tpXTsKCiAgICAgIC8vIFJ1biB0aGUgdGltZXIgYW5kIHNhZmVseSByZW1vdmUgaXQgd2hlbiBkb25lIChhbGxvd2luZyBmb3IgZXh0ZXJuYWwgcmVtb3ZhbCkKICAgICAgaWYgKCF0aW1lcigpICYmIHRpbWVyc1tpXSA9PT0gdGltZXIpIHsKICAgICAgICB0aW1lcnMuc3BsaWNlKGktLSwgMSk7CiAgICAgIH0KICAgIH0KICAgIGlmICghdGltZXJzLmxlbmd0aCkgewogICAgICBqUXVlcnkuZnguc3RvcCgpOwogICAgfQogICAgZnhOb3cgPSB1bmRlZmluZWQ7CiAgfTsKICBqUXVlcnkuZngudGltZXIgPSBmdW5jdGlvbiAodGltZXIpIHsKICAgIGpRdWVyeS50aW1lcnMucHVzaCh0aW1lcik7CiAgICBqUXVlcnkuZnguc3RhcnQoKTsKICB9OwogIGpRdWVyeS5meC5pbnRlcnZhbCA9IDEzOwogIGpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uICgpIHsKICAgIGlmIChpblByb2dyZXNzKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGluUHJvZ3Jlc3MgPSB0cnVlOwogICAgc2NoZWR1bGUoKTsKICB9OwogIGpRdWVyeS5meC5zdG9wID0gZnVuY3Rpb24gKCkgewogICAgaW5Qcm9ncmVzcyA9IG51bGw7CiAgfTsKICBqUXVlcnkuZnguc3BlZWRzID0gewogICAgc2xvdzogNjAwLAogICAgZmFzdDogMjAwLAogICAgLy8gRGVmYXVsdCBzcGVlZAogICAgX2RlZmF1bHQ6IDQwMAogIH07CgogIC8vIEJhc2VkIG9mZiBvZiB0aGUgcGx1Z2luIGJ5IENsaW50IEhlbGZlcnMsIHdpdGggcGVybWlzc2lvbi4KICAvLyBodHRwczovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxMDAzMjQwMTQ3NDcvaHR0cDovL2JsaW5kc2lnbmFscy5jb20vaW5kZXgucGhwLzIwMDkvMDcvanF1ZXJ5LWRlbGF5LwogIGpRdWVyeS5mbi5kZWxheSA9IGZ1bmN0aW9uICh0aW1lLCB0eXBlKSB7CiAgICB0aW1lID0galF1ZXJ5LmZ4ID8galF1ZXJ5LmZ4LnNwZWVkc1t0aW1lXSB8fCB0aW1lIDogdGltZTsKICAgIHR5cGUgPSB0eXBlIHx8ICJmeCI7CiAgICByZXR1cm4gdGhpcy5xdWV1ZSh0eXBlLCBmdW5jdGlvbiAobmV4dCwgaG9va3MpIHsKICAgICAgdmFyIHRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChuZXh0LCB0aW1lKTsKICAgICAgaG9va3Muc3RvcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwogICAgICB9OwogICAgfSk7CiAgfTsKICAoZnVuY3Rpb24gKCkgewogICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSwKICAgICAgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2VsZWN0IiksCiAgICAgIG9wdCA9IHNlbGVjdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7CiAgICBpbnB1dC50eXBlID0gImNoZWNrYm94IjsKCiAgICAvLyBTdXBwb3J0OiBBbmRyb2lkIDw9NC4zIG9ubHkKICAgIC8vIERlZmF1bHQgdmFsdWUgZm9yIGEgY2hlY2tib3ggc2hvdWxkIGJlICJvbiIKICAgIHN1cHBvcnQuY2hlY2tPbiA9IGlucHV0LnZhbHVlICE9PSAiIjsKCiAgICAvLyBTdXBwb3J0OiBJRSA8PTExIG9ubHkKICAgIC8vIE11c3QgYWNjZXNzIHNlbGVjdGVkSW5kZXggdG8gbWFrZSBkZWZhdWx0IG9wdGlvbnMgc2VsZWN0CiAgICBzdXBwb3J0Lm9wdFNlbGVjdGVkID0gb3B0LnNlbGVjdGVkOwoKICAgIC8vIFN1cHBvcnQ6IElFIDw9MTEgb25seQogICAgLy8gQW4gaW5wdXQgbG9zZXMgaXRzIHZhbHVlIGFmdGVyIGJlY29taW5nIGEgcmFkaW8KICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgIGlucHV0LnZhbHVlID0gInQiOwogICAgaW5wdXQudHlwZSA9ICJyYWRpbyI7CiAgICBzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gInQiOwogIH0pKCk7CiAgdmFyIGJvb2xIb29rLAogICAgYXR0ckhhbmRsZSA9IGpRdWVyeS5leHByLmF0dHJIYW5kbGU7CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBhdHRyOiBmdW5jdGlvbiBhdHRyKG5hbWUsIHZhbHVlKSB7CiAgICAgIHJldHVybiBhY2Nlc3ModGhpcywgalF1ZXJ5LmF0dHIsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSk7CiAgICB9LAogICAgcmVtb3ZlQXR0cjogZnVuY3Rpb24gcmVtb3ZlQXR0cihuYW1lKSB7CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGpRdWVyeS5yZW1vdmVBdHRyKHRoaXMsIG5hbWUpOwogICAgICB9KTsKICAgIH0KICB9KTsKICBqUXVlcnkuZXh0ZW5kKHsKICAgIGF0dHI6IGZ1bmN0aW9uIGF0dHIoZWxlbSwgbmFtZSwgdmFsdWUpIHsKICAgICAgdmFyIHJldCwKICAgICAgICBob29rcywKICAgICAgICBuVHlwZSA9IGVsZW0ubm9kZVR5cGU7CgogICAgICAvLyBEb24ndCBnZXQvc2V0IGF0dHJpYnV0ZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRlIG5vZGVzCiAgICAgIGlmIChuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gRmFsbGJhY2sgdG8gcHJvcCB3aGVuIGF0dHJpYnV0ZXMgYXJlIG5vdCBzdXBwb3J0ZWQKICAgICAgaWYgKHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXR1cm4galF1ZXJ5LnByb3AoZWxlbSwgbmFtZSwgdmFsdWUpOwogICAgICB9CgogICAgICAvLyBBdHRyaWJ1dGUgaG9va3MgYXJlIGRldGVybWluZWQgYnkgdGhlIGxvd2VyY2FzZSB2ZXJzaW9uCiAgICAgIC8vIEdyYWIgbmVjZXNzYXJ5IGhvb2sgaWYgb25lIGlzIGRlZmluZWQKICAgICAgaWYgKG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoZWxlbSkpIHsKICAgICAgICBob29rcyA9IGpRdWVyeS5hdHRySG9va3NbbmFtZS50b0xvd2VyQ2FzZSgpXSB8fCAoalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KG5hbWUpID8gYm9vbEhvb2sgOiB1bmRlZmluZWQpOwogICAgICB9CiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICBqUXVlcnkucmVtb3ZlQXR0cihlbGVtLCBuYW1lKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGhvb2tzICYmICJzZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5zZXQoZWxlbSwgdmFsdWUsIG5hbWUpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0KICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSArICIiKTsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KICAgICAgaWYgKGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoZWxlbSwgbmFtZSkpICE9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHJldDsKICAgICAgfQogICAgICByZXQgPSBqUXVlcnkuZmluZC5hdHRyKGVsZW0sIG5hbWUpOwoKICAgICAgLy8gTm9uLWV4aXN0ZW50IGF0dHJpYnV0ZXMgcmV0dXJuIG51bGwsIHdlIG5vcm1hbGl6ZSB0byB1bmRlZmluZWQKICAgICAgcmV0dXJuIHJldCA9PSBudWxsID8gdW5kZWZpbmVkIDogcmV0OwogICAgfSwKICAgIGF0dHJIb29rczogewogICAgICB0eXBlOiB7CiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUpIHsKICAgICAgICAgIGlmICghc3VwcG9ydC5yYWRpb1ZhbHVlICYmIHZhbHVlID09PSAicmFkaW8iICYmIG5vZGVOYW1lKGVsZW0sICJpbnB1dCIpKSB7CiAgICAgICAgICAgIHZhciB2YWwgPSBlbGVtLnZhbHVlOwogICAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZSgidHlwZSIsIHZhbHVlKTsKICAgICAgICAgICAgaWYgKHZhbCkgewogICAgICAgICAgICAgIGVsZW0udmFsdWUgPSB2YWw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9uIHJlbW92ZUF0dHIoZWxlbSwgdmFsdWUpIHsKICAgICAgdmFyIG5hbWUsCiAgICAgICAgaSA9IDAsCiAgICAgICAgLy8gQXR0cmlidXRlIG5hbWVzIGNhbiBjb250YWluIG5vbi1IVE1MIHdoaXRlc3BhY2UgY2hhcmFjdGVycwogICAgICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2F0dHJpYnV0ZXMtMgogICAgICAgIGF0dHJOYW1lcyA9IHZhbHVlICYmIHZhbHVlLm1hdGNoKHJub3RodG1sd2hpdGUpOwogICAgICBpZiAoYXR0ck5hbWVzICYmIGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICB3aGlsZSAobmFtZSA9IGF0dHJOYW1lc1tpKytdKSB7CiAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gSG9va3MgZm9yIGJvb2xlYW4gYXR0cmlidXRlcwogIGJvb2xIb29rID0gewogICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUsIG5hbWUpIHsKICAgICAgaWYgKHZhbHVlID09PSBmYWxzZSkgewogICAgICAgIC8vIFJlbW92ZSBib29sZWFuIGF0dHJpYnV0ZXMgd2hlbiBzZXQgdG8gZmFsc2UKICAgICAgICBqUXVlcnkucmVtb3ZlQXR0cihlbGVtLCBuYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShuYW1lLCBuYW1lKTsKICAgICAgfQogICAgICByZXR1cm4gbmFtZTsKICAgIH0KICB9OwogIGpRdWVyeS5lYWNoKGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksIGZ1bmN0aW9uIChfaSwgbmFtZSkgewogICAgdmFyIGdldHRlciA9IGF0dHJIYW5kbGVbbmFtZV0gfHwgalF1ZXJ5LmZpbmQuYXR0cjsKICAgIGF0dHJIYW5kbGVbbmFtZV0gPSBmdW5jdGlvbiAoZWxlbSwgbmFtZSwgaXNYTUwpIHsKICAgICAgdmFyIHJldCwKICAgICAgICBoYW5kbGUsCiAgICAgICAgbG93ZXJjYXNlTmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgaWYgKCFpc1hNTCkgewogICAgICAgIC8vIEF2b2lkIGFuIGluZmluaXRlIGxvb3AgYnkgdGVtcG9yYXJpbHkgcmVtb3ZpbmcgdGhpcyBmdW5jdGlvbiBmcm9tIHRoZSBnZXR0ZXIKICAgICAgICBoYW5kbGUgPSBhdHRySGFuZGxlW2xvd2VyY2FzZU5hbWVdOwogICAgICAgIGF0dHJIYW5kbGVbbG93ZXJjYXNlTmFtZV0gPSByZXQ7CiAgICAgICAgcmV0ID0gZ2V0dGVyKGVsZW0sIG5hbWUsIGlzWE1MKSAhPSBudWxsID8gbG93ZXJjYXNlTmFtZSA6IG51bGw7CiAgICAgICAgYXR0ckhhbmRsZVtsb3dlcmNhc2VOYW1lXSA9IGhhbmRsZTsKICAgICAgfQogICAgICByZXR1cm4gcmV0OwogICAgfTsKICB9KTsKICB2YXIgcmZvY3VzYWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksCiAgICByY2xpY2thYmxlID0gL14oPzphfGFyZWEpJC9pOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgcHJvcDogZnVuY3Rpb24gcHJvcChuYW1lLCB2YWx1ZSkgewogICAgICByZXR1cm4gYWNjZXNzKHRoaXMsIGpRdWVyeS5wcm9wLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEpOwogICAgfSwKICAgIHJlbW92ZVByb3A6IGZ1bmN0aW9uIHJlbW92ZVByb3AobmFtZSkgewogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBkZWxldGUgdGhpc1tqUXVlcnkucHJvcEZpeFtuYW1lXSB8fCBuYW1lXTsKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgalF1ZXJ5LmV4dGVuZCh7CiAgICBwcm9wOiBmdW5jdGlvbiBwcm9wKGVsZW0sIG5hbWUsIHZhbHVlKSB7CiAgICAgIHZhciByZXQsCiAgICAgICAgaG9va3MsCiAgICAgICAgblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKICAgICAgLy8gRG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwogICAgICBpZiAoblR5cGUgPT09IDMgfHwgblR5cGUgPT09IDggfHwgblR5cGUgPT09IDIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoZWxlbSkpIHsKICAgICAgICAvLyBGaXggbmFtZSBhbmQgYXR0YWNoIGhvb2tzCiAgICAgICAgbmFtZSA9IGpRdWVyeS5wcm9wRml4W25hbWVdIHx8IG5hbWU7CiAgICAgICAgaG9va3MgPSBqUXVlcnkucHJvcEhvb2tzW25hbWVdOwogICAgICB9CiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGhvb2tzICYmICJzZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5zZXQoZWxlbSwgdmFsdWUsIG5hbWUpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0KICAgICAgICByZXR1cm4gZWxlbVtuYW1lXSA9IHZhbHVlOwogICAgICB9CiAgICAgIGlmIChob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KGVsZW0sIG5hbWUpKSAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0KICAgICAgcmV0dXJuIGVsZW1bbmFtZV07CiAgICB9LAogICAgcHJvcEhvb2tzOiB7CiAgICAgIHRhYkluZGV4OiB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSkgewogICAgICAgICAgLy8gU3VwcG9ydDogSUUgPD05IC0gMTEgb25seQogICAgICAgICAgLy8gZWxlbS50YWJJbmRleCBkb2Vzbid0IGFsd2F5cyByZXR1cm4gdGhlCiAgICAgICAgICAvLyBjb3JyZWN0IHZhbHVlIHdoZW4gaXQgaGFzbid0IGJlZW4gZXhwbGljaXRseSBzZXQKICAgICAgICAgIC8vIGh0dHBzOi8vd2ViLmFyY2hpdmUub3JnL3dlYi8yMDE0MTExNjIzMzM0Ny9odHRwOi8vZmx1aWRwcm9qZWN0Lm9yZy9ibG9nLzIwMDgvMDEvMDkvZ2V0dGluZy1zZXR0aW5nLWFuZC1yZW1vdmluZy10YWJpbmRleC12YWx1ZXMtd2l0aC1qYXZhc2NyaXB0LwogICAgICAgICAgLy8gVXNlIHByb3BlciBhdHRyaWJ1dGUgcmV0cmlldmFsKCMxMjA3MikKICAgICAgICAgIHZhciB0YWJpbmRleCA9IGpRdWVyeS5maW5kLmF0dHIoZWxlbSwgInRhYmluZGV4Iik7CiAgICAgICAgICBpZiAodGFiaW5kZXgpIHsKICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHRhYmluZGV4LCAxMCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocmZvY3VzYWJsZS50ZXN0KGVsZW0ubm9kZU5hbWUpIHx8IHJjbGlja2FibGUudGVzdChlbGVtLm5vZGVOYW1lKSAmJiBlbGVtLmhyZWYpIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcHJvcEZpeDogewogICAgICAiZm9yIjogImh0bWxGb3IiLAogICAgICAiY2xhc3MiOiAiY2xhc3NOYW1lIgogICAgfQogIH0pOwoKICAvLyBTdXBwb3J0OiBJRSA8PTExIG9ubHkKICAvLyBBY2Nlc3NpbmcgdGhlIHNlbGVjdGVkSW5kZXggcHJvcGVydHkKICAvLyBmb3JjZXMgdGhlIGJyb3dzZXIgdG8gcmVzcGVjdCBzZXR0aW5nIHNlbGVjdGVkCiAgLy8gb24gdGhlIG9wdGlvbgogIC8vIFRoZSBnZXR0ZXIgZW5zdXJlcyBhIGRlZmF1bHQgb3B0aW9uIGlzIHNlbGVjdGVkCiAgLy8gd2hlbiBpbiBhbiBvcHRncm91cAogIC8vIGVzbGludCBydWxlICJuby11bnVzZWQtZXhwcmVzc2lvbnMiIGlzIGRpc2FibGVkIGZvciB0aGlzIGNvZGUKICAvLyBzaW5jZSBpdCBjb25zaWRlcnMgc3VjaCBhY2Nlc3Npb25zIG5vb3AKICBpZiAoIXN1cHBvcnQub3B0U2VsZWN0ZWQpIHsKICAgIGpRdWVyeS5wcm9wSG9va3Muc2VsZWN0ZWQgPSB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0pIHsKICAgICAgICAvKiBlc2xpbnQgbm8tdW51c2VkLWV4cHJlc3Npb25zOiAib2ZmIiAqLwoKICAgICAgICB2YXIgcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlOwogICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LnBhcmVudE5vZGUpIHsKICAgICAgICAgIHBhcmVudC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbGVtKSB7CiAgICAgICAgLyogZXNsaW50IG5vLXVudXNlZC1leHByZXNzaW9uczogIm9mZiIgKi8KCiAgICAgICAgdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKICAgICAgICBpZiAocGFyZW50KSB7CiAgICAgICAgICBwYXJlbnQuc2VsZWN0ZWRJbmRleDsKICAgICAgICAgIGlmIChwYXJlbnQucGFyZW50Tm9kZSkgewogICAgICAgICAgICBwYXJlbnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9CiAgalF1ZXJ5LmVhY2goWyJ0YWJJbmRleCIsICJyZWFkT25seSIsICJtYXhMZW5ndGgiLCAiY2VsbFNwYWNpbmciLCAiY2VsbFBhZGRpbmciLCAicm93U3BhbiIsICJjb2xTcGFuIiwgInVzZU1hcCIsICJmcmFtZUJvcmRlciIsICJjb250ZW50RWRpdGFibGUiXSwgZnVuY3Rpb24gKCkgewogICAgalF1ZXJ5LnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXSA9IHRoaXM7CiAgfSk7CgogIC8vIFN0cmlwIGFuZCBjb2xsYXBzZSB3aGl0ZXNwYWNlIGFjY29yZGluZyB0byBIVE1MIHNwZWMKICAvLyBodHRwczovL2luZnJhLnNwZWMud2hhdHdnLm9yZy8jc3RyaXAtYW5kLWNvbGxhcHNlLWFzY2lpLXdoaXRlc3BhY2UKICBmdW5jdGlvbiBzdHJpcEFuZENvbGxhcHNlKHZhbHVlKSB7CiAgICB2YXIgdG9rZW5zID0gdmFsdWUubWF0Y2gocm5vdGh0bWx3aGl0ZSkgfHwgW107CiAgICByZXR1cm4gdG9rZW5zLmpvaW4oIiAiKTsKICB9CiAgZnVuY3Rpb24gZ2V0Q2xhc3MoZWxlbSkgewogICAgcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlICYmIGVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiOwogIH0KICBmdW5jdGlvbiBjbGFzc2VzVG9BcnJheSh2YWx1ZSkgewogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiB2YWx1ZS5tYXRjaChybm90aHRtbHdoaXRlKSB8fCBbXTsKICAgIH0KICAgIHJldHVybiBbXTsKICB9CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBhZGRDbGFzczogZnVuY3Rpb24gYWRkQ2xhc3ModmFsdWUpIHsKICAgICAgdmFyIGNsYXNzZXMsCiAgICAgICAgZWxlbSwKICAgICAgICBjdXIsCiAgICAgICAgY3VyVmFsdWUsCiAgICAgICAgY2xhenosCiAgICAgICAgaiwKICAgICAgICBmaW5hbFZhbHVlLAogICAgICAgIGkgPSAwOwogICAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHsKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChqKSB7CiAgICAgICAgICBqUXVlcnkodGhpcykuYWRkQ2xhc3ModmFsdWUuY2FsbCh0aGlzLCBqLCBnZXRDbGFzcyh0aGlzKSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGNsYXNzZXMgPSBjbGFzc2VzVG9BcnJheSh2YWx1ZSk7CiAgICAgIGlmIChjbGFzc2VzLmxlbmd0aCkgewogICAgICAgIHdoaWxlIChlbGVtID0gdGhpc1tpKytdKSB7CiAgICAgICAgICBjdXJWYWx1ZSA9IGdldENsYXNzKGVsZW0pOwogICAgICAgICAgY3VyID0gZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAiICIgKyBzdHJpcEFuZENvbGxhcHNlKGN1clZhbHVlKSArICIgIjsKICAgICAgICAgIGlmIChjdXIpIHsKICAgICAgICAgICAgaiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChjbGF6eiA9IGNsYXNzZXNbaisrXSkgewogICAgICAgICAgICAgIGlmIChjdXIuaW5kZXhPZigiICIgKyBjbGF6eiArICIgIikgPCAwKSB7CiAgICAgICAgICAgICAgICBjdXIgKz0gY2xhenogKyAiICI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBPbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgogICAgICAgICAgICBmaW5hbFZhbHVlID0gc3RyaXBBbmRDb2xsYXBzZShjdXIpOwogICAgICAgICAgICBpZiAoY3VyVmFsdWUgIT09IGZpbmFsVmFsdWUpIHsKICAgICAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCBmaW5hbFZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICByZW1vdmVDbGFzczogZnVuY3Rpb24gcmVtb3ZlQ2xhc3ModmFsdWUpIHsKICAgICAgdmFyIGNsYXNzZXMsCiAgICAgICAgZWxlbSwKICAgICAgICBjdXIsCiAgICAgICAgY3VyVmFsdWUsCiAgICAgICAgY2xhenosCiAgICAgICAgaiwKICAgICAgICBmaW5hbFZhbHVlLAogICAgICAgIGkgPSAwOwogICAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHsKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChqKSB7CiAgICAgICAgICBqUXVlcnkodGhpcykucmVtb3ZlQ2xhc3ModmFsdWUuY2FsbCh0aGlzLCBqLCBnZXRDbGFzcyh0aGlzKSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgewogICAgICAgIHJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwgIiIpOwogICAgICB9CiAgICAgIGNsYXNzZXMgPSBjbGFzc2VzVG9BcnJheSh2YWx1ZSk7CiAgICAgIGlmIChjbGFzc2VzLmxlbmd0aCkgewogICAgICAgIHdoaWxlIChlbGVtID0gdGhpc1tpKytdKSB7CiAgICAgICAgICBjdXJWYWx1ZSA9IGdldENsYXNzKGVsZW0pOwoKICAgICAgICAgIC8vIFRoaXMgZXhwcmVzc2lvbiBpcyBoZXJlIGZvciBiZXR0ZXIgY29tcHJlc3NpYmlsaXR5IChzZWUgYWRkQ2xhc3MpCiAgICAgICAgICBjdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmICIgIiArIHN0cmlwQW5kQ29sbGFwc2UoY3VyVmFsdWUpICsgIiAiOwogICAgICAgICAgaWYgKGN1cikgewogICAgICAgICAgICBqID0gMDsKICAgICAgICAgICAgd2hpbGUgKGNsYXp6ID0gY2xhc3Nlc1tqKytdKSB7CiAgICAgICAgICAgICAgLy8gUmVtb3ZlICphbGwqIGluc3RhbmNlcwogICAgICAgICAgICAgIHdoaWxlIChjdXIuaW5kZXhPZigiICIgKyBjbGF6eiArICIgIikgPiAtMSkgewogICAgICAgICAgICAgICAgY3VyID0gY3VyLnJlcGxhY2UoIiAiICsgY2xhenogKyAiICIsICIgIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBPbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgogICAgICAgICAgICBmaW5hbFZhbHVlID0gc3RyaXBBbmRDb2xsYXBzZShjdXIpOwogICAgICAgICAgICBpZiAoY3VyVmFsdWUgIT09IGZpbmFsVmFsdWUpIHsKICAgICAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCBmaW5hbFZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICB0b2dnbGVDbGFzczogZnVuY3Rpb24gdG9nZ2xlQ2xhc3ModmFsdWUsIHN0YXRlVmFsKSB7CiAgICAgIHZhciB0eXBlID0gX3R5cGVvZih2YWx1ZSksCiAgICAgICAgaXNWYWxpZFZhbHVlID0gdHlwZSA9PT0gInN0cmluZyIgfHwgQXJyYXkuaXNBcnJheSh2YWx1ZSk7CiAgICAgIGlmICh0eXBlb2Ygc3RhdGVWYWwgPT09ICJib29sZWFuIiAmJiBpc1ZhbGlkVmFsdWUpIHsKICAgICAgICByZXR1cm4gc3RhdGVWYWwgPyB0aGlzLmFkZENsYXNzKHZhbHVlKSA6IHRoaXMucmVtb3ZlQ2xhc3ModmFsdWUpOwogICAgICB9CiAgICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkgewogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS50b2dnbGVDbGFzcyh2YWx1ZS5jYWxsKHRoaXMsIGksIGdldENsYXNzKHRoaXMpLCBzdGF0ZVZhbCksIHN0YXRlVmFsKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgY2xhc3NOYW1lLCBpLCBzZWxmLCBjbGFzc05hbWVzOwogICAgICAgIGlmIChpc1ZhbGlkVmFsdWUpIHsKICAgICAgICAgIC8vIFRvZ2dsZSBpbmRpdmlkdWFsIGNsYXNzIG5hbWVzCiAgICAgICAgICBpID0gMDsKICAgICAgICAgIHNlbGYgPSBqUXVlcnkodGhpcyk7CiAgICAgICAgICBjbGFzc05hbWVzID0gY2xhc3Nlc1RvQXJyYXkodmFsdWUpOwogICAgICAgICAgd2hpbGUgKGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNbaSsrXSkgewogICAgICAgICAgICAvLyBDaGVjayBlYWNoIGNsYXNzTmFtZSBnaXZlbiwgc3BhY2Ugc2VwYXJhdGVkIGxpc3QKICAgICAgICAgICAgaWYgKHNlbGYuaGFzQ2xhc3MoY2xhc3NOYW1lKSkgewogICAgICAgICAgICAgIHNlbGYucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZWxmLmFkZENsYXNzKGNsYXNzTmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAvLyBUb2dnbGUgd2hvbGUgY2xhc3MgbmFtZQogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB0eXBlID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgIGNsYXNzTmFtZSA9IGdldENsYXNzKHRoaXMpOwogICAgICAgICAgaWYgKGNsYXNzTmFtZSkgewogICAgICAgICAgICAvLyBTdG9yZSBjbGFzc05hbWUgaWYgc2V0CiAgICAgICAgICAgIGRhdGFQcml2LnNldCh0aGlzLCAiX19jbGFzc05hbWVfXyIsIGNsYXNzTmFtZSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gSWYgdGhlIGVsZW1lbnQgaGFzIGEgY2xhc3MgbmFtZSBvciBpZiB3ZSdyZSBwYXNzZWQgYGZhbHNlYCwKICAgICAgICAgIC8vIHRoZW4gcmVtb3ZlIHRoZSB3aG9sZSBjbGFzc25hbWUgKGlmIHRoZXJlIHdhcyBvbmUsIHRoZSBhYm92ZSBzYXZlZCBpdCkuCiAgICAgICAgICAvLyBPdGhlcndpc2UgYnJpbmcgYmFjayB3aGF0ZXZlciB3YXMgcHJldmlvdXNseSBzYXZlZCAoaWYgYW55dGhpbmcpLAogICAgICAgICAgLy8gZmFsbGluZyBiYWNrIHRvIHRoZSBlbXB0eSBzdHJpbmcgaWYgbm90aGluZyB3YXMgc3RvcmVkLgogICAgICAgICAgaWYgKHRoaXMuc2V0QXR0cmlidXRlKSB7CiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsIGNsYXNzTmFtZSB8fCB2YWx1ZSA9PT0gZmFsc2UgPyAiIiA6IGRhdGFQcml2LmdldCh0aGlzLCAiX19jbGFzc05hbWVfXyIpIHx8ICIiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGhhc0NsYXNzOiBmdW5jdGlvbiBoYXNDbGFzcyhzZWxlY3RvcikgewogICAgICB2YXIgY2xhc3NOYW1lLAogICAgICAgIGVsZW0sCiAgICAgICAgaSA9IDA7CiAgICAgIGNsYXNzTmFtZSA9ICIgIiArIHNlbGVjdG9yICsgIiAiOwogICAgICB3aGlsZSAoZWxlbSA9IHRoaXNbaSsrXSkgewogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxICYmICgiICIgKyBzdHJpcEFuZENvbGxhcHNlKGdldENsYXNzKGVsZW0pKSArICIgIikuaW5kZXhPZihjbGFzc05hbWUpID4gLTEpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSk7CiAgdmFyIHJyZXR1cm4gPSAvXHIvZzsKICBqUXVlcnkuZm4uZXh0ZW5kKHsKICAgIHZhbDogZnVuY3Rpb24gdmFsKHZhbHVlKSB7CiAgICAgIHZhciBob29rcywKICAgICAgICByZXQsCiAgICAgICAgdmFsdWVJc0Z1bmN0aW9uLAogICAgICAgIGVsZW0gPSB0aGlzWzBdOwogICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgaG9va3MgPSBqUXVlcnkudmFsSG9va3NbZWxlbS50eXBlXSB8fCBqUXVlcnkudmFsSG9va3NbZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTsKICAgICAgICAgIGlmIChob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KGVsZW0sICJ2YWx1ZSIpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgICB9CiAgICAgICAgICByZXQgPSBlbGVtLnZhbHVlOwoKICAgICAgICAgIC8vIEhhbmRsZSBtb3N0IGNvbW1vbiBzdHJpbmcgY2FzZXMKICAgICAgICAgIGlmICh0eXBlb2YgcmV0ID09PSAic3RyaW5nIikgewogICAgICAgICAgICByZXR1cm4gcmV0LnJlcGxhY2UocnJldHVybiwgIiIpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEhhbmRsZSBjYXNlcyB3aGVyZSB2YWx1ZSBpcyBudWxsL3VuZGVmIG9yIG51bWJlcgogICAgICAgICAgcmV0dXJuIHJldCA9PSBudWxsID8gIiIgOiByZXQ7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YWx1ZUlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uKHZhbHVlKTsKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaSkgewogICAgICAgIHZhciB2YWw7CiAgICAgICAgaWYgKHRoaXMubm9kZVR5cGUgIT09IDEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHZhbHVlSXNGdW5jdGlvbikgewogICAgICAgICAgdmFsID0gdmFsdWUuY2FsbCh0aGlzLCBpLCBqUXVlcnkodGhpcykudmFsKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YWwgPSB2YWx1ZTsKICAgICAgICB9CgogICAgICAgIC8vIFRyZWF0IG51bGwvdW5kZWZpbmVkIGFzICIiOyBjb252ZXJ0IG51bWJlcnMgdG8gc3RyaW5nCiAgICAgICAgaWYgKHZhbCA9PSBudWxsKSB7CiAgICAgICAgICB2YWwgPSAiIjsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICJudW1iZXIiKSB7CiAgICAgICAgICB2YWwgKz0gIiI7CiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHsKICAgICAgICAgIHZhbCA9IGpRdWVyeS5tYXAodmFsLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAiIiA6IHZhbHVlICsgIiI7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaG9va3MgPSBqUXVlcnkudmFsSG9va3NbdGhpcy50eXBlXSB8fCBqUXVlcnkudmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTsKCiAgICAgICAgLy8gSWYgc2V0IHJldHVybnMgdW5kZWZpbmVkLCBmYWxsIGJhY2sgdG8gbm9ybWFsIHNldHRpbmcKICAgICAgICBpZiAoIWhvb2tzIHx8ICEoInNldCIgaW4gaG9va3MpIHx8IGhvb2tzLnNldCh0aGlzLCB2YWwsICJ2YWx1ZSIpID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWw7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9KTsKICBqUXVlcnkuZXh0ZW5kKHsKICAgIHZhbEhvb2tzOiB7CiAgICAgIG9wdGlvbjogewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0pIHsKICAgICAgICAgIHZhciB2YWwgPSBqUXVlcnkuZmluZC5hdHRyKGVsZW0sICJ2YWx1ZSIpOwogICAgICAgICAgcmV0dXJuIHZhbCAhPSBudWxsID8gdmFsIDoKICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDw9MTAgLSAxMSBvbmx5CiAgICAgICAgICAvLyBvcHRpb24udGV4dCB0aHJvd3MgZXhjZXB0aW9ucyAoIzE0Njg2LCAjMTQ4NTgpCiAgICAgICAgICAvLyBTdHJpcCBhbmQgY29sbGFwc2Ugd2hpdGVzcGFjZQogICAgICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy8jc3RyaXAtYW5kLWNvbGxhcHNlLXdoaXRlc3BhY2UKICAgICAgICAgIHN0cmlwQW5kQ29sbGFwc2UoalF1ZXJ5LnRleHQoZWxlbSkpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2VsZWN0OiB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSkgewogICAgICAgICAgdmFyIHZhbHVlLAogICAgICAgICAgICBvcHRpb24sCiAgICAgICAgICAgIGksCiAgICAgICAgICAgIG9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCiAgICAgICAgICAgIGluZGV4ID0gZWxlbS5zZWxlY3RlZEluZGV4LAogICAgICAgICAgICBvbmUgPSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIiwKICAgICAgICAgICAgdmFsdWVzID0gb25lID8gbnVsbCA6IFtdLAogICAgICAgICAgICBtYXggPSBvbmUgPyBpbmRleCArIDEgOiBvcHRpb25zLmxlbmd0aDsKICAgICAgICAgIGlmIChpbmRleCA8IDApIHsKICAgICAgICAgICAgaSA9IG1heDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkgPSBvbmUgPyBpbmRleCA6IDA7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgc2VsZWN0ZWQgb3B0aW9ucwogICAgICAgICAgZm9yICg7IGkgPCBtYXg7IGkrKykgewogICAgICAgICAgICBvcHRpb24gPSBvcHRpb25zW2ldOwoKICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUgPD05IG9ubHkKICAgICAgICAgICAgLy8gSUU4LTkgZG9lc24ndCB1cGRhdGUgc2VsZWN0ZWQgYWZ0ZXIgZm9ybSByZXNldCAoIzI1NTEpCiAgICAgICAgICAgIGlmICgob3B0aW9uLnNlbGVjdGVkIHx8IGkgPT09IGluZGV4KSAmJgogICAgICAgICAgICAvLyBEb24ndCByZXR1cm4gb3B0aW9ucyB0aGF0IGFyZSBkaXNhYmxlZCBvciBpbiBhIGRpc2FibGVkIG9wdGdyb3VwCiAgICAgICAgICAgICFvcHRpb24uZGlzYWJsZWQgJiYgKCFvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZCB8fCAhbm9kZU5hbWUob3B0aW9uLnBhcmVudE5vZGUsICJvcHRncm91cCIpKSkgewogICAgICAgICAgICAgIC8vIEdldCB0aGUgc3BlY2lmaWMgdmFsdWUgZm9yIHRoZSBvcHRpb24KICAgICAgICAgICAgICB2YWx1ZSA9IGpRdWVyeShvcHRpb24pLnZhbCgpOwoKICAgICAgICAgICAgICAvLyBXZSBkb24ndCBuZWVkIGFuIGFycmF5IGZvciBvbmUgc2VsZWN0cwogICAgICAgICAgICAgIGlmIChvbmUpIHsKICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIE11bHRpLVNlbGVjdHMgcmV0dXJuIGFuIGFycmF5CiAgICAgICAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdmFsdWVzOwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUpIHsKICAgICAgICAgIHZhciBvcHRpb25TZXQsCiAgICAgICAgICAgIG9wdGlvbiwKICAgICAgICAgICAgb3B0aW9ucyA9IGVsZW0ub3B0aW9ucywKICAgICAgICAgICAgdmFsdWVzID0galF1ZXJ5Lm1ha2VBcnJheSh2YWx1ZSksCiAgICAgICAgICAgIGkgPSBvcHRpb25zLmxlbmd0aDsKICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgb3B0aW9uID0gb3B0aW9uc1tpXTsKCiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbmQtYXNzaWduICovCgogICAgICAgICAgICBpZiAob3B0aW9uLnNlbGVjdGVkID0galF1ZXJ5LmluQXJyYXkoalF1ZXJ5LnZhbEhvb2tzLm9wdGlvbi5nZXQob3B0aW9uKSwgdmFsdWVzKSA+IC0xKSB7CiAgICAgICAgICAgICAgb3B0aW9uU2V0ID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBuby1jb25kLWFzc2lnbiAqLwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEZvcmNlIGJyb3dzZXJzIHRvIGJlaGF2ZSBjb25zaXN0ZW50bHkgd2hlbiBub24tbWF0Y2hpbmcgdmFsdWUgaXMgc2V0CiAgICAgICAgICBpZiAoIW9wdGlvblNldCkgewogICAgICAgICAgICBlbGVtLnNlbGVjdGVkSW5kZXggPSAtMTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB2YWx1ZXM7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIFJhZGlvcyBhbmQgY2hlY2tib3hlcyBnZXR0ZXIvc2V0dGVyCiAgalF1ZXJ5LmVhY2goWyJyYWRpbyIsICJjaGVja2JveCJdLCBmdW5jdGlvbiAoKSB7CiAgICBqUXVlcnkudmFsSG9va3NbdGhpc10gPSB7CiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVsZW0sIHZhbHVlKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgICByZXR1cm4gZWxlbS5jaGVja2VkID0galF1ZXJ5LmluQXJyYXkoalF1ZXJ5KGVsZW0pLnZhbCgpLCB2YWx1ZSkgPiAtMTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBpZiAoIXN1cHBvcnQuY2hlY2tPbikgewogICAgICBqUXVlcnkudmFsSG9va3NbdGhpc10uZ2V0ID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICByZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoInZhbHVlIikgPT09IG51bGwgPyAib24iIDogZWxlbS52YWx1ZTsKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gUmV0dXJuIGpRdWVyeSBmb3IgYXR0cmlidXRlcy1vbmx5IGluY2x1c2lvbgoKICBzdXBwb3J0LmZvY3VzaW4gPSAib25mb2N1c2luIiBpbiB3aW5kb3c7CiAgdmFyIHJmb2N1c01vcnBoID0gL14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLAogICAgc3RvcFByb3BhZ2F0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb25DYWxsYmFjayhlKSB7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9OwogIGpRdWVyeS5leHRlbmQoalF1ZXJ5LmV2ZW50LCB7CiAgICB0cmlnZ2VyOiBmdW5jdGlvbiB0cmlnZ2VyKGV2ZW50LCBkYXRhLCBlbGVtLCBvbmx5SGFuZGxlcnMpIHsKICAgICAgdmFyIGksCiAgICAgICAgY3VyLAogICAgICAgIHRtcCwKICAgICAgICBidWJibGVUeXBlLAogICAgICAgIG9udHlwZSwKICAgICAgICBoYW5kbGUsCiAgICAgICAgc3BlY2lhbCwKICAgICAgICBsYXN0RWxlbWVudCwKICAgICAgICBldmVudFBhdGggPSBbZWxlbSB8fCBkb2N1bWVudF0sCiAgICAgICAgdHlwZSA9IGhhc093bi5jYWxsKGV2ZW50LCAidHlwZSIpID8gZXZlbnQudHlwZSA6IGV2ZW50LAogICAgICAgIG5hbWVzcGFjZXMgPSBoYXNPd24uY2FsbChldmVudCwgIm5hbWVzcGFjZSIpID8gZXZlbnQubmFtZXNwYWNlLnNwbGl0KCIuIikgOiBbXTsKICAgICAgY3VyID0gbGFzdEVsZW1lbnQgPSB0bXAgPSBlbGVtID0gZWxlbSB8fCBkb2N1bWVudDsKCiAgICAgIC8vIERvbid0IGRvIGV2ZW50cyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzCiAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIGZvY3VzL2JsdXIgbW9ycGhzIHRvIGZvY3VzaW4vb3V0OyBlbnN1cmUgd2UncmUgbm90IGZpcmluZyB0aGVtIHJpZ2h0IG5vdwogICAgICBpZiAocmZvY3VzTW9ycGgudGVzdCh0eXBlICsgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGUuaW5kZXhPZigiLiIpID4gLTEpIHsKICAgICAgICAvLyBOYW1lc3BhY2VkIHRyaWdnZXI7IGNyZWF0ZSBhIHJlZ2V4cCB0byBtYXRjaCBldmVudCB0eXBlIGluIGhhbmRsZSgpCiAgICAgICAgbmFtZXNwYWNlcyA9IHR5cGUuc3BsaXQoIi4iKTsKICAgICAgICB0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgpOwogICAgICAgIG5hbWVzcGFjZXMuc29ydCgpOwogICAgICB9CiAgICAgIG9udHlwZSA9IHR5cGUuaW5kZXhPZigiOiIpIDwgMCAmJiAib24iICsgdHlwZTsKCiAgICAgIC8vIENhbGxlciBjYW4gcGFzcyBpbiBhIGpRdWVyeS5FdmVudCBvYmplY3QsIE9iamVjdCwgb3IganVzdCBhbiBldmVudCB0eXBlIHN0cmluZwogICAgICBldmVudCA9IGV2ZW50W2pRdWVyeS5leHBhbmRvXSA/IGV2ZW50IDogbmV3IGpRdWVyeS5FdmVudCh0eXBlLCBfdHlwZW9mKGV2ZW50KSA9PT0gIm9iamVjdCIgJiYgZXZlbnQpOwoKICAgICAgLy8gVHJpZ2dlciBiaXRtYXNrOiAmIDEgZm9yIG5hdGl2ZSBoYW5kbGVyczsgJiAyIGZvciBqUXVlcnkgKGFsd2F5cyB0cnVlKQogICAgICBldmVudC5pc1RyaWdnZXIgPSBvbmx5SGFuZGxlcnMgPyAyIDogMzsKICAgICAgZXZlbnQubmFtZXNwYWNlID0gbmFtZXNwYWNlcy5qb2luKCIuIik7CiAgICAgIGV2ZW50LnJuYW1lc3BhY2UgPSBldmVudC5uYW1lc3BhY2UgPyBuZXcgUmVnRXhwKCIoXnxcXC4pIiArIG5hbWVzcGFjZXMuam9pbigiXFwuKD86LipcXC58KSIpICsgIihcXC58JCkiKSA6IG51bGw7CgogICAgICAvLyBDbGVhbiB1cCB0aGUgZXZlbnQgaW4gY2FzZSBpdCBpcyBiZWluZyByZXVzZWQKICAgICAgZXZlbnQucmVzdWx0ID0gdW5kZWZpbmVkOwogICAgICBpZiAoIWV2ZW50LnRhcmdldCkgewogICAgICAgIGV2ZW50LnRhcmdldCA9IGVsZW07CiAgICAgIH0KCiAgICAgIC8vIENsb25lIGFueSBpbmNvbWluZyBkYXRhIGFuZCBwcmVwZW5kIHRoZSBldmVudCwgY3JlYXRpbmcgdGhlIGhhbmRsZXIgYXJnIGxpc3QKICAgICAgZGF0YSA9IGRhdGEgPT0gbnVsbCA/IFtldmVudF0gOiBqUXVlcnkubWFrZUFycmF5KGRhdGEsIFtldmVudF0pOwoKICAgICAgLy8gQWxsb3cgc3BlY2lhbCBldmVudHMgdG8gZHJhdyBvdXRzaWRlIHRoZSBsaW5lcwogICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307CiAgICAgIGlmICghb25seUhhbmRsZXJzICYmIHNwZWNpYWwudHJpZ2dlciAmJiBzcGVjaWFsLnRyaWdnZXIuYXBwbHkoZWxlbSwgZGF0YSkgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyBEZXRlcm1pbmUgZXZlbnQgcHJvcGFnYXRpb24gcGF0aCBpbiBhZHZhbmNlLCBwZXIgVzNDIGV2ZW50cyBzcGVjICgjOTk1MSkKICAgICAgLy8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNCkKICAgICAgaWYgKCFvbmx5SGFuZGxlcnMgJiYgIXNwZWNpYWwubm9CdWJibGUgJiYgIWlzV2luZG93KGVsZW0pKSB7CiAgICAgICAgYnViYmxlVHlwZSA9IHNwZWNpYWwuZGVsZWdhdGVUeXBlIHx8IHR5cGU7CiAgICAgICAgaWYgKCFyZm9jdXNNb3JwaC50ZXN0KGJ1YmJsZVR5cGUgKyB0eXBlKSkgewogICAgICAgICAgY3VyID0gY3VyLnBhcmVudE5vZGU7CiAgICAgICAgfQogICAgICAgIGZvciAoOyBjdXI7IGN1ciA9IGN1ci5wYXJlbnROb2RlKSB7CiAgICAgICAgICBldmVudFBhdGgucHVzaChjdXIpOwogICAgICAgICAgdG1wID0gY3VyOwogICAgICAgIH0KCiAgICAgICAgLy8gT25seSBhZGQgd2luZG93IGlmIHdlIGdvdCB0byBkb2N1bWVudCAoZS5nLiwgbm90IHBsYWluIG9iaiBvciBkZXRhY2hlZCBET00pCiAgICAgICAgaWYgKHRtcCA9PT0gKGVsZW0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCkpIHsKICAgICAgICAgIGV2ZW50UGF0aC5wdXNoKHRtcC5kZWZhdWx0VmlldyB8fCB0bXAucGFyZW50V2luZG93IHx8IHdpbmRvdyk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBGaXJlIGhhbmRsZXJzIG9uIHRoZSBldmVudCBwYXRoCiAgICAgIGkgPSAwOwogICAgICB3aGlsZSAoKGN1ciA9IGV2ZW50UGF0aFtpKytdKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSkgewogICAgICAgIGxhc3RFbGVtZW50ID0gY3VyOwogICAgICAgIGV2ZW50LnR5cGUgPSBpID4gMSA/IGJ1YmJsZVR5cGUgOiBzcGVjaWFsLmJpbmRUeXBlIHx8IHR5cGU7CgogICAgICAgIC8vIGpRdWVyeSBoYW5kbGVyCiAgICAgICAgaGFuZGxlID0gKGRhdGFQcml2LmdldChjdXIsICJldmVudHMiKSB8fCBPYmplY3QuY3JlYXRlKG51bGwpKVtldmVudC50eXBlXSAmJiBkYXRhUHJpdi5nZXQoY3VyLCAiaGFuZGxlIik7CiAgICAgICAgaWYgKGhhbmRsZSkgewogICAgICAgICAgaGFuZGxlLmFwcGx5KGN1ciwgZGF0YSk7CiAgICAgICAgfQoKICAgICAgICAvLyBOYXRpdmUgaGFuZGxlcgogICAgICAgIGhhbmRsZSA9IG9udHlwZSAmJiBjdXJbb250eXBlXTsKICAgICAgICBpZiAoaGFuZGxlICYmIGhhbmRsZS5hcHBseSAmJiBhY2NlcHREYXRhKGN1cikpIHsKICAgICAgICAgIGV2ZW50LnJlc3VsdCA9IGhhbmRsZS5hcHBseShjdXIsIGRhdGEpOwogICAgICAgICAgaWYgKGV2ZW50LnJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnQudHlwZSA9IHR5cGU7CgogICAgICAvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93CiAgICAgIGlmICghb25seUhhbmRsZXJzICYmICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgewogICAgICAgIGlmICgoIXNwZWNpYWwuX2RlZmF1bHQgfHwgc3BlY2lhbC5fZGVmYXVsdC5hcHBseShldmVudFBhdGgucG9wKCksIGRhdGEpID09PSBmYWxzZSkgJiYgYWNjZXB0RGF0YShlbGVtKSkgewogICAgICAgICAgLy8gQ2FsbCBhIG5hdGl2ZSBET00gbWV0aG9kIG9uIHRoZSB0YXJnZXQgd2l0aCB0aGUgc2FtZSBuYW1lIGFzIHRoZSBldmVudC4KICAgICAgICAgIC8vIERvbid0IGRvIGRlZmF1bHQgYWN0aW9ucyBvbiB3aW5kb3csIHRoYXQncyB3aGVyZSBnbG9iYWwgdmFyaWFibGVzIGJlICgjNjE3MCkKICAgICAgICAgIGlmIChvbnR5cGUgJiYgaXNGdW5jdGlvbihlbGVtW3R5cGVdKSAmJiAhaXNXaW5kb3coZWxlbSkpIHsKICAgICAgICAgICAgLy8gRG9uJ3QgcmUtdHJpZ2dlciBhbiBvbkZPTyBldmVudCB3aGVuIHdlIGNhbGwgaXRzIEZPTygpIG1ldGhvZAogICAgICAgICAgICB0bXAgPSBlbGVtW29udHlwZV07CiAgICAgICAgICAgIGlmICh0bXApIHsKICAgICAgICAgICAgICBlbGVtW29udHlwZV0gPSBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBQcmV2ZW50IHJlLXRyaWdnZXJpbmcgb2YgdGhlIHNhbWUgZXZlbnQsIHNpbmNlIHdlIGFscmVhZHkgYnViYmxlZCBpdCBhYm92ZQogICAgICAgICAgICBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdHlwZTsKICAgICAgICAgICAgaWYgKGV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHsKICAgICAgICAgICAgICBsYXN0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIHN0b3BQcm9wYWdhdGlvbkNhbGxiYWNrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbGVtW3R5cGVdKCk7CiAgICAgICAgICAgIGlmIChldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKSB7CiAgICAgICAgICAgICAgbGFzdEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBzdG9wUHJvcGFnYXRpb25DYWxsYmFjayk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgaWYgKHRtcCkgewogICAgICAgICAgICAgIGVsZW1bb250eXBlXSA9IHRtcDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZXZlbnQucmVzdWx0OwogICAgfSwKICAgIC8vIFBpZ2d5YmFjayBvbiBhIGRvbm9yIGV2ZW50IHRvIHNpbXVsYXRlIGEgZGlmZmVyZW50IG9uZQogICAgLy8gVXNlZCBvbmx5IGZvciBgZm9jdXMoaW4gfCBvdXQpYCBldmVudHMKICAgIHNpbXVsYXRlOiBmdW5jdGlvbiBzaW11bGF0ZSh0eXBlLCBlbGVtLCBldmVudCkgewogICAgICB2YXIgZSA9IGpRdWVyeS5leHRlbmQobmV3IGpRdWVyeS5FdmVudCgpLCBldmVudCwgewogICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgaXNTaW11bGF0ZWQ6IHRydWUKICAgICAgfSk7CiAgICAgIGpRdWVyeS5ldmVudC50cmlnZ2VyKGUsIG51bGwsIGVsZW0pOwogICAgfQogIH0pOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgdHJpZ2dlcjogZnVuY3Rpb24gdHJpZ2dlcih0eXBlLCBkYXRhKSB7CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGpRdWVyeS5ldmVudC50cmlnZ2VyKHR5cGUsIGRhdGEsIHRoaXMpOwogICAgICB9KTsKICAgIH0sCiAgICB0cmlnZ2VySGFuZGxlcjogZnVuY3Rpb24gdHJpZ2dlckhhbmRsZXIodHlwZSwgZGF0YSkgewogICAgICB2YXIgZWxlbSA9IHRoaXNbMF07CiAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKHR5cGUsIGRhdGEsIGVsZW0sIHRydWUpOwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIFN1cHBvcnQ6IEZpcmVmb3ggPD00NAogIC8vIEZpcmVmb3ggZG9lc24ndCBoYXZlIGZvY3VzKGluIHwgb3V0KSBldmVudHMKICAvLyBSZWxhdGVkIHRpY2tldCAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY4Nzc4NwogIC8vCiAgLy8gU3VwcG9ydDogQ2hyb21lIDw9NDggLSA0OSwgU2FmYXJpIDw9OS4wIC0gOS4xCiAgLy8gZm9jdXMoaW4gfCBvdXQpIGV2ZW50cyBmaXJlIGFmdGVyIGZvY3VzICYgYmx1ciBldmVudHMsCiAgLy8gd2hpY2ggaXMgc3BlYyB2aW9sYXRpb24gLSBodHRwOi8vd3d3LnczLm9yZy9UUi9ET00tTGV2ZWwtMy1FdmVudHMvI2V2ZW50cy1mb2N1c2V2ZW50LWV2ZW50LW9yZGVyCiAgLy8gUmVsYXRlZCB0aWNrZXQgLSBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD00NDk4NTcKICBpZiAoIXN1cHBvcnQuZm9jdXNpbikgewogICAgalF1ZXJ5LmVhY2goewogICAgICBmb2N1czogImZvY3VzaW4iLAogICAgICBibHVyOiAiZm9jdXNvdXQiCiAgICB9LCBmdW5jdGlvbiAob3JpZywgZml4KSB7CiAgICAgIC8vIEF0dGFjaCBhIHNpbmdsZSBjYXB0dXJpbmcgaGFuZGxlciBvbiB0aGUgZG9jdW1lbnQgd2hpbGUgc29tZW9uZSB3YW50cyBmb2N1c2luL2ZvY3Vzb3V0CiAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gaGFuZGxlcihldmVudCkgewogICAgICAgIGpRdWVyeS5ldmVudC5zaW11bGF0ZShmaXgsIGV2ZW50LnRhcmdldCwgalF1ZXJ5LmV2ZW50LmZpeChldmVudCkpOwogICAgICB9OwogICAgICBqUXVlcnkuZXZlbnQuc3BlY2lhbFtmaXhdID0gewogICAgICAgIHNldHVwOiBmdW5jdGlvbiBzZXR1cCgpIHsKICAgICAgICAgIC8vIEhhbmRsZTogcmVndWxhciBub2RlcyAodmlhIGB0aGlzLm93bmVyRG9jdW1lbnRgKSwgd2luZG93CiAgICAgICAgICAvLyAodmlhIGB0aGlzLmRvY3VtZW50YCkgJiBkb2N1bWVudCAodmlhIGB0aGlzYCkuCiAgICAgICAgICB2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMuZG9jdW1lbnQgfHwgdGhpcywKICAgICAgICAgICAgYXR0YWNoZXMgPSBkYXRhUHJpdi5hY2Nlc3MoZG9jLCBmaXgpOwogICAgICAgICAgaWYgKCFhdHRhY2hlcykgewogICAgICAgICAgICBkb2MuYWRkRXZlbnRMaXN0ZW5lcihvcmlnLCBoYW5kbGVyLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICAgIGRhdGFQcml2LmFjY2Vzcyhkb2MsIGZpeCwgKGF0dGFjaGVzIHx8IDApICsgMSk7CiAgICAgICAgfSwKICAgICAgICB0ZWFyZG93bjogZnVuY3Rpb24gdGVhcmRvd24oKSB7CiAgICAgICAgICB2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMuZG9jdW1lbnQgfHwgdGhpcywKICAgICAgICAgICAgYXR0YWNoZXMgPSBkYXRhUHJpdi5hY2Nlc3MoZG9jLCBmaXgpIC0gMTsKICAgICAgICAgIGlmICghYXR0YWNoZXMpIHsKICAgICAgICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIob3JpZywgaGFuZGxlciwgdHJ1ZSk7CiAgICAgICAgICAgIGRhdGFQcml2LnJlbW92ZShkb2MsIGZpeCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhUHJpdi5hY2Nlc3MoZG9jLCBmaXgsIGF0dGFjaGVzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9KTsKICB9CiAgdmFyIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uOwogIHZhciBub25jZSA9IHsKICAgIGd1aWQ6IERhdGUubm93KCkKICB9OwogIHZhciBycXVlcnkgPSAvXD8vOwoKICAvLyBDcm9zcy1icm93c2VyIHhtbCBwYXJzaW5nCiAgalF1ZXJ5LnBhcnNlWE1MID0gZnVuY3Rpb24gKGRhdGEpIHsKICAgIHZhciB4bWw7CiAgICBpZiAoIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8vIFN1cHBvcnQ6IElFIDkgLSAxMSBvbmx5CiAgICAvLyBJRSB0aHJvd3Mgb24gcGFyc2VGcm9tU3RyaW5nIHdpdGggaW52YWxpZCBpbnB1dC4KICAgIHRyeSB7CiAgICAgIHhtbCA9IG5ldyB3aW5kb3cuRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGRhdGEsICJ0ZXh0L3htbCIpOwogICAgfSBjYXRjaCAoZSkgewogICAgICB4bWwgPSB1bmRlZmluZWQ7CiAgICB9CiAgICBpZiAoIXhtbCB8fCB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIikubGVuZ3RoKSB7CiAgICAgIGpRdWVyeS5lcnJvcigiSW52YWxpZCBYTUw6ICIgKyBkYXRhKTsKICAgIH0KICAgIHJldHVybiB4bWw7CiAgfTsKICB2YXIgcmJyYWNrZXQgPSAvXFtcXSQvLAogICAgckNSTEYgPSAvXHI/XG4vZywKICAgIHJzdWJtaXR0ZXJUeXBlcyA9IC9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSwKICAgIHJzdWJtaXR0YWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTsKICBmdW5jdGlvbiBidWlsZFBhcmFtcyhwcmVmaXgsIG9iaiwgdHJhZGl0aW9uYWwsIGFkZCkgewogICAgdmFyIG5hbWU7CiAgICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7CiAgICAgIC8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLgogICAgICBqUXVlcnkuZWFjaChvYmosIGZ1bmN0aW9uIChpLCB2KSB7CiAgICAgICAgaWYgKHRyYWRpdGlvbmFsIHx8IHJicmFja2V0LnRlc3QocHJlZml4KSkgewogICAgICAgICAgLy8gVHJlYXQgZWFjaCBhcnJheSBpdGVtIGFzIGEgc2NhbGFyLgogICAgICAgICAgYWRkKHByZWZpeCwgdik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIEl0ZW0gaXMgbm9uLXNjYWxhciAoYXJyYXkgb3Igb2JqZWN0KSwgZW5jb2RlIGl0cyBudW1lcmljIGluZGV4LgogICAgICAgICAgYnVpbGRQYXJhbXMocHJlZml4ICsgIlsiICsgKF90eXBlb2YodikgPT09ICJvYmplY3QiICYmIHYgIT0gbnVsbCA/IGkgOiAiIikgKyAiXSIsIHYsIHRyYWRpdGlvbmFsLCBhZGQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKCF0cmFkaXRpb25hbCAmJiB0b1R5cGUob2JqKSA9PT0gIm9iamVjdCIpIHsKICAgICAgLy8gU2VyaWFsaXplIG9iamVjdCBpdGVtLgogICAgICBmb3IgKG5hbWUgaW4gb2JqKSB7CiAgICAgICAgYnVpbGRQYXJhbXMocHJlZml4ICsgIlsiICsgbmFtZSArICJdIiwgb2JqW25hbWVdLCB0cmFkaXRpb25hbCwgYWRkKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gU2VyaWFsaXplIHNjYWxhciBpdGVtLgogICAgICBhZGQocHJlZml4LCBvYmopOwogICAgfQogIH0KCiAgLy8gU2VyaWFsaXplIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMgb3IgYSBzZXQgb2YKICAvLyBrZXkvdmFsdWVzIGludG8gYSBxdWVyeSBzdHJpbmcKICBqUXVlcnkucGFyYW0gPSBmdW5jdGlvbiAoYSwgdHJhZGl0aW9uYWwpIHsKICAgIHZhciBwcmVmaXgsCiAgICAgIHMgPSBbXSwKICAgICAgYWRkID0gZnVuY3Rpb24gYWRkKGtleSwgdmFsdWVPckZ1bmN0aW9uKSB7CiAgICAgICAgLy8gSWYgdmFsdWUgaXMgYSBmdW5jdGlvbiwgaW52b2tlIGl0IGFuZCB1c2UgaXRzIHJldHVybiB2YWx1ZQogICAgICAgIHZhciB2YWx1ZSA9IGlzRnVuY3Rpb24odmFsdWVPckZ1bmN0aW9uKSA/IHZhbHVlT3JGdW5jdGlvbigpIDogdmFsdWVPckZ1bmN0aW9uOwogICAgICAgIHNbcy5sZW5ndGhdID0gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUgPT0gbnVsbCA/ICIiIDogdmFsdWUpOwogICAgICB9OwogICAgaWYgKGEgPT0gbnVsbCkgewogICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgLy8gSWYgYW4gYXJyYXkgd2FzIHBhc3NlZCBpbiwgYXNzdW1lIHRoYXQgaXQgaXMgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cy4KICAgIGlmIChBcnJheS5pc0FycmF5KGEpIHx8IGEuanF1ZXJ5ICYmICFqUXVlcnkuaXNQbGFpbk9iamVjdChhKSkgewogICAgICAvLyBTZXJpYWxpemUgdGhlIGZvcm0gZWxlbWVudHMKICAgICAgalF1ZXJ5LmVhY2goYSwgZnVuY3Rpb24gKCkgewogICAgICAgIGFkZCh0aGlzLm5hbWUsIHRoaXMudmFsdWUpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIElmIHRyYWRpdGlvbmFsLCBlbmNvZGUgdGhlICJvbGQiIHdheSAodGhlIHdheSAxLjMuMiBvciBvbGRlcgogICAgICAvLyBkaWQgaXQpLCBvdGhlcndpc2UgZW5jb2RlIHBhcmFtcyByZWN1cnNpdmVseS4KICAgICAgZm9yIChwcmVmaXggaW4gYSkgewogICAgICAgIGJ1aWxkUGFyYW1zKHByZWZpeCwgYVtwcmVmaXhdLCB0cmFkaXRpb25hbCwgYWRkKTsKICAgICAgfQogICAgfQoKICAgIC8vIFJldHVybiB0aGUgcmVzdWx0aW5nIHNlcmlhbGl6YXRpb24KICAgIHJldHVybiBzLmpvaW4oIiYiKTsKICB9OwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgc2VyaWFsaXplOiBmdW5jdGlvbiBzZXJpYWxpemUoKSB7CiAgICAgIHJldHVybiBqUXVlcnkucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKTsKICAgIH0sCiAgICBzZXJpYWxpemVBcnJheTogZnVuY3Rpb24gc2VyaWFsaXplQXJyYXkoKSB7CiAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gQ2FuIGFkZCBwcm9wSG9vayBmb3IgImVsZW1lbnRzIiB0byBmaWx0ZXIgb3IgYWRkIGZvcm0gZWxlbWVudHMKICAgICAgICB2YXIgZWxlbWVudHMgPSBqUXVlcnkucHJvcCh0aGlzLCAiZWxlbWVudHMiKTsKICAgICAgICByZXR1cm4gZWxlbWVudHMgPyBqUXVlcnkubWFrZUFycmF5KGVsZW1lbnRzKSA6IHRoaXM7CiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHR5cGUgPSB0aGlzLnR5cGU7CgogICAgICAgIC8vIFVzZSAuaXMoICI6ZGlzYWJsZWQiICkgc28gdGhhdCBmaWVsZHNldFtkaXNhYmxlZF0gd29ya3MKICAgICAgICByZXR1cm4gdGhpcy5uYW1lICYmICFqUXVlcnkodGhpcykuaXMoIjpkaXNhYmxlZCIpICYmIHJzdWJtaXR0YWJsZS50ZXN0KHRoaXMubm9kZU5hbWUpICYmICFyc3VibWl0dGVyVHlwZXMudGVzdCh0eXBlKSAmJiAodGhpcy5jaGVja2VkIHx8ICFyY2hlY2thYmxlVHlwZS50ZXN0KHR5cGUpKTsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChfaSwgZWxlbSkgewogICAgICAgIHZhciB2YWwgPSBqUXVlcnkodGhpcykudmFsKCk7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsKSkgewogICAgICAgICAgcmV0dXJuIGpRdWVyeS5tYXAodmFsLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgbmFtZTogZWxlbS5uYW1lLAogICAgICAgICAgICAgIHZhbHVlOiB2YWwucmVwbGFjZShyQ1JMRiwgIlxyXG4iKQogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB7CiAgICAgICAgICBuYW1lOiBlbGVtLm5hbWUsCiAgICAgICAgICB2YWx1ZTogdmFsLnJlcGxhY2UockNSTEYsICJcclxuIikKICAgICAgICB9OwogICAgICB9KS5nZXQoKTsKICAgIH0KICB9KTsKICB2YXIgcjIwID0gLyUyMC9nLAogICAgcmhhc2ggPSAvIy4qJC8sCiAgICByYW50aUNhY2hlID0gLyhbPyZdKV89W14mXSovLAogICAgcmhlYWRlcnMgPSAvXiguKj8pOlsgXHRdKihbXlxyXG5dKikkL21nLAogICAgLy8gIzc2NTMsICM4MTI1LCAjODE1MjogbG9jYWwgcHJvdG9jb2wgZGV0ZWN0aW9uCiAgICBybG9jYWxQcm90b2NvbCA9IC9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLAogICAgcm5vQ29udGVudCA9IC9eKD86R0VUfEhFQUQpJC8sCiAgICBycHJvdG9jb2wgPSAvXlwvXC8vLAogICAgLyogUHJlZmlsdGVycwogICAgKiAxKSBUaGV5IGFyZSB1c2VmdWwgdG8gaW50cm9kdWNlIGN1c3RvbSBkYXRhVHlwZXMgKHNlZSBhamF4L2pzb25wLmpzIGZvciBhbiBleGFtcGxlKQogICAgKiAyKSBUaGVzZSBhcmUgY2FsbGVkOgogICAgKiAgICAtIEJFRk9SRSBhc2tpbmcgZm9yIGEgdHJhbnNwb3J0CiAgICAqICAgIC0gQUZURVIgcGFyYW0gc2VyaWFsaXphdGlvbiAocy5kYXRhIGlzIGEgc3RyaW5nIGlmIHMucHJvY2Vzc0RhdGEgaXMgdHJ1ZSkKICAgICogMykga2V5IGlzIHRoZSBkYXRhVHlwZQogICAgKiA0KSB0aGUgY2F0Y2hhbGwgc3ltYm9sICIqIiBjYW4gYmUgdXNlZAogICAgKiA1KSBleGVjdXRpb24gd2lsbCBzdGFydCB3aXRoIHRyYW5zcG9ydCBkYXRhVHlwZSBhbmQgVEhFTiBjb250aW51ZSBkb3duIHRvICIqIiBpZiBuZWVkZWQKICAgICovCiAgICBwcmVmaWx0ZXJzID0ge30sCiAgICAvKiBUcmFuc3BvcnRzIGJpbmRpbmdzCiAgICAqIDEpIGtleSBpcyB0aGUgZGF0YVR5cGUKICAgICogMikgdGhlIGNhdGNoYWxsIHN5bWJvbCAiKiIgY2FuIGJlIHVzZWQKICAgICogMykgc2VsZWN0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28gdG8gIioiIGlmIG5lZWRlZAogICAgKi8KICAgIHRyYW5zcG9ydHMgPSB7fSwKICAgIC8vIEF2b2lkIGNvbW1lbnQtcHJvbG9nIGNoYXIgc2VxdWVuY2UgKCMxMDA5OCk7IG11c3QgYXBwZWFzZSBsaW50IGFuZCBldmFkZSBjb21wcmVzc2lvbgogICAgYWxsVHlwZXMgPSAiKi8iLmNvbmNhdCgiKiIpLAogICAgLy8gQW5jaG9yIHRhZyBmb3IgcGFyc2luZyB0aGUgZG9jdW1lbnQgb3JpZ2luCiAgICBvcmlnaW5BbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgb3JpZ2luQW5jaG9yLmhyZWYgPSBsb2NhdGlvbi5ocmVmOwoKICAvLyBCYXNlICJjb25zdHJ1Y3RvciIgZm9yIGpRdWVyeS5hamF4UHJlZmlsdGVyIGFuZCBqUXVlcnkuYWpheFRyYW5zcG9ydAogIGZ1bmN0aW9uIGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyhzdHJ1Y3R1cmUpIHsKICAgIC8vIGRhdGFUeXBlRXhwcmVzc2lvbiBpcyBvcHRpb25hbCBhbmQgZGVmYXVsdHMgdG8gIioiCiAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGFUeXBlRXhwcmVzc2lvbiwgZnVuYykgewogICAgICBpZiAodHlwZW9mIGRhdGFUeXBlRXhwcmVzc2lvbiAhPT0gInN0cmluZyIpIHsKICAgICAgICBmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uOwogICAgICAgIGRhdGFUeXBlRXhwcmVzc2lvbiA9ICIqIjsKICAgICAgfQogICAgICB2YXIgZGF0YVR5cGUsCiAgICAgICAgaSA9IDAsCiAgICAgICAgZGF0YVR5cGVzID0gZGF0YVR5cGVFeHByZXNzaW9uLnRvTG93ZXJDYXNlKCkubWF0Y2gocm5vdGh0bWx3aGl0ZSkgfHwgW107CiAgICAgIGlmIChpc0Z1bmN0aW9uKGZ1bmMpKSB7CiAgICAgICAgLy8gRm9yIGVhY2ggZGF0YVR5cGUgaW4gdGhlIGRhdGFUeXBlRXhwcmVzc2lvbgogICAgICAgIHdoaWxlIChkYXRhVHlwZSA9IGRhdGFUeXBlc1tpKytdKSB7CiAgICAgICAgICAvLyBQcmVwZW5kIGlmIHJlcXVlc3RlZAogICAgICAgICAgaWYgKGRhdGFUeXBlWzBdID09PSAiKyIpIHsKICAgICAgICAgICAgZGF0YVR5cGUgPSBkYXRhVHlwZS5zbGljZSgxKSB8fCAiKiI7CiAgICAgICAgICAgIChzdHJ1Y3R1cmVbZGF0YVR5cGVdID0gc3RydWN0dXJlW2RhdGFUeXBlXSB8fCBbXSkudW5zaGlmdChmdW5jKTsKCiAgICAgICAgICAgIC8vIE90aGVyd2lzZSBhcHBlbmQKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIChzdHJ1Y3R1cmVbZGF0YVR5cGVdID0gc3RydWN0dXJlW2RhdGFUeXBlXSB8fCBbXSkucHVzaChmdW5jKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQoKICAvLyBCYXNlIGluc3BlY3Rpb24gZnVuY3Rpb24gZm9yIHByZWZpbHRlcnMgYW5kIHRyYW5zcG9ydHMKICBmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyhzdHJ1Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIpIHsKICAgIHZhciBpbnNwZWN0ZWQgPSB7fSwKICAgICAgc2Vla2luZ1RyYW5zcG9ydCA9IHN0cnVjdHVyZSA9PT0gdHJhbnNwb3J0czsKICAgIGZ1bmN0aW9uIGluc3BlY3QoZGF0YVR5cGUpIHsKICAgICAgdmFyIHNlbGVjdGVkOwogICAgICBpbnNwZWN0ZWRbZGF0YVR5cGVdID0gdHJ1ZTsKICAgICAgalF1ZXJ5LmVhY2goc3RydWN0dXJlW2RhdGFUeXBlXSB8fCBbXSwgZnVuY3Rpb24gKF8sIHByZWZpbHRlck9yRmFjdG9yeSkgewogICAgICAgIHZhciBkYXRhVHlwZU9yVHJhbnNwb3J0ID0gcHJlZmlsdGVyT3JGYWN0b3J5KG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIpOwogICAgICAgIGlmICh0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydCA9PT0gInN0cmluZyIgJiYgIXNlZWtpbmdUcmFuc3BvcnQgJiYgIWluc3BlY3RlZFtkYXRhVHlwZU9yVHJhbnNwb3J0XSkgewogICAgICAgICAgb3B0aW9ucy5kYXRhVHlwZXMudW5zaGlmdChkYXRhVHlwZU9yVHJhbnNwb3J0KTsKICAgICAgICAgIGluc3BlY3QoZGF0YVR5cGVPclRyYW5zcG9ydCk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChzZWVraW5nVHJhbnNwb3J0KSB7CiAgICAgICAgICByZXR1cm4gIShzZWxlY3RlZCA9IGRhdGFUeXBlT3JUcmFuc3BvcnQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBzZWxlY3RlZDsKICAgIH0KICAgIHJldHVybiBpbnNwZWN0KG9wdGlvbnMuZGF0YVR5cGVzWzBdKSB8fCAhaW5zcGVjdGVkWyIqIl0gJiYgaW5zcGVjdCgiKiIpOwogIH0KCiAgLy8gQSBzcGVjaWFsIGV4dGVuZCBmb3IgYWpheCBvcHRpb25zCiAgLy8gdGhhdCB0YWtlcyAiZmxhdCIgb3B0aW9ucyAobm90IHRvIGJlIGRlZXAgZXh0ZW5kZWQpCiAgLy8gRml4ZXMgIzk4ODcKICBmdW5jdGlvbiBhamF4RXh0ZW5kKHRhcmdldCwgc3JjKSB7CiAgICB2YXIga2V5LAogICAgICBkZWVwLAogICAgICBmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307CiAgICBmb3IgKGtleSBpbiBzcmMpIHsKICAgICAgaWYgKHNyY1trZXldICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAoZmxhdE9wdGlvbnNba2V5XSA/IHRhcmdldCA6IGRlZXAgfHwgKGRlZXAgPSB7fSkpW2tleV0gPSBzcmNba2V5XTsKICAgICAgfQogICAgfQogICAgaWYgKGRlZXApIHsKICAgICAgalF1ZXJ5LmV4dGVuZCh0cnVlLCB0YXJnZXQsIGRlZXApOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIC8qIEhhbmRsZXMgcmVzcG9uc2VzIHRvIGFuIGFqYXggcmVxdWVzdDoKICAqIC0gZmluZHMgdGhlIHJpZ2h0IGRhdGFUeXBlIChtZWRpYXRlcyBiZXR3ZWVuIGNvbnRlbnQtdHlwZSBhbmQgZXhwZWN0ZWQgZGF0YVR5cGUpCiAgKiAtIHJldHVybnMgdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKICAqLwogIGZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMocywganFYSFIsIHJlc3BvbnNlcykgewogICAgdmFyIGN0LAogICAgICB0eXBlLAogICAgICBmaW5hbERhdGFUeXBlLAogICAgICBmaXJzdERhdGFUeXBlLAogICAgICBjb250ZW50cyA9IHMuY29udGVudHMsCiAgICAgIGRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzOwoKICAgIC8vIFJlbW92ZSBhdXRvIGRhdGFUeXBlIGFuZCBnZXQgY29udGVudC10eXBlIGluIHRoZSBwcm9jZXNzCiAgICB3aGlsZSAoZGF0YVR5cGVzWzBdID09PSAiKiIpIHsKICAgICAgZGF0YVR5cGVzLnNoaWZ0KCk7CiAgICAgIGlmIChjdCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY3QgPSBzLm1pbWVUeXBlIHx8IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKTsKICAgICAgfQogICAgfQoKICAgIC8vIENoZWNrIGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCBhIGtub3duIGNvbnRlbnQtdHlwZQogICAgaWYgKGN0KSB7CiAgICAgIGZvciAodHlwZSBpbiBjb250ZW50cykgewogICAgICAgIGlmIChjb250ZW50c1t0eXBlXSAmJiBjb250ZW50c1t0eXBlXS50ZXN0KGN0KSkgewogICAgICAgICAgZGF0YVR5cGVzLnVuc2hpZnQodHlwZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvLyBDaGVjayB0byBzZWUgaWYgd2UgaGF2ZSBhIHJlc3BvbnNlIGZvciB0aGUgZXhwZWN0ZWQgZGF0YVR5cGUKICAgIGlmIChkYXRhVHlwZXNbMF0gaW4gcmVzcG9uc2VzKSB7CiAgICAgIGZpbmFsRGF0YVR5cGUgPSBkYXRhVHlwZXNbMF07CiAgICB9IGVsc2UgewogICAgICAvLyBUcnkgY29udmVydGlibGUgZGF0YVR5cGVzCiAgICAgIGZvciAodHlwZSBpbiByZXNwb25zZXMpIHsKICAgICAgICBpZiAoIWRhdGFUeXBlc1swXSB8fCBzLmNvbnZlcnRlcnNbdHlwZSArICIgIiArIGRhdGFUeXBlc1swXV0pIHsKICAgICAgICAgIGZpbmFsRGF0YVR5cGUgPSB0eXBlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGlmICghZmlyc3REYXRhVHlwZSkgewogICAgICAgICAgZmlyc3REYXRhVHlwZSA9IHR5cGU7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBPciBqdXN0IHVzZSBmaXJzdCBvbmUKICAgICAgZmluYWxEYXRhVHlwZSA9IGZpbmFsRGF0YVR5cGUgfHwgZmlyc3REYXRhVHlwZTsKICAgIH0KCiAgICAvLyBJZiB3ZSBmb3VuZCBhIGRhdGFUeXBlCiAgICAvLyBXZSBhZGQgdGhlIGRhdGFUeXBlIHRvIHRoZSBsaXN0IGlmIG5lZWRlZAogICAgLy8gYW5kIHJldHVybiB0aGUgY29ycmVzcG9uZGluZyByZXNwb25zZQogICAgaWYgKGZpbmFsRGF0YVR5cGUpIHsKICAgICAgaWYgKGZpbmFsRGF0YVR5cGUgIT09IGRhdGFUeXBlc1swXSkgewogICAgICAgIGRhdGFUeXBlcy51bnNoaWZ0KGZpbmFsRGF0YVR5cGUpOwogICAgICB9CiAgICAgIHJldHVybiByZXNwb25zZXNbZmluYWxEYXRhVHlwZV07CiAgICB9CiAgfQoKICAvKiBDaGFpbiBjb252ZXJzaW9ucyBnaXZlbiB0aGUgcmVxdWVzdCBhbmQgdGhlIG9yaWdpbmFsIHJlc3BvbnNlCiAgKiBBbHNvIHNldHMgdGhlIHJlc3BvbnNlWFhYIGZpZWxkcyBvbiB0aGUganFYSFIgaW5zdGFuY2UKICAqLwogIGZ1bmN0aW9uIGFqYXhDb252ZXJ0KHMsIHJlc3BvbnNlLCBqcVhIUiwgaXNTdWNjZXNzKSB7CiAgICB2YXIgY29udjIsCiAgICAgIGN1cnJlbnQsCiAgICAgIGNvbnYsCiAgICAgIHRtcCwKICAgICAgcHJldiwKICAgICAgY29udmVydGVycyA9IHt9LAogICAgICAvLyBXb3JrIHdpdGggYSBjb3B5IG9mIGRhdGFUeXBlcyBpbiBjYXNlIHdlIG5lZWQgdG8gbW9kaWZ5IGl0IGZvciBjb252ZXJzaW9uCiAgICAgIGRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzLnNsaWNlKCk7CgogICAgLy8gQ3JlYXRlIGNvbnZlcnRlcnMgbWFwIHdpdGggbG93ZXJjYXNlZCBrZXlzCiAgICBpZiAoZGF0YVR5cGVzWzFdKSB7CiAgICAgIGZvciAoY29udiBpbiBzLmNvbnZlcnRlcnMpIHsKICAgICAgICBjb252ZXJ0ZXJzW2NvbnYudG9Mb3dlckNhc2UoKV0gPSBzLmNvbnZlcnRlcnNbY29udl07CiAgICAgIH0KICAgIH0KICAgIGN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTsKCiAgICAvLyBDb252ZXJ0IHRvIGVhY2ggc2VxdWVudGlhbCBkYXRhVHlwZQogICAgd2hpbGUgKGN1cnJlbnQpIHsKICAgICAgaWYgKHMucmVzcG9uc2VGaWVsZHNbY3VycmVudF0pIHsKICAgICAgICBqcVhIUltzLnJlc3BvbnNlRmllbGRzW2N1cnJlbnRdXSA9IHJlc3BvbnNlOwogICAgICB9CgogICAgICAvLyBBcHBseSB0aGUgZGF0YUZpbHRlciBpZiBwcm92aWRlZAogICAgICBpZiAoIXByZXYgJiYgaXNTdWNjZXNzICYmIHMuZGF0YUZpbHRlcikgewogICAgICAgIHJlc3BvbnNlID0gcy5kYXRhRmlsdGVyKHJlc3BvbnNlLCBzLmRhdGFUeXBlKTsKICAgICAgfQogICAgICBwcmV2ID0gY3VycmVudDsKICAgICAgY3VycmVudCA9IGRhdGFUeXBlcy5zaGlmdCgpOwogICAgICBpZiAoY3VycmVudCkgewogICAgICAgIC8vIFRoZXJlJ3Mgb25seSB3b3JrIHRvIGRvIGlmIGN1cnJlbnQgZGF0YVR5cGUgaXMgbm9uLWF1dG8KICAgICAgICBpZiAoY3VycmVudCA9PT0gIioiKSB7CiAgICAgICAgICBjdXJyZW50ID0gcHJldjsKCiAgICAgICAgICAvLyBDb252ZXJ0IHJlc3BvbnNlIGlmIHByZXYgZGF0YVR5cGUgaXMgbm9uLWF1dG8gYW5kIGRpZmZlcnMgZnJvbSBjdXJyZW50CiAgICAgICAgfSBlbHNlIGlmIChwcmV2ICE9PSAiKiIgJiYgcHJldiAhPT0gY3VycmVudCkgewogICAgICAgICAgLy8gU2VlayBhIGRpcmVjdCBjb252ZXJ0ZXIKICAgICAgICAgIGNvbnYgPSBjb252ZXJ0ZXJzW3ByZXYgKyAiICIgKyBjdXJyZW50XSB8fCBjb252ZXJ0ZXJzWyIqICIgKyBjdXJyZW50XTsKCiAgICAgICAgICAvLyBJZiBub25lIGZvdW5kLCBzZWVrIGEgcGFpcgogICAgICAgICAgaWYgKCFjb252KSB7CiAgICAgICAgICAgIGZvciAoY29udjIgaW4gY29udmVydGVycykgewogICAgICAgICAgICAgIC8vIElmIGNvbnYyIG91dHB1dHMgY3VycmVudAogICAgICAgICAgICAgIHRtcCA9IGNvbnYyLnNwbGl0KCIgIik7CiAgICAgICAgICAgICAgaWYgKHRtcFsxXSA9PT0gY3VycmVudCkgewogICAgICAgICAgICAgICAgLy8gSWYgcHJldiBjYW4gYmUgY29udmVydGVkIHRvIGFjY2VwdGVkIGlucHV0CiAgICAgICAgICAgICAgICBjb252ID0gY29udmVydGVyc1twcmV2ICsgIiAiICsgdG1wWzBdXSB8fCBjb252ZXJ0ZXJzWyIqICIgKyB0bXBbMF1dOwogICAgICAgICAgICAgICAgaWYgKGNvbnYpIHsKICAgICAgICAgICAgICAgICAgLy8gQ29uZGVuc2UgZXF1aXZhbGVuY2UgY29udmVydGVycwogICAgICAgICAgICAgICAgICBpZiAoY29udiA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnYgPSBjb252ZXJ0ZXJzW2NvbnYyXTsKCiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBpbnNlcnQgdGhlIGludGVybWVkaWF0ZSBkYXRhVHlwZQogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnZlcnRlcnNbY29udjJdICE9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHRtcFswXTsKICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZXMudW5zaGlmdCh0bXBbMV0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIEFwcGx5IGNvbnZlcnRlciAoaWYgbm90IGFuIGVxdWl2YWxlbmNlKQogICAgICAgICAgaWYgKGNvbnYgIT09IHRydWUpIHsKICAgICAgICAgICAgLy8gVW5sZXNzIGVycm9ycyBhcmUgYWxsb3dlZCB0byBidWJibGUsIGNhdGNoIGFuZCByZXR1cm4gdGhlbQogICAgICAgICAgICBpZiAoY29udiAmJiBzLnRocm93cykgewogICAgICAgICAgICAgIHJlc3BvbnNlID0gY29udihyZXNwb25zZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gY29udihyZXNwb25zZSk7CiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgc3RhdGU6ICJwYXJzZXJlcnJvciIsCiAgICAgICAgICAgICAgICAgIGVycm9yOiBjb252ID8gZSA6ICJObyBjb252ZXJzaW9uIGZyb20gIiArIHByZXYgKyAiIHRvICIgKyBjdXJyZW50CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHsKICAgICAgc3RhdGU6ICJzdWNjZXNzIiwKICAgICAgZGF0YTogcmVzcG9uc2UKICAgIH07CiAgfQogIGpRdWVyeS5leHRlbmQoewogICAgLy8gQ291bnRlciBmb3IgaG9sZGluZyB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBxdWVyaWVzCiAgICBhY3RpdmU6IDAsCiAgICAvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4dCByZXF1ZXN0CiAgICBsYXN0TW9kaWZpZWQ6IHt9LAogICAgZXRhZzoge30sCiAgICBhamF4U2V0dGluZ3M6IHsKICAgICAgdXJsOiBsb2NhdGlvbi5ocmVmLAogICAgICB0eXBlOiAiR0VUIiwKICAgICAgaXNMb2NhbDogcmxvY2FsUHJvdG9jb2wudGVzdChsb2NhdGlvbi5wcm90b2NvbCksCiAgICAgIGdsb2JhbDogdHJ1ZSwKICAgICAgcHJvY2Vzc0RhdGE6IHRydWUsCiAgICAgIGFzeW5jOiB0cnVlLAogICAgICBjb250ZW50VHlwZTogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsCiAgICAgIC8qCiAgICAgIHRpbWVvdXQ6IDAsCiAgICAgIGRhdGE6IG51bGwsCiAgICAgIGRhdGFUeXBlOiBudWxsLAogICAgICB1c2VybmFtZTogbnVsbCwKICAgICAgcGFzc3dvcmQ6IG51bGwsCiAgICAgIGNhY2hlOiBudWxsLAogICAgICB0aHJvd3M6IGZhbHNlLAogICAgICB0cmFkaXRpb25hbDogZmFsc2UsCiAgICAgIGhlYWRlcnM6IHt9LAogICAgICAqLwoKICAgICAgYWNjZXB0czogewogICAgICAgICIqIjogYWxsVHlwZXMsCiAgICAgICAgdGV4dDogInRleHQvcGxhaW4iLAogICAgICAgIGh0bWw6ICJ0ZXh0L2h0bWwiLAogICAgICAgIHhtbDogImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLAogICAgICAgIGpzb246ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQiCiAgICAgIH0sCiAgICAgIGNvbnRlbnRzOiB7CiAgICAgICAgeG1sOiAvXGJ4bWxcYi8sCiAgICAgICAgaHRtbDogL1xiaHRtbC8sCiAgICAgICAganNvbjogL1xianNvblxiLwogICAgICB9LAogICAgICByZXNwb25zZUZpZWxkczogewogICAgICAgIHhtbDogInJlc3BvbnNlWE1MIiwKICAgICAgICB0ZXh0OiAicmVzcG9uc2VUZXh0IiwKICAgICAgICBqc29uOiAicmVzcG9uc2VKU09OIgogICAgICB9LAogICAgICAvLyBEYXRhIGNvbnZlcnRlcnMKICAgICAgLy8gS2V5cyBzZXBhcmF0ZSBzb3VyY2UgKG9yIGNhdGNoYWxsICIqIikgYW5kIGRlc3RpbmF0aW9uIHR5cGVzIHdpdGggYSBzaW5nbGUgc3BhY2UKICAgICAgY29udmVydGVyczogewogICAgICAgIC8vIENvbnZlcnQgYW55dGhpbmcgdG8gdGV4dAogICAgICAgICIqIHRleHQiOiBTdHJpbmcsCiAgICAgICAgLy8gVGV4dCB0byBodG1sICh0cnVlID0gbm8gdHJhbnNmb3JtYXRpb24pCiAgICAgICAgInRleHQgaHRtbCI6IHRydWUsCiAgICAgICAgLy8gRXZhbHVhdGUgdGV4dCBhcyBhIGpzb24gZXhwcmVzc2lvbgogICAgICAgICJ0ZXh0IGpzb24iOiBKU09OLnBhcnNlLAogICAgICAgIC8vIFBhcnNlIHRleHQgYXMgeG1sCiAgICAgICAgInRleHQgeG1sIjogalF1ZXJ5LnBhcnNlWE1MCiAgICAgIH0sCiAgICAgIC8vIEZvciBvcHRpb25zIHRoYXQgc2hvdWxkbid0IGJlIGRlZXAgZXh0ZW5kZWQ6CiAgICAgIC8vIHlvdSBjYW4gYWRkIHlvdXIgb3duIGN1c3RvbSBvcHRpb25zIGhlcmUgaWYKICAgICAgLy8gYW5kIHdoZW4geW91IGNyZWF0ZSBvbmUgdGhhdCBzaG91bGRuJ3QgYmUKICAgICAgLy8gZGVlcCBleHRlbmRlZCAoc2VlIGFqYXhFeHRlbmQpCiAgICAgIGZsYXRPcHRpb25zOiB7CiAgICAgICAgdXJsOiB0cnVlLAogICAgICAgIGNvbnRleHQ6IHRydWUKICAgICAgfQogICAgfSwKICAgIC8vIENyZWF0ZXMgYSBmdWxsIGZsZWRnZWQgc2V0dGluZ3Mgb2JqZWN0IGludG8gdGFyZ2V0CiAgICAvLyB3aXRoIGJvdGggYWpheFNldHRpbmdzIGFuZCBzZXR0aW5ncyBmaWVsZHMuCiAgICAvLyBJZiB0YXJnZXQgaXMgb21pdHRlZCwgd3JpdGVzIGludG8gYWpheFNldHRpbmdzLgogICAgYWpheFNldHVwOiBmdW5jdGlvbiBhamF4U2V0dXAodGFyZ2V0LCBzZXR0aW5ncykgewogICAgICByZXR1cm4gc2V0dGluZ3MgPwogICAgICAvLyBCdWlsZGluZyBhIHNldHRpbmdzIG9iamVjdAogICAgICBhamF4RXh0ZW5kKGFqYXhFeHRlbmQodGFyZ2V0LCBqUXVlcnkuYWpheFNldHRpbmdzKSwgc2V0dGluZ3MpIDoKICAgICAgLy8gRXh0ZW5kaW5nIGFqYXhTZXR0aW5ncwogICAgICBhamF4RXh0ZW5kKGpRdWVyeS5hamF4U2V0dGluZ3MsIHRhcmdldCk7CiAgICB9LAogICAgYWpheFByZWZpbHRlcjogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHByZWZpbHRlcnMpLAogICAgYWpheFRyYW5zcG9ydDogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHRyYW5zcG9ydHMpLAogICAgLy8gTWFpbiBtZXRob2QKICAgIGFqYXg6IGZ1bmN0aW9uIGFqYXgodXJsLCBvcHRpb25zKSB7CiAgICAgIC8vIElmIHVybCBpcyBhbiBvYmplY3QsIHNpbXVsYXRlIHByZS0xLjUgc2lnbmF0dXJlCiAgICAgIGlmIChfdHlwZW9mKHVybCkgPT09ICJvYmplY3QiKSB7CiAgICAgICAgb3B0aW9ucyA9IHVybDsKICAgICAgICB1cmwgPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIC8vIEZvcmNlIG9wdGlvbnMgdG8gYmUgYW4gb2JqZWN0CiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgICB2YXIgdHJhbnNwb3J0LAogICAgICAgIC8vIFVSTCB3aXRob3V0IGFudGktY2FjaGUgcGFyYW0KICAgICAgICBjYWNoZVVSTCwKICAgICAgICAvLyBSZXNwb25zZSBoZWFkZXJzCiAgICAgICAgcmVzcG9uc2VIZWFkZXJzU3RyaW5nLAogICAgICAgIHJlc3BvbnNlSGVhZGVycywKICAgICAgICAvLyB0aW1lb3V0IGhhbmRsZQogICAgICAgIHRpbWVvdXRUaW1lciwKICAgICAgICAvLyBVcmwgY2xlYW51cCB2YXIKICAgICAgICB1cmxBbmNob3IsCiAgICAgICAgLy8gUmVxdWVzdCBzdGF0ZSAoYmVjb21lcyBmYWxzZSB1cG9uIHNlbmQgYW5kIHRydWUgdXBvbiBjb21wbGV0aW9uKQogICAgICAgIGNvbXBsZXRlZCwKICAgICAgICAvLyBUbyBrbm93IGlmIGdsb2JhbCBldmVudHMgYXJlIHRvIGJlIGRpc3BhdGNoZWQKICAgICAgICBmaXJlR2xvYmFscywKICAgICAgICAvLyBMb29wIHZhcmlhYmxlCiAgICAgICAgaSwKICAgICAgICAvLyB1bmNhY2hlZCBwYXJ0IG9mIHRoZSB1cmwKICAgICAgICB1bmNhY2hlZCwKICAgICAgICAvLyBDcmVhdGUgdGhlIGZpbmFsIG9wdGlvbnMgb2JqZWN0CiAgICAgICAgcyA9IGpRdWVyeS5hamF4U2V0dXAoe30sIG9wdGlvbnMpLAogICAgICAgIC8vIENhbGxiYWNrcyBjb250ZXh0CiAgICAgICAgY2FsbGJhY2tDb250ZXh0ID0gcy5jb250ZXh0IHx8IHMsCiAgICAgICAgLy8gQ29udGV4dCBmb3IgZ2xvYmFsIGV2ZW50cyBpcyBjYWxsYmFja0NvbnRleHQgaWYgaXQgaXMgYSBET00gbm9kZSBvciBqUXVlcnkgY29sbGVjdGlvbgogICAgICAgIGdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJiAoY2FsbGJhY2tDb250ZXh0Lm5vZGVUeXBlIHx8IGNhbGxiYWNrQ29udGV4dC5qcXVlcnkpID8galF1ZXJ5KGNhbGxiYWNrQ29udGV4dCkgOiBqUXVlcnkuZXZlbnQsCiAgICAgICAgLy8gRGVmZXJyZWRzCiAgICAgICAgZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKSwKICAgICAgICBjb21wbGV0ZURlZmVycmVkID0galF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwKICAgICAgICAvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwogICAgICAgIF9zdGF0dXNDb2RlID0gcy5zdGF0dXNDb2RlIHx8IHt9LAogICAgICAgIC8vIEhlYWRlcnMgKHRoZXkgYXJlIHNlbnQgYWxsIGF0IG9uY2UpCiAgICAgICAgcmVxdWVzdEhlYWRlcnMgPSB7fSwKICAgICAgICByZXF1ZXN0SGVhZGVyc05hbWVzID0ge30sCiAgICAgICAgLy8gRGVmYXVsdCBhYm9ydCBtZXNzYWdlCiAgICAgICAgc3RyQWJvcnQgPSAiY2FuY2VsZWQiLAogICAgICAgIC8vIEZha2UgeGhyCiAgICAgICAganFYSFIgPSB7CiAgICAgICAgICByZWFkeVN0YXRlOiAwLAogICAgICAgICAgLy8gQnVpbGRzIGhlYWRlcnMgaGFzaHRhYmxlIGlmIG5lZWRlZAogICAgICAgICAgZ2V0UmVzcG9uc2VIZWFkZXI6IGZ1bmN0aW9uIGdldFJlc3BvbnNlSGVhZGVyKGtleSkgewogICAgICAgICAgICB2YXIgbWF0Y2g7CiAgICAgICAgICAgIGlmIChjb21wbGV0ZWQpIHsKICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlSGVhZGVycykgewogICAgICAgICAgICAgICAgcmVzcG9uc2VIZWFkZXJzID0ge307CiAgICAgICAgICAgICAgICB3aGlsZSAobWF0Y2ggPSByaGVhZGVycy5leGVjKHJlc3BvbnNlSGVhZGVyc1N0cmluZykpIHsKICAgICAgICAgICAgICAgICAgcmVzcG9uc2VIZWFkZXJzW21hdGNoWzFdLnRvTG93ZXJDYXNlKCkgKyAiICJdID0gKHJlc3BvbnNlSGVhZGVyc1ttYXRjaFsxXS50b0xvd2VyQ2FzZSgpICsgIiAiXSB8fCBbXSkuY29uY2F0KG1hdGNoWzJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbWF0Y2ggPSByZXNwb25zZUhlYWRlcnNba2V5LnRvTG93ZXJDYXNlKCkgKyAiICJdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBtYXRjaCA9PSBudWxsID8gbnVsbCA6IG1hdGNoLmpvaW4oIiwgIik7CiAgICAgICAgICB9LAogICAgICAgICAgLy8gUmF3IHN0cmluZwogICAgICAgICAgZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbiBnZXRBbGxSZXNwb25zZUhlYWRlcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBjb21wbGV0ZWQgPyByZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxsOwogICAgICAgICAgfSwKICAgICAgICAgIC8vIENhY2hlcyB0aGUgaGVhZGVyCiAgICAgICAgICBzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiBzZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChjb21wbGV0ZWQgPT0gbnVsbCkgewogICAgICAgICAgICAgIG5hbWUgPSByZXF1ZXN0SGVhZGVyc05hbWVzW25hbWUudG9Mb3dlckNhc2UoKV0gPSByZXF1ZXN0SGVhZGVyc05hbWVzW25hbWUudG9Mb3dlckNhc2UoKV0gfHwgbmFtZTsKICAgICAgICAgICAgICByZXF1ZXN0SGVhZGVyc1tuYW1lXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfSwKICAgICAgICAgIC8vIE92ZXJyaWRlcyByZXNwb25zZSBjb250ZW50LXR5cGUgaGVhZGVyCiAgICAgICAgICBvdmVycmlkZU1pbWVUeXBlOiBmdW5jdGlvbiBvdmVycmlkZU1pbWVUeXBlKHR5cGUpIHsKICAgICAgICAgICAgaWYgKGNvbXBsZXRlZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgcy5taW1lVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9LAogICAgICAgICAgLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKICAgICAgICAgIHN0YXR1c0NvZGU6IGZ1bmN0aW9uIHN0YXR1c0NvZGUobWFwKSB7CiAgICAgICAgICAgIHZhciBjb2RlOwogICAgICAgICAgICBpZiAobWFwKSB7CiAgICAgICAgICAgICAgaWYgKGNvbXBsZXRlZCkgewogICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgYXBwcm9wcmlhdGUgY2FsbGJhY2tzCiAgICAgICAgICAgICAgICBqcVhIUi5hbHdheXMobWFwW2pxWEhSLnN0YXR1c10pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBMYXp5LWFkZCB0aGUgbmV3IGNhbGxiYWNrcyBpbiBhIHdheSB0aGF0IHByZXNlcnZlcyBvbGQgb25lcwogICAgICAgICAgICAgICAgZm9yIChjb2RlIGluIG1hcCkgewogICAgICAgICAgICAgICAgICBfc3RhdHVzQ29kZVtjb2RlXSA9IFtfc3RhdHVzQ29kZVtjb2RlXSwgbWFwW2NvZGVdXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9LAogICAgICAgICAgLy8gQ2FuY2VsIHRoZSByZXF1ZXN0CiAgICAgICAgICBhYm9ydDogZnVuY3Rpb24gYWJvcnQoc3RhdHVzVGV4dCkgewogICAgICAgICAgICB2YXIgZmluYWxUZXh0ID0gc3RhdHVzVGV4dCB8fCBzdHJBYm9ydDsKICAgICAgICAgICAgaWYgKHRyYW5zcG9ydCkgewogICAgICAgICAgICAgIHRyYW5zcG9ydC5hYm9ydChmaW5hbFRleHQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRvbmUoMCwgZmluYWxUZXh0KTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgIC8vIEF0dGFjaCBkZWZlcnJlZHMKICAgICAgZGVmZXJyZWQucHJvbWlzZShqcVhIUik7CgogICAgICAvLyBBZGQgcHJvdG9jb2wgaWYgbm90IHByb3ZpZGVkIChwcmVmaWx0ZXJzIG1pZ2h0IGV4cGVjdCBpdCkKICAgICAgLy8gSGFuZGxlIGZhbHN5IHVybCBpbiB0aGUgc2V0dGluZ3Mgb2JqZWN0ICgjMTAwOTM6IGNvbnNpc3RlbmN5IHdpdGggb2xkIHNpZ25hdHVyZSkKICAgICAgLy8gV2UgYWxzbyB1c2UgdGhlIHVybCBwYXJhbWV0ZXIgaWYgYXZhaWxhYmxlCiAgICAgIHMudXJsID0gKCh1cmwgfHwgcy51cmwgfHwgbG9jYXRpb24uaHJlZikgKyAiIikucmVwbGFjZShycHJvdG9jb2wsIGxvY2F0aW9uLnByb3RvY29sICsgIi8vIik7CgogICAgICAvLyBBbGlhcyBtZXRob2Qgb3B0aW9uIHRvIHR5cGUgYXMgcGVyIHRpY2tldCAjMTIwMDQKICAgICAgcy50eXBlID0gb3B0aW9ucy5tZXRob2QgfHwgb3B0aW9ucy50eXBlIHx8IHMubWV0aG9kIHx8IHMudHlwZTsKCiAgICAgIC8vIEV4dHJhY3QgZGF0YVR5cGVzIGxpc3QKICAgICAgcy5kYXRhVHlwZXMgPSAocy5kYXRhVHlwZSB8fCAiKiIpLnRvTG93ZXJDYXNlKCkubWF0Y2gocm5vdGh0bWx3aGl0ZSkgfHwgWyIiXTsKCiAgICAgIC8vIEEgY3Jvc3MtZG9tYWluIHJlcXVlc3QgaXMgaW4gb3JkZXIgd2hlbiB0aGUgb3JpZ2luIGRvZXNuJ3QgbWF0Y2ggdGhlIGN1cnJlbnQgb3JpZ2luLgogICAgICBpZiAocy5jcm9zc0RvbWFpbiA9PSBudWxsKSB7CiAgICAgICAgdXJsQW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwoKICAgICAgICAvLyBTdXBwb3J0OiBJRSA8PTggLSAxMSwgRWRnZSAxMiAtIDE1CiAgICAgICAgLy8gSUUgdGhyb3dzIGV4Y2VwdGlvbiBvbiBhY2Nlc3NpbmcgdGhlIGhyZWYgcHJvcGVydHkgaWYgdXJsIGlzIG1hbGZvcm1lZCwKICAgICAgICAvLyBlLmcuIGh0dHA6Ly9leGFtcGxlLmNvbTo4MHgvCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHVybEFuY2hvci5ocmVmID0gcy51cmw7CgogICAgICAgICAgLy8gU3VwcG9ydDogSUUgPD04IC0gMTEgb25seQogICAgICAgICAgLy8gQW5jaG9yJ3MgaG9zdCBwcm9wZXJ0eSBpc24ndCBjb3JyZWN0bHkgc2V0IHdoZW4gcy51cmwgaXMgcmVsYXRpdmUKICAgICAgICAgIHVybEFuY2hvci5ocmVmID0gdXJsQW5jaG9yLmhyZWY7CiAgICAgICAgICBzLmNyb3NzRG9tYWluID0gb3JpZ2luQW5jaG9yLnByb3RvY29sICsgIi8vIiArIG9yaWdpbkFuY2hvci5ob3N0ICE9PSB1cmxBbmNob3IucHJvdG9jb2wgKyAiLy8iICsgdXJsQW5jaG9yLmhvc3Q7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gZXJyb3IgcGFyc2luZyB0aGUgVVJMLCBhc3N1bWUgaXQgaXMgY3Jvc3NEb21haW4sCiAgICAgICAgICAvLyBpdCBjYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIHRyYW5zcG9ydCBpZiBpdCBpcyBpbnZhbGlkCiAgICAgICAgICBzLmNyb3NzRG9tYWluID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZwogICAgICBpZiAocy5kYXRhICYmIHMucHJvY2Vzc0RhdGEgJiYgdHlwZW9mIHMuZGF0YSAhPT0gInN0cmluZyIpIHsKICAgICAgICBzLmRhdGEgPSBqUXVlcnkucGFyYW0ocy5kYXRhLCBzLnRyYWRpdGlvbmFsKTsKICAgICAgfQoKICAgICAgLy8gQXBwbHkgcHJlZmlsdGVycwogICAgICBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyhwcmVmaWx0ZXJzLCBzLCBvcHRpb25zLCBqcVhIUik7CgogICAgICAvLyBJZiByZXF1ZXN0IHdhcyBhYm9ydGVkIGluc2lkZSBhIHByZWZpbHRlciwgc3RvcCB0aGVyZQogICAgICBpZiAoY29tcGxldGVkKSB7CiAgICAgICAgcmV0dXJuIGpxWEhSOwogICAgICB9CgogICAgICAvLyBXZSBjYW4gZmlyZSBnbG9iYWwgZXZlbnRzIGFzIG9mIG5vdyBpZiBhc2tlZCB0bwogICAgICAvLyBEb24ndCBmaXJlIGV2ZW50cyBpZiBqUXVlcnkuZXZlbnQgaXMgdW5kZWZpbmVkIGluIGFuIEFNRC11c2FnZSBzY2VuYXJpbyAoIzE1MTE4KQogICAgICBmaXJlR2xvYmFscyA9IGpRdWVyeS5ldmVudCAmJiBzLmdsb2JhbDsKCiAgICAgIC8vIFdhdGNoIGZvciBhIG5ldyBzZXQgb2YgcmVxdWVzdHMKICAgICAgaWYgKGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCkgewogICAgICAgIGpRdWVyeS5ldmVudC50cmlnZ2VyKCJhamF4U3RhcnQiKTsKICAgICAgfQoKICAgICAgLy8gVXBwZXJjYXNlIHRoZSB0eXBlCiAgICAgIHMudHlwZSA9IHMudHlwZS50b1VwcGVyQ2FzZSgpOwoKICAgICAgLy8gRGV0ZXJtaW5lIGlmIHJlcXVlc3QgaGFzIGNvbnRlbnQKICAgICAgcy5oYXNDb250ZW50ID0gIXJub0NvbnRlbnQudGVzdChzLnR5cGUpOwoKICAgICAgLy8gU2F2ZSB0aGUgVVJMIGluIGNhc2Ugd2UncmUgdG95aW5nIHdpdGggdGhlIElmLU1vZGlmaWVkLVNpbmNlCiAgICAgIC8vIGFuZC9vciBJZi1Ob25lLU1hdGNoIGhlYWRlciBsYXRlciBvbgogICAgICAvLyBSZW1vdmUgaGFzaCB0byBzaW1wbGlmeSB1cmwgbWFuaXB1bGF0aW9uCiAgICAgIGNhY2hlVVJMID0gcy51cmwucmVwbGFjZShyaGFzaCwgIiIpOwoKICAgICAgLy8gTW9yZSBvcHRpb25zIGhhbmRsaW5nIGZvciByZXF1ZXN0cyB3aXRoIG5vIGNvbnRlbnQKICAgICAgaWYgKCFzLmhhc0NvbnRlbnQpIHsKICAgICAgICAvLyBSZW1lbWJlciB0aGUgaGFzaCBzbyB3ZSBjYW4gcHV0IGl0IGJhY2sKICAgICAgICB1bmNhY2hlZCA9IHMudXJsLnNsaWNlKGNhY2hlVVJMLmxlbmd0aCk7CgogICAgICAgIC8vIElmIGRhdGEgaXMgYXZhaWxhYmxlIGFuZCBzaG91bGQgYmUgcHJvY2Vzc2VkLCBhcHBlbmQgZGF0YSB0byB1cmwKICAgICAgICBpZiAocy5kYXRhICYmIChzLnByb2Nlc3NEYXRhIHx8IHR5cGVvZiBzLmRhdGEgPT09ICJzdHJpbmciKSkgewogICAgICAgICAgY2FjaGVVUkwgKz0gKHJxdWVyeS50ZXN0KGNhY2hlVVJMKSA/ICImIiA6ICI/IikgKyBzLmRhdGE7CgogICAgICAgICAgLy8gIzk2ODI6IHJlbW92ZSBkYXRhIHNvIHRoYXQgaXQncyBub3QgdXNlZCBpbiBhbiBldmVudHVhbCByZXRyeQogICAgICAgICAgZGVsZXRlIHMuZGF0YTsKICAgICAgICB9CgogICAgICAgIC8vIEFkZCBvciB1cGRhdGUgYW50aS1jYWNoZSBwYXJhbSBpZiBuZWVkZWQKICAgICAgICBpZiAocy5jYWNoZSA9PT0gZmFsc2UpIHsKICAgICAgICAgIGNhY2hlVVJMID0gY2FjaGVVUkwucmVwbGFjZShyYW50aUNhY2hlLCAiJDEiKTsKICAgICAgICAgIHVuY2FjaGVkID0gKHJxdWVyeS50ZXN0KGNhY2hlVVJMKSA/ICImIiA6ICI/IikgKyAiXz0iICsgbm9uY2UuZ3VpZCsrICsgdW5jYWNoZWQ7CiAgICAgICAgfQoKICAgICAgICAvLyBQdXQgaGFzaCBhbmQgYW50aS1jYWNoZSBvbiB0aGUgVVJMIHRoYXQgd2lsbCBiZSByZXF1ZXN0ZWQgKGdoLTE3MzIpCiAgICAgICAgcy51cmwgPSBjYWNoZVVSTCArIHVuY2FjaGVkOwoKICAgICAgICAvLyBDaGFuZ2UgJyUyMCcgdG8gJysnIGlmIHRoaXMgaXMgZW5jb2RlZCBmb3JtIGJvZHkgY29udGVudCAoZ2gtMjY1OCkKICAgICAgfSBlbHNlIGlmIChzLmRhdGEgJiYgcy5wcm9jZXNzRGF0YSAmJiAocy5jb250ZW50VHlwZSB8fCAiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikgPT09IDApIHsKICAgICAgICBzLmRhdGEgPSBzLmRhdGEucmVwbGFjZShyMjAsICIrIik7CiAgICAgIH0KCiAgICAgIC8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuCiAgICAgIGlmIChzLmlmTW9kaWZpZWQpIHsKICAgICAgICBpZiAoalF1ZXJ5Lmxhc3RNb2RpZmllZFtjYWNoZVVSTF0pIHsKICAgICAgICAgIGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIiwgalF1ZXJ5Lmxhc3RNb2RpZmllZFtjYWNoZVVSTF0pOwogICAgICAgIH0KICAgICAgICBpZiAoalF1ZXJ5LmV0YWdbY2FjaGVVUkxdKSB7CiAgICAgICAgICBqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIiwgalF1ZXJ5LmV0YWdbY2FjaGVVUkxdKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIFNldCB0aGUgY29ycmVjdCBoZWFkZXIsIGlmIGRhdGEgaXMgYmVpbmcgc2VudAogICAgICBpZiAocy5kYXRhICYmIHMuaGFzQ29udGVudCAmJiBzLmNvbnRlbnRUeXBlICE9PSBmYWxzZSB8fCBvcHRpb25zLmNvbnRlbnRUeXBlKSB7CiAgICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgcy5jb250ZW50VHlwZSk7CiAgICAgIH0KCiAgICAgIC8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRlcGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0Iiwgcy5kYXRhVHlwZXNbMF0gJiYgcy5hY2NlcHRzW3MuZGF0YVR5cGVzWzBdXSA/IHMuYWNjZXB0c1tzLmRhdGFUeXBlc1swXV0gKyAocy5kYXRhVHlwZXNbMF0gIT09ICIqIiA/ICIsICIgKyBhbGxUeXBlcyArICI7IHE9MC4wMSIgOiAiIikgOiBzLmFjY2VwdHNbIioiXSk7CgogICAgICAvLyBDaGVjayBmb3IgaGVhZGVycyBvcHRpb24KICAgICAgZm9yIChpIGluIHMuaGVhZGVycykgewogICAgICAgIGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoaSwgcy5oZWFkZXJzW2ldKTsKICAgICAgfQoKICAgICAgLy8gQWxsb3cgY3VzdG9tIGhlYWRlcnMvbWltZXR5cGVzIGFuZCBlYXJseSBhYm9ydAogICAgICBpZiAocy5iZWZvcmVTZW5kICYmIChzLmJlZm9yZVNlbmQuY2FsbChjYWxsYmFja0NvbnRleHQsIGpxWEhSLCBzKSA9PT0gZmFsc2UgfHwgY29tcGxldGVkKSkgewogICAgICAgIC8vIEFib3J0IGlmIG5vdCBkb25lIGFscmVhZHkgYW5kIHJldHVybgogICAgICAgIHJldHVybiBqcVhIUi5hYm9ydCgpOwogICAgICB9CgogICAgICAvLyBBYm9ydGluZyBpcyBubyBsb25nZXIgYSBjYW5jZWxsYXRpb24KICAgICAgc3RyQWJvcnQgPSAiYWJvcnQiOwoKICAgICAgLy8gSW5zdGFsbCBjYWxsYmFja3Mgb24gZGVmZXJyZWRzCiAgICAgIGNvbXBsZXRlRGVmZXJyZWQuYWRkKHMuY29tcGxldGUpOwogICAgICBqcVhIUi5kb25lKHMuc3VjY2Vzcyk7CiAgICAgIGpxWEhSLmZhaWwocy5lcnJvcik7CgogICAgICAvLyBHZXQgdHJhbnNwb3J0CiAgICAgIHRyYW5zcG9ydCA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHRyYW5zcG9ydHMsIHMsIG9wdGlvbnMsIGpxWEhSKTsKCiAgICAgIC8vIElmIG5vIHRyYW5zcG9ydCwgd2UgYXV0by1hYm9ydAogICAgICBpZiAoIXRyYW5zcG9ydCkgewogICAgICAgIGRvbmUoLTEsICJObyBUcmFuc3BvcnQiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBqcVhIUi5yZWFkeVN0YXRlID0gMTsKCiAgICAgICAgLy8gU2VuZCBnbG9iYWwgZXZlbnQKICAgICAgICBpZiAoZmlyZUdsb2JhbHMpIHsKICAgICAgICAgIGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCJhamF4U2VuZCIsIFtqcVhIUiwgc10pOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYWpheFNlbmQsIHN0b3AgdGhlcmUKICAgICAgICBpZiAoY29tcGxldGVkKSB7CiAgICAgICAgICByZXR1cm4ganFYSFI7CiAgICAgICAgfQoKICAgICAgICAvLyBUaW1lb3V0CiAgICAgICAgaWYgKHMuYXN5bmMgJiYgcy50aW1lb3V0ID4gMCkgewogICAgICAgICAgdGltZW91dFRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBqcVhIUi5hYm9ydCgidGltZW91dCIpOwogICAgICAgICAgfSwgcy50aW1lb3V0KTsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbXBsZXRlZCA9IGZhbHNlOwogICAgICAgICAgdHJhbnNwb3J0LnNlbmQocmVxdWVzdEhlYWRlcnMsIGRvbmUpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIC8vIFJldGhyb3cgcG9zdC1jb21wbGV0aW9uIGV4Y2VwdGlvbnMKICAgICAgICAgIGlmIChjb21wbGV0ZWQpIHsKICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBQcm9wYWdhdGUgb3RoZXJzIGFzIHJlc3VsdHMKICAgICAgICAgIGRvbmUoLTEsIGUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlcnl0aGluZyBpcyBkb25lCiAgICAgIGZ1bmN0aW9uIGRvbmUoc3RhdHVzLCBuYXRpdmVTdGF0dXNUZXh0LCByZXNwb25zZXMsIGhlYWRlcnMpIHsKICAgICAgICB2YXIgaXNTdWNjZXNzLAogICAgICAgICAgc3VjY2VzcywKICAgICAgICAgIGVycm9yLAogICAgICAgICAgcmVzcG9uc2UsCiAgICAgICAgICBtb2RpZmllZCwKICAgICAgICAgIHN0YXR1c1RleHQgPSBuYXRpdmVTdGF0dXNUZXh0OwoKICAgICAgICAvLyBJZ25vcmUgcmVwZWF0IGludm9jYXRpb25zCiAgICAgICAgaWYgKGNvbXBsZXRlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb21wbGV0ZWQgPSB0cnVlOwoKICAgICAgICAvLyBDbGVhciB0aW1lb3V0IGlmIGl0IGV4aXN0cwogICAgICAgIGlmICh0aW1lb3V0VGltZXIpIHsKICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dFRpbWVyKTsKICAgICAgICB9CgogICAgICAgIC8vIERlcmVmZXJlbmNlIHRyYW5zcG9ydCBmb3IgZWFybHkgZ2FyYmFnZSBjb2xsZWN0aW9uCiAgICAgICAgLy8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZCkKICAgICAgICB0cmFuc3BvcnQgPSB1bmRlZmluZWQ7CgogICAgICAgIC8vIENhY2hlIHJlc3BvbnNlIGhlYWRlcnMKICAgICAgICByZXNwb25zZUhlYWRlcnNTdHJpbmcgPSBoZWFkZXJzIHx8ICIiOwoKICAgICAgICAvLyBTZXQgcmVhZHlTdGF0ZQogICAgICAgIGpxWEhSLnJlYWR5U3RhdGUgPSBzdGF0dXMgPiAwID8gNCA6IDA7CgogICAgICAgIC8vIERldGVybWluZSBpZiBzdWNjZXNzZnVsCiAgICAgICAgaXNTdWNjZXNzID0gc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDAgfHwgc3RhdHVzID09PSAzMDQ7CgogICAgICAgIC8vIEdldCByZXNwb25zZSBkYXRhCiAgICAgICAgaWYgKHJlc3BvbnNlcykgewogICAgICAgICAgcmVzcG9uc2UgPSBhamF4SGFuZGxlUmVzcG9uc2VzKHMsIGpxWEhSLCByZXNwb25zZXMpOwogICAgICAgIH0KCiAgICAgICAgLy8gVXNlIGEgbm9vcCBjb252ZXJ0ZXIgZm9yIG1pc3Npbmcgc2NyaXB0CiAgICAgICAgaWYgKCFpc1N1Y2Nlc3MgJiYgalF1ZXJ5LmluQXJyYXkoInNjcmlwdCIsIHMuZGF0YVR5cGVzKSA+IC0xKSB7CiAgICAgICAgICBzLmNvbnZlcnRlcnNbInRleHQgc2NyaXB0Il0gPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CgogICAgICAgIC8vIENvbnZlcnQgbm8gbWF0dGVyIHdoYXQgKHRoYXQgd2F5IHJlc3BvbnNlWFhYIGZpZWxkcyBhcmUgYWx3YXlzIHNldCkKICAgICAgICByZXNwb25zZSA9IGFqYXhDb252ZXJ0KHMsIHJlc3BvbnNlLCBqcVhIUiwgaXNTdWNjZXNzKTsKCiAgICAgICAgLy8gSWYgc3VjY2Vzc2Z1bCwgaGFuZGxlIHR5cGUgY2hhaW5pbmcKICAgICAgICBpZiAoaXNTdWNjZXNzKSB7CiAgICAgICAgICAvLyBTZXQgdGhlIElmLU1vZGlmaWVkLVNpbmNlIGFuZC9vciBJZi1Ob25lLU1hdGNoIGhlYWRlciwgaWYgaW4gaWZNb2RpZmllZCBtb2RlLgogICAgICAgICAgaWYgKHMuaWZNb2RpZmllZCkgewogICAgICAgICAgICBtb2RpZmllZCA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIik7CiAgICAgICAgICAgIGlmIChtb2RpZmllZCkgewogICAgICAgICAgICAgIGpRdWVyeS5sYXN0TW9kaWZpZWRbY2FjaGVVUkxdID0gbW9kaWZpZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpOwogICAgICAgICAgICBpZiAobW9kaWZpZWQpIHsKICAgICAgICAgICAgICBqUXVlcnkuZXRhZ1tjYWNoZVVSTF0gPSBtb2RpZmllZDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIGlmIG5vIGNvbnRlbnQKICAgICAgICAgIGlmIChzdGF0dXMgPT09IDIwNCB8fCBzLnR5cGUgPT09ICJIRUFEIikgewogICAgICAgICAgICBzdGF0dXNUZXh0ID0gIm5vY29udGVudCI7CgogICAgICAgICAgICAvLyBpZiBub3QgbW9kaWZpZWQKICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSAzMDQpIHsKICAgICAgICAgICAgc3RhdHVzVGV4dCA9ICJub3Rtb2RpZmllZCI7CgogICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGRhdGEsIGxldCdzIGNvbnZlcnQgaXQKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YXR1c1RleHQgPSByZXNwb25zZS5zdGF0ZTsKICAgICAgICAgICAgc3VjY2VzcyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIGVycm9yID0gcmVzcG9uc2UuZXJyb3I7CiAgICAgICAgICAgIGlzU3VjY2VzcyA9ICFlcnJvcjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gRXh0cmFjdCBlcnJvciBmcm9tIHN0YXR1c1RleHQgYW5kIG5vcm1hbGl6ZSBmb3Igbm9uLWFib3J0cwogICAgICAgICAgZXJyb3IgPSBzdGF0dXNUZXh0OwogICAgICAgICAgaWYgKHN0YXR1cyB8fCAhc3RhdHVzVGV4dCkgewogICAgICAgICAgICBzdGF0dXNUZXh0ID0gImVycm9yIjsKICAgICAgICAgICAgaWYgKHN0YXR1cyA8IDApIHsKICAgICAgICAgICAgICBzdGF0dXMgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBTZXQgZGF0YSBmb3IgdGhlIGZha2UgeGhyIG9iamVjdAogICAgICAgIGpxWEhSLnN0YXR1cyA9IHN0YXR1czsKICAgICAgICBqcVhIUi5zdGF0dXNUZXh0ID0gKG5hdGl2ZVN0YXR1c1RleHQgfHwgc3RhdHVzVGV4dCkgKyAiIjsKCiAgICAgICAgLy8gU3VjY2Vzcy9FcnJvcgogICAgICAgIGlmIChpc1N1Y2Nlc3MpIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmVXaXRoKGNhbGxiYWNrQ29udGV4dCwgW3N1Y2Nlc3MsIHN0YXR1c1RleHQsIGpxWEhSXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlZmVycmVkLnJlamVjdFdpdGgoY2FsbGJhY2tDb250ZXh0LCBbanFYSFIsIHN0YXR1c1RleHQsIGVycm9yXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwogICAgICAgIGpxWEhSLnN0YXR1c0NvZGUoX3N0YXR1c0NvZGUpOwogICAgICAgIF9zdGF0dXNDb2RlID0gdW5kZWZpbmVkOwogICAgICAgIGlmIChmaXJlR2xvYmFscykgewogICAgICAgICAgZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoaXNTdWNjZXNzID8gImFqYXhTdWNjZXNzIiA6ICJhamF4RXJyb3IiLCBbanFYSFIsIHMsIGlzU3VjY2VzcyA/IHN1Y2Nlc3MgOiBlcnJvcl0pOwogICAgICAgIH0KCiAgICAgICAgLy8gQ29tcGxldGUKICAgICAgICBjb21wbGV0ZURlZmVycmVkLmZpcmVXaXRoKGNhbGxiYWNrQ29udGV4dCwgW2pxWEhSLCBzdGF0dXNUZXh0XSk7CiAgICAgICAgaWYgKGZpcmVHbG9iYWxzKSB7CiAgICAgICAgICBnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlcigiYWpheENvbXBsZXRlIiwgW2pxWEhSLCBzXSk7CgogICAgICAgICAgLy8gSGFuZGxlIHRoZSBnbG9iYWwgQUpBWCBjb3VudGVyCiAgICAgICAgICBpZiAoISAtLWpRdWVyeS5hY3RpdmUpIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBqcVhIUjsKICAgIH0sCiAgICBnZXRKU09OOiBmdW5jdGlvbiBnZXRKU09OKHVybCwgZGF0YSwgY2FsbGJhY2spIHsKICAgICAgcmV0dXJuIGpRdWVyeS5nZXQodXJsLCBkYXRhLCBjYWxsYmFjaywgImpzb24iKTsKICAgIH0sCiAgICBnZXRTY3JpcHQ6IGZ1bmN0aW9uIGdldFNjcmlwdCh1cmwsIGNhbGxiYWNrKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZ2V0KHVybCwgdW5kZWZpbmVkLCBjYWxsYmFjaywgInNjcmlwdCIpOwogICAgfQogIH0pOwogIGpRdWVyeS5lYWNoKFsiZ2V0IiwgInBvc3QiXSwgZnVuY3Rpb24gKF9pLCBtZXRob2QpIHsKICAgIGpRdWVyeVttZXRob2RdID0gZnVuY3Rpb24gKHVybCwgZGF0YSwgY2FsbGJhY2ssIHR5cGUpIHsKICAgICAgLy8gU2hpZnQgYXJndW1lbnRzIGlmIGRhdGEgYXJndW1lbnQgd2FzIG9taXR0ZWQKICAgICAgaWYgKGlzRnVuY3Rpb24oZGF0YSkpIHsKICAgICAgICB0eXBlID0gdHlwZSB8fCBjYWxsYmFjazsKICAgICAgICBjYWxsYmFjayA9IGRhdGE7CiAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgLy8gVGhlIHVybCBjYW4gYmUgYW4gb3B0aW9ucyBvYmplY3QgKHdoaWNoIHRoZW4gbXVzdCBoYXZlIC51cmwpCiAgICAgIHJldHVybiBqUXVlcnkuYWpheChqUXVlcnkuZXh0ZW5kKHsKICAgICAgICB1cmw6IHVybCwKICAgICAgICB0eXBlOiBtZXRob2QsCiAgICAgICAgZGF0YVR5cGU6IHR5cGUsCiAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICBzdWNjZXNzOiBjYWxsYmFjawogICAgICB9LCBqUXVlcnkuaXNQbGFpbk9iamVjdCh1cmwpICYmIHVybCkpOwogICAgfTsKICB9KTsKICBqUXVlcnkuYWpheFByZWZpbHRlcihmdW5jdGlvbiAocykgewogICAgdmFyIGk7CiAgICBmb3IgKGkgaW4gcy5oZWFkZXJzKSB7CiAgICAgIGlmIChpLnRvTG93ZXJDYXNlKCkgPT09ICJjb250ZW50LXR5cGUiKSB7CiAgICAgICAgcy5jb250ZW50VHlwZSA9IHMuaGVhZGVyc1tpXSB8fCAiIjsKICAgICAgfQogICAgfQogIH0pOwogIGpRdWVyeS5fZXZhbFVybCA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMsIGRvYykgewogICAgcmV0dXJuIGpRdWVyeS5hamF4KHsKICAgICAgdXJsOiB1cmwsCiAgICAgIC8vIE1ha2UgdGhpcyBleHBsaWNpdCwgc2luY2UgdXNlciBjYW4gb3ZlcnJpZGUgdGhpcyB0aHJvdWdoIGFqYXhTZXR1cCAoIzExMjY0KQogICAgICB0eXBlOiAiR0VUIiwKICAgICAgZGF0YVR5cGU6ICJzY3JpcHQiLAogICAgICBjYWNoZTogdHJ1ZSwKICAgICAgYXN5bmM6IGZhbHNlLAogICAgICBnbG9iYWw6IGZhbHNlLAogICAgICAvLyBPbmx5IGV2YWx1YXRlIHRoZSByZXNwb25zZSBpZiBpdCBpcyBzdWNjZXNzZnVsIChnaC00MTI2KQogICAgICAvLyBkYXRhRmlsdGVyIGlzIG5vdCBpbnZva2VkIGZvciBmYWlsdXJlIHJlc3BvbnNlcywgc28gdXNpbmcgaXQgaW5zdGVhZAogICAgICAvLyBvZiB0aGUgZGVmYXVsdCBjb252ZXJ0ZXIgaXMga2x1ZGd5IGJ1dCBpdCB3b3Jrcy4KICAgICAgY29udmVydGVyczogewogICAgICAgICJ0ZXh0IHNjcmlwdCI6IGZ1bmN0aW9uIHRleHRTY3JpcHQoKSB7fQogICAgICB9LAogICAgICBkYXRhRmlsdGVyOiBmdW5jdGlvbiBkYXRhRmlsdGVyKHJlc3BvbnNlKSB7CiAgICAgICAgalF1ZXJ5Lmdsb2JhbEV2YWwocmVzcG9uc2UsIG9wdGlvbnMsIGRvYyk7CiAgICAgIH0KICAgIH0pOwogIH07CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICB3cmFwQWxsOiBmdW5jdGlvbiB3cmFwQWxsKGh0bWwpIHsKICAgICAgdmFyIHdyYXA7CiAgICAgIGlmICh0aGlzWzBdKSB7CiAgICAgICAgaWYgKGlzRnVuY3Rpb24oaHRtbCkpIHsKICAgICAgICAgIGh0bWwgPSBodG1sLmNhbGwodGhpc1swXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBUaGUgZWxlbWVudHMgdG8gd3JhcCB0aGUgdGFyZ2V0IGFyb3VuZAogICAgICAgIHdyYXAgPSBqUXVlcnkoaHRtbCwgdGhpc1swXS5vd25lckRvY3VtZW50KS5lcSgwKS5jbG9uZSh0cnVlKTsKICAgICAgICBpZiAodGhpc1swXS5wYXJlbnROb2RlKSB7CiAgICAgICAgICB3cmFwLmluc2VydEJlZm9yZSh0aGlzWzBdKTsKICAgICAgICB9CiAgICAgICAgd3JhcC5tYXAoZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGVsZW0gPSB0aGlzOwogICAgICAgICAgd2hpbGUgKGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQpIHsKICAgICAgICAgICAgZWxlbSA9IGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQ7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZWxlbTsKICAgICAgICB9KS5hcHBlbmQodGhpcyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgd3JhcElubmVyOiBmdW5jdGlvbiB3cmFwSW5uZXIoaHRtbCkgewogICAgICBpZiAoaXNGdW5jdGlvbihodG1sKSkgewogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS53cmFwSW5uZXIoaHRtbC5jYWxsKHRoaXMsIGkpKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgc2VsZiA9IGpRdWVyeSh0aGlzKSwKICAgICAgICAgIGNvbnRlbnRzID0gc2VsZi5jb250ZW50cygpOwogICAgICAgIGlmIChjb250ZW50cy5sZW5ndGgpIHsKICAgICAgICAgIGNvbnRlbnRzLndyYXBBbGwoaHRtbCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlbGYuYXBwZW5kKGh0bWwpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgd3JhcDogZnVuY3Rpb24gd3JhcChodG1sKSB7CiAgICAgIHZhciBodG1sSXNGdW5jdGlvbiA9IGlzRnVuY3Rpb24oaHRtbCk7CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICBqUXVlcnkodGhpcykud3JhcEFsbChodG1sSXNGdW5jdGlvbiA/IGh0bWwuY2FsbCh0aGlzLCBpKSA6IGh0bWwpOwogICAgICB9KTsKICAgIH0sCiAgICB1bndyYXA6IGZ1bmN0aW9uIHVud3JhcChzZWxlY3RvcikgewogICAgICB0aGlzLnBhcmVudChzZWxlY3Rvcikubm90KCJib2R5IikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgalF1ZXJ5KHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9KTsKICBqUXVlcnkuZXhwci5wc2V1ZG9zLmhpZGRlbiA9IGZ1bmN0aW9uIChlbGVtKSB7CiAgICByZXR1cm4gIWpRdWVyeS5leHByLnBzZXVkb3MudmlzaWJsZShlbGVtKTsKICB9OwogIGpRdWVyeS5leHByLnBzZXVkb3MudmlzaWJsZSA9IGZ1bmN0aW9uIChlbGVtKSB7CiAgICByZXR1cm4gISEoZWxlbS5vZmZzZXRXaWR0aCB8fCBlbGVtLm9mZnNldEhlaWdodCB8fCBlbGVtLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKTsKICB9OwogIGpRdWVyeS5hamF4U2V0dGluZ3MueGhyID0gZnVuY3Rpb24gKCkgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKICAgIH0gY2F0Y2ggKGUpIHt9CiAgfTsKICB2YXIgeGhyU3VjY2Vzc1N0YXR1cyA9IHsKICAgICAgLy8gRmlsZSBwcm90b2NvbCBhbHdheXMgeWllbGRzIHN0YXR1cyBjb2RlIDAsIGFzc3VtZSAyMDAKICAgICAgMDogMjAwLAogICAgICAvLyBTdXBwb3J0OiBJRSA8PTkgb25seQogICAgICAvLyAjMTQ1MDogc29tZXRpbWVzIElFIHJldHVybnMgMTIyMyB3aGVuIGl0IHNob3VsZCBiZSAyMDQKICAgICAgMTIyMzogMjA0CiAgICB9LAogICAgeGhyU3VwcG9ydGVkID0galF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIoKTsKICBzdXBwb3J0LmNvcnMgPSAhIXhoclN1cHBvcnRlZCAmJiAid2l0aENyZWRlbnRpYWxzIiBpbiB4aHJTdXBwb3J0ZWQ7CiAgc3VwcG9ydC5hamF4ID0geGhyU3VwcG9ydGVkID0gISF4aHJTdXBwb3J0ZWQ7CiAgalF1ZXJ5LmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIHZhciBfY2FsbGJhY2ssIGVycm9yQ2FsbGJhY2s7CgogICAgLy8gQ3Jvc3MgZG9tYWluIG9ubHkgYWxsb3dlZCBpZiBzdXBwb3J0ZWQgdGhyb3VnaCBYTUxIdHRwUmVxdWVzdAogICAgaWYgKHN1cHBvcnQuY29ycyB8fCB4aHJTdXBwb3J0ZWQgJiYgIW9wdGlvbnMuY3Jvc3NEb21haW4pIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzZW5kOiBmdW5jdGlvbiBzZW5kKGhlYWRlcnMsIGNvbXBsZXRlKSB7CiAgICAgICAgICB2YXIgaSwKICAgICAgICAgICAgeGhyID0gb3B0aW9ucy54aHIoKTsKICAgICAgICAgIHhoci5vcGVuKG9wdGlvbnMudHlwZSwgb3B0aW9ucy51cmwsIG9wdGlvbnMuYXN5bmMsIG9wdGlvbnMudXNlcm5hbWUsIG9wdGlvbnMucGFzc3dvcmQpOwoKICAgICAgICAgIC8vIEFwcGx5IGN1c3RvbSBmaWVsZHMgaWYgcHJvdmlkZWQKICAgICAgICAgIGlmIChvcHRpb25zLnhockZpZWxkcykgewogICAgICAgICAgICBmb3IgKGkgaW4gb3B0aW9ucy54aHJGaWVsZHMpIHsKICAgICAgICAgICAgICB4aHJbaV0gPSBvcHRpb25zLnhockZpZWxkc1tpXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIE92ZXJyaWRlIG1pbWUgdHlwZSBpZiBuZWVkZWQKICAgICAgICAgIGlmIChvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlKSB7CiAgICAgICAgICAgIHhoci5vdmVycmlkZU1pbWVUeXBlKG9wdGlvbnMubWltZVR5cGUpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFgtUmVxdWVzdGVkLVdpdGggaGVhZGVyCiAgICAgICAgICAvLyBGb3IgY3Jvc3MtZG9tYWluIHJlcXVlc3RzLCBzZWVpbmcgYXMgY29uZGl0aW9ucyBmb3IgYSBwcmVmbGlnaHQgYXJlCiAgICAgICAgICAvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLgogICAgICAgICAgLy8gKGl0IGNhbiBhbHdheXMgYmUgc2V0IG9uIGEgcGVyLXJlcXVlc3QgYmFzaXMgb3IgZXZlbiB1c2luZyBhamF4U2V0dXApCiAgICAgICAgICAvLyBGb3Igc2FtZS1kb21haW4gcmVxdWVzdHMsIHdvbid0IGNoYW5nZSBoZWFkZXIgaWYgYWxyZWFkeSBwcm92aWRlZC4KICAgICAgICAgIGlmICghb3B0aW9ucy5jcm9zc0RvbWFpbiAmJiAhaGVhZGVyc1siWC1SZXF1ZXN0ZWQtV2l0aCJdKSB7CiAgICAgICAgICAgIGhlYWRlcnNbIlgtUmVxdWVzdGVkLVdpdGgiXSA9ICJYTUxIdHRwUmVxdWVzdCI7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU2V0IGhlYWRlcnMKICAgICAgICAgIGZvciAoaSBpbiBoZWFkZXJzKSB7CiAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGksIGhlYWRlcnNbaV0pOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIENhbGxiYWNrCiAgICAgICAgICBfY2FsbGJhY2sgPSBmdW5jdGlvbiBjYWxsYmFjayh0eXBlKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKF9jYWxsYmFjaykgewogICAgICAgICAgICAgICAgX2NhbGxiYWNrID0gZXJyb3JDYWxsYmFjayA9IHhoci5vbmxvYWQgPSB4aHIub25lcnJvciA9IHhoci5vbmFib3J0ID0geGhyLm9udGltZW91dCA9IHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICJhYm9ydCIpIHsKICAgICAgICAgICAgICAgICAgeGhyLmFib3J0KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJlcnJvciIpIHsKICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUgPD05IG9ubHkKICAgICAgICAgICAgICAgICAgLy8gT24gYSBtYW51YWwgbmF0aXZlIGFib3J0LCBJRTkgdGhyb3dzCiAgICAgICAgICAgICAgICAgIC8vIGVycm9ycyBvbiBhbnkgcHJvcGVydHkgYWNjZXNzIHRoYXQgaXMgbm90IHJlYWR5U3RhdGUKICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB4aHIuc3RhdHVzICE9PSAibnVtYmVyIikgewogICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlKDAsICJlcnJvciIpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlKAogICAgICAgICAgICAgICAgICAgIC8vIEZpbGU6IHByb3RvY29sIGFsd2F5cyB5aWVsZHMgc3RhdHVzIDA7IHNlZSAjODYwNSwgIzE0MjA3CiAgICAgICAgICAgICAgICAgICAgeGhyLnN0YXR1cywgeGhyLnN0YXR1c1RleHQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb21wbGV0ZSh4aHJTdWNjZXNzU3RhdHVzW3hoci5zdGF0dXNdIHx8IHhoci5zdGF0dXMsIHhoci5zdGF0dXNUZXh0LAogICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBJRSA8PTkgb25seQogICAgICAgICAgICAgICAgICAvLyBJRTkgaGFzIG5vIFhIUjIgYnV0IHRocm93cyBvbiBiaW5hcnkgKHRyYWMtMTE0MjYpCiAgICAgICAgICAgICAgICAgIC8vIEZvciBYSFIyIG5vbi10ZXh0LCBsZXQgdGhlIGNhbGxlciBoYW5kbGUgaXQgKGdoLTI0OTgpCiAgICAgICAgICAgICAgICAgICh4aHIucmVzcG9uc2VUeXBlIHx8ICJ0ZXh0IikgIT09ICJ0ZXh0IiB8fCB0eXBlb2YgeGhyLnJlc3BvbnNlVGV4dCAhPT0gInN0cmluZyIgPyB7CiAgICAgICAgICAgICAgICAgICAgYmluYXJ5OiB4aHIucmVzcG9uc2UKICAgICAgICAgICAgICAgICAgfSA6IHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB4aHIucmVzcG9uc2VUZXh0CiAgICAgICAgICAgICAgICAgIH0sIHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfTsKCiAgICAgICAgICAvLyBMaXN0ZW4gdG8gZXZlbnRzCiAgICAgICAgICB4aHIub25sb2FkID0gX2NhbGxiYWNrKCk7CiAgICAgICAgICBlcnJvckNhbGxiYWNrID0geGhyLm9uZXJyb3IgPSB4aHIub250aW1lb3V0ID0gX2NhbGxiYWNrKCJlcnJvciIpOwoKICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDkgb25seQogICAgICAgICAgLy8gVXNlIG9ucmVhZHlzdGF0ZWNoYW5nZSB0byByZXBsYWNlIG9uYWJvcnQKICAgICAgICAgIC8vIHRvIGhhbmRsZSB1bmNhdWdodCBhYm9ydHMKICAgICAgICAgIGlmICh4aHIub25hYm9ydCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHhoci5vbmFib3J0ID0gZXJyb3JDYWxsYmFjazsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgLy8gQ2hlY2sgcmVhZHlTdGF0ZSBiZWZvcmUgdGltZW91dCBhcyBpdCBjaGFuZ2VzCiAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7CiAgICAgICAgICAgICAgICAvLyBBbGxvdyBvbmVycm9yIHRvIGJlIGNhbGxlZCBmaXJzdCwKICAgICAgICAgICAgICAgIC8vIGJ1dCB0aGF0IHdpbGwgbm90IGhhbmRsZSBhIG5hdGl2ZSBhYm9ydAogICAgICAgICAgICAgICAgLy8gQWxzbywgc2F2ZSBlcnJvckNhbGxiYWNrIHRvIGEgdmFyaWFibGUKICAgICAgICAgICAgICAgIC8vIGFzIHhoci5vbmVycm9yIGNhbm5vdCBiZSBhY2Nlc3NlZAogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBpZiAoX2NhbGxiYWNrKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JDYWxsYmFjaygpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQ3JlYXRlIHRoZSBhYm9ydCBjYWxsYmFjawogICAgICAgICAgX2NhbGxiYWNrID0gX2NhbGxiYWNrKCJhYm9ydCIpOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gRG8gc2VuZCB0aGUgcmVxdWVzdCAodGhpcyBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uKQogICAgICAgICAgICB4aHIuc2VuZChvcHRpb25zLmhhc0NvbnRlbnQgJiYgb3B0aW9ucy5kYXRhIHx8IG51bGwpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAvLyAjMTQ2ODM6IE9ubHkgcmV0aHJvdyBpZiB0aGlzIGhhc24ndCBiZWVuIG5vdGlmaWVkIGFzIGFuIGVycm9yIHlldAogICAgICAgICAgICBpZiAoX2NhbGxiYWNrKSB7CiAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uIGFib3J0KCkgewogICAgICAgICAgaWYgKF9jYWxsYmFjaykgewogICAgICAgICAgICBfY2FsbGJhY2soKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIFByZXZlbnQgYXV0by1leGVjdXRpb24gb2Ygc2NyaXB0cyB3aGVuIG5vIGV4cGxpY2l0IGRhdGFUeXBlIHdhcyBwcm92aWRlZCAoU2VlIGdoLTI0MzIpCiAgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoZnVuY3Rpb24gKHMpIHsKICAgIGlmIChzLmNyb3NzRG9tYWluKSB7CiAgICAgIHMuY29udGVudHMuc2NyaXB0ID0gZmFsc2U7CiAgICB9CiAgfSk7CgogIC8vIEluc3RhbGwgc2NyaXB0IGRhdGFUeXBlCiAgalF1ZXJ5LmFqYXhTZXR1cCh7CiAgICBhY2NlcHRzOiB7CiAgICAgIHNjcmlwdDogInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgIiArICJhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQiCiAgICB9LAogICAgY29udGVudHM6IHsKICAgICAgc2NyaXB0OiAvXGIoPzpqYXZhfGVjbWEpc2NyaXB0XGIvCiAgICB9LAogICAgY29udmVydGVyczogewogICAgICAidGV4dCBzY3JpcHQiOiBmdW5jdGlvbiB0ZXh0U2NyaXB0KHRleHQpIHsKICAgICAgICBqUXVlcnkuZ2xvYmFsRXZhbCh0ZXh0KTsKICAgICAgICByZXR1cm4gdGV4dDsKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBIYW5kbGUgY2FjaGUncyBzcGVjaWFsIGNhc2UgYW5kIGNyb3NzRG9tYWluCiAgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsIGZ1bmN0aW9uIChzKSB7CiAgICBpZiAocy5jYWNoZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHMuY2FjaGUgPSBmYWxzZTsKICAgIH0KICAgIGlmIChzLmNyb3NzRG9tYWluKSB7CiAgICAgIHMudHlwZSA9ICJHRVQiOwogICAgfQogIH0pOwoKICAvLyBCaW5kIHNjcmlwdCB0YWcgaGFjayB0cmFuc3BvcnQKICBqUXVlcnkuYWpheFRyYW5zcG9ydCgic2NyaXB0IiwgZnVuY3Rpb24gKHMpIHsKICAgIC8vIFRoaXMgdHJhbnNwb3J0IG9ubHkgZGVhbHMgd2l0aCBjcm9zcyBkb21haW4gb3IgZm9yY2VkLWJ5LWF0dHJzIHJlcXVlc3RzCiAgICBpZiAocy5jcm9zc0RvbWFpbiB8fCBzLnNjcmlwdEF0dHJzKSB7CiAgICAgIHZhciBzY3JpcHQsIF9jYWxsYmFjazI7CiAgICAgIHJldHVybiB7CiAgICAgICAgc2VuZDogZnVuY3Rpb24gc2VuZChfLCBjb21wbGV0ZSkgewogICAgICAgICAgc2NyaXB0ID0galF1ZXJ5KCI8c2NyaXB0PiIpLmF0dHIocy5zY3JpcHRBdHRycyB8fCB7fSkucHJvcCh7CiAgICAgICAgICAgIGNoYXJzZXQ6IHMuc2NyaXB0Q2hhcnNldCwKICAgICAgICAgICAgc3JjOiBzLnVybAogICAgICAgICAgfSkub24oImxvYWQgZXJyb3IiLCBfY2FsbGJhY2syID0gZnVuY3Rpb24gY2FsbGJhY2soZXZ0KSB7CiAgICAgICAgICAgIHNjcmlwdC5yZW1vdmUoKTsKICAgICAgICAgICAgX2NhbGxiYWNrMiA9IG51bGw7CiAgICAgICAgICAgIGlmIChldnQpIHsKICAgICAgICAgICAgICBjb21wbGV0ZShldnQudHlwZSA9PT0gImVycm9yIiA/IDQwNCA6IDIwMCwgZXZ0LnR5cGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBVc2UgbmF0aXZlIERPTSBtYW5pcHVsYXRpb24gdG8gYXZvaWQgb3VyIGRvbU1hbmlwIEFKQVggdHJpY2tlcnkKICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0WzBdKTsKICAgICAgICB9LAogICAgICAgIGFib3J0OiBmdW5jdGlvbiBhYm9ydCgpIHsKICAgICAgICAgIGlmIChfY2FsbGJhY2syKSB7CiAgICAgICAgICAgIF9jYWxsYmFjazIoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CiAgdmFyIG9sZENhbGxiYWNrcyA9IFtdLAogICAgcmpzb25wID0gLyg9KVw/KD89JnwkKXxcP1w/LzsKCiAgLy8gRGVmYXVsdCBqc29ucCBzZXR0aW5ncwogIGpRdWVyeS5hamF4U2V0dXAoewogICAganNvbnA6ICJjYWxsYmFjayIsCiAgICBqc29ucENhbGxiYWNrOiBmdW5jdGlvbiBqc29ucENhbGxiYWNrKCkgewogICAgICB2YXIgY2FsbGJhY2sgPSBvbGRDYWxsYmFja3MucG9wKCkgfHwgalF1ZXJ5LmV4cGFuZG8gKyAiXyIgKyBub25jZS5ndWlkKys7CiAgICAgIHRoaXNbY2FsbGJhY2tdID0gdHJ1ZTsKICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgfQogIH0pOwoKICAvLyBEZXRlY3QsIG5vcm1hbGl6ZSBvcHRpb25zIGFuZCBpbnN0YWxsIGNhbGxiYWNrcyBmb3IganNvbnAgcmVxdWVzdHMKICBqUXVlcnkuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsIGZ1bmN0aW9uIChzLCBvcmlnaW5hbFNldHRpbmdzLCBqcVhIUikgewogICAgdmFyIGNhbGxiYWNrTmFtZSwKICAgICAgb3ZlcndyaXR0ZW4sCiAgICAgIHJlc3BvbnNlQ29udGFpbmVyLAogICAgICBqc29uUHJvcCA9IHMuanNvbnAgIT09IGZhbHNlICYmIChyanNvbnAudGVzdChzLnVybCkgPyAidXJsIiA6IHR5cGVvZiBzLmRhdGEgPT09ICJzdHJpbmciICYmIChzLmNvbnRlbnRUeXBlIHx8ICIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSA9PT0gMCAmJiByanNvbnAudGVzdChzLmRhdGEpICYmICJkYXRhIik7CgogICAgLy8gSGFuZGxlIGlmZiB0aGUgZXhwZWN0ZWQgZGF0YSB0eXBlIGlzICJqc29ucCIgb3Igd2UgaGF2ZSBhIHBhcmFtZXRlciB0byBzZXQKICAgIGlmIChqc29uUHJvcCB8fCBzLmRhdGFUeXBlc1swXSA9PT0gImpzb25wIikgewogICAgICAvLyBHZXQgY2FsbGJhY2sgbmFtZSwgcmVtZW1iZXJpbmcgcHJlZXhpc3RpbmcgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIGl0CiAgICAgIGNhbGxiYWNrTmFtZSA9IHMuanNvbnBDYWxsYmFjayA9IGlzRnVuY3Rpb24ocy5qc29ucENhbGxiYWNrKSA/IHMuanNvbnBDYWxsYmFjaygpIDogcy5qc29ucENhbGxiYWNrOwoKICAgICAgLy8gSW5zZXJ0IGNhbGxiYWNrIGludG8gdXJsIG9yIGZvcm0gZGF0YQogICAgICBpZiAoanNvblByb3ApIHsKICAgICAgICBzW2pzb25Qcm9wXSA9IHNbanNvblByb3BdLnJlcGxhY2Uocmpzb25wLCAiJDEiICsgY2FsbGJhY2tOYW1lKTsKICAgICAgfSBlbHNlIGlmIChzLmpzb25wICE9PSBmYWxzZSkgewogICAgICAgIHMudXJsICs9IChycXVlcnkudGVzdChzLnVybCkgPyAiJiIgOiAiPyIpICsgcy5qc29ucCArICI9IiArIGNhbGxiYWNrTmFtZTsKICAgICAgfQoKICAgICAgLy8gVXNlIGRhdGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1dGlvbgogICAgICBzLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFyZXNwb25zZUNvbnRhaW5lcikgewogICAgICAgICAgalF1ZXJ5LmVycm9yKGNhbGxiYWNrTmFtZSArICIgd2FzIG5vdCBjYWxsZWQiKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWzBdOwogICAgICB9OwoKICAgICAgLy8gRm9yY2UganNvbiBkYXRhVHlwZQogICAgICBzLmRhdGFUeXBlc1swXSA9ICJqc29uIjsKCiAgICAgIC8vIEluc3RhbGwgY2FsbGJhY2sKICAgICAgb3ZlcndyaXR0ZW4gPSB3aW5kb3dbY2FsbGJhY2tOYW1lXTsKICAgICAgd2luZG93W2NhbGxiYWNrTmFtZV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVzcG9uc2VDb250YWluZXIgPSBhcmd1bWVudHM7CiAgICAgIH07CgogICAgICAvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycykKICAgICAganFYSFIuYWx3YXlzKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBJZiBwcmV2aW91cyB2YWx1ZSBkaWRuJ3QgZXhpc3QgLSByZW1vdmUgaXQKICAgICAgICBpZiAob3ZlcndyaXR0ZW4gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgalF1ZXJ5KHdpbmRvdykucmVtb3ZlUHJvcChjYWxsYmFja05hbWUpOwoKICAgICAgICAgIC8vIE90aGVyd2lzZSByZXN0b3JlIHByZWV4aXN0aW5nIHZhbHVlCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpbmRvd1tjYWxsYmFja05hbWVdID0gb3ZlcndyaXR0ZW47CiAgICAgICAgfQoKICAgICAgICAvLyBTYXZlIGJhY2sgYXMgZnJlZQogICAgICAgIGlmIChzW2NhbGxiYWNrTmFtZV0pIHsKICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHJlLXVzaW5nIHRoZSBvcHRpb25zIGRvZXNuJ3Qgc2NyZXcgdGhpbmdzIGFyb3VuZAogICAgICAgICAgcy5qc29ucENhbGxiYWNrID0gb3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrOwoKICAgICAgICAgIC8vIFNhdmUgdGhlIGNhbGxiYWNrIG5hbWUgZm9yIGZ1dHVyZSB1c2UKICAgICAgICAgIG9sZENhbGxiYWNrcy5wdXNoKGNhbGxiYWNrTmFtZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBDYWxsIGlmIGl0IHdhcyBhIGZ1bmN0aW9uIGFuZCB3ZSBoYXZlIGEgcmVzcG9uc2UKICAgICAgICBpZiAocmVzcG9uc2VDb250YWluZXIgJiYgaXNGdW5jdGlvbihvdmVyd3JpdHRlbikpIHsKICAgICAgICAgIG92ZXJ3cml0dGVuKHJlc3BvbnNlQ29udGFpbmVyWzBdKTsKICAgICAgICB9CiAgICAgICAgcmVzcG9uc2VDb250YWluZXIgPSBvdmVyd3JpdHRlbiA9IHVuZGVmaW5lZDsKICAgICAgfSk7CgogICAgICAvLyBEZWxlZ2F0ZSB0byBzY3JpcHQKICAgICAgcmV0dXJuICJzY3JpcHQiOwogICAgfQogIH0pOwoKICAvLyBTdXBwb3J0OiBTYWZhcmkgOCBvbmx5CiAgLy8gSW4gU2FmYXJpIDggZG9jdW1lbnRzIGNyZWF0ZWQgdmlhIGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudAogIC8vIGNvbGxhcHNlIHNpYmxpbmcgZm9ybXM6IHRoZSBzZWNvbmQgb25lIGJlY29tZXMgYSBjaGlsZCBvZiB0aGUgZmlyc3Qgb25lLgogIC8vIEJlY2F1c2Ugb2YgdGhhdCwgdGhpcyBzZWN1cml0eSBtZWFzdXJlIGhhcyB0byBiZSBkaXNhYmxlZCBpbiBTYWZhcmkgOC4KICAvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM3MzM3CiAgc3VwcG9ydC5jcmVhdGVIVE1MRG9jdW1lbnQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgYm9keSA9IGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keTsKICAgIGJvZHkuaW5uZXJIVE1MID0gIjxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IjsKICAgIHJldHVybiBib2R5LmNoaWxkTm9kZXMubGVuZ3RoID09PSAyOwogIH0oKTsKCiAgLy8gQXJndW1lbnQgImRhdGEiIHNob3VsZCBiZSBzdHJpbmcgb2YgaHRtbAogIC8vIGNvbnRleHQgKG9wdGlvbmFsKTogSWYgc3BlY2lmaWVkLCB0aGUgZnJhZ21lbnQgd2lsbCBiZSBjcmVhdGVkIGluIHRoaXMgY29udGV4dCwKICAvLyBkZWZhdWx0cyB0byBkb2N1bWVudAogIC8vIGtlZXBTY3JpcHRzIChvcHRpb25hbCk6IElmIHRydWUsIHdpbGwgaW5jbHVkZSBzY3JpcHRzIHBhc3NlZCBpbiB0aGUgaHRtbCBzdHJpbmcKICBqUXVlcnkucGFyc2VIVE1MID0gZnVuY3Rpb24gKGRhdGEsIGNvbnRleHQsIGtlZXBTY3JpcHRzKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIGlmICh0eXBlb2YgY29udGV4dCA9PT0gImJvb2xlYW4iKSB7CiAgICAgIGtlZXBTY3JpcHRzID0gY29udGV4dDsKICAgICAgY29udGV4dCA9IGZhbHNlOwogICAgfQogICAgdmFyIGJhc2UsIHBhcnNlZCwgc2NyaXB0czsKICAgIGlmICghY29udGV4dCkgewogICAgICAvLyBTdG9wIHNjcmlwdHMgb3IgaW5saW5lIGV2ZW50IGhhbmRsZXJzIGZyb20gYmVpbmcgZXhlY3V0ZWQgaW1tZWRpYXRlbHkKICAgICAgLy8gYnkgdXNpbmcgZG9jdW1lbnQuaW1wbGVtZW50YXRpb24KICAgICAgaWYgKHN1cHBvcnQuY3JlYXRlSFRNTERvY3VtZW50KSB7CiAgICAgICAgY29udGV4dCA9IGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIik7CgogICAgICAgIC8vIFNldCB0aGUgYmFzZSBocmVmIGZvciB0aGUgY3JlYXRlZCBkb2N1bWVudAogICAgICAgIC8vIHNvIGFueSBwYXJzZWQgZWxlbWVudHMgd2l0aCBVUkxzCiAgICAgICAgLy8gYXJlIGJhc2VkIG9uIHRoZSBkb2N1bWVudCdzIFVSTCAoZ2gtMjk2NSkKICAgICAgICBiYXNlID0gY29udGV4dC5jcmVhdGVFbGVtZW50KCJiYXNlIik7CiAgICAgICAgYmFzZS5ocmVmID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZjsKICAgICAgICBjb250ZXh0LmhlYWQuYXBwZW5kQ2hpbGQoYmFzZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGV4dCA9IGRvY3VtZW50OwogICAgICB9CiAgICB9CiAgICBwYXJzZWQgPSByc2luZ2xlVGFnLmV4ZWMoZGF0YSk7CiAgICBzY3JpcHRzID0gIWtlZXBTY3JpcHRzICYmIFtdOwoKICAgIC8vIFNpbmdsZSB0YWcKICAgIGlmIChwYXJzZWQpIHsKICAgICAgcmV0dXJuIFtjb250ZXh0LmNyZWF0ZUVsZW1lbnQocGFyc2VkWzFdKV07CiAgICB9CiAgICBwYXJzZWQgPSBidWlsZEZyYWdtZW50KFtkYXRhXSwgY29udGV4dCwgc2NyaXB0cyk7CiAgICBpZiAoc2NyaXB0cyAmJiBzY3JpcHRzLmxlbmd0aCkgewogICAgICBqUXVlcnkoc2NyaXB0cykucmVtb3ZlKCk7CiAgICB9CiAgICByZXR1cm4galF1ZXJ5Lm1lcmdlKFtdLCBwYXJzZWQuY2hpbGROb2Rlcyk7CiAgfTsKCiAgLyoqCiAgICogTG9hZCBhIHVybCBpbnRvIGEgcGFnZQogICAqLwogIGpRdWVyeS5mbi5sb2FkID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zLCBjYWxsYmFjaykgewogICAgdmFyIHNlbGVjdG9yLAogICAgICB0eXBlLAogICAgICByZXNwb25zZSwKICAgICAgc2VsZiA9IHRoaXMsCiAgICAgIG9mZiA9IHVybC5pbmRleE9mKCIgIik7CiAgICBpZiAob2ZmID4gLTEpIHsKICAgICAgc2VsZWN0b3IgPSBzdHJpcEFuZENvbGxhcHNlKHVybC5zbGljZShvZmYpKTsKICAgICAgdXJsID0gdXJsLnNsaWNlKDAsIG9mZik7CiAgICB9CgogICAgLy8gSWYgaXQncyBhIGZ1bmN0aW9uCiAgICBpZiAoaXNGdW5jdGlvbihwYXJhbXMpKSB7CiAgICAgIC8vIFdlIGFzc3VtZSB0aGF0IGl0J3MgdGhlIGNhbGxiYWNrCiAgICAgIGNhbGxiYWNrID0gcGFyYW1zOwogICAgICBwYXJhbXMgPSB1bmRlZmluZWQ7CgogICAgICAvLyBPdGhlcndpc2UsIGJ1aWxkIGEgcGFyYW0gc3RyaW5nCiAgICB9IGVsc2UgaWYgKHBhcmFtcyAmJiBfdHlwZW9mKHBhcmFtcykgPT09ICJvYmplY3QiKSB7CiAgICAgIHR5cGUgPSAiUE9TVCI7CiAgICB9CgogICAgLy8gSWYgd2UgaGF2ZSBlbGVtZW50cyB0byBtb2RpZnksIG1ha2UgdGhlIHJlcXVlc3QKICAgIGlmIChzZWxmLmxlbmd0aCA+IDApIHsKICAgICAgalF1ZXJ5LmFqYXgoewogICAgICAgIHVybDogdXJsLAogICAgICAgIC8vIElmICJ0eXBlIiB2YXJpYWJsZSBpcyB1bmRlZmluZWQsIHRoZW4gIkdFVCIgbWV0aG9kIHdpbGwgYmUgdXNlZC4KICAgICAgICAvLyBNYWtlIHZhbHVlIG9mIHRoaXMgZmllbGQgZXhwbGljaXQgc2luY2UKICAgICAgICAvLyB1c2VyIGNhbiBvdmVycmlkZSBpdCB0aHJvdWdoIGFqYXhTZXR1cCBtZXRob2QKICAgICAgICB0eXBlOiB0eXBlIHx8ICJHRVQiLAogICAgICAgIGRhdGFUeXBlOiAiaHRtbCIsCiAgICAgICAgZGF0YTogcGFyYW1zCiAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKHJlc3BvbnNlVGV4dCkgewogICAgICAgIC8vIFNhdmUgcmVzcG9uc2UgZm9yIHVzZSBpbiBjb21wbGV0ZSBjYWxsYmFjawogICAgICAgIHJlc3BvbnNlID0gYXJndW1lbnRzOwogICAgICAgIHNlbGYuaHRtbChzZWxlY3RvciA/CiAgICAgICAgLy8gSWYgYSBzZWxlY3RvciB3YXMgc3BlY2lmaWVkLCBsb2NhdGUgdGhlIHJpZ2h0IGVsZW1lbnRzIGluIGEgZHVtbXkgZGl2CiAgICAgICAgLy8gRXhjbHVkZSBzY3JpcHRzIHRvIGF2b2lkIElFICdQZXJtaXNzaW9uIERlbmllZCcgZXJyb3JzCiAgICAgICAgalF1ZXJ5KCI8ZGl2PiIpLmFwcGVuZChqUXVlcnkucGFyc2VIVE1MKHJlc3BvbnNlVGV4dCkpLmZpbmQoc2VsZWN0b3IpIDoKICAgICAgICAvLyBPdGhlcndpc2UgdXNlIHRoZSBmdWxsIHJlc3VsdAogICAgICAgIHJlc3BvbnNlVGV4dCk7CgogICAgICAgIC8vIElmIHRoZSByZXF1ZXN0IHN1Y2NlZWRzLCB0aGlzIGZ1bmN0aW9uIGdldHMgImRhdGEiLCAic3RhdHVzIiwgImpxWEhSIgogICAgICAgIC8vIGJ1dCB0aGV5IGFyZSBpZ25vcmVkIGJlY2F1c2UgcmVzcG9uc2Ugd2FzIHNldCBhYm92ZS4KICAgICAgICAvLyBJZiBpdCBmYWlscywgdGhpcyBmdW5jdGlvbiBnZXRzICJqcVhIUiIsICJzdGF0dXMiLCAiZXJyb3IiCiAgICAgIH0pLmFsd2F5cyhjYWxsYmFjayAmJiBmdW5jdGlvbiAoanFYSFIsIHN0YXR1cykgewogICAgICAgIHNlbGYuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCByZXNwb25zZSB8fCBbanFYSFIucmVzcG9uc2VUZXh0LCBzdGF0dXMsIGpxWEhSXSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfTsKICBqUXVlcnkuZXhwci5wc2V1ZG9zLmFuaW1hdGVkID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgIHJldHVybiBqUXVlcnkuZ3JlcChqUXVlcnkudGltZXJzLCBmdW5jdGlvbiAoZm4pIHsKICAgICAgcmV0dXJuIGVsZW0gPT09IGZuLmVsZW07CiAgICB9KS5sZW5ndGg7CiAgfTsKICBqUXVlcnkub2Zmc2V0ID0gewogICAgc2V0T2Zmc2V0OiBmdW5jdGlvbiBzZXRPZmZzZXQoZWxlbSwgb3B0aW9ucywgaSkgewogICAgICB2YXIgY3VyUG9zaXRpb24sCiAgICAgICAgY3VyTGVmdCwKICAgICAgICBjdXJDU1NUb3AsCiAgICAgICAgY3VyVG9wLAogICAgICAgIGN1ck9mZnNldCwKICAgICAgICBjdXJDU1NMZWZ0LAogICAgICAgIGNhbGN1bGF0ZVBvc2l0aW9uLAogICAgICAgIHBvc2l0aW9uID0galF1ZXJ5LmNzcyhlbGVtLCAicG9zaXRpb24iKSwKICAgICAgICBjdXJFbGVtID0galF1ZXJ5KGVsZW0pLAogICAgICAgIHByb3BzID0ge307CgogICAgICAvLyBTZXQgcG9zaXRpb24gZmlyc3QsIGluLWNhc2UgdG9wL2xlZnQgYXJlIHNldCBldmVuIG9uIHN0YXRpYyBlbGVtCiAgICAgIGlmIChwb3NpdGlvbiA9PT0gInN0YXRpYyIpIHsKICAgICAgICBlbGVtLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKICAgICAgfQogICAgICBjdXJPZmZzZXQgPSBjdXJFbGVtLm9mZnNldCgpOwogICAgICBjdXJDU1NUb3AgPSBqUXVlcnkuY3NzKGVsZW0sICJ0b3AiKTsKICAgICAgY3VyQ1NTTGVmdCA9IGpRdWVyeS5jc3MoZWxlbSwgImxlZnQiKTsKICAgICAgY2FsY3VsYXRlUG9zaXRpb24gPSAocG9zaXRpb24gPT09ICJhYnNvbHV0ZSIgfHwgcG9zaXRpb24gPT09ICJmaXhlZCIpICYmIChjdXJDU1NUb3AgKyBjdXJDU1NMZWZ0KS5pbmRleE9mKCJhdXRvIikgPiAtMTsKCiAgICAgIC8vIE5lZWQgdG8gYmUgYWJsZSB0byBjYWxjdWxhdGUgcG9zaXRpb24gaWYgZWl0aGVyCiAgICAgIC8vIHRvcCBvciBsZWZ0IGlzIGF1dG8gYW5kIHBvc2l0aW9uIGlzIGVpdGhlciBhYnNvbHV0ZSBvciBmaXhlZAogICAgICBpZiAoY2FsY3VsYXRlUG9zaXRpb24pIHsKICAgICAgICBjdXJQb3NpdGlvbiA9IGN1ckVsZW0ucG9zaXRpb24oKTsKICAgICAgICBjdXJUb3AgPSBjdXJQb3NpdGlvbi50b3A7CiAgICAgICAgY3VyTGVmdCA9IGN1clBvc2l0aW9uLmxlZnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VyVG9wID0gcGFyc2VGbG9hdChjdXJDU1NUb3ApIHx8IDA7CiAgICAgICAgY3VyTGVmdCA9IHBhcnNlRmxvYXQoY3VyQ1NTTGVmdCkgfHwgMDsKICAgICAgfQogICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zKSkgewogICAgICAgIC8vIFVzZSBqUXVlcnkuZXh0ZW5kIGhlcmUgdG8gYWxsb3cgbW9kaWZpY2F0aW9uIG9mIGNvb3JkaW5hdGVzIGFyZ3VtZW50IChnaC0xODQ4KQogICAgICAgIG9wdGlvbnMgPSBvcHRpb25zLmNhbGwoZWxlbSwgaSwgalF1ZXJ5LmV4dGVuZCh7fSwgY3VyT2Zmc2V0KSk7CiAgICAgIH0KICAgICAgaWYgKG9wdGlvbnMudG9wICE9IG51bGwpIHsKICAgICAgICBwcm9wcy50b3AgPSBvcHRpb25zLnRvcCAtIGN1ck9mZnNldC50b3AgKyBjdXJUb3A7CiAgICAgIH0KICAgICAgaWYgKG9wdGlvbnMubGVmdCAhPSBudWxsKSB7CiAgICAgICAgcHJvcHMubGVmdCA9IG9wdGlvbnMubGVmdCAtIGN1ck9mZnNldC5sZWZ0ICsgY3VyTGVmdDsKICAgICAgfQogICAgICBpZiAoInVzaW5nIiBpbiBvcHRpb25zKSB7CiAgICAgICAgb3B0aW9ucy51c2luZy5jYWxsKGVsZW0sIHByb3BzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodHlwZW9mIHByb3BzLnRvcCA9PT0gIm51bWJlciIpIHsKICAgICAgICAgIHByb3BzLnRvcCArPSAicHgiOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHByb3BzLmxlZnQgPT09ICJudW1iZXIiKSB7CiAgICAgICAgICBwcm9wcy5sZWZ0ICs9ICJweCI7CiAgICAgICAgfQogICAgICAgIGN1ckVsZW0uY3NzKHByb3BzKTsKICAgICAgfQogICAgfQogIH07CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICAvLyBvZmZzZXQoKSByZWxhdGVzIGFuIGVsZW1lbnQncyBib3JkZXIgYm94IHRvIHRoZSBkb2N1bWVudCBvcmlnaW4KICAgIG9mZnNldDogZnVuY3Rpb24gb2Zmc2V0KG9wdGlvbnMpIHsKICAgICAgLy8gUHJlc2VydmUgY2hhaW5pbmcgZm9yIHNldHRlcgogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkgewogICAgICAgIHJldHVybiBvcHRpb25zID09PSB1bmRlZmluZWQgPyB0aGlzIDogdGhpcy5lYWNoKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICBqUXVlcnkub2Zmc2V0LnNldE9mZnNldCh0aGlzLCBvcHRpb25zLCBpKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICB2YXIgcmVjdCwKICAgICAgICB3aW4sCiAgICAgICAgZWxlbSA9IHRoaXNbMF07CiAgICAgIGlmICghZWxlbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gUmV0dXJuIHplcm9zIGZvciBkaXNjb25uZWN0ZWQgYW5kIGhpZGRlbiAoZGlzcGxheTogbm9uZSkgZWxlbWVudHMgKGdoLTIzMTApCiAgICAgIC8vIFN1cHBvcnQ6IElFIDw9MTEgb25seQogICAgICAvLyBSdW5uaW5nIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBvbiBhCiAgICAgIC8vIGRpc2Nvbm5lY3RlZCBub2RlIGluIElFIHRocm93cyBhbiBlcnJvcgogICAgICBpZiAoIWVsZW0uZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdG9wOiAwLAogICAgICAgICAgbGVmdDogMAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIC8vIEdldCBkb2N1bWVudC1yZWxhdGl2ZSBwb3NpdGlvbiBieSBhZGRpbmcgdmlld3BvcnQgc2Nyb2xsIHRvIHZpZXdwb3J0LXJlbGF0aXZlIGdCQ1IKICAgICAgcmVjdCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHdpbiA9IGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldzsKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3A6IHJlY3QudG9wICsgd2luLnBhZ2VZT2Zmc2V0LAogICAgICAgIGxlZnQ6IHJlY3QubGVmdCArIHdpbi5wYWdlWE9mZnNldAogICAgICB9OwogICAgfSwKICAgIC8vIHBvc2l0aW9uKCkgcmVsYXRlcyBhbiBlbGVtZW50J3MgbWFyZ2luIGJveCB0byBpdHMgb2Zmc2V0IHBhcmVudCdzIHBhZGRpbmcgYm94CiAgICAvLyBUaGlzIGNvcnJlc3BvbmRzIHRvIHRoZSBiZWhhdmlvciBvZiBDU1MgYWJzb2x1dGUgcG9zaXRpb25pbmcKICAgIHBvc2l0aW9uOiBmdW5jdGlvbiBwb3NpdGlvbigpIHsKICAgICAgaWYgKCF0aGlzWzBdKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBvZmZzZXRQYXJlbnQsCiAgICAgICAgb2Zmc2V0LAogICAgICAgIGRvYywKICAgICAgICBlbGVtID0gdGhpc1swXSwKICAgICAgICBwYXJlbnRPZmZzZXQgPSB7CiAgICAgICAgICB0b3A6IDAsCiAgICAgICAgICBsZWZ0OiAwCiAgICAgICAgfTsKCiAgICAgIC8vIHBvc2l0aW9uOmZpeGVkIGVsZW1lbnRzIGFyZSBvZmZzZXQgZnJvbSB0aGUgdmlld3BvcnQsIHdoaWNoIGl0c2VsZiBhbHdheXMgaGFzIHplcm8gb2Zmc2V0CiAgICAgIGlmIChqUXVlcnkuY3NzKGVsZW0sICJwb3NpdGlvbiIpID09PSAiZml4ZWQiKSB7CiAgICAgICAgLy8gQXNzdW1lIHBvc2l0aW9uOmZpeGVkIGltcGxpZXMgYXZhaWxhYmlsaXR5IG9mIGdldEJvdW5kaW5nQ2xpZW50UmVjdAogICAgICAgIG9mZnNldCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTsKCiAgICAgICAgLy8gQWNjb3VudCBmb3IgdGhlICpyZWFsKiBvZmZzZXQgcGFyZW50LCB3aGljaCBjYW4gYmUgdGhlIGRvY3VtZW50IG9yIGl0cyByb290IGVsZW1lbnQKICAgICAgICAvLyB3aGVuIGEgc3RhdGljYWxseSBwb3NpdGlvbmVkIGVsZW1lbnQgaXMgaWRlbnRpZmllZAogICAgICAgIGRvYyA9IGVsZW0ub3duZXJEb2N1bWVudDsKICAgICAgICBvZmZzZXRQYXJlbnQgPSBlbGVtLm9mZnNldFBhcmVudCB8fCBkb2MuZG9jdW1lbnRFbGVtZW50OwogICAgICAgIHdoaWxlIChvZmZzZXRQYXJlbnQgJiYgKG9mZnNldFBhcmVudCA9PT0gZG9jLmJvZHkgfHwgb2Zmc2V0UGFyZW50ID09PSBkb2MuZG9jdW1lbnRFbGVtZW50KSAmJiBqUXVlcnkuY3NzKG9mZnNldFBhcmVudCwgInBvc2l0aW9uIikgPT09ICJzdGF0aWMiKSB7CiAgICAgICAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQucGFyZW50Tm9kZTsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZnNldFBhcmVudCAmJiBvZmZzZXRQYXJlbnQgIT09IGVsZW0gJiYgb2Zmc2V0UGFyZW50Lm5vZGVUeXBlID09PSAxKSB7CiAgICAgICAgICAvLyBJbmNvcnBvcmF0ZSBib3JkZXJzIGludG8gaXRzIG9mZnNldCwgc2luY2UgdGhleSBhcmUgb3V0c2lkZSBpdHMgY29udGVudCBvcmlnaW4KICAgICAgICAgIHBhcmVudE9mZnNldCA9IGpRdWVyeShvZmZzZXRQYXJlbnQpLm9mZnNldCgpOwogICAgICAgICAgcGFyZW50T2Zmc2V0LnRvcCArPSBqUXVlcnkuY3NzKG9mZnNldFBhcmVudCwgImJvcmRlclRvcFdpZHRoIiwgdHJ1ZSk7CiAgICAgICAgICBwYXJlbnRPZmZzZXQubGVmdCArPSBqUXVlcnkuY3NzKG9mZnNldFBhcmVudCwgImJvcmRlckxlZnRXaWR0aCIsIHRydWUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8gU3VidHJhY3QgcGFyZW50IG9mZnNldHMgYW5kIGVsZW1lbnQgbWFyZ2lucwogICAgICByZXR1cm4gewogICAgICAgIHRvcDogb2Zmc2V0LnRvcCAtIHBhcmVudE9mZnNldC50b3AgLSBqUXVlcnkuY3NzKGVsZW0sICJtYXJnaW5Ub3AiLCB0cnVlKSwKICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCAtIHBhcmVudE9mZnNldC5sZWZ0IC0galF1ZXJ5LmNzcyhlbGVtLCAibWFyZ2luTGVmdCIsIHRydWUpCiAgICAgIH07CiAgICB9LAogICAgLy8gVGhpcyBtZXRob2Qgd2lsbCByZXR1cm4gZG9jdW1lbnRFbGVtZW50IGluIHRoZSBmb2xsb3dpbmcgY2FzZXM6CiAgICAvLyAxKSBGb3IgdGhlIGVsZW1lbnQgaW5zaWRlIHRoZSBpZnJhbWUgd2l0aG91dCBvZmZzZXRQYXJlbnQsIHRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuCiAgICAvLyAgICBkb2N1bWVudEVsZW1lbnQgb2YgdGhlIHBhcmVudCB3aW5kb3cKICAgIC8vIDIpIEZvciB0aGUgaGlkZGVuIG9yIGRldGFjaGVkIGVsZW1lbnQKICAgIC8vIDMpIEZvciBib2R5IG9yIGh0bWwgZWxlbWVudCwgaS5lLiBpbiBjYXNlIG9mIHRoZSBodG1sIG5vZGUgLSBpdCB3aWxsIHJldHVybiBpdHNlbGYKICAgIC8vCiAgICAvLyBidXQgdGhvc2UgZXhjZXB0aW9ucyB3ZXJlIG5ldmVyIHByZXNlbnRlZCBhcyBhIHJlYWwgbGlmZSB1c2UtY2FzZXMKICAgIC8vIGFuZCBtaWdodCBiZSBjb25zaWRlcmVkIGFzIG1vcmUgcHJlZmVyYWJsZSByZXN1bHRzLgogICAgLy8KICAgIC8vIFRoaXMgbG9naWMsIGhvd2V2ZXIsIGlzIG5vdCBndWFyYW50ZWVkIGFuZCBjYW4gY2hhbmdlIGF0IGFueSBwb2ludCBpbiB0aGUgZnV0dXJlCiAgICBvZmZzZXRQYXJlbnQ6IGZ1bmN0aW9uIG9mZnNldFBhcmVudCgpIHsKICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQ7CiAgICAgICAgd2hpbGUgKG9mZnNldFBhcmVudCAmJiBqUXVlcnkuY3NzKG9mZnNldFBhcmVudCwgInBvc2l0aW9uIikgPT09ICJzdGF0aWMiKSB7CiAgICAgICAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50OwogICAgICAgIH0KICAgICAgICByZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGRvY3VtZW50RWxlbWVudDsKICAgICAgfSk7CiAgICB9CiAgfSk7CgogIC8vIENyZWF0ZSBzY3JvbGxMZWZ0IGFuZCBzY3JvbGxUb3AgbWV0aG9kcwogIGpRdWVyeS5lYWNoKHsKICAgIHNjcm9sbExlZnQ6ICJwYWdlWE9mZnNldCIsCiAgICBzY3JvbGxUb3A6ICJwYWdlWU9mZnNldCIKICB9LCBmdW5jdGlvbiAobWV0aG9kLCBwcm9wKSB7CiAgICB2YXIgdG9wID0gInBhZ2VZT2Zmc2V0IiA9PT0gcHJvcDsKICAgIGpRdWVyeS5mblttZXRob2RdID0gZnVuY3Rpb24gKHZhbCkgewogICAgICByZXR1cm4gYWNjZXNzKHRoaXMsIGZ1bmN0aW9uIChlbGVtLCBtZXRob2QsIHZhbCkgewogICAgICAgIC8vIENvYWxlc2NlIGRvY3VtZW50cyBhbmQgd2luZG93cwogICAgICAgIHZhciB3aW47CiAgICAgICAgaWYgKGlzV2luZG93KGVsZW0pKSB7CiAgICAgICAgICB3aW4gPSBlbGVtOwogICAgICAgIH0gZWxzZSBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gOSkgewogICAgICAgICAgd2luID0gZWxlbS5kZWZhdWx0VmlldzsKICAgICAgICB9CiAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gd2luID8gd2luW3Byb3BdIDogZWxlbVttZXRob2RdOwogICAgICAgIH0KICAgICAgICBpZiAod2luKSB7CiAgICAgICAgICB3aW4uc2Nyb2xsVG8oIXRvcCA/IHZhbCA6IHdpbi5wYWdlWE9mZnNldCwgdG9wID8gdmFsIDogd2luLnBhZ2VZT2Zmc2V0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxlbVttZXRob2RdID0gdmFsOwogICAgICAgIH0KICAgICAgfSwgbWV0aG9kLCB2YWwsIGFyZ3VtZW50cy5sZW5ndGgpOwogICAgfTsKICB9KTsKCiAgLy8gU3VwcG9ydDogU2FmYXJpIDw9NyAtIDkuMSwgQ2hyb21lIDw9MzcgLSA0OQogIC8vIEFkZCB0aGUgdG9wL2xlZnQgY3NzSG9va3MgdXNpbmcgalF1ZXJ5LmZuLnBvc2l0aW9uCiAgLy8gV2Via2l0IGJ1ZzogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTI5MDg0CiAgLy8gQmxpbmsgYnVnOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD01ODkzNDcKICAvLyBnZXRDb21wdXRlZFN0eWxlIHJldHVybnMgcGVyY2VudCB3aGVuIHNwZWNpZmllZCBmb3IgdG9wL2xlZnQvYm90dG9tL3JpZ2h0OwogIC8vIHJhdGhlciB0aGFuIG1ha2UgdGhlIGNzcyBtb2R1bGUgZGVwZW5kIG9uIHRoZSBvZmZzZXQgbW9kdWxlLCBqdXN0IGNoZWNrIGZvciBpdCBoZXJlCiAgalF1ZXJ5LmVhY2goWyJ0b3AiLCAibGVmdCJdLCBmdW5jdGlvbiAoX2ksIHByb3ApIHsKICAgIGpRdWVyeS5jc3NIb29rc1twcm9wXSA9IGFkZEdldEhvb2tJZihzdXBwb3J0LnBpeGVsUG9zaXRpb24sIGZ1bmN0aW9uIChlbGVtLCBjb21wdXRlZCkgewogICAgICBpZiAoY29tcHV0ZWQpIHsKICAgICAgICBjb21wdXRlZCA9IGN1ckNTUyhlbGVtLCBwcm9wKTsKCiAgICAgICAgLy8gSWYgY3VyQ1NTIHJldHVybnMgcGVyY2VudGFnZSwgZmFsbGJhY2sgdG8gb2Zmc2V0CiAgICAgICAgcmV0dXJuIHJudW1ub25weC50ZXN0KGNvbXB1dGVkKSA/IGpRdWVyeShlbGVtKS5wb3NpdGlvbigpW3Byb3BdICsgInB4IiA6IGNvbXB1dGVkOwogICAgICB9CiAgICB9KTsKICB9KTsKCiAgLy8gQ3JlYXRlIGlubmVySGVpZ2h0LCBpbm5lcldpZHRoLCBoZWlnaHQsIHdpZHRoLCBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aCBtZXRob2RzCiAgalF1ZXJ5LmVhY2goewogICAgSGVpZ2h0OiAiaGVpZ2h0IiwKICAgIFdpZHRoOiAid2lkdGgiCiAgfSwgZnVuY3Rpb24gKG5hbWUsIHR5cGUpIHsKICAgIGpRdWVyeS5lYWNoKHsKICAgICAgcGFkZGluZzogImlubmVyIiArIG5hbWUsCiAgICAgIGNvbnRlbnQ6IHR5cGUsCiAgICAgICIiOiAib3V0ZXIiICsgbmFtZQogICAgfSwgZnVuY3Rpb24gKGRlZmF1bHRFeHRyYSwgZnVuY05hbWUpIHsKICAgICAgLy8gTWFyZ2luIGlzIG9ubHkgZm9yIG91dGVySGVpZ2h0LCBvdXRlcldpZHRoCiAgICAgIGpRdWVyeS5mbltmdW5jTmFtZV0gPSBmdW5jdGlvbiAobWFyZ2luLCB2YWx1ZSkgewogICAgICAgIHZhciBjaGFpbmFibGUgPSBhcmd1bWVudHMubGVuZ3RoICYmIChkZWZhdWx0RXh0cmEgfHwgdHlwZW9mIG1hcmdpbiAhPT0gImJvb2xlYW4iKSwKICAgICAgICAgIGV4dHJhID0gZGVmYXVsdEV4dHJhIHx8IChtYXJnaW4gPT09IHRydWUgfHwgdmFsdWUgPT09IHRydWUgPyAibWFyZ2luIiA6ICJib3JkZXIiKTsKICAgICAgICByZXR1cm4gYWNjZXNzKHRoaXMsIGZ1bmN0aW9uIChlbGVtLCB0eXBlLCB2YWx1ZSkgewogICAgICAgICAgdmFyIGRvYzsKICAgICAgICAgIGlmIChpc1dpbmRvdyhlbGVtKSkgewogICAgICAgICAgICAvLyAkKCB3aW5kb3cgKS5vdXRlcldpZHRoL0hlaWdodCByZXR1cm4gdy9oIGluY2x1ZGluZyBzY3JvbGxiYXJzIChnaC0xNzI5KQogICAgICAgICAgICByZXR1cm4gZnVuY05hbWUuaW5kZXhPZigib3V0ZXIiKSA9PT0gMCA/IGVsZW1bImlubmVyIiArIG5hbWVdIDogZWxlbS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIgKyBuYW1lXTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgd2lkdGggb3IgaGVpZ2h0CiAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gOSkgewogICAgICAgICAgICBkb2MgPSBlbGVtLmRvY3VtZW50RWxlbWVudDsKCiAgICAgICAgICAgIC8vIEVpdGhlciBzY3JvbGxbV2lkdGgvSGVpZ2h0XSBvciBvZmZzZXRbV2lkdGgvSGVpZ2h0XSBvciBjbGllbnRbV2lkdGgvSGVpZ2h0XSwKICAgICAgICAgICAgLy8gd2hpY2hldmVyIGlzIGdyZWF0ZXN0CiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChlbGVtLmJvZHlbInNjcm9sbCIgKyBuYW1lXSwgZG9jWyJzY3JvbGwiICsgbmFtZV0sIGVsZW0uYm9keVsib2Zmc2V0IiArIG5hbWVdLCBkb2NbIm9mZnNldCIgKyBuYW1lXSwgZG9jWyJjbGllbnQiICsgbmFtZV0pOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPwogICAgICAgICAgLy8gR2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudCwgcmVxdWVzdGluZyBidXQgbm90IGZvcmNpbmcgcGFyc2VGbG9hdAogICAgICAgICAgalF1ZXJ5LmNzcyhlbGVtLCB0eXBlLCBleHRyYSkgOgogICAgICAgICAgLy8gU2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudAogICAgICAgICAgalF1ZXJ5LnN0eWxlKGVsZW0sIHR5cGUsIHZhbHVlLCBleHRyYSk7CiAgICAgICAgfSwgdHlwZSwgY2hhaW5hYmxlID8gbWFyZ2luIDogdW5kZWZpbmVkLCBjaGFpbmFibGUpOwogICAgICB9OwogICAgfSk7CiAgfSk7CiAgalF1ZXJ5LmVhY2goWyJhamF4U3RhcnQiLCAiYWpheFN0b3AiLCAiYWpheENvbXBsZXRlIiwgImFqYXhFcnJvciIsICJhamF4U3VjY2VzcyIsICJhamF4U2VuZCJdLCBmdW5jdGlvbiAoX2ksIHR5cGUpIHsKICAgIGpRdWVyeS5mblt0eXBlXSA9IGZ1bmN0aW9uIChmbikgewogICAgICByZXR1cm4gdGhpcy5vbih0eXBlLCBmbik7CiAgICB9OwogIH0pOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgYmluZDogZnVuY3Rpb24gYmluZCh0eXBlcywgZGF0YSwgZm4pIHsKICAgICAgcmV0dXJuIHRoaXMub24odHlwZXMsIG51bGwsIGRhdGEsIGZuKTsKICAgIH0sCiAgICB1bmJpbmQ6IGZ1bmN0aW9uIHVuYmluZCh0eXBlcywgZm4pIHsKICAgICAgcmV0dXJuIHRoaXMub2ZmKHR5cGVzLCBudWxsLCBmbik7CiAgICB9LAogICAgZGVsZWdhdGU6IGZ1bmN0aW9uIGRlbGVnYXRlKHNlbGVjdG9yLCB0eXBlcywgZGF0YSwgZm4pIHsKICAgICAgcmV0dXJuIHRoaXMub24odHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbik7CiAgICB9LAogICAgdW5kZWxlZ2F0ZTogZnVuY3Rpb24gdW5kZWxlZ2F0ZShzZWxlY3RvciwgdHlwZXMsIGZuKSB7CiAgICAgIC8vICggbmFtZXNwYWNlICkgb3IgKCBzZWxlY3RvciwgdHlwZXMgWywgZm5dICkKICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgPyB0aGlzLm9mZihzZWxlY3RvciwgIioqIikgOiB0aGlzLm9mZih0eXBlcywgc2VsZWN0b3IgfHwgIioqIiwgZm4pOwogICAgfSwKICAgIGhvdmVyOiBmdW5jdGlvbiBob3Zlcihmbk92ZXIsIGZuT3V0KSB7CiAgICAgIHJldHVybiB0aGlzLm1vdXNlZW50ZXIoZm5PdmVyKS5tb3VzZWxlYXZlKGZuT3V0IHx8IGZuT3Zlcik7CiAgICB9CiAgfSk7CiAgalF1ZXJ5LmVhY2goKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgcmVzaXplIHNjcm9sbCBjbGljayBkYmxjbGljayAiICsgIm1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlICIgKyAiY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBjb250ZXh0bWVudSIpLnNwbGl0KCIgIiksIGZ1bmN0aW9uIChfaSwgbmFtZSkgewogICAgLy8gSGFuZGxlIGV2ZW50IGJpbmRpbmcKICAgIGpRdWVyeS5mbltuYW1lXSA9IGZ1bmN0aW9uIChkYXRhLCBmbikgewogICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPyB0aGlzLm9uKG5hbWUsIG51bGwsIGRhdGEsIGZuKSA6IHRoaXMudHJpZ2dlcihuYW1lKTsKICAgIH07CiAgfSk7CgogIC8vIFN1cHBvcnQ6IEFuZHJvaWQgPD00LjAgb25seQogIC8vIE1ha2Ugc3VyZSB3ZSB0cmltIEJPTSBhbmQgTkJTUAogIHZhciBydHJpbSA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZzsKCiAgLy8gQmluZCBhIGZ1bmN0aW9uIHRvIGEgY29udGV4dCwgb3B0aW9uYWxseSBwYXJ0aWFsbHkgYXBwbHlpbmcgYW55CiAgLy8gYXJndW1lbnRzLgogIC8vIGpRdWVyeS5wcm94eSBpcyBkZXByZWNhdGVkIHRvIHByb21vdGUgc3RhbmRhcmRzIChzcGVjaWZpY2FsbHkgRnVuY3Rpb24jYmluZCkKICAvLyBIb3dldmVyLCBpdCBpcyBub3Qgc2xhdGVkIGZvciByZW1vdmFsIGFueSB0aW1lIHNvb24KICBqUXVlcnkucHJveHkgPSBmdW5jdGlvbiAoZm4sIGNvbnRleHQpIHsKICAgIHZhciB0bXAsIGFyZ3MsIHByb3h5OwogICAgaWYgKHR5cGVvZiBjb250ZXh0ID09PSAic3RyaW5nIikgewogICAgICB0bXAgPSBmbltjb250ZXh0XTsKICAgICAgY29udGV4dCA9IGZuOwogICAgICBmbiA9IHRtcDsKICAgIH0KCiAgICAvLyBRdWljayBjaGVjayB0byBkZXRlcm1pbmUgaWYgdGFyZ2V0IGlzIGNhbGxhYmxlLCBpbiB0aGUgc3BlYwogICAgLy8gdGhpcyB0aHJvd3MgYSBUeXBlRXJyb3IsIGJ1dCB3ZSB3aWxsIGp1c3QgcmV0dXJuIHVuZGVmaW5lZC4KICAgIGlmICghaXNGdW5jdGlvbihmbikpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICAvLyBTaW11bGF0ZWQgYmluZAogICAgYXJncyA9IF9zbGljZS5jYWxsKGFyZ3VtZW50cywgMik7CiAgICBwcm94eSA9IGZ1bmN0aW9uIHByb3h5KCkgewogICAgICByZXR1cm4gZm4uYXBwbHkoY29udGV4dCB8fCB0aGlzLCBhcmdzLmNvbmNhdChfc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7CiAgICB9OwoKICAgIC8vIFNldCB0aGUgZ3VpZCBvZiB1bmlxdWUgaGFuZGxlciB0byB0aGUgc2FtZSBvZiBvcmlnaW5hbCBoYW5kbGVyLCBzbyBpdCBjYW4gYmUgcmVtb3ZlZAogICAgcHJveHkuZ3VpZCA9IGZuLmd1aWQgPSBmbi5ndWlkIHx8IGpRdWVyeS5ndWlkKys7CiAgICByZXR1cm4gcHJveHk7CiAgfTsKICBqUXVlcnkuaG9sZFJlYWR5ID0gZnVuY3Rpb24gKGhvbGQpIHsKICAgIGlmIChob2xkKSB7CiAgICAgIGpRdWVyeS5yZWFkeVdhaXQrKzsKICAgIH0gZWxzZSB7CiAgICAgIGpRdWVyeS5yZWFkeSh0cnVlKTsKICAgIH0KICB9OwogIGpRdWVyeS5pc0FycmF5ID0gQXJyYXkuaXNBcnJheTsKICBqUXVlcnkucGFyc2VKU09OID0gSlNPTi5wYXJzZTsKICBqUXVlcnkubm9kZU5hbWUgPSBub2RlTmFtZTsKICBqUXVlcnkuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247CiAgalF1ZXJ5LmlzV2luZG93ID0gaXNXaW5kb3c7CiAgalF1ZXJ5LmNhbWVsQ2FzZSA9IGNhbWVsQ2FzZTsKICBqUXVlcnkudHlwZSA9IHRvVHlwZTsKICBqUXVlcnkubm93ID0gRGF0ZS5ub3c7CiAgalF1ZXJ5LmlzTnVtZXJpYyA9IGZ1bmN0aW9uIChvYmopIHsKICAgIC8vIEFzIG9mIGpRdWVyeSAzLjAsIGlzTnVtZXJpYyBpcyBsaW1pdGVkIHRvCiAgICAvLyBzdHJpbmdzIGFuZCBudW1iZXJzIChwcmltaXRpdmVzIG9yIG9iamVjdHMpCiAgICAvLyB0aGF0IGNhbiBiZSBjb2VyY2VkIHRvIGZpbml0ZSBudW1iZXJzIChnaC0yNjYyKQogICAgdmFyIHR5cGUgPSBqUXVlcnkudHlwZShvYmopOwogICAgcmV0dXJuICh0eXBlID09PSAibnVtYmVyIiB8fCB0eXBlID09PSAic3RyaW5nIikgJiYKICAgIC8vIHBhcnNlRmxvYXQgTmFOcyBudW1lcmljLWNhc3QgZmFsc2UgcG9zaXRpdmVzICgiIikKICAgIC8vIC4uLmJ1dCBtaXNpbnRlcnByZXRzIGxlYWRpbmctbnVtYmVyIHN0cmluZ3MsIHBhcnRpY3VsYXJseSBoZXggbGl0ZXJhbHMgKCIweC4uLiIpCiAgICAvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU4KICAgICFpc05hTihvYmogLSBwYXJzZUZsb2F0KG9iaikpOwogIH07CiAgalF1ZXJ5LnRyaW0gPSBmdW5jdGlvbiAodGV4dCkgewogICAgcmV0dXJuIHRleHQgPT0gbnVsbCA/ICIiIDogKHRleHQgKyAiIikucmVwbGFjZShydHJpbSwgIiIpOwogIH07CgogIC8vIFJlZ2lzdGVyIGFzIGEgbmFtZWQgQU1EIG1vZHVsZSwgc2luY2UgalF1ZXJ5IGNhbiBiZSBjb25jYXRlbmF0ZWQgd2l0aCBvdGhlcgogIC8vIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsIGJ1dCBub3QgdmlhIGEgcHJvcGVyIGNvbmNhdGVuYXRpb24gc2NyaXB0IHRoYXQKICAvLyB1bmRlcnN0YW5kcyBhbm9ueW1vdXMgQU1EIG1vZHVsZXMuIEEgbmFtZWQgQU1EIGlzIHNhZmVzdCBhbmQgbW9zdCByb2J1c3QKICAvLyB3YXkgdG8gcmVnaXN0ZXIuIExvd2VyY2FzZSBqcXVlcnkgaXMgdXNlZCBiZWNhdXNlIEFNRCBtb2R1bGUgbmFtZXMgYXJlCiAgLy8gZGVyaXZlZCBmcm9tIGZpbGUgbmFtZXMsIGFuZCBqUXVlcnkgaXMgbm9ybWFsbHkgZGVsaXZlcmVkIGluIGEgbG93ZXJjYXNlCiAgLy8gZmlsZSBuYW1lLiBEbyB0aGlzIGFmdGVyIGNyZWF0aW5nIHRoZSBnbG9iYWwgc28gdGhhdCBpZiBhbiBBTUQgbW9kdWxlIHdhbnRzCiAgLy8gdG8gY2FsbCBub0NvbmZsaWN0IHRvIGhpZGUgdGhpcyB2ZXJzaW9uIG9mIGpRdWVyeSwgaXQgd2lsbCB3b3JrLgoKICAvLyBOb3RlIHRoYXQgZm9yIG1heGltdW0gcG9ydGFiaWxpdHksIGxpYnJhcmllcyB0aGF0IGFyZSBub3QgalF1ZXJ5IHNob3VsZAogIC8vIGRlY2xhcmUgdGhlbXNlbHZlcyBhcyBhbm9ueW1vdXMgbW9kdWxlcywgYW5kIGF2b2lkIHNldHRpbmcgYSBnbG9iYWwgaWYgYW4KICAvLyBBTUQgbG9hZGVyIGlzIHByZXNlbnQuIGpRdWVyeSBpcyBhIHNwZWNpYWwgY2FzZS4gRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZQogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL3JlcXVpcmVqcy93aWtpL1VwZGF0aW5nLWV4aXN0aW5nLWxpYnJhcmllcyN3aWtpLWFub24KCiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICJmdW5jdGlvbiIgJiYgZGVmaW5lLmFtZCkgewogICAgZGVmaW5lKCJqcXVlcnkiLCBbXSwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4galF1ZXJ5OwogICAgfSk7CiAgfQogIHZhcgogICAgLy8gTWFwIG92ZXIgalF1ZXJ5IGluIGNhc2Ugb2Ygb3ZlcndyaXRlCiAgICBfalF1ZXJ5ID0gd2luZG93LmpRdWVyeSwKICAgIC8vIE1hcCBvdmVyIHRoZSAkIGluIGNhc2Ugb2Ygb3ZlcndyaXRlCiAgICBfJCA9IHdpbmRvdy4kOwogIGpRdWVyeS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKGRlZXApIHsKICAgIGlmICh3aW5kb3cuJCA9PT0galF1ZXJ5KSB7CiAgICAgIHdpbmRvdy4kID0gXyQ7CiAgICB9CiAgICBpZiAoZGVlcCAmJiB3aW5kb3cualF1ZXJ5ID09PSBqUXVlcnkpIHsKICAgICAgd2luZG93LmpRdWVyeSA9IF9qUXVlcnk7CiAgICB9CiAgICByZXR1cm4galF1ZXJ5OwogIH07CgogIC8vIEV4cG9zZSBqUXVlcnkgYW5kICQgaWRlbnRpZmllcnMsIGV2ZW4gaW4gQU1ECiAgLy8gKCM3MTAyI2NvbW1lbnQ6MTAsIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L3B1bGwvNTU3KQogIC8vIGFuZCBDb21tb25KUyBmb3IgYnJvd3NlciBlbXVsYXRvcnMgKCMxMzU2NikKICBpZiAodHlwZW9mIG5vR2xvYmFsID09PSAidW5kZWZpbmVkIikgewogICAgd2luZG93LmpRdWVyeSA9IHdpbmRvdy4kID0galF1ZXJ5OwogIH0KICByZXR1cm4galF1ZXJ5Owp9KTs="},{"version":3,"names":["global","factory","module","_typeof","exports","document","w","Error","window","noGlobal","arr","getProto","Object","getPrototypeOf","slice","flat","array","call","concat","apply","push","indexOf","class2type","toString","hasOwn","hasOwnProperty","fnToString","ObjectFunctionString","support","isFunction","obj","nodeType","isWindow","preservedScriptAttributes","type","src","nonce","noModule","DOMEval","code","node","doc","i","val","script","createElement","text","getAttribute","setAttribute","head","appendChild","parentNode","removeChild","toType","version","jQuery","selector","context","fn","init","prototype","jquery","constructor","length","toArray","get","num","pushStack","elems","ret","merge","prevObject","each","callback","map","elem","arguments","first","eq","last","even","grep","_elem","odd","len","j","end","sort","splice","extend","options","name","copy","copyIsArray","clone","target","deep","isPlainObject","Array","isArray","undefined","expando","Math","random","replace","isReady","error","msg","noop","proto","Ctor","isEmptyObject","globalEval","isArrayLike","makeArray","results","inArray","second","invert","callbackInverse","matches","callbackExpect","arg","value","guid","Symbol","iterator","split","_i","toLowerCase","Sizzle","Expr","getText","isXML","tokenize","compile","select","outermostContext","sortInput","hasDuplicate","setDocument","docElem","documentIsHTML","rbuggyQSA","rbuggyMatches","contains","Date","preferredDoc","dirruns","done","classCache","createCache","tokenCache","compilerCache","nonnativeSelectorCache","sortOrder","a","b","pop","pushNative","list","booleans","whitespace","identifier","attributes","pseudos","rwhitespace","RegExp","rtrim","rcomma","rcombinators","rdescend","rpseudo","ridentifier","matchExpr","rhtml","rinputs","rheader","rnative","rquickExpr","rsibling","runescape","funescape","escape","nonHex","high","String","fromCharCode","rcssescape","fcssescape","ch","asCodePoint","charCodeAt","unloadHandler","inDisabledFieldset","addCombinator","disabled","nodeName","dir","next","childNodes","e","els","seed","m","nid","match","groups","newSelector","newContext","ownerDocument","exec","getElementById","id","getElementsByTagName","getElementsByClassName","qsa","test","testContext","scope","toSelector","join","querySelectorAll","qsaError","removeAttribute","keys","cache","key","cacheLength","shift","markFunction","assert","el","addHandle","attrs","handler","attrHandle","siblingCheck","cur","diff","sourceIndex","nextSibling","createInputPseudo","createButtonPseudo","createDisabledPseudo","isDisabled","createPositionalPseudo","argument","matchIndexes","namespace","namespaceURI","documentElement","hasCompare","subWindow","defaultView","top","addEventListener","attachEvent","className","createComment","getById","getElementsByName","filter","attrId","find","getAttributeNode","tag","tmp","input","innerHTML","matchesSelector","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","msMatchesSelector","disconnectedMatch","compareDocumentPosition","adown","bup","compare","sortDetached","aup","ap","bp","unshift","expr","elements","attr","specified","sel","uniqueSort","duplicates","detectDuplicates","sortStable","textContent","firstChild","nodeValue","selectors","createPseudo","relative","preFilter","ATTR","CHILD","PSEUDO","excess","unquoted","TAG","nodeNameSelector","CLASS","pattern","operator","check","result","what","_argument","simple","forward","ofType","_context","xml","uniqueCache","outerCache","nodeIndex","start","parent","useCache","lastChild","uniqueID","pseudo","args","setFilters","idx","matched","matcher","unmatched","lang","elemLang","hash","location","root","focus","activeElement","hasFocus","href","tabIndex","checked","selected","selectedIndex","empty","header","button","_matchIndexes","radio","checkbox","file","password","image","submit","reset","filters","parseOnly","tokens","soFar","preFilters","cached","combinator","base","skip","checkNonElements","doneName","oldCache","newCache","elementMatcher","matchers","multipleContexts","contexts","condense","newUnmatched","mapped","setMatcher","postFilter","postFinder","postSelector","temp","preMap","postMap","preexisting","matcherIn","matcherOut","matcherFromTokens","checkContext","leadingRelative","implicitRelative","matchContext","matchAnyContext","matcherFromGroupMatchers","elementMatchers","setMatchers","bySet","byElement","superMatcher","outermost","matchedCount","setMatched","contextBackup","dirrunsUnique","token","compiled","_name","defaultValue","unique","isXMLDoc","escapeSelector","until","truncate","is","siblings","n","rneedsContext","needsContext","rsingleTag","winnow","qualifier","not","self","rootjQuery","parseHTML","ready","rparentsprev","guaranteedUnique","children","contents","prev","has","targets","l","closest","index","prevAll","add","addBack","sibling","parents","parentsUntil","nextAll","nextUntil","prevUntil","contentDocument","content","reverse","rnothtmlwhite","createOptions","object","_","flag","Callbacks","firing","memory","fired","locked","queue","firingIndex","fire","once","stopOnFalse","remove","disable","lock","fireWith","Identity","v","Thrower","ex","adoptValue","resolve","reject","noValue","method","promise","fail","then","Deferred","func","tuples","state","always","deferred","_catch","pipe","fns","newDefer","tuple","returned","progress","notify","onFulfilled","onRejected","onProgress","maxDepth","depth","special","that","mightThrow","TypeError","notifyWith","resolveWith","process","exceptionHook","stackTrace","rejectWith","getStackHook","setTimeout","stateString","when","singleValue","remaining","resolveContexts","resolveValues","master","updateFunc","rerrorNames","stack","console","warn","message","readyException","readyList","catch","readyWait","wait","completed","removeEventListener","readyState","doScroll","access","chainable","emptyGet","raw","bulk","_key","rmsPrefix","rdashAlpha","fcamelCase","_all","letter","toUpperCase","camelCase","string","acceptData","owner","Data","uid","defineProperty","configurable","set","data","prop","hasData","dataPriv","dataUser","rbrace","rmultiDash","getData","JSON","parse","dataAttr","removeData","_data","_removeData","dequeue","startLength","hooks","_queueHooks","stop","setter","clearQueue","count","defer","pnum","source","rcssNum","cssExpand","isAttached","composed","getRootNode","isHiddenWithinTree","style","display","css","adjustCSS","valueParts","tween","adjusted","scale","maxIterations","currentValue","initial","unit","cssNumber","initialInUnit","defaultDisplayMap","getDefaultDisplay","body","showHide","show","values","hide","toggle","rcheckableType","rtagName","rscriptType","fragment","createDocumentFragment","div","checkClone","cloneNode","noCloneChecked","option","wrapMap","thead","col","tr","td","_default","tbody","tfoot","colgroup","caption","th","optgroup","getAll","setGlobalEval","refElements","buildFragment","scripts","selection","ignored","wrap","attached","nodes","createTextNode","htmlPrefilter","rkeyEvent","rmouseEvent","rtypenamespace","returnTrue","returnFalse","expectSync","safeActiveElement","err","on","types","one","origFn","event","off","handleObjIn","eventHandle","events","t","handleObj","handlers","namespaces","origType","elemData","create","handle","triggered","dispatch","delegateType","bindType","delegateCount","setup","mappedTypes","origCount","teardown","removeEvent","nativeEvent","handlerQueue","fix","delegateTarget","preDispatch","isPropagationStopped","currentTarget","isImmediatePropagationStopped","rnamespace","preventDefault","stopPropagation","postDispatch","matchedHandlers","matchedSelectors","addProp","hook","Event","enumerable","originalEvent","writable","load","noBubble","click","leverageNative","trigger","beforeunload","returnValue","notAsync","saved","isTrigger","stopImmediatePropagation","props","isDefaultPrevented","defaultPrevented","relatedTarget","timeStamp","now","isSimulated","altKey","bubbles","cancelable","changedTouches","ctrlKey","detail","eventPhase","metaKey","pageX","pageY","shiftKey","view","charCode","keyCode","buttons","clientX","clientY","offsetX","offsetY","pointerId","pointerType","screenX","screenY","targetTouches","toElement","touches","which","blur","mouseenter","mouseleave","pointerenter","pointerleave","orig","related","rnoInnerhtml","rchecked","rcleanScript","manipulationTarget","disableScript","restoreScript","cloneCopyEvent","dest","pdataOld","udataOld","udataCur","fixInput","domManip","collection","hasScripts","iNoClone","valueIsFunction","html","_evalUrl","keepData","cleanData","dataAndEvents","deepDataAndEvents","srcElements","destElements","inPage","detach","append","prepend","insertBefore","before","after","replaceWith","replaceChild","appendTo","prependTo","insertAfter","replaceAll","original","insert","rnumnonpx","getStyles","opener","getComputedStyle","swap","old","rboxStyle","computeStyleTests","container","cssText","divStyle","pixelPositionVal","reliableMarginLeftVal","roundPixelMeasures","marginLeft","right","pixelBoxStylesVal","boxSizingReliableVal","width","position","scrollboxSizeVal","offsetWidth","measure","round","parseFloat","reliableTrDimensionsVal","backgroundClip","clearCloneStyle","boxSizingReliable","pixelBoxStyles","pixelPosition","reliableMarginLeft","scrollboxSize","reliableTrDimensions","table","trChild","trStyle","height","parseInt","curCSS","computed","minWidth","maxWidth","getPropertyValue","addGetHookIf","conditionFn","hookFn","cssPrefixes","emptyStyle","vendorProps","vendorPropName","capName","finalPropName","final","cssProps","rdisplayswap","rcustomProp","cssShow","visibility","cssNormalTransform","letterSpacing","fontWeight","setPositiveNumber","subtract","max","boxModelAdjustment","dimension","box","isBorderBox","styles","computedVal","extra","delta","ceil","getWidthOrHeight","boxSizingNeeded","valueIsBorderBox","offsetProp","getClientRects","cssHooks","opacity","origName","isCustomProp","setProperty","isFinite","getBoundingClientRect","scrollboxSizeBuggy","left","margin","padding","border","prefix","suffix","expand","expanded","parts","Tween","easing","propHooks","run","percent","eased","duration","pos","step","fx","scrollTop","scrollLeft","linear","p","swing","cos","PI","fxNow","inProgress","rfxtypes","rrun","schedule","hidden","requestAnimationFrame","interval","tick","createFxNow","genFx","includeWidth","createTween","animation","Animation","tweeners","defaultPrefilter","opts","oldfire","propTween","restoreDisplay","isBox","anim","dataShow","unqueued","overflow","overflowX","overflowY","propFilter","specialEasing","properties","stopped","prefilters","currentTime","startTime","tweens","originalProperties","originalOptions","gotoEnd","bind","complete","timer","tweener","prefilter","speed","opt","speeds","fadeTo","to","animate","optall","doAnimation","finish","stopQueue","timers","cssFn","slideDown","slideUp","slideToggle","fadeIn","fadeOut","fadeToggle","slow","fast","delay","time","timeout","clearTimeout","checkOn","optSelected","radioValue","boolHook","removeAttr","nType","attrHooks","bool","attrNames","getter","lowercaseName","rfocusable","rclickable","removeProp","propFix","tabindex","stripAndCollapse","getClass","classesToArray","addClass","classes","curValue","clazz","finalValue","removeClass","toggleClass","stateVal","isValidValue","classNames","hasClass","rreturn","valHooks","optionSet","focusin","rfocusMorph","stopPropagationCallback","onlyHandlers","bubbleType","ontype","lastElement","eventPath","parentWindow","simulate","triggerHandler","attaches","rquery","parseXML","DOMParser","parseFromString","rbracket","rCRLF","rsubmitterTypes","rsubmittable","buildParams","traditional","param","s","valueOrFunction","encodeURIComponent","serialize","serializeArray","r20","rhash","rantiCache","rheaders","rlocalProtocol","rnoContent","rprotocol","transports","allTypes","originAnchor","addToPrefiltersOrTransports","structure","dataTypeExpression","dataType","dataTypes","inspectPrefiltersOrTransports","jqXHR","inspected","seekingTransport","inspect","prefilterOrFactory","dataTypeOrTransport","ajaxExtend","flatOptions","ajaxSettings","ajaxHandleResponses","responses","ct","finalDataType","firstDataType","mimeType","getResponseHeader","converters","ajaxConvert","response","isSuccess","conv2","current","conv","responseFields","dataFilter","throws","active","lastModified","etag","url","isLocal","protocol","processData","async","contentType","accepts","json","ajaxSetup","settings","ajaxPrefilter","ajaxTransport","ajax","transport","cacheURL","responseHeadersString","responseHeaders","timeoutTimer","urlAnchor","fireGlobals","uncached","callbackContext","globalEventContext","completeDeferred","statusCode","requestHeaders","requestHeadersNames","strAbort","getAllResponseHeaders","setRequestHeader","overrideMimeType","status","abort","statusText","finalText","crossDomain","host","hasContent","ifModified","headers","beforeSend","success","send","nativeStatusText","modified","getJSON","getScript","textScript","wrapAll","firstElementChild","wrapInner","htmlIsFunction","unwrap","visible","offsetHeight","xhr","XMLHttpRequest","xhrSuccessStatus","xhrSupported","cors","errorCallback","open","username","xhrFields","onload","onerror","onabort","ontimeout","onreadystatechange","responseType","responseText","binary","scriptAttrs","charset","scriptCharset","evt","oldCallbacks","rjsonp","jsonp","jsonpCallback","originalSettings","callbackName","overwritten","responseContainer","jsonProp","createHTMLDocument","implementation","keepScripts","parsed","params","animated","offset","setOffset","curPosition","curLeft","curCSSTop","curTop","curOffset","curCSSLeft","calculatePosition","curElem","using","rect","win","pageYOffset","pageXOffset","offsetParent","parentOffset","scrollTo","Height","Width","defaultExtra","funcName","unbind","delegate","undelegate","hover","fnOver","fnOut","proxy","holdReady","hold","parseJSON","isNumeric","isNaN","trim","define","amd","_jQuery","_$","$","noConflict"],"sources":["/Users/admin/Downloads/vue-element-admin/src/utils/jquery.js"],"sourcesContent":["/*!\n * jQuery JavaScript Library v3.5.1\n * https://jquery.com/\n *\n * Includes Sizzle.js\n * https://sizzlejs.com/\n *\n * Copyright JS Foundation and other contributors\n * Released under the MIT license\n * https://jquery.org/license\n *\n * Date: 2020-05-04T22:49Z\n */\n( function( global, factory ) {\n\n  \"use strict\";\n\n  if ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n\n    // For CommonJS and CommonJS-like environments where a proper `window`\n    // is present, execute the factory and get jQuery.\n    // For environments that do not have a `window` with a `document`\n    // (such as Node.js), expose a factory as module.exports.\n    // This accentuates the need for the creation of a real `window`.\n    // e.g. var jQuery = require(\"jquery\")(window);\n    // See ticket #14549 for more info.\n    module.exports = global.document ?\n      factory( global, true ) :\n      function( w ) {\n        if ( !w.document ) {\n          throw new Error( \"jQuery requires a window with a document\" );\n        }\n        return factory( w );\n      };\n  } else {\n    factory( global );\n  }\n\n// Pass this if window is not defined yet\n} )( typeof window !== \"undefined\" ? window : this, function( window, noGlobal ) {\n\n// Edge <= 12 - 13+, Firefox <=18 - 45+, IE 10 - 11, Safari 5.1 - 9+, iOS 6 - 9.1\n// throw exceptions when non-strict code (e.g., ASP.NET 4.5) accesses strict mode\n// arguments.callee.caller (trac-13335). But as of jQuery 3.0 (2016), strict mode should be common\n// enough that all such attempts are guarded in a try block.\n  \"use strict\";\n\n  var arr = [];\n\n  var getProto = Object.getPrototypeOf;\n\n  var slice = arr.slice;\n\n  var flat = arr.flat ? function( array ) {\n    return arr.flat.call( array );\n  } : function( array ) {\n    return arr.concat.apply( [], array );\n  };\n\n\n  var push = arr.push;\n\n  var indexOf = arr.indexOf;\n\n  var class2type = {};\n\n  var toString = class2type.toString;\n\n  var hasOwn = class2type.hasOwnProperty;\n\n  var fnToString = hasOwn.toString;\n\n  var ObjectFunctionString = fnToString.call( Object );\n\n  var support = {};\n\n  var isFunction = function isFunction( obj ) {\n\n    // Support: Chrome <=57, Firefox <=52\n    // In some browsers, typeof returns \"function\" for HTML <object> elements\n    // (i.e., `typeof document.createElement( \"object\" ) === \"function\"`).\n    // We don't want to classify *any* DOM node as a function.\n    return typeof obj === \"function\" && typeof obj.nodeType !== \"number\";\n  };\n\n\n  var isWindow = function isWindow( obj ) {\n    return obj != null && obj === obj.window;\n  };\n\n\n  var document = window.document;\n\n\n\n  var preservedScriptAttributes = {\n    type: true,\n    src: true,\n    nonce: true,\n    noModule: true\n  };\n\n  function DOMEval( code, node, doc ) {\n    doc = doc || document;\n\n    var i, val,\n      script = doc.createElement( \"script\" );\n\n    script.text = code;\n    if ( node ) {\n      for ( i in preservedScriptAttributes ) {\n\n        // Support: Firefox 64+, Edge 18+\n        // Some browsers don't support the \"nonce\" property on scripts.\n        // On the other hand, just using `getAttribute` is not enough as\n        // the `nonce` attribute is reset to an empty string whenever it\n        // becomes browsing-context connected.\n        // See https://github.com/whatwg/html/issues/2369\n        // See https://html.spec.whatwg.org/#nonce-attributes\n        // The `node.getAttribute` check was added for the sake of\n        // `jQuery.globalEval` so that it can fake a nonce-containing node\n        // via an object.\n        val = node[ i ] || node.getAttribute && node.getAttribute( i );\n        if ( val ) {\n          script.setAttribute( i, val );\n        }\n      }\n    }\n    doc.head.appendChild( script ).parentNode.removeChild( script );\n  }\n\n\n  function toType( obj ) {\n    if ( obj == null ) {\n      return obj + \"\";\n    }\n\n    // Support: Android <=2.3 only (functionish RegExp)\n    return typeof obj === \"object\" || typeof obj === \"function\" ?\n      class2type[ toString.call( obj ) ] || \"object\" :\n      typeof obj;\n  }\n  /* global Symbol */\n// Defining this global in .eslintrc.json would create a danger of using the global\n// unguarded in another place, it seems safer to define global only for this module\n\n\n\n  var\n    version = \"3.5.1\",\n\n    // Define a local copy of jQuery\n    jQuery = function( selector, context ) {\n\n      // The jQuery object is actually just the init constructor 'enhanced'\n      // Need init if jQuery is called (just allow error to be thrown if not included)\n      return new jQuery.fn.init( selector, context );\n    };\n\n  jQuery.fn = jQuery.prototype = {\n\n    // The current version of jQuery being used\n    jquery: version,\n\n    constructor: jQuery,\n\n    // The default length of a jQuery object is 0\n    length: 0,\n\n    toArray: function() {\n      return slice.call( this );\n    },\n\n    // Get the Nth element in the matched element set OR\n    // Get the whole matched element set as a clean array\n    get: function( num ) {\n\n      // Return all the elements in a clean array\n      if ( num == null ) {\n        return slice.call( this );\n      }\n\n      // Return just the one element from the set\n      return num < 0 ? this[ num + this.length ] : this[ num ];\n    },\n\n    // Take an array of elements and push it onto the stack\n    // (returning the new matched element set)\n    pushStack: function( elems ) {\n\n      // Build a new jQuery matched element set\n      var ret = jQuery.merge( this.constructor(), elems );\n\n      // Add the old object onto the stack (as a reference)\n      ret.prevObject = this;\n\n      // Return the newly-formed element set\n      return ret;\n    },\n\n    // Execute a callback for every element in the matched set.\n    each: function( callback ) {\n      return jQuery.each( this, callback );\n    },\n\n    map: function( callback ) {\n      return this.pushStack( jQuery.map( this, function( elem, i ) {\n        return callback.call( elem, i, elem );\n      } ) );\n    },\n\n    slice: function() {\n      return this.pushStack( slice.apply( this, arguments ) );\n    },\n\n    first: function() {\n      return this.eq( 0 );\n    },\n\n    last: function() {\n      return this.eq( -1 );\n    },\n\n    even: function() {\n      return this.pushStack( jQuery.grep( this, function( _elem, i ) {\n        return ( i + 1 ) % 2;\n      } ) );\n    },\n\n    odd: function() {\n      return this.pushStack( jQuery.grep( this, function( _elem, i ) {\n        return i % 2;\n      } ) );\n    },\n\n    eq: function( i ) {\n      var len = this.length,\n        j = +i + ( i < 0 ? len : 0 );\n      return this.pushStack( j >= 0 && j < len ? [ this[ j ] ] : [] );\n    },\n\n    end: function() {\n      return this.prevObject || this.constructor();\n    },\n\n    // For internal use only.\n    // Behaves like an Array's method, not like a jQuery method.\n    push: push,\n    sort: arr.sort,\n    splice: arr.splice\n  };\n\n  jQuery.extend = jQuery.fn.extend = function() {\n    var options, name, src, copy, copyIsArray, clone,\n      target = arguments[ 0 ] || {},\n      i = 1,\n      length = arguments.length,\n      deep = false;\n\n    // Handle a deep copy situation\n    if ( typeof target === \"boolean\" ) {\n      deep = target;\n\n      // Skip the boolean and the target\n      target = arguments[ i ] || {};\n      i++;\n    }\n\n    // Handle case when target is a string or something (possible in deep copy)\n    if ( typeof target !== \"object\" && !isFunction( target ) ) {\n      target = {};\n    }\n\n    // Extend jQuery itself if only one argument is passed\n    if ( i === length ) {\n      target = this;\n      i--;\n    }\n\n    for ( ; i < length; i++ ) {\n\n      // Only deal with non-null/undefined values\n      if ( ( options = arguments[ i ] ) != null ) {\n\n        // Extend the base object\n        for ( name in options ) {\n          copy = options[ name ];\n\n          // Prevent Object.prototype pollution\n          // Prevent never-ending loop\n          if ( name === \"__proto__\" || target === copy ) {\n            continue;\n          }\n\n          // Recurse if we're merging plain objects or arrays\n          if ( deep && copy && ( jQuery.isPlainObject( copy ) ||\n            ( copyIsArray = Array.isArray( copy ) ) ) ) {\n            src = target[ name ];\n\n            // Ensure proper type for the source value\n            if ( copyIsArray && !Array.isArray( src ) ) {\n              clone = [];\n            } else if ( !copyIsArray && !jQuery.isPlainObject( src ) ) {\n              clone = {};\n            } else {\n              clone = src;\n            }\n            copyIsArray = false;\n\n            // Never move original objects, clone them\n            target[ name ] = jQuery.extend( deep, clone, copy );\n\n            // Don't bring in undefined values\n          } else if ( copy !== undefined ) {\n            target[ name ] = copy;\n          }\n        }\n      }\n    }\n\n    // Return the modified object\n    return target;\n  };\n\n  jQuery.extend( {\n\n    // Unique for each copy of jQuery on the page\n    expando: \"jQuery\" + ( version + Math.random() ).replace( /\\D/g, \"\" ),\n\n    // Assume jQuery is ready without the ready module\n    isReady: true,\n\n    error: function( msg ) {\n      throw new Error( msg );\n    },\n\n    noop: function() {},\n\n    isPlainObject: function( obj ) {\n      var proto, Ctor;\n\n      // Detect obvious negatives\n      // Use toString instead of jQuery.type to catch host objects\n      if ( !obj || toString.call( obj ) !== \"[object Object]\" ) {\n        return false;\n      }\n\n      proto = getProto( obj );\n\n      // Objects with no prototype (e.g., `Object.create( null )`) are plain\n      if ( !proto ) {\n        return true;\n      }\n\n      // Objects with prototype are plain iff they were constructed by a global Object function\n      Ctor = hasOwn.call( proto, \"constructor\" ) && proto.constructor;\n      return typeof Ctor === \"function\" && fnToString.call( Ctor ) === ObjectFunctionString;\n    },\n\n    isEmptyObject: function( obj ) {\n      var name;\n\n      for ( name in obj ) {\n        return false;\n      }\n      return true;\n    },\n\n    // Evaluates a script in a provided context; falls back to the global one\n    // if not specified.\n    globalEval: function( code, options, doc ) {\n      DOMEval( code, { nonce: options && options.nonce }, doc );\n    },\n\n    each: function( obj, callback ) {\n      var length, i = 0;\n\n      if ( isArrayLike( obj ) ) {\n        length = obj.length;\n        for ( ; i < length; i++ ) {\n          if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\n            break;\n          }\n        }\n      } else {\n        for ( i in obj ) {\n          if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\n            break;\n          }\n        }\n      }\n\n      return obj;\n    },\n\n    // results is for internal usage only\n    makeArray: function( arr, results ) {\n      var ret = results || [];\n\n      if ( arr != null ) {\n        if ( isArrayLike( Object( arr ) ) ) {\n          jQuery.merge( ret,\n            typeof arr === \"string\" ?\n              [ arr ] : arr\n          );\n        } else {\n          push.call( ret, arr );\n        }\n      }\n\n      return ret;\n    },\n\n    inArray: function( elem, arr, i ) {\n      return arr == null ? -1 : indexOf.call( arr, elem, i );\n    },\n\n    // Support: Android <=4.0 only, PhantomJS 1 only\n    // push.apply(_, arraylike) throws on ancient WebKit\n    merge: function( first, second ) {\n      var len = +second.length,\n        j = 0,\n        i = first.length;\n\n      for ( ; j < len; j++ ) {\n        first[ i++ ] = second[ j ];\n      }\n\n      first.length = i;\n\n      return first;\n    },\n\n    grep: function( elems, callback, invert ) {\n      var callbackInverse,\n        matches = [],\n        i = 0,\n        length = elems.length,\n        callbackExpect = !invert;\n\n      // Go through the array, only saving the items\n      // that pass the validator function\n      for ( ; i < length; i++ ) {\n        callbackInverse = !callback( elems[ i ], i );\n        if ( callbackInverse !== callbackExpect ) {\n          matches.push( elems[ i ] );\n        }\n      }\n\n      return matches;\n    },\n\n    // arg is for internal usage only\n    map: function( elems, callback, arg ) {\n      var length, value,\n        i = 0,\n        ret = [];\n\n      // Go through the array, translating each of the items to their new values\n      if ( isArrayLike( elems ) ) {\n        length = elems.length;\n        for ( ; i < length; i++ ) {\n          value = callback( elems[ i ], i, arg );\n\n          if ( value != null ) {\n            ret.push( value );\n          }\n        }\n\n        // Go through every key on the object,\n      } else {\n        for ( i in elems ) {\n          value = callback( elems[ i ], i, arg );\n\n          if ( value != null ) {\n            ret.push( value );\n          }\n        }\n      }\n\n      // Flatten any nested arrays\n      return flat( ret );\n    },\n\n    // A global GUID counter for objects\n    guid: 1,\n\n    // jQuery.support is not used in Core but other projects attach their\n    // properties to it so it needs to exist.\n    support: support\n  } );\n\n  if ( typeof Symbol === \"function\" ) {\n    jQuery.fn[ Symbol.iterator ] = arr[ Symbol.iterator ];\n  }\n\n// Populate the class2type map\n  jQuery.each( \"Boolean Number String Function Array Date RegExp Object Error Symbol\".split( \" \" ),\n    function( _i, name ) {\n      class2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\n    } );\n\n  function isArrayLike( obj ) {\n\n    // Support: real iOS 8.2 only (not reproducible in simulator)\n    // `in` check used to prevent JIT error (gh-2145)\n    // hasOwn isn't used here due to false negatives\n    // regarding Nodelist length in IE\n    var length = !!obj && \"length\" in obj && obj.length,\n      type = toType( obj );\n\n    if ( isFunction( obj ) || isWindow( obj ) ) {\n      return false;\n    }\n\n    return type === \"array\" || length === 0 ||\n      typeof length === \"number\" && length > 0 && ( length - 1 ) in obj;\n  }\n  var Sizzle =\n    /*!\n * Sizzle CSS Selector Engine v2.3.5\n * https://sizzlejs.com/\n *\n * Copyright JS Foundation and other contributors\n * Released under the MIT license\n * https://js.foundation/\n *\n * Date: 2020-03-14\n */\n    ( function( window ) {\n      var i,\n        support,\n        Expr,\n        getText,\n        isXML,\n        tokenize,\n        compile,\n        select,\n        outermostContext,\n        sortInput,\n        hasDuplicate,\n\n        // Local document vars\n        setDocument,\n        document,\n        docElem,\n        documentIsHTML,\n        rbuggyQSA,\n        rbuggyMatches,\n        matches,\n        contains,\n\n        // Instance-specific data\n        expando = \"sizzle\" + 1 * new Date(),\n        preferredDoc = window.document,\n        dirruns = 0,\n        done = 0,\n        classCache = createCache(),\n        tokenCache = createCache(),\n        compilerCache = createCache(),\n        nonnativeSelectorCache = createCache(),\n        sortOrder = function( a, b ) {\n          if ( a === b ) {\n            hasDuplicate = true;\n          }\n          return 0;\n        },\n\n        // Instance methods\n        hasOwn = ( {} ).hasOwnProperty,\n        arr = [],\n        pop = arr.pop,\n        pushNative = arr.push,\n        push = arr.push,\n        slice = arr.slice,\n\n        // Use a stripped-down indexOf as it's faster than native\n        // https://jsperf.com/thor-indexof-vs-for/5\n        indexOf = function( list, elem ) {\n          var i = 0,\n            len = list.length;\n          for ( ; i < len; i++ ) {\n            if ( list[ i ] === elem ) {\n              return i;\n            }\n          }\n          return -1;\n        },\n\n        booleans = \"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|\" +\n          \"ismap|loop|multiple|open|readonly|required|scoped\",\n\n        // Regular expressions\n\n        // http://www.w3.org/TR/css3-selectors/#whitespace\n        whitespace = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",\n\n        // https://www.w3.org/TR/css-syntax-3/#ident-token-diagram\n        identifier = \"(?:\\\\\\\\[\\\\da-fA-F]{1,6}\" + whitespace +\n          \"?|\\\\\\\\[^\\\\r\\\\n\\\\f]|[\\\\w-]|[^\\0-\\\\x7f])+\",\n\n        // Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors\n        attributes = \"\\\\[\" + whitespace + \"*(\" + identifier + \")(?:\" + whitespace +\n\n          // Operator (capture 2)\n          \"*([*^$|!~]?=)\" + whitespace +\n\n          // \"Attribute values must be CSS identifiers [capture 5]\n          // or strings [capture 3 or capture 4]\"\n          \"*(?:'((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\"|(\" + identifier + \"))|)\" +\n          whitespace + \"*\\\\]\",\n\n        pseudos = \":(\" + identifier + \")(?:\\\\((\" +\n\n          // To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:\n          // 1. quoted (capture 3; capture 4 or capture 5)\n          \"('((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\")|\" +\n\n          // 2. simple (capture 6)\n          \"((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\" + attributes + \")*)|\" +\n\n          // 3. anything else (capture 2)\n          \".*\" +\n          \")\\\\)|)\",\n\n        // Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n        rwhitespace = new RegExp( whitespace + \"+\", \"g\" ),\n        rtrim = new RegExp( \"^\" + whitespace + \"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\" +\n          whitespace + \"+$\", \"g\" ),\n\n        rcomma = new RegExp( \"^\" + whitespace + \"*,\" + whitespace + \"*\" ),\n        rcombinators = new RegExp( \"^\" + whitespace + \"*([>+~]|\" + whitespace + \")\" + whitespace +\n          \"*\" ),\n        rdescend = new RegExp( whitespace + \"|>\" ),\n\n        rpseudo = new RegExp( pseudos ),\n        ridentifier = new RegExp( \"^\" + identifier + \"$\" ),\n\n        matchExpr = {\n          \"ID\": new RegExp( \"^#(\" + identifier + \")\" ),\n          \"CLASS\": new RegExp( \"^\\\\.(\" + identifier + \")\" ),\n          \"TAG\": new RegExp( \"^(\" + identifier + \"|[*])\" ),\n          \"ATTR\": new RegExp( \"^\" + attributes ),\n          \"PSEUDO\": new RegExp( \"^\" + pseudos ),\n          \"CHILD\": new RegExp( \"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\" +\n            whitespace + \"*(even|odd|(([+-]|)(\\\\d*)n|)\" + whitespace + \"*(?:([+-]|)\" +\n            whitespace + \"*(\\\\d+)|))\" + whitespace + \"*\\\\)|)\", \"i\" ),\n          \"bool\": new RegExp( \"^(?:\" + booleans + \")$\", \"i\" ),\n\n          // For use in libraries implementing .is()\n          // We use this for POS matching in `select`\n          \"needsContext\": new RegExp( \"^\" + whitespace +\n            \"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\" + whitespace +\n            \"*((?:-\\\\d)?\\\\d*)\" + whitespace + \"*\\\\)|)(?=[^-]|$)\", \"i\" )\n        },\n\n        rhtml = /HTML$/i,\n        rinputs = /^(?:input|select|textarea|button)$/i,\n        rheader = /^h\\d$/i,\n\n        rnative = /^[^{]+\\{\\s*\\[native \\w/,\n\n        // Easily-parseable/retrievable ID or TAG or CLASS selectors\n        rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n\n        rsibling = /[+~]/,\n\n        // CSS escapes\n        // http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n        runescape = new RegExp( \"\\\\\\\\[\\\\da-fA-F]{1,6}\" + whitespace + \"?|\\\\\\\\([^\\\\r\\\\n\\\\f])\", \"g\" ),\n        funescape = function( escape, nonHex ) {\n          var high = \"0x\" + escape.slice( 1 ) - 0x10000;\n\n          return nonHex ?\n\n            // Strip the backslash prefix from a non-hex escape sequence\n            nonHex :\n\n            // Replace a hexadecimal escape sequence with the encoded Unicode code point\n            // Support: IE <=11+\n            // For values outside the Basic Multilingual Plane (BMP), manually construct a\n            // surrogate pair\n            high < 0 ?\n              String.fromCharCode( high + 0x10000 ) :\n              String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n        },\n\n        // CSS string/identifier serialization\n        // https://drafts.csswg.org/cssom/#common-serializing-idioms\n        rcssescape = /([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\0-\\x1f\\x7f-\\uFFFF\\w-]/g,\n        fcssescape = function( ch, asCodePoint ) {\n          if ( asCodePoint ) {\n\n            // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER\n            if ( ch === \"\\0\" ) {\n              return \"\\uFFFD\";\n            }\n\n            // Control characters and (dependent upon position) numbers get escaped as code points\n            return ch.slice( 0, -1 ) + \"\\\\\" +\n              ch.charCodeAt( ch.length - 1 ).toString( 16 ) + \" \";\n          }\n\n          // Other potentially-special ASCII characters get backslash-escaped\n          return \"\\\\\" + ch;\n        },\n\n        // Used for iframes\n        // See setDocument()\n        // Removing the function wrapper causes a \"Permission Denied\"\n        // error in IE\n        unloadHandler = function() {\n          setDocument();\n        },\n\n        inDisabledFieldset = addCombinator(\n          function( elem ) {\n            return elem.disabled === true && elem.nodeName.toLowerCase() === \"fieldset\";\n          },\n          { dir: \"parentNode\", next: \"legend\" }\n        );\n\n// Optimize for push.apply( _, NodeList )\n      try {\n        push.apply(\n          ( arr = slice.call( preferredDoc.childNodes ) ),\n          preferredDoc.childNodes\n        );\n\n        // Support: Android<4.0\n        // Detect silently failing push.apply\n        // eslint-disable-next-line no-unused-expressions\n        arr[ preferredDoc.childNodes.length ].nodeType;\n      } catch ( e ) {\n        push = { apply: arr.length ?\n\n            // Leverage slice if possible\n            function( target, els ) {\n              pushNative.apply( target, slice.call( els ) );\n            } :\n\n            // Support: IE<9\n            // Otherwise append directly\n            function( target, els ) {\n              var j = target.length,\n                i = 0;\n\n              // Can't trust NodeList.length\n              while ( ( target[ j++ ] = els[ i++ ] ) ) {}\n              target.length = j - 1;\n            }\n        };\n      }\n\n      function Sizzle( selector, context, results, seed ) {\n        var m, i, elem, nid, match, groups, newSelector,\n          newContext = context && context.ownerDocument,\n\n          // nodeType defaults to 9, since context defaults to document\n          nodeType = context ? context.nodeType : 9;\n\n        results = results || [];\n\n        // Return early from calls with invalid selector or context\n        if ( typeof selector !== \"string\" || !selector ||\n          nodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {\n\n          return results;\n        }\n\n        // Try to shortcut find operations (as opposed to filters) in HTML documents\n        if ( !seed ) {\n          setDocument( context );\n          context = context || document;\n\n          if ( documentIsHTML ) {\n\n            // If the selector is sufficiently simple, try using a \"get*By*\" DOM method\n            // (excepting DocumentFragment context, where the methods don't exist)\n            if ( nodeType !== 11 && ( match = rquickExpr.exec( selector ) ) ) {\n\n              // ID selector\n              if ( ( m = match[ 1 ] ) ) {\n\n                // Document context\n                if ( nodeType === 9 ) {\n                  if ( ( elem = context.getElementById( m ) ) ) {\n\n                    // Support: IE, Opera, Webkit\n                    // TODO: identify versions\n                    // getElementById can match elements by name instead of ID\n                    if ( elem.id === m ) {\n                      results.push( elem );\n                      return results;\n                    }\n                  } else {\n                    return results;\n                  }\n\n                  // Element context\n                } else {\n\n                  // Support: IE, Opera, Webkit\n                  // TODO: identify versions\n                  // getElementById can match elements by name instead of ID\n                  if ( newContext && ( elem = newContext.getElementById( m ) ) &&\n                    contains( context, elem ) &&\n                    elem.id === m ) {\n\n                    results.push( elem );\n                    return results;\n                  }\n                }\n\n                // Type selector\n              } else if ( match[ 2 ] ) {\n                push.apply( results, context.getElementsByTagName( selector ) );\n                return results;\n\n                // Class selector\n              } else if ( ( m = match[ 3 ] ) && support.getElementsByClassName &&\n                context.getElementsByClassName ) {\n\n                push.apply( results, context.getElementsByClassName( m ) );\n                return results;\n              }\n            }\n\n            // Take advantage of querySelectorAll\n            if ( support.qsa &&\n              !nonnativeSelectorCache[ selector + \" \" ] &&\n              ( !rbuggyQSA || !rbuggyQSA.test( selector ) ) &&\n\n              // Support: IE 8 only\n              // Exclude object elements\n              ( nodeType !== 1 || context.nodeName.toLowerCase() !== \"object\" ) ) {\n\n              newSelector = selector;\n              newContext = context;\n\n              // qSA considers elements outside a scoping root when evaluating child or\n              // descendant combinators, which is not what we want.\n              // In such cases, we work around the behavior by prefixing every selector in the\n              // list with an ID selector referencing the scope context.\n              // The technique has to be used as well when a leading combinator is used\n              // as such selectors are not recognized by querySelectorAll.\n              // Thanks to Andrew Dupont for this technique.\n              if ( nodeType === 1 &&\n                ( rdescend.test( selector ) || rcombinators.test( selector ) ) ) {\n\n                // Expand context for sibling selectors\n                newContext = rsibling.test( selector ) && testContext( context.parentNode ) ||\n                  context;\n\n                // We can use :scope instead of the ID hack if the browser\n                // supports it & if we're not changing the context.\n                if ( newContext !== context || !support.scope ) {\n\n                  // Capture the context ID, setting it first if necessary\n                  if ( ( nid = context.getAttribute( \"id\" ) ) ) {\n                    nid = nid.replace( rcssescape, fcssescape );\n                  } else {\n                    context.setAttribute( \"id\", ( nid = expando ) );\n                  }\n                }\n\n                // Prefix every selector in the list\n                groups = tokenize( selector );\n                i = groups.length;\n                while ( i-- ) {\n                  groups[ i ] = ( nid ? \"#\" + nid : \":scope\" ) + \" \" +\n                    toSelector( groups[ i ] );\n                }\n                newSelector = groups.join( \",\" );\n              }\n\n              try {\n                push.apply( results,\n                  newContext.querySelectorAll( newSelector )\n                );\n                return results;\n              } catch ( qsaError ) {\n                nonnativeSelectorCache( selector, true );\n              } finally {\n                if ( nid === expando ) {\n                  context.removeAttribute( \"id\" );\n                }\n              }\n            }\n          }\n        }\n\n        // All others\n        return select( selector.replace( rtrim, \"$1\" ), context, results, seed );\n      }\n\n      /**\n       * Create key-value caches of limited size\n       * @returns {function(string, object)} Returns the Object data after storing it on itself with\n       *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n       *\tdeleting the oldest entry\n       */\n      function createCache() {\n        var keys = [];\n\n        function cache( key, value ) {\n\n          // Use (key + \" \") to avoid collision with native prototype properties (see Issue #157)\n          if ( keys.push( key + \" \" ) > Expr.cacheLength ) {\n\n            // Only keep the most recent entries\n            delete cache[ keys.shift() ];\n          }\n          return ( cache[ key + \" \" ] = value );\n        }\n        return cache;\n      }\n\n      /**\n       * Mark a function for special use by Sizzle\n       * @param {Function} fn The function to mark\n       */\n      function markFunction( fn ) {\n        fn[ expando ] = true;\n        return fn;\n      }\n\n      /**\n       * Support testing using an element\n       * @param {Function} fn Passed the created element and returns a boolean result\n       */\n      function assert( fn ) {\n        var el = document.createElement( \"fieldset\" );\n\n        try {\n          return !!fn( el );\n        } catch ( e ) {\n          return false;\n        } finally {\n\n          // Remove from its parent by default\n          if ( el.parentNode ) {\n            el.parentNode.removeChild( el );\n          }\n\n          // release memory in IE\n          el = null;\n        }\n      }\n\n      /**\n       * Adds the same handler for all of the specified attrs\n       * @param {String} attrs Pipe-separated list of attributes\n       * @param {Function} handler The method that will be applied\n       */\n      function addHandle( attrs, handler ) {\n        var arr = attrs.split( \"|\" ),\n          i = arr.length;\n\n        while ( i-- ) {\n          Expr.attrHandle[ arr[ i ] ] = handler;\n        }\n      }\n\n      /**\n       * Checks document order of two siblings\n       * @param {Element} a\n       * @param {Element} b\n       * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\n       */\n      function siblingCheck( a, b ) {\n        var cur = b && a,\n          diff = cur && a.nodeType === 1 && b.nodeType === 1 &&\n            a.sourceIndex - b.sourceIndex;\n\n        // Use IE sourceIndex if available on both nodes\n        if ( diff ) {\n          return diff;\n        }\n\n        // Check if b follows a\n        if ( cur ) {\n          while ( ( cur = cur.nextSibling ) ) {\n            if ( cur === b ) {\n              return -1;\n            }\n          }\n        }\n\n        return a ? 1 : -1;\n      }\n\n      /**\n       * Returns a function to use in pseudos for input types\n       * @param {String} type\n       */\n      function createInputPseudo( type ) {\n        return function( elem ) {\n          var name = elem.nodeName.toLowerCase();\n          return name === \"input\" && elem.type === type;\n        };\n      }\n\n      /**\n       * Returns a function to use in pseudos for buttons\n       * @param {String} type\n       */\n      function createButtonPseudo( type ) {\n        return function( elem ) {\n          var name = elem.nodeName.toLowerCase();\n          return ( name === \"input\" || name === \"button\" ) && elem.type === type;\n        };\n      }\n\n      /**\n       * Returns a function to use in pseudos for :enabled/:disabled\n       * @param {Boolean} disabled true for :disabled; false for :enabled\n       */\n      function createDisabledPseudo( disabled ) {\n\n        // Known :disabled false positives: fieldset[disabled] > legend:nth-of-type(n+2) :can-disable\n        return function( elem ) {\n\n          // Only certain elements can match :enabled or :disabled\n          // https://html.spec.whatwg.org/multipage/scripting.html#selector-enabled\n          // https://html.spec.whatwg.org/multipage/scripting.html#selector-disabled\n          if ( \"form\" in elem ) {\n\n            // Check for inherited disabledness on relevant non-disabled elements:\n            // * listed form-associated elements in a disabled fieldset\n            //   https://html.spec.whatwg.org/multipage/forms.html#category-listed\n            //   https://html.spec.whatwg.org/multipage/forms.html#concept-fe-disabled\n            // * option elements in a disabled optgroup\n            //   https://html.spec.whatwg.org/multipage/forms.html#concept-option-disabled\n            // All such elements have a \"form\" property.\n            if ( elem.parentNode && elem.disabled === false ) {\n\n              // Option elements defer to a parent optgroup if present\n              if ( \"label\" in elem ) {\n                if ( \"label\" in elem.parentNode ) {\n                  return elem.parentNode.disabled === disabled;\n                } else {\n                  return elem.disabled === disabled;\n                }\n              }\n\n              // Support: IE 6 - 11\n              // Use the isDisabled shortcut property to check for disabled fieldset ancestors\n              return elem.isDisabled === disabled ||\n\n                // Where there is no isDisabled, check manually\n                /* jshint -W018 */\n                elem.isDisabled !== !disabled &&\n                inDisabledFieldset( elem ) === disabled;\n            }\n\n            return elem.disabled === disabled;\n\n            // Try to winnow out elements that can't be disabled before trusting the disabled property.\n            // Some victims get caught in our net (label, legend, menu, track), but it shouldn't\n            // even exist on them, let alone have a boolean value.\n          } else if ( \"label\" in elem ) {\n            return elem.disabled === disabled;\n          }\n\n          // Remaining elements are neither :enabled nor :disabled\n          return false;\n        };\n      }\n\n      /**\n       * Returns a function to use in pseudos for positionals\n       * @param {Function} fn\n       */\n      function createPositionalPseudo( fn ) {\n        return markFunction( function( argument ) {\n          argument = +argument;\n          return markFunction( function( seed, matches ) {\n            var j,\n              matchIndexes = fn( [], seed.length, argument ),\n              i = matchIndexes.length;\n\n            // Match elements found at the specified indexes\n            while ( i-- ) {\n              if ( seed[ ( j = matchIndexes[ i ] ) ] ) {\n                seed[ j ] = !( matches[ j ] = seed[ j ] );\n              }\n            }\n          } );\n        } );\n      }\n\n      /**\n       * Checks a node for validity as a Sizzle context\n       * @param {Element|Object=} context\n       * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value\n       */\n      function testContext( context ) {\n        return context && typeof context.getElementsByTagName !== \"undefined\" && context;\n      }\n\n// Expose support vars for convenience\n      support = Sizzle.support = {};\n\n      /**\n       * Detects XML nodes\n       * @param {Element|Object} elem An element or a document\n       * @returns {Boolean} True iff elem is a non-HTML XML node\n       */\n      isXML = Sizzle.isXML = function( elem ) {\n        var namespace = elem.namespaceURI,\n          docElem = ( elem.ownerDocument || elem ).documentElement;\n\n        // Support: IE <=8\n        // Assume HTML when documentElement doesn't yet exist, such as inside loading iframes\n        // https://bugs.jquery.com/ticket/4833\n        return !rhtml.test( namespace || docElem && docElem.nodeName || \"HTML\" );\n      };\n\n      /**\n       * Sets document-related variables once based on the current document\n       * @param {Element|Object} [doc] An element or document object to use to set the document\n       * @returns {Object} Returns the current document\n       */\n      setDocument = Sizzle.setDocument = function( node ) {\n        var hasCompare, subWindow,\n          doc = node ? node.ownerDocument || node : preferredDoc;\n\n        // Return early if doc is invalid or already selected\n        // Support: IE 11+, Edge 17 - 18+\n        // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n        // two documents; shallow comparisons work.\n        // eslint-disable-next-line eqeqeq\n        if ( doc == document || doc.nodeType !== 9 || !doc.documentElement ) {\n          return document;\n        }\n\n        // Update global variables\n        document = doc;\n        docElem = document.documentElement;\n        documentIsHTML = !isXML( document );\n\n        // Support: IE 9 - 11+, Edge 12 - 18+\n        // Accessing iframe documents after unload throws \"permission denied\" errors (jQuery #13936)\n        // Support: IE 11+, Edge 17 - 18+\n        // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n        // two documents; shallow comparisons work.\n        // eslint-disable-next-line eqeqeq\n        if ( preferredDoc != document &&\n          ( subWindow = document.defaultView ) && subWindow.top !== subWindow ) {\n\n          // Support: IE 11, Edge\n          if ( subWindow.addEventListener ) {\n            subWindow.addEventListener( \"unload\", unloadHandler, false );\n\n            // Support: IE 9 - 10 only\n          } else if ( subWindow.attachEvent ) {\n            subWindow.attachEvent( \"onunload\", unloadHandler );\n          }\n        }\n\n        // Support: IE 8 - 11+, Edge 12 - 18+, Chrome <=16 - 25 only, Firefox <=3.6 - 31 only,\n        // Safari 4 - 5 only, Opera <=11.6 - 12.x only\n        // IE/Edge & older browsers don't support the :scope pseudo-class.\n        // Support: Safari 6.0 only\n        // Safari 6.0 supports :scope but it's an alias of :root there.\n        support.scope = assert( function( el ) {\n          docElem.appendChild( el ).appendChild( document.createElement( \"div\" ) );\n          return typeof el.querySelectorAll !== \"undefined\" &&\n            !el.querySelectorAll( \":scope fieldset div\" ).length;\n        } );\n\n        /* Attributes\n\t---------------------------------------------------------------------- */\n\n        // Support: IE<8\n        // Verify that getAttribute really returns attributes and not properties\n        // (excepting IE8 booleans)\n        support.attributes = assert( function( el ) {\n          el.className = \"i\";\n          return !el.getAttribute( \"className\" );\n        } );\n\n        /* getElement(s)By*\n\t---------------------------------------------------------------------- */\n\n        // Check if getElementsByTagName(\"*\") returns only elements\n        support.getElementsByTagName = assert( function( el ) {\n          el.appendChild( document.createComment( \"\" ) );\n          return !el.getElementsByTagName( \"*\" ).length;\n        } );\n\n        // Support: IE<9\n        support.getElementsByClassName = rnative.test( document.getElementsByClassName );\n\n        // Support: IE<10\n        // Check if getElementById returns elements by name\n        // The broken getElementById methods don't pick up programmatically-set names,\n        // so use a roundabout getElementsByName test\n        support.getById = assert( function( el ) {\n          docElem.appendChild( el ).id = expando;\n          return !document.getElementsByName || !document.getElementsByName( expando ).length;\n        } );\n\n        // ID filter and find\n        if ( support.getById ) {\n          Expr.filter[ \"ID\" ] = function( id ) {\n            var attrId = id.replace( runescape, funescape );\n            return function( elem ) {\n              return elem.getAttribute( \"id\" ) === attrId;\n            };\n          };\n          Expr.find[ \"ID\" ] = function( id, context ) {\n            if ( typeof context.getElementById !== \"undefined\" && documentIsHTML ) {\n              var elem = context.getElementById( id );\n              return elem ? [ elem ] : [];\n            }\n          };\n        } else {\n          Expr.filter[ \"ID\" ] =  function( id ) {\n            var attrId = id.replace( runescape, funescape );\n            return function( elem ) {\n              var node = typeof elem.getAttributeNode !== \"undefined\" &&\n                elem.getAttributeNode( \"id\" );\n              return node && node.value === attrId;\n            };\n          };\n\n          // Support: IE 6 - 7 only\n          // getElementById is not reliable as a find shortcut\n          Expr.find[ \"ID\" ] = function( id, context ) {\n            if ( typeof context.getElementById !== \"undefined\" && documentIsHTML ) {\n              var node, i, elems,\n                elem = context.getElementById( id );\n\n              if ( elem ) {\n\n                // Verify the id attribute\n                node = elem.getAttributeNode( \"id\" );\n                if ( node && node.value === id ) {\n                  return [ elem ];\n                }\n\n                // Fall back on getElementsByName\n                elems = context.getElementsByName( id );\n                i = 0;\n                while ( ( elem = elems[ i++ ] ) ) {\n                  node = elem.getAttributeNode( \"id\" );\n                  if ( node && node.value === id ) {\n                    return [ elem ];\n                  }\n                }\n              }\n\n              return [];\n            }\n          };\n        }\n\n        // Tag\n        Expr.find[ \"TAG\" ] = support.getElementsByTagName ?\n          function( tag, context ) {\n            if ( typeof context.getElementsByTagName !== \"undefined\" ) {\n              return context.getElementsByTagName( tag );\n\n              // DocumentFragment nodes don't have gEBTN\n            } else if ( support.qsa ) {\n              return context.querySelectorAll( tag );\n            }\n          } :\n\n          function( tag, context ) {\n            var elem,\n              tmp = [],\n              i = 0,\n\n              // By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too\n              results = context.getElementsByTagName( tag );\n\n            // Filter out possible comments\n            if ( tag === \"*\" ) {\n              while ( ( elem = results[ i++ ] ) ) {\n                if ( elem.nodeType === 1 ) {\n                  tmp.push( elem );\n                }\n              }\n\n              return tmp;\n            }\n            return results;\n          };\n\n        // Class\n        Expr.find[ \"CLASS\" ] = support.getElementsByClassName && function( className, context ) {\n          if ( typeof context.getElementsByClassName !== \"undefined\" && documentIsHTML ) {\n            return context.getElementsByClassName( className );\n          }\n        };\n\n        /* QSA/matchesSelector\n\t---------------------------------------------------------------------- */\n\n        // QSA and matchesSelector support\n\n        // matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n        rbuggyMatches = [];\n\n        // qSa(:focus) reports false when true (Chrome 21)\n        // We allow this because of a bug in IE8/9 that throws an error\n        // whenever `document.activeElement` is accessed on an iframe\n        // So, we allow :focus to pass through QSA all the time to avoid the IE error\n        // See https://bugs.jquery.com/ticket/13378\n        rbuggyQSA = [];\n\n        if ( ( support.qsa = rnative.test( document.querySelectorAll ) ) ) {\n\n          // Build QSA regex\n          // Regex strategy adopted from Diego Perini\n          assert( function( el ) {\n\n            var input;\n\n            // Select is set to empty string on purpose\n            // This is to test IE's treatment of not explicitly\n            // setting a boolean content attribute,\n            // since its presence should be enough\n            // https://bugs.jquery.com/ticket/12359\n            docElem.appendChild( el ).innerHTML = \"<a id='\" + expando + \"'></a>\" +\n              \"<select id='\" + expando + \"-\\r\\\\' msallowcapture=''>\" +\n              \"<option selected=''></option></select>\";\n\n            // Support: IE8, Opera 11-12.16\n            // Nothing should be selected when empty strings follow ^= or $= or *=\n            // The test attribute must be unknown in Opera but \"safe\" for WinRT\n            // https://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section\n            if ( el.querySelectorAll( \"[msallowcapture^='']\" ).length ) {\n              rbuggyQSA.push( \"[*^$]=\" + whitespace + \"*(?:''|\\\"\\\")\" );\n            }\n\n            // Support: IE8\n            // Boolean attributes and \"value\" are not treated correctly\n            if ( !el.querySelectorAll( \"[selected]\" ).length ) {\n              rbuggyQSA.push( \"\\\\[\" + whitespace + \"*(?:value|\" + booleans + \")\" );\n            }\n\n            // Support: Chrome<29, Android<4.4, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.8+\n            if ( !el.querySelectorAll( \"[id~=\" + expando + \"-]\" ).length ) {\n              rbuggyQSA.push( \"~=\" );\n            }\n\n            // Support: IE 11+, Edge 15 - 18+\n            // IE 11/Edge don't find elements on a `[name='']` query in some cases.\n            // Adding a temporary attribute to the document before the selection works\n            // around the issue.\n            // Interestingly, IE 10 & older don't seem to have the issue.\n            input = document.createElement( \"input\" );\n            input.setAttribute( \"name\", \"\" );\n            el.appendChild( input );\n            if ( !el.querySelectorAll( \"[name='']\" ).length ) {\n              rbuggyQSA.push( \"\\\\[\" + whitespace + \"*name\" + whitespace + \"*=\" +\n                whitespace + \"*(?:''|\\\"\\\")\" );\n            }\n\n            // Webkit/Opera - :checked should return selected option elements\n            // http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n            // IE8 throws error here and will not see later tests\n            if ( !el.querySelectorAll( \":checked\" ).length ) {\n              rbuggyQSA.push( \":checked\" );\n            }\n\n            // Support: Safari 8+, iOS 8+\n            // https://bugs.webkit.org/show_bug.cgi?id=136851\n            // In-page `selector#id sibling-combinator selector` fails\n            if ( !el.querySelectorAll( \"a#\" + expando + \"+*\" ).length ) {\n              rbuggyQSA.push( \".#.+[+~]\" );\n            }\n\n            // Support: Firefox <=3.6 - 5 only\n            // Old Firefox doesn't throw on a badly-escaped identifier.\n            el.querySelectorAll( \"\\\\\\f\" );\n            rbuggyQSA.push( \"[\\\\r\\\\n\\\\f]\" );\n          } );\n\n          assert( function( el ) {\n            el.innerHTML = \"<a href='' disabled='disabled'></a>\" +\n              \"<select disabled='disabled'><option/></select>\";\n\n            // Support: Windows 8 Native Apps\n            // The type and name attributes are restricted during .innerHTML assignment\n            var input = document.createElement( \"input\" );\n            input.setAttribute( \"type\", \"hidden\" );\n            el.appendChild( input ).setAttribute( \"name\", \"D\" );\n\n            // Support: IE8\n            // Enforce case-sensitivity of name attribute\n            if ( el.querySelectorAll( \"[name=d]\" ).length ) {\n              rbuggyQSA.push( \"name\" + whitespace + \"*[*^$|!~]?=\" );\n            }\n\n            // FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n            // IE8 throws error here and will not see later tests\n            if ( el.querySelectorAll( \":enabled\" ).length !== 2 ) {\n              rbuggyQSA.push( \":enabled\", \":disabled\" );\n            }\n\n            // Support: IE9-11+\n            // IE's :disabled selector does not pick up the children of disabled fieldsets\n            docElem.appendChild( el ).disabled = true;\n            if ( el.querySelectorAll( \":disabled\" ).length !== 2 ) {\n              rbuggyQSA.push( \":enabled\", \":disabled\" );\n            }\n\n            // Support: Opera 10 - 11 only\n            // Opera 10-11 does not throw on post-comma invalid pseudos\n            el.querySelectorAll( \"*,:x\" );\n            rbuggyQSA.push( \",.*:\" );\n          } );\n        }\n\n        if ( ( support.matchesSelector = rnative.test( ( matches = docElem.matches ||\n          docElem.webkitMatchesSelector ||\n          docElem.mozMatchesSelector ||\n          docElem.oMatchesSelector ||\n          docElem.msMatchesSelector ) ) ) ) {\n\n          assert( function( el ) {\n\n            // Check to see if it's possible to do matchesSelector\n            // on a disconnected node (IE 9)\n            support.disconnectedMatch = matches.call( el, \"*\" );\n\n            // This should fail with an exception\n            // Gecko does not error, returns false instead\n            matches.call( el, \"[s!='']:x\" );\n            rbuggyMatches.push( \"!=\", pseudos );\n          } );\n        }\n\n        rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join( \"|\" ) );\n        rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join( \"|\" ) );\n\n        /* Contains\n\t---------------------------------------------------------------------- */\n        hasCompare = rnative.test( docElem.compareDocumentPosition );\n\n        // Element contains another\n        // Purposefully self-exclusive\n        // As in, an element does not contain itself\n        contains = hasCompare || rnative.test( docElem.contains ) ?\n          function( a, b ) {\n            var adown = a.nodeType === 9 ? a.documentElement : a,\n              bup = b && b.parentNode;\n            return a === bup || !!( bup && bup.nodeType === 1 && (\n              adown.contains ?\n                adown.contains( bup ) :\n                a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n            ) );\n          } :\n          function( a, b ) {\n            if ( b ) {\n              while ( ( b = b.parentNode ) ) {\n                if ( b === a ) {\n                  return true;\n                }\n              }\n            }\n            return false;\n          };\n\n        /* Sorting\n\t---------------------------------------------------------------------- */\n\n        // Document order sorting\n        sortOrder = hasCompare ?\n          function( a, b ) {\n\n            // Flag for duplicate removal\n            if ( a === b ) {\n              hasDuplicate = true;\n              return 0;\n            }\n\n            // Sort on method existence if only one input has compareDocumentPosition\n            var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n            if ( compare ) {\n              return compare;\n            }\n\n            // Calculate position if both inputs belong to the same document\n            // Support: IE 11+, Edge 17 - 18+\n            // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n            // two documents; shallow comparisons work.\n            // eslint-disable-next-line eqeqeq\n            compare = ( a.ownerDocument || a ) == ( b.ownerDocument || b ) ?\n              a.compareDocumentPosition( b ) :\n\n              // Otherwise we know they are disconnected\n              1;\n\n            // Disconnected nodes\n            if ( compare & 1 ||\n              ( !support.sortDetached && b.compareDocumentPosition( a ) === compare ) ) {\n\n              // Choose the first element that is related to our preferred document\n              // Support: IE 11+, Edge 17 - 18+\n              // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n              // two documents; shallow comparisons work.\n              // eslint-disable-next-line eqeqeq\n              if ( a == document || a.ownerDocument == preferredDoc &&\n                contains( preferredDoc, a ) ) {\n                return -1;\n              }\n\n              // Support: IE 11+, Edge 17 - 18+\n              // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n              // two documents; shallow comparisons work.\n              // eslint-disable-next-line eqeqeq\n              if ( b == document || b.ownerDocument == preferredDoc &&\n                contains( preferredDoc, b ) ) {\n                return 1;\n              }\n\n              // Maintain original order\n              return sortInput ?\n                ( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n                0;\n            }\n\n            return compare & 4 ? -1 : 1;\n          } :\n          function( a, b ) {\n\n            // Exit early if the nodes are identical\n            if ( a === b ) {\n              hasDuplicate = true;\n              return 0;\n            }\n\n            var cur,\n              i = 0,\n              aup = a.parentNode,\n              bup = b.parentNode,\n              ap = [ a ],\n              bp = [ b ];\n\n            // Parentless nodes are either documents or disconnected\n            if ( !aup || !bup ) {\n\n              // Support: IE 11+, Edge 17 - 18+\n              // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n              // two documents; shallow comparisons work.\n              /* eslint-disable eqeqeq */\n              return a == document ? -1 :\n                b == document ? 1 :\n                  /* eslint-enable eqeqeq */\n                  aup ? -1 :\n                    bup ? 1 :\n                      sortInput ?\n                        ( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n                        0;\n\n              // If the nodes are siblings, we can do a quick check\n            } else if ( aup === bup ) {\n              return siblingCheck( a, b );\n            }\n\n            // Otherwise we need full lists of their ancestors for comparison\n            cur = a;\n            while ( ( cur = cur.parentNode ) ) {\n              ap.unshift( cur );\n            }\n            cur = b;\n            while ( ( cur = cur.parentNode ) ) {\n              bp.unshift( cur );\n            }\n\n            // Walk down the tree looking for a discrepancy\n            while ( ap[ i ] === bp[ i ] ) {\n              i++;\n            }\n\n            return i ?\n\n              // Do a sibling check if the nodes have a common ancestor\n              siblingCheck( ap[ i ], bp[ i ] ) :\n\n              // Otherwise nodes in our document sort first\n              // Support: IE 11+, Edge 17 - 18+\n              // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n              // two documents; shallow comparisons work.\n              /* eslint-disable eqeqeq */\n              ap[ i ] == preferredDoc ? -1 :\n                bp[ i ] == preferredDoc ? 1 :\n                  /* eslint-enable eqeqeq */\n                  0;\n          };\n\n        return document;\n      };\n\n      Sizzle.matches = function( expr, elements ) {\n        return Sizzle( expr, null, null, elements );\n      };\n\n      Sizzle.matchesSelector = function( elem, expr ) {\n        setDocument( elem );\n\n        if ( support.matchesSelector && documentIsHTML &&\n          !nonnativeSelectorCache[ expr + \" \" ] &&\n          ( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\n          ( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\n\n          try {\n            var ret = matches.call( elem, expr );\n\n            // IE 9's matchesSelector returns false on disconnected nodes\n            if ( ret || support.disconnectedMatch ||\n\n              // As well, disconnected nodes are said to be in a document\n              // fragment in IE 9\n              elem.document && elem.document.nodeType !== 11 ) {\n              return ret;\n            }\n          } catch ( e ) {\n            nonnativeSelectorCache( expr, true );\n          }\n        }\n\n        return Sizzle( expr, document, null, [ elem ] ).length > 0;\n      };\n\n      Sizzle.contains = function( context, elem ) {\n\n        // Set document vars if needed\n        // Support: IE 11+, Edge 17 - 18+\n        // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n        // two documents; shallow comparisons work.\n        // eslint-disable-next-line eqeqeq\n        if ( ( context.ownerDocument || context ) != document ) {\n          setDocument( context );\n        }\n        return contains( context, elem );\n      };\n\n      Sizzle.attr = function( elem, name ) {\n\n        // Set document vars if needed\n        // Support: IE 11+, Edge 17 - 18+\n        // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n        // two documents; shallow comparisons work.\n        // eslint-disable-next-line eqeqeq\n        if ( ( elem.ownerDocument || elem ) != document ) {\n          setDocument( elem );\n        }\n\n        var fn = Expr.attrHandle[ name.toLowerCase() ],\n\n          // Don't get fooled by Object.prototype properties (jQuery #13807)\n          val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\n            fn( elem, name, !documentIsHTML ) :\n            undefined;\n\n        return val !== undefined ?\n          val :\n          support.attributes || !documentIsHTML ?\n            elem.getAttribute( name ) :\n            ( val = elem.getAttributeNode( name ) ) && val.specified ?\n              val.value :\n              null;\n      };\n\n      Sizzle.escape = function( sel ) {\n        return ( sel + \"\" ).replace( rcssescape, fcssescape );\n      };\n\n      Sizzle.error = function( msg ) {\n        throw new Error( \"Syntax error, unrecognized expression: \" + msg );\n      };\n\n      /**\n       * Document sorting and removing duplicates\n       * @param {ArrayLike} results\n       */\n      Sizzle.uniqueSort = function( results ) {\n        var elem,\n          duplicates = [],\n          j = 0,\n          i = 0;\n\n        // Unless we *know* we can detect duplicates, assume their presence\n        hasDuplicate = !support.detectDuplicates;\n        sortInput = !support.sortStable && results.slice( 0 );\n        results.sort( sortOrder );\n\n        if ( hasDuplicate ) {\n          while ( ( elem = results[ i++ ] ) ) {\n            if ( elem === results[ i ] ) {\n              j = duplicates.push( i );\n            }\n          }\n          while ( j-- ) {\n            results.splice( duplicates[ j ], 1 );\n          }\n        }\n\n        // Clear input after sorting to release objects\n        // See https://github.com/jquery/sizzle/pull/225\n        sortInput = null;\n\n        return results;\n      };\n\n      /**\n       * Utility function for retrieving the text value of an array of DOM nodes\n       * @param {Array|Element} elem\n       */\n      getText = Sizzle.getText = function( elem ) {\n        var node,\n          ret = \"\",\n          i = 0,\n          nodeType = elem.nodeType;\n\n        if ( !nodeType ) {\n\n          // If no nodeType, this is expected to be an array\n          while ( ( node = elem[ i++ ] ) ) {\n\n            // Do not traverse comment nodes\n            ret += getText( node );\n          }\n        } else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\n          // Use textContent for elements\n          // innerText usage removed for consistency of new lines (jQuery #11153)\n          if ( typeof elem.textContent === \"string\" ) {\n            return elem.textContent;\n          } else {\n\n            // Traverse its children\n            for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n              ret += getText( elem );\n            }\n          }\n        } else if ( nodeType === 3 || nodeType === 4 ) {\n          return elem.nodeValue;\n        }\n\n        // Do not include comment or processing instruction nodes\n\n        return ret;\n      };\n\n      Expr = Sizzle.selectors = {\n\n        // Can be adjusted by the user\n        cacheLength: 50,\n\n        createPseudo: markFunction,\n\n        match: matchExpr,\n\n        attrHandle: {},\n\n        find: {},\n\n        relative: {\n          \">\": { dir: \"parentNode\", first: true },\n          \" \": { dir: \"parentNode\" },\n          \"+\": { dir: \"previousSibling\", first: true },\n          \"~\": { dir: \"previousSibling\" }\n        },\n\n        preFilter: {\n          \"ATTR\": function( match ) {\n            match[ 1 ] = match[ 1 ].replace( runescape, funescape );\n\n            // Move the given value to match[3] whether quoted or unquoted\n            match[ 3 ] = ( match[ 3 ] || match[ 4 ] ||\n              match[ 5 ] || \"\" ).replace( runescape, funescape );\n\n            if ( match[ 2 ] === \"~=\" ) {\n              match[ 3 ] = \" \" + match[ 3 ] + \" \";\n            }\n\n            return match.slice( 0, 4 );\n          },\n\n          \"CHILD\": function( match ) {\n\n            /* matches from matchExpr[\"CHILD\"]\n\t\t\t\t1 type (only|nth|...)\n\t\t\t\t2 what (child|of-type)\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n\t\t\t\t5 sign of xn-component\n\t\t\t\t6 x of xn-component\n\t\t\t\t7 sign of y-component\n\t\t\t\t8 y of y-component\n\t\t\t*/\n            match[ 1 ] = match[ 1 ].toLowerCase();\n\n            if ( match[ 1 ].slice( 0, 3 ) === \"nth\" ) {\n\n              // nth-* requires argument\n              if ( !match[ 3 ] ) {\n                Sizzle.error( match[ 0 ] );\n              }\n\n              // numeric x and y parameters for Expr.filter.CHILD\n              // remember that false/true cast respectively to 0/1\n              match[ 4 ] = +( match[ 4 ] ?\n                match[ 5 ] + ( match[ 6 ] || 1 ) :\n                2 * ( match[ 3 ] === \"even\" || match[ 3 ] === \"odd\" ) );\n              match[ 5 ] = +( ( match[ 7 ] + match[ 8 ] ) || match[ 3 ] === \"odd\" );\n\n              // other types prohibit arguments\n            } else if ( match[ 3 ] ) {\n              Sizzle.error( match[ 0 ] );\n            }\n\n            return match;\n          },\n\n          \"PSEUDO\": function( match ) {\n            var excess,\n              unquoted = !match[ 6 ] && match[ 2 ];\n\n            if ( matchExpr[ \"CHILD\" ].test( match[ 0 ] ) ) {\n              return null;\n            }\n\n            // Accept quoted arguments as-is\n            if ( match[ 3 ] ) {\n              match[ 2 ] = match[ 4 ] || match[ 5 ] || \"\";\n\n              // Strip excess characters from unquoted arguments\n            } else if ( unquoted && rpseudo.test( unquoted ) &&\n\n              // Get excess from tokenize (recursively)\n              ( excess = tokenize( unquoted, true ) ) &&\n\n              // advance to the next closing parenthesis\n              ( excess = unquoted.indexOf( \")\", unquoted.length - excess ) - unquoted.length ) ) {\n\n              // excess is a negative index\n              match[ 0 ] = match[ 0 ].slice( 0, excess );\n              match[ 2 ] = unquoted.slice( 0, excess );\n            }\n\n            // Return only captures needed by the pseudo filter method (type and argument)\n            return match.slice( 0, 3 );\n          }\n        },\n\n        filter: {\n\n          \"TAG\": function( nodeNameSelector ) {\n            var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\n            return nodeNameSelector === \"*\" ?\n              function() {\n                return true;\n              } :\n              function( elem ) {\n                return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n              };\n          },\n\n          \"CLASS\": function( className ) {\n            var pattern = classCache[ className + \" \" ];\n\n            return pattern ||\n              ( pattern = new RegExp( \"(^|\" + whitespace +\n                \")\" + className + \"(\" + whitespace + \"|$)\" ) ) && classCache(\n                className, function( elem ) {\n                  return pattern.test(\n                    typeof elem.className === \"string\" && elem.className ||\n                    typeof elem.getAttribute !== \"undefined\" &&\n                    elem.getAttribute( \"class\" ) ||\n                    \"\"\n                  );\n                } );\n          },\n\n          \"ATTR\": function( name, operator, check ) {\n            return function( elem ) {\n              var result = Sizzle.attr( elem, name );\n\n              if ( result == null ) {\n                return operator === \"!=\";\n              }\n              if ( !operator ) {\n                return true;\n              }\n\n              result += \"\";\n\n              /* eslint-disable max-len */\n\n              return operator === \"=\" ? result === check :\n                operator === \"!=\" ? result !== check :\n                  operator === \"^=\" ? check && result.indexOf( check ) === 0 :\n                    operator === \"*=\" ? check && result.indexOf( check ) > -1 :\n                      operator === \"$=\" ? check && result.slice( -check.length ) === check :\n                        operator === \"~=\" ? ( \" \" + result.replace( rwhitespace, \" \" ) + \" \" ).indexOf( check ) > -1 :\n                          operator === \"|=\" ? result === check || result.slice( 0, check.length + 1 ) === check + \"-\" :\n                            false;\n              /* eslint-enable max-len */\n\n            };\n          },\n\n          \"CHILD\": function( type, what, _argument, first, last ) {\n            var simple = type.slice( 0, 3 ) !== \"nth\",\n              forward = type.slice( -4 ) !== \"last\",\n              ofType = what === \"of-type\";\n\n            return first === 1 && last === 0 ?\n\n              // Shortcut for :nth-*(n)\n              function( elem ) {\n                return !!elem.parentNode;\n              } :\n\n              function( elem, _context, xml ) {\n                var cache, uniqueCache, outerCache, node, nodeIndex, start,\n                  dir = simple !== forward ? \"nextSibling\" : \"previousSibling\",\n                  parent = elem.parentNode,\n                  name = ofType && elem.nodeName.toLowerCase(),\n                  useCache = !xml && !ofType,\n                  diff = false;\n\n                if ( parent ) {\n\n                  // :(first|last|only)-(child|of-type)\n                  if ( simple ) {\n                    while ( dir ) {\n                      node = elem;\n                      while ( ( node = node[ dir ] ) ) {\n                        if ( ofType ?\n                          node.nodeName.toLowerCase() === name :\n                          node.nodeType === 1 ) {\n\n                          return false;\n                        }\n                      }\n\n                      // Reverse direction for :only-* (if we haven't yet done so)\n                      start = dir = type === \"only\" && !start && \"nextSibling\";\n                    }\n                    return true;\n                  }\n\n                  start = [ forward ? parent.firstChild : parent.lastChild ];\n\n                  // non-xml :nth-child(...) stores cache data on `parent`\n                  if ( forward && useCache ) {\n\n                    // Seek `elem` from a previously-cached index\n\n                    // ...in a gzip-friendly way\n                    node = parent;\n                    outerCache = node[ expando ] || ( node[ expando ] = {} );\n\n                    // Support: IE <9 only\n                    // Defend against cloned attroperties (jQuery gh-1709)\n                    uniqueCache = outerCache[ node.uniqueID ] ||\n                      ( outerCache[ node.uniqueID ] = {} );\n\n                    cache = uniqueCache[ type ] || [];\n                    nodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];\n                    diff = nodeIndex && cache[ 2 ];\n                    node = nodeIndex && parent.childNodes[ nodeIndex ];\n\n                    while ( ( node = ++nodeIndex && node && node[ dir ] ||\n\n                      // Fallback to seeking `elem` from the start\n                      ( diff = nodeIndex = 0 ) || start.pop() ) ) {\n\n                      // When found, cache indexes on `parent` and break\n                      if ( node.nodeType === 1 && ++diff && node === elem ) {\n                        uniqueCache[ type ] = [ dirruns, nodeIndex, diff ];\n                        break;\n                      }\n                    }\n\n                  } else {\n\n                    // Use previously-cached element index if available\n                    if ( useCache ) {\n\n                      // ...in a gzip-friendly way\n                      node = elem;\n                      outerCache = node[ expando ] || ( node[ expando ] = {} );\n\n                      // Support: IE <9 only\n                      // Defend against cloned attroperties (jQuery gh-1709)\n                      uniqueCache = outerCache[ node.uniqueID ] ||\n                        ( outerCache[ node.uniqueID ] = {} );\n\n                      cache = uniqueCache[ type ] || [];\n                      nodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];\n                      diff = nodeIndex;\n                    }\n\n                    // xml :nth-child(...)\n                    // or :nth-last-child(...) or :nth(-last)?-of-type(...)\n                    if ( diff === false ) {\n\n                      // Use the same loop as above to seek `elem` from the start\n                      while ( ( node = ++nodeIndex && node && node[ dir ] ||\n                        ( diff = nodeIndex = 0 ) || start.pop() ) ) {\n\n                        if ( ( ofType ?\n                            node.nodeName.toLowerCase() === name :\n                            node.nodeType === 1 ) &&\n                          ++diff ) {\n\n                          // Cache the index of each encountered element\n                          if ( useCache ) {\n                            outerCache = node[ expando ] ||\n                              ( node[ expando ] = {} );\n\n                            // Support: IE <9 only\n                            // Defend against cloned attroperties (jQuery gh-1709)\n                            uniqueCache = outerCache[ node.uniqueID ] ||\n                              ( outerCache[ node.uniqueID ] = {} );\n\n                            uniqueCache[ type ] = [ dirruns, diff ];\n                          }\n\n                          if ( node === elem ) {\n                            break;\n                          }\n                        }\n                      }\n                    }\n                  }\n\n                  // Incorporate the offset, then check against cycle size\n                  diff -= last;\n                  return diff === first || ( diff % first === 0 && diff / first >= 0 );\n                }\n              };\n          },\n\n          \"PSEUDO\": function( pseudo, argument ) {\n\n            // pseudo-class names are case-insensitive\n            // http://www.w3.org/TR/selectors/#pseudo-classes\n            // Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n            // Remember that setFilters inherits from pseudos\n            var args,\n              fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n                Sizzle.error( \"unsupported pseudo: \" + pseudo );\n\n            // The user may use createPseudo to indicate that\n            // arguments are needed to create the filter function\n            // just as Sizzle does\n            if ( fn[ expando ] ) {\n              return fn( argument );\n            }\n\n            // But maintain support for old signatures\n            if ( fn.length > 1 ) {\n              args = [ pseudo, pseudo, \"\", argument ];\n              return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n                markFunction( function( seed, matches ) {\n                  var idx,\n                    matched = fn( seed, argument ),\n                    i = matched.length;\n                  while ( i-- ) {\n                    idx = indexOf( seed, matched[ i ] );\n                    seed[ idx ] = !( matches[ idx ] = matched[ i ] );\n                  }\n                } ) :\n                function( elem ) {\n                  return fn( elem, 0, args );\n                };\n            }\n\n            return fn;\n          }\n        },\n\n        pseudos: {\n\n          // Potentially complex pseudos\n          \"not\": markFunction( function( selector ) {\n\n            // Trim the selector passed to compile\n            // to avoid treating leading and trailing\n            // spaces as combinators\n            var input = [],\n              results = [],\n              matcher = compile( selector.replace( rtrim, \"$1\" ) );\n\n            return matcher[ expando ] ?\n              markFunction( function( seed, matches, _context, xml ) {\n                var elem,\n                  unmatched = matcher( seed, null, xml, [] ),\n                  i = seed.length;\n\n                // Match elements unmatched by `matcher`\n                while ( i-- ) {\n                  if ( ( elem = unmatched[ i ] ) ) {\n                    seed[ i ] = !( matches[ i ] = elem );\n                  }\n                }\n              } ) :\n              function( elem, _context, xml ) {\n                input[ 0 ] = elem;\n                matcher( input, null, xml, results );\n\n                // Don't keep the element (issue #299)\n                input[ 0 ] = null;\n                return !results.pop();\n              };\n          } ),\n\n          \"has\": markFunction( function( selector ) {\n            return function( elem ) {\n              return Sizzle( selector, elem ).length > 0;\n            };\n          } ),\n\n          \"contains\": markFunction( function( text ) {\n            text = text.replace( runescape, funescape );\n            return function( elem ) {\n              return ( elem.textContent || getText( elem ) ).indexOf( text ) > -1;\n            };\n          } ),\n\n          // \"Whether an element is represented by a :lang() selector\n          // is based solely on the element's language value\n          // being equal to the identifier C,\n          // or beginning with the identifier C immediately followed by \"-\".\n          // The matching of C against the element's language value is performed case-insensitively.\n          // The identifier C does not have to be a valid language name.\"\n          // http://www.w3.org/TR/selectors/#lang-pseudo\n          \"lang\": markFunction( function( lang ) {\n\n            // lang value must be a valid identifier\n            if ( !ridentifier.test( lang || \"\" ) ) {\n              Sizzle.error( \"unsupported lang: \" + lang );\n            }\n            lang = lang.replace( runescape, funescape ).toLowerCase();\n            return function( elem ) {\n              var elemLang;\n              do {\n                if ( ( elemLang = documentIsHTML ?\n                  elem.lang :\n                  elem.getAttribute( \"xml:lang\" ) || elem.getAttribute( \"lang\" ) ) ) {\n\n                  elemLang = elemLang.toLowerCase();\n                  return elemLang === lang || elemLang.indexOf( lang + \"-\" ) === 0;\n                }\n              } while ( ( elem = elem.parentNode ) && elem.nodeType === 1 );\n              return false;\n            };\n          } ),\n\n          // Miscellaneous\n          \"target\": function( elem ) {\n            var hash = window.location && window.location.hash;\n            return hash && hash.slice( 1 ) === elem.id;\n          },\n\n          \"root\": function( elem ) {\n            return elem === docElem;\n          },\n\n          \"focus\": function( elem ) {\n            return elem === document.activeElement &&\n              ( !document.hasFocus || document.hasFocus() ) &&\n              !!( elem.type || elem.href || ~elem.tabIndex );\n          },\n\n          // Boolean properties\n          \"enabled\": createDisabledPseudo( false ),\n          \"disabled\": createDisabledPseudo( true ),\n\n          \"checked\": function( elem ) {\n\n            // In CSS3, :checked should return both checked and selected elements\n            // http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n            var nodeName = elem.nodeName.toLowerCase();\n            return ( nodeName === \"input\" && !!elem.checked ) ||\n              ( nodeName === \"option\" && !!elem.selected );\n          },\n\n          \"selected\": function( elem ) {\n\n            // Accessing this property makes selected-by-default\n            // options in Safari work properly\n            if ( elem.parentNode ) {\n              // eslint-disable-next-line no-unused-expressions\n              elem.parentNode.selectedIndex;\n            }\n\n            return elem.selected === true;\n          },\n\n          // Contents\n          \"empty\": function( elem ) {\n\n            // http://www.w3.org/TR/selectors/#empty-pseudo\n            // :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),\n            //   but not by others (comment: 8; processing instruction: 7; etc.)\n            // nodeType < 6 works because attributes (2) do not appear as children\n            for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n              if ( elem.nodeType < 6 ) {\n                return false;\n              }\n            }\n            return true;\n          },\n\n          \"parent\": function( elem ) {\n            return !Expr.pseudos[ \"empty\" ]( elem );\n          },\n\n          // Element/input types\n          \"header\": function( elem ) {\n            return rheader.test( elem.nodeName );\n          },\n\n          \"input\": function( elem ) {\n            return rinputs.test( elem.nodeName );\n          },\n\n          \"button\": function( elem ) {\n            var name = elem.nodeName.toLowerCase();\n            return name === \"input\" && elem.type === \"button\" || name === \"button\";\n          },\n\n          \"text\": function( elem ) {\n            var attr;\n            return elem.nodeName.toLowerCase() === \"input\" &&\n              elem.type === \"text\" &&\n\n              // Support: IE<8\n              // New HTML5 attribute values (e.g., \"search\") appear with elem.type === \"text\"\n              ( ( attr = elem.getAttribute( \"type\" ) ) == null ||\n                attr.toLowerCase() === \"text\" );\n          },\n\n          // Position-in-collection\n          \"first\": createPositionalPseudo( function() {\n            return [ 0 ];\n          } ),\n\n          \"last\": createPositionalPseudo( function( _matchIndexes, length ) {\n            return [ length - 1 ];\n          } ),\n\n          \"eq\": createPositionalPseudo( function( _matchIndexes, length, argument ) {\n            return [ argument < 0 ? argument + length : argument ];\n          } ),\n\n          \"even\": createPositionalPseudo( function( matchIndexes, length ) {\n            var i = 0;\n            for ( ; i < length; i += 2 ) {\n              matchIndexes.push( i );\n            }\n            return matchIndexes;\n          } ),\n\n          \"odd\": createPositionalPseudo( function( matchIndexes, length ) {\n            var i = 1;\n            for ( ; i < length; i += 2 ) {\n              matchIndexes.push( i );\n            }\n            return matchIndexes;\n          } ),\n\n          \"lt\": createPositionalPseudo( function( matchIndexes, length, argument ) {\n            var i = argument < 0 ?\n              argument + length :\n              argument > length ?\n                length :\n                argument;\n            for ( ; --i >= 0; ) {\n              matchIndexes.push( i );\n            }\n            return matchIndexes;\n          } ),\n\n          \"gt\": createPositionalPseudo( function( matchIndexes, length, argument ) {\n            var i = argument < 0 ? argument + length : argument;\n            for ( ; ++i < length; ) {\n              matchIndexes.push( i );\n            }\n            return matchIndexes;\n          } )\n        }\n      };\n\n      Expr.pseudos[ \"nth\" ] = Expr.pseudos[ \"eq\" ];\n\n// Add button/input type pseudos\n      for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n        Expr.pseudos[ i ] = createInputPseudo( i );\n      }\n      for ( i in { submit: true, reset: true } ) {\n        Expr.pseudos[ i ] = createButtonPseudo( i );\n      }\n\n// Easy API for creating new setFilters\n      function setFilters() {}\n      setFilters.prototype = Expr.filters = Expr.pseudos;\n      Expr.setFilters = new setFilters();\n\n      tokenize = Sizzle.tokenize = function( selector, parseOnly ) {\n        var matched, match, tokens, type,\n          soFar, groups, preFilters,\n          cached = tokenCache[ selector + \" \" ];\n\n        if ( cached ) {\n          return parseOnly ? 0 : cached.slice( 0 );\n        }\n\n        soFar = selector;\n        groups = [];\n        preFilters = Expr.preFilter;\n\n        while ( soFar ) {\n\n          // Comma and first run\n          if ( !matched || ( match = rcomma.exec( soFar ) ) ) {\n            if ( match ) {\n\n              // Don't consume trailing commas as valid\n              soFar = soFar.slice( match[ 0 ].length ) || soFar;\n            }\n            groups.push( ( tokens = [] ) );\n          }\n\n          matched = false;\n\n          // Combinators\n          if ( ( match = rcombinators.exec( soFar ) ) ) {\n            matched = match.shift();\n            tokens.push( {\n              value: matched,\n\n              // Cast descendant combinators to space\n              type: match[ 0 ].replace( rtrim, \" \" )\n            } );\n            soFar = soFar.slice( matched.length );\n          }\n\n          // Filters\n          for ( type in Expr.filter ) {\n            if ( ( match = matchExpr[ type ].exec( soFar ) ) && ( !preFilters[ type ] ||\n              ( match = preFilters[ type ]( match ) ) ) ) {\n              matched = match.shift();\n              tokens.push( {\n                value: matched,\n                type: type,\n                matches: match\n              } );\n              soFar = soFar.slice( matched.length );\n            }\n          }\n\n          if ( !matched ) {\n            break;\n          }\n        }\n\n        // Return the length of the invalid excess\n        // if we're just parsing\n        // Otherwise, throw an error or return tokens\n        return parseOnly ?\n          soFar.length :\n          soFar ?\n            Sizzle.error( selector ) :\n\n            // Cache the tokens\n            tokenCache( selector, groups ).slice( 0 );\n      };\n\n      function toSelector( tokens ) {\n        var i = 0,\n          len = tokens.length,\n          selector = \"\";\n        for ( ; i < len; i++ ) {\n          selector += tokens[ i ].value;\n        }\n        return selector;\n      }\n\n      function addCombinator( matcher, combinator, base ) {\n        var dir = combinator.dir,\n          skip = combinator.next,\n          key = skip || dir,\n          checkNonElements = base && key === \"parentNode\",\n          doneName = done++;\n\n        return combinator.first ?\n\n          // Check against closest ancestor/preceding element\n          function( elem, context, xml ) {\n            while ( ( elem = elem[ dir ] ) ) {\n              if ( elem.nodeType === 1 || checkNonElements ) {\n                return matcher( elem, context, xml );\n              }\n            }\n            return false;\n          } :\n\n          // Check against all ancestor/preceding elements\n          function( elem, context, xml ) {\n            var oldCache, uniqueCache, outerCache,\n              newCache = [ dirruns, doneName ];\n\n            // We can't set arbitrary data on XML nodes, so they don't benefit from combinator caching\n            if ( xml ) {\n              while ( ( elem = elem[ dir ] ) ) {\n                if ( elem.nodeType === 1 || checkNonElements ) {\n                  if ( matcher( elem, context, xml ) ) {\n                    return true;\n                  }\n                }\n              }\n            } else {\n              while ( ( elem = elem[ dir ] ) ) {\n                if ( elem.nodeType === 1 || checkNonElements ) {\n                  outerCache = elem[ expando ] || ( elem[ expando ] = {} );\n\n                  // Support: IE <9 only\n                  // Defend against cloned attroperties (jQuery gh-1709)\n                  uniqueCache = outerCache[ elem.uniqueID ] ||\n                    ( outerCache[ elem.uniqueID ] = {} );\n\n                  if ( skip && skip === elem.nodeName.toLowerCase() ) {\n                    elem = elem[ dir ] || elem;\n                  } else if ( ( oldCache = uniqueCache[ key ] ) &&\n                    oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {\n\n                    // Assign to newCache so results back-propagate to previous elements\n                    return ( newCache[ 2 ] = oldCache[ 2 ] );\n                  } else {\n\n                    // Reuse newcache so results back-propagate to previous elements\n                    uniqueCache[ key ] = newCache;\n\n                    // A match means we're done; a fail means we have to keep checking\n                    if ( ( newCache[ 2 ] = matcher( elem, context, xml ) ) ) {\n                      return true;\n                    }\n                  }\n                }\n              }\n            }\n            return false;\n          };\n      }\n\n      function elementMatcher( matchers ) {\n        return matchers.length > 1 ?\n          function( elem, context, xml ) {\n            var i = matchers.length;\n            while ( i-- ) {\n              if ( !matchers[ i ]( elem, context, xml ) ) {\n                return false;\n              }\n            }\n            return true;\n          } :\n          matchers[ 0 ];\n      }\n\n      function multipleContexts( selector, contexts, results ) {\n        var i = 0,\n          len = contexts.length;\n        for ( ; i < len; i++ ) {\n          Sizzle( selector, contexts[ i ], results );\n        }\n        return results;\n      }\n\n      function condense( unmatched, map, filter, context, xml ) {\n        var elem,\n          newUnmatched = [],\n          i = 0,\n          len = unmatched.length,\n          mapped = map != null;\n\n        for ( ; i < len; i++ ) {\n          if ( ( elem = unmatched[ i ] ) ) {\n            if ( !filter || filter( elem, context, xml ) ) {\n              newUnmatched.push( elem );\n              if ( mapped ) {\n                map.push( i );\n              }\n            }\n          }\n        }\n\n        return newUnmatched;\n      }\n\n      function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n        if ( postFilter && !postFilter[ expando ] ) {\n          postFilter = setMatcher( postFilter );\n        }\n        if ( postFinder && !postFinder[ expando ] ) {\n          postFinder = setMatcher( postFinder, postSelector );\n        }\n        return markFunction( function( seed, results, context, xml ) {\n          var temp, i, elem,\n            preMap = [],\n            postMap = [],\n            preexisting = results.length,\n\n            // Get initial elements from seed or context\n            elems = seed || multipleContexts(\n              selector || \"*\",\n              context.nodeType ? [ context ] : context,\n              []\n            ),\n\n            // Prefilter to get matcher input, preserving a map for seed-results synchronization\n            matcherIn = preFilter && ( seed || !selector ) ?\n              condense( elems, preMap, preFilter, context, xml ) :\n              elems,\n\n            matcherOut = matcher ?\n\n              // If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n              postFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n\n                // ...intermediate processing is necessary\n                [] :\n\n                // ...otherwise use results directly\n                results :\n              matcherIn;\n\n          // Find primary matches\n          if ( matcher ) {\n            matcher( matcherIn, matcherOut, context, xml );\n          }\n\n          // Apply postFilter\n          if ( postFilter ) {\n            temp = condense( matcherOut, postMap );\n            postFilter( temp, [], context, xml );\n\n            // Un-match failing elements by moving them back to matcherIn\n            i = temp.length;\n            while ( i-- ) {\n              if ( ( elem = temp[ i ] ) ) {\n                matcherOut[ postMap[ i ] ] = !( matcherIn[ postMap[ i ] ] = elem );\n              }\n            }\n          }\n\n          if ( seed ) {\n            if ( postFinder || preFilter ) {\n              if ( postFinder ) {\n\n                // Get the final matcherOut by condensing this intermediate into postFinder contexts\n                temp = [];\n                i = matcherOut.length;\n                while ( i-- ) {\n                  if ( ( elem = matcherOut[ i ] ) ) {\n\n                    // Restore matcherIn since elem is not yet a final match\n                    temp.push( ( matcherIn[ i ] = elem ) );\n                  }\n                }\n                postFinder( null, ( matcherOut = [] ), temp, xml );\n              }\n\n              // Move matched elements from seed to results to keep them synchronized\n              i = matcherOut.length;\n              while ( i-- ) {\n                if ( ( elem = matcherOut[ i ] ) &&\n                  ( temp = postFinder ? indexOf( seed, elem ) : preMap[ i ] ) > -1 ) {\n\n                  seed[ temp ] = !( results[ temp ] = elem );\n                }\n              }\n            }\n\n            // Add elements to results, through postFinder if defined\n          } else {\n            matcherOut = condense(\n              matcherOut === results ?\n                matcherOut.splice( preexisting, matcherOut.length ) :\n                matcherOut\n            );\n            if ( postFinder ) {\n              postFinder( null, results, matcherOut, xml );\n            } else {\n              push.apply( results, matcherOut );\n            }\n          }\n        } );\n      }\n\n      function matcherFromTokens( tokens ) {\n        var checkContext, matcher, j,\n          len = tokens.length,\n          leadingRelative = Expr.relative[ tokens[ 0 ].type ],\n          implicitRelative = leadingRelative || Expr.relative[ \" \" ],\n          i = leadingRelative ? 1 : 0,\n\n          // The foundational matcher ensures that elements are reachable from top-level context(s)\n          matchContext = addCombinator( function( elem ) {\n            return elem === checkContext;\n          }, implicitRelative, true ),\n          matchAnyContext = addCombinator( function( elem ) {\n            return indexOf( checkContext, elem ) > -1;\n          }, implicitRelative, true ),\n          matchers = [ function( elem, context, xml ) {\n            var ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n              ( checkContext = context ).nodeType ?\n                matchContext( elem, context, xml ) :\n                matchAnyContext( elem, context, xml ) );\n\n            // Avoid hanging onto element (issue #299)\n            checkContext = null;\n            return ret;\n          } ];\n\n        for ( ; i < len; i++ ) {\n          if ( ( matcher = Expr.relative[ tokens[ i ].type ] ) ) {\n            matchers = [ addCombinator( elementMatcher( matchers ), matcher ) ];\n          } else {\n            matcher = Expr.filter[ tokens[ i ].type ].apply( null, tokens[ i ].matches );\n\n            // Return special upon seeing a positional matcher\n            if ( matcher[ expando ] ) {\n\n              // Find the next relative operator (if any) for proper handling\n              j = ++i;\n              for ( ; j < len; j++ ) {\n                if ( Expr.relative[ tokens[ j ].type ] ) {\n                  break;\n                }\n              }\n              return setMatcher(\n                i > 1 && elementMatcher( matchers ),\n                i > 1 && toSelector(\n\n                  // If the preceding token was a descendant combinator, insert an implicit any-element `*`\n                  tokens\n                    .slice( 0, i - 1 )\n                    .concat( { value: tokens[ i - 2 ].type === \" \" ? \"*\" : \"\" } )\n                ).replace( rtrim, \"$1\" ),\n                matcher,\n                i < j && matcherFromTokens( tokens.slice( i, j ) ),\n                j < len && matcherFromTokens( ( tokens = tokens.slice( j ) ) ),\n                j < len && toSelector( tokens )\n              );\n            }\n            matchers.push( matcher );\n          }\n        }\n\n        return elementMatcher( matchers );\n      }\n\n      function matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n        var bySet = setMatchers.length > 0,\n          byElement = elementMatchers.length > 0,\n          superMatcher = function( seed, context, xml, results, outermost ) {\n            var elem, j, matcher,\n              matchedCount = 0,\n              i = \"0\",\n              unmatched = seed && [],\n              setMatched = [],\n              contextBackup = outermostContext,\n\n              // We must always have either seed elements or outermost context\n              elems = seed || byElement && Expr.find[ \"TAG\" ]( \"*\", outermost ),\n\n              // Use integer dirruns iff this is the outermost matcher\n              dirrunsUnique = ( dirruns += contextBackup == null ? 1 : Math.random() || 0.1 ),\n              len = elems.length;\n\n            if ( outermost ) {\n\n              // Support: IE 11+, Edge 17 - 18+\n              // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n              // two documents; shallow comparisons work.\n              // eslint-disable-next-line eqeqeq\n              outermostContext = context == document || context || outermost;\n            }\n\n            // Add elements passing elementMatchers directly to results\n            // Support: IE<9, Safari\n            // Tolerate NodeList properties (IE: \"length\"; Safari: <number>) matching elements by id\n            for ( ; i !== len && ( elem = elems[ i ] ) != null; i++ ) {\n              if ( byElement && elem ) {\n                j = 0;\n\n                // Support: IE 11+, Edge 17 - 18+\n                // IE/Edge sometimes throw a \"Permission denied\" error when strict-comparing\n                // two documents; shallow comparisons work.\n                // eslint-disable-next-line eqeqeq\n                if ( !context && elem.ownerDocument != document ) {\n                  setDocument( elem );\n                  xml = !documentIsHTML;\n                }\n                while ( ( matcher = elementMatchers[ j++ ] ) ) {\n                  if ( matcher( elem, context || document, xml ) ) {\n                    results.push( elem );\n                    break;\n                  }\n                }\n                if ( outermost ) {\n                  dirruns = dirrunsUnique;\n                }\n              }\n\n              // Track unmatched elements for set filters\n              if ( bySet ) {\n\n                // They will have gone through all possible matchers\n                if ( ( elem = !matcher && elem ) ) {\n                  matchedCount--;\n                }\n\n                // Lengthen the array for every element, matched or not\n                if ( seed ) {\n                  unmatched.push( elem );\n                }\n              }\n            }\n\n            // `i` is now the count of elements visited above, and adding it to `matchedCount`\n            // makes the latter nonnegative.\n            matchedCount += i;\n\n            // Apply set filters to unmatched elements\n            // NOTE: This can be skipped if there are no unmatched elements (i.e., `matchedCount`\n            // equals `i`), unless we didn't visit _any_ elements in the above loop because we have\n            // no element matchers and no seed.\n            // Incrementing an initially-string \"0\" `i` allows `i` to remain a string only in that\n            // case, which will result in a \"00\" `matchedCount` that differs from `i` but is also\n            // numerically zero.\n            if ( bySet && i !== matchedCount ) {\n              j = 0;\n              while ( ( matcher = setMatchers[ j++ ] ) ) {\n                matcher( unmatched, setMatched, context, xml );\n              }\n\n              if ( seed ) {\n\n                // Reintegrate element matches to eliminate the need for sorting\n                if ( matchedCount > 0 ) {\n                  while ( i-- ) {\n                    if ( !( unmatched[ i ] || setMatched[ i ] ) ) {\n                      setMatched[ i ] = pop.call( results );\n                    }\n                  }\n                }\n\n                // Discard index placeholder values to get only actual matches\n                setMatched = condense( setMatched );\n              }\n\n              // Add matches to results\n              push.apply( results, setMatched );\n\n              // Seedless set matches succeeding multiple successful matchers stipulate sorting\n              if ( outermost && !seed && setMatched.length > 0 &&\n                ( matchedCount + setMatchers.length ) > 1 ) {\n\n                Sizzle.uniqueSort( results );\n              }\n            }\n\n            // Override manipulation of globals by nested matchers\n            if ( outermost ) {\n              dirruns = dirrunsUnique;\n              outermostContext = contextBackup;\n            }\n\n            return unmatched;\n          };\n\n        return bySet ?\n          markFunction( superMatcher ) :\n          superMatcher;\n      }\n\n      compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {\n        var i,\n          setMatchers = [],\n          elementMatchers = [],\n          cached = compilerCache[ selector + \" \" ];\n\n        if ( !cached ) {\n\n          // Generate a function of recursive functions that can be used to check each element\n          if ( !match ) {\n            match = tokenize( selector );\n          }\n          i = match.length;\n          while ( i-- ) {\n            cached = matcherFromTokens( match[ i ] );\n            if ( cached[ expando ] ) {\n              setMatchers.push( cached );\n            } else {\n              elementMatchers.push( cached );\n            }\n          }\n\n          // Cache the compiled function\n          cached = compilerCache(\n            selector,\n            matcherFromGroupMatchers( elementMatchers, setMatchers )\n          );\n\n          // Save selector and tokenization\n          cached.selector = selector;\n        }\n        return cached;\n      };\n\n      /**\n       * A low-level selection function that works with Sizzle's compiled\n       *  selector functions\n       * @param {String|Function} selector A selector or a pre-compiled\n       *  selector function built with Sizzle.compile\n       * @param {Element} context\n       * @param {Array} [results]\n       * @param {Array} [seed] A set of elements to match against\n       */\n      select = Sizzle.select = function( selector, context, results, seed ) {\n        var i, tokens, token, type, find,\n          compiled = typeof selector === \"function\" && selector,\n          match = !seed && tokenize( ( selector = compiled.selector || selector ) );\n\n        results = results || [];\n\n        // Try to minimize operations if there is only one selector in the list and no seed\n        // (the latter of which guarantees us context)\n        if ( match.length === 1 ) {\n\n          // Reduce context if the leading compound selector is an ID\n          tokens = match[ 0 ] = match[ 0 ].slice( 0 );\n          if ( tokens.length > 2 && ( token = tokens[ 0 ] ).type === \"ID\" &&\n            context.nodeType === 9 && documentIsHTML && Expr.relative[ tokens[ 1 ].type ] ) {\n\n            context = ( Expr.find[ \"ID\" ]( token.matches[ 0 ]\n              .replace( runescape, funescape ), context ) || [] )[ 0 ];\n            if ( !context ) {\n              return results;\n\n              // Precompiled matchers will still verify ancestry, so step up a level\n            } else if ( compiled ) {\n              context = context.parentNode;\n            }\n\n            selector = selector.slice( tokens.shift().value.length );\n          }\n\n          // Fetch a seed set for right-to-left matching\n          i = matchExpr[ \"needsContext\" ].test( selector ) ? 0 : tokens.length;\n          while ( i-- ) {\n            token = tokens[ i ];\n\n            // Abort if we hit a combinator\n            if ( Expr.relative[ ( type = token.type ) ] ) {\n              break;\n            }\n            if ( ( find = Expr.find[ type ] ) ) {\n\n              // Search, expanding context for leading sibling combinators\n              if ( ( seed = find(\n                token.matches[ 0 ].replace( runescape, funescape ),\n                rsibling.test( tokens[ 0 ].type ) && testContext( context.parentNode ) ||\n                context\n              ) ) ) {\n\n                // If seed is empty or no tokens remain, we can return early\n                tokens.splice( i, 1 );\n                selector = seed.length && toSelector( tokens );\n                if ( !selector ) {\n                  push.apply( results, seed );\n                  return results;\n                }\n\n                break;\n              }\n            }\n          }\n        }\n\n        // Compile and execute a filtering function if one is not provided\n        // Provide `match` to avoid retokenization if we modified the selector above\n        ( compiled || compile( selector, match ) )(\n          seed,\n          context,\n          !documentIsHTML,\n          results,\n          !context || rsibling.test( selector ) && testContext( context.parentNode ) || context\n        );\n        return results;\n      };\n\n// One-time assignments\n\n// Sort stability\n      support.sortStable = expando.split( \"\" ).sort( sortOrder ).join( \"\" ) === expando;\n\n// Support: Chrome 14-35+\n// Always assume duplicates if they aren't passed to the comparison function\n      support.detectDuplicates = !!hasDuplicate;\n\n// Initialize against the default document\n      setDocument();\n\n// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\n// Detached nodes confoundingly follow *each other*\n      support.sortDetached = assert( function( el ) {\n\n        // Should return 1, but returns 4 (following)\n        return el.compareDocumentPosition( document.createElement( \"fieldset\" ) ) & 1;\n      } );\n\n// Support: IE<8\n// Prevent attribute/property \"interpolation\"\n// https://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\n      if ( !assert( function( el ) {\n        el.innerHTML = \"<a href='#'></a>\";\n        return el.firstChild.getAttribute( \"href\" ) === \"#\";\n      } ) ) {\n        addHandle( \"type|href|height|width\", function( elem, name, isXML ) {\n          if ( !isXML ) {\n            return elem.getAttribute( name, name.toLowerCase() === \"type\" ? 1 : 2 );\n          }\n        } );\n      }\n\n// Support: IE<9\n// Use defaultValue in place of getAttribute(\"value\")\n      if ( !support.attributes || !assert( function( el ) {\n        el.innerHTML = \"<input/>\";\n        el.firstChild.setAttribute( \"value\", \"\" );\n        return el.firstChild.getAttribute( \"value\" ) === \"\";\n      } ) ) {\n        addHandle( \"value\", function( elem, _name, isXML ) {\n          if ( !isXML && elem.nodeName.toLowerCase() === \"input\" ) {\n            return elem.defaultValue;\n          }\n        } );\n      }\n\n// Support: IE<9\n// Use getAttributeNode to fetch booleans when getAttribute lies\n      if ( !assert( function( el ) {\n        return el.getAttribute( \"disabled\" ) == null;\n      } ) ) {\n        addHandle( booleans, function( elem, name, isXML ) {\n          var val;\n          if ( !isXML ) {\n            return elem[ name ] === true ? name.toLowerCase() :\n              ( val = elem.getAttributeNode( name ) ) && val.specified ?\n                val.value :\n                null;\n          }\n        } );\n      }\n\n      return Sizzle;\n\n    } )( window );\n\n\n\n  jQuery.find = Sizzle;\n  jQuery.expr = Sizzle.selectors;\n\n// Deprecated\n  jQuery.expr[ \":\" ] = jQuery.expr.pseudos;\n  jQuery.uniqueSort = jQuery.unique = Sizzle.uniqueSort;\n  jQuery.text = Sizzle.getText;\n  jQuery.isXMLDoc = Sizzle.isXML;\n  jQuery.contains = Sizzle.contains;\n  jQuery.escapeSelector = Sizzle.escape;\n\n\n\n\n  var dir = function( elem, dir, until ) {\n    var matched = [],\n      truncate = until !== undefined;\n\n    while ( ( elem = elem[ dir ] ) && elem.nodeType !== 9 ) {\n      if ( elem.nodeType === 1 ) {\n        if ( truncate && jQuery( elem ).is( until ) ) {\n          break;\n        }\n        matched.push( elem );\n      }\n    }\n    return matched;\n  };\n\n\n  var siblings = function( n, elem ) {\n    var matched = [];\n\n    for ( ; n; n = n.nextSibling ) {\n      if ( n.nodeType === 1 && n !== elem ) {\n        matched.push( n );\n      }\n    }\n\n    return matched;\n  };\n\n\n  var rneedsContext = jQuery.expr.match.needsContext;\n\n\n\n  function nodeName( elem, name ) {\n\n    return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\n\n  };\n  var rsingleTag = ( /^<([a-z][^\\/\\0>:\\x20\\t\\r\\n\\f]*)[\\x20\\t\\r\\n\\f]*\\/?>(?:<\\/\\1>|)$/i );\n\n\n\n// Implement the identical functionality for filter and not\n  function winnow( elements, qualifier, not ) {\n    if ( isFunction( qualifier ) ) {\n      return jQuery.grep( elements, function( elem, i ) {\n        return !!qualifier.call( elem, i, elem ) !== not;\n      } );\n    }\n\n    // Single element\n    if ( qualifier.nodeType ) {\n      return jQuery.grep( elements, function( elem ) {\n        return ( elem === qualifier ) !== not;\n      } );\n    }\n\n    // Arraylike of elements (jQuery, arguments, Array)\n    if ( typeof qualifier !== \"string\" ) {\n      return jQuery.grep( elements, function( elem ) {\n        return ( indexOf.call( qualifier, elem ) > -1 ) !== not;\n      } );\n    }\n\n    // Filtered directly for both simple and complex selectors\n    return jQuery.filter( qualifier, elements, not );\n  }\n\n  jQuery.filter = function( expr, elems, not ) {\n    var elem = elems[ 0 ];\n\n    if ( not ) {\n      expr = \":not(\" + expr + \")\";\n    }\n\n    if ( elems.length === 1 && elem.nodeType === 1 ) {\n      return jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [];\n    }\n\n    return jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {\n      return elem.nodeType === 1;\n    } ) );\n  };\n\n  jQuery.fn.extend( {\n    find: function( selector ) {\n      var i, ret,\n        len = this.length,\n        self = this;\n\n      if ( typeof selector !== \"string\" ) {\n        return this.pushStack( jQuery( selector ).filter( function() {\n          for ( i = 0; i < len; i++ ) {\n            if ( jQuery.contains( self[ i ], this ) ) {\n              return true;\n            }\n          }\n        } ) );\n      }\n\n      ret = this.pushStack( [] );\n\n      for ( i = 0; i < len; i++ ) {\n        jQuery.find( selector, self[ i ], ret );\n      }\n\n      return len > 1 ? jQuery.uniqueSort( ret ) : ret;\n    },\n    filter: function( selector ) {\n      return this.pushStack( winnow( this, selector || [], false ) );\n    },\n    not: function( selector ) {\n      return this.pushStack( winnow( this, selector || [], true ) );\n    },\n    is: function( selector ) {\n      return !!winnow(\n        this,\n\n        // If this is a positional/relative selector, check membership in the returned set\n        // so $(\"p:first\").is(\"p:last\") won't return true for a doc with two \"p\".\n        typeof selector === \"string\" && rneedsContext.test( selector ) ?\n          jQuery( selector ) :\n          selector || [],\n        false\n      ).length;\n    }\n  } );\n\n\n// Initialize a jQuery object\n\n\n// A central reference to the root jQuery(document)\n  var rootjQuery,\n\n    // A simple way to check for HTML strings\n    // Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n    // Strict HTML recognition (#11290: must start with <)\n    // Shortcut simple #id case for speed\n    rquickExpr = /^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]+))$/,\n\n    init = jQuery.fn.init = function( selector, context, root ) {\n      var match, elem;\n\n      // HANDLE: $(\"\"), $(null), $(undefined), $(false)\n      if ( !selector ) {\n        return this;\n      }\n\n      // Method init() accepts an alternate rootjQuery\n      // so migrate can support jQuery.sub (gh-2101)\n      root = root || rootjQuery;\n\n      // Handle HTML strings\n      if ( typeof selector === \"string\" ) {\n        if ( selector[ 0 ] === \"<\" &&\n          selector[ selector.length - 1 ] === \">\" &&\n          selector.length >= 3 ) {\n\n          // Assume that strings that start and end with <> are HTML and skip the regex check\n          match = [ null, selector, null ];\n\n        } else {\n          match = rquickExpr.exec( selector );\n        }\n\n        // Match html or make sure no context is specified for #id\n        if ( match && ( match[ 1 ] || !context ) ) {\n\n          // HANDLE: $(html) -> $(array)\n          if ( match[ 1 ] ) {\n            context = context instanceof jQuery ? context[ 0 ] : context;\n\n            // Option to run scripts is true for back-compat\n            // Intentionally let the error be thrown if parseHTML is not present\n            jQuery.merge( this, jQuery.parseHTML(\n              match[ 1 ],\n              context && context.nodeType ? context.ownerDocument || context : document,\n              true\n            ) );\n\n            // HANDLE: $(html, props)\n            if ( rsingleTag.test( match[ 1 ] ) && jQuery.isPlainObject( context ) ) {\n              for ( match in context ) {\n\n                // Properties of context are called as methods if possible\n                if ( isFunction( this[ match ] ) ) {\n                  this[ match ]( context[ match ] );\n\n                  // ...and otherwise set as attributes\n                } else {\n                  this.attr( match, context[ match ] );\n                }\n              }\n            }\n\n            return this;\n\n            // HANDLE: $(#id)\n          } else {\n            elem = document.getElementById( match[ 2 ] );\n\n            if ( elem ) {\n\n              // Inject the element directly into the jQuery object\n              this[ 0 ] = elem;\n              this.length = 1;\n            }\n            return this;\n          }\n\n          // HANDLE: $(expr, $(...))\n        } else if ( !context || context.jquery ) {\n          return ( context || root ).find( selector );\n\n          // HANDLE: $(expr, context)\n          // (which is just equivalent to: $(context).find(expr)\n        } else {\n          return this.constructor( context ).find( selector );\n        }\n\n        // HANDLE: $(DOMElement)\n      } else if ( selector.nodeType ) {\n        this[ 0 ] = selector;\n        this.length = 1;\n        return this;\n\n        // HANDLE: $(function)\n        // Shortcut for document ready\n      } else if ( isFunction( selector ) ) {\n        return root.ready !== undefined ?\n          root.ready( selector ) :\n\n          // Execute immediately if ready is not present\n          selector( jQuery );\n      }\n\n      return jQuery.makeArray( selector, this );\n    };\n\n// Give the init function the jQuery prototype for later instantiation\n  init.prototype = jQuery.fn;\n\n// Initialize central reference\n  rootjQuery = jQuery( document );\n\n\n  var rparentsprev = /^(?:parents|prev(?:Until|All))/,\n\n    // Methods guaranteed to produce a unique set when starting from a unique set\n    guaranteedUnique = {\n      children: true,\n      contents: true,\n      next: true,\n      prev: true\n    };\n\n  jQuery.fn.extend( {\n    has: function( target ) {\n      var targets = jQuery( target, this ),\n        l = targets.length;\n\n      return this.filter( function() {\n        var i = 0;\n        for ( ; i < l; i++ ) {\n          if ( jQuery.contains( this, targets[ i ] ) ) {\n            return true;\n          }\n        }\n      } );\n    },\n\n    closest: function( selectors, context ) {\n      var cur,\n        i = 0,\n        l = this.length,\n        matched = [],\n        targets = typeof selectors !== \"string\" && jQuery( selectors );\n\n      // Positional selectors never match, since there's no _selection_ context\n      if ( !rneedsContext.test( selectors ) ) {\n        for ( ; i < l; i++ ) {\n          for ( cur = this[ i ]; cur && cur !== context; cur = cur.parentNode ) {\n\n            // Always skip document fragments\n            if ( cur.nodeType < 11 && ( targets ?\n              targets.index( cur ) > -1 :\n\n              // Don't pass non-elements to Sizzle\n              cur.nodeType === 1 &&\n              jQuery.find.matchesSelector( cur, selectors ) ) ) {\n\n              matched.push( cur );\n              break;\n            }\n          }\n        }\n      }\n\n      return this.pushStack( matched.length > 1 ? jQuery.uniqueSort( matched ) : matched );\n    },\n\n    // Determine the position of an element within the set\n    index: function( elem ) {\n\n      // No argument, return index in parent\n      if ( !elem ) {\n        return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;\n      }\n\n      // Index in selector\n      if ( typeof elem === \"string\" ) {\n        return indexOf.call( jQuery( elem ), this[ 0 ] );\n      }\n\n      // Locate the position of the desired element\n      return indexOf.call( this,\n\n        // If it receives a jQuery object, the first element is used\n        elem.jquery ? elem[ 0 ] : elem\n      );\n    },\n\n    add: function( selector, context ) {\n      return this.pushStack(\n        jQuery.uniqueSort(\n          jQuery.merge( this.get(), jQuery( selector, context ) )\n        )\n      );\n    },\n\n    addBack: function( selector ) {\n      return this.add( selector == null ?\n        this.prevObject : this.prevObject.filter( selector )\n      );\n    }\n  } );\n\n  function sibling( cur, dir ) {\n    while ( ( cur = cur[ dir ] ) && cur.nodeType !== 1 ) {}\n    return cur;\n  }\n\n  jQuery.each( {\n    parent: function( elem ) {\n      var parent = elem.parentNode;\n      return parent && parent.nodeType !== 11 ? parent : null;\n    },\n    parents: function( elem ) {\n      return dir( elem, \"parentNode\" );\n    },\n    parentsUntil: function( elem, _i, until ) {\n      return dir( elem, \"parentNode\", until );\n    },\n    next: function( elem ) {\n      return sibling( elem, \"nextSibling\" );\n    },\n    prev: function( elem ) {\n      return sibling( elem, \"previousSibling\" );\n    },\n    nextAll: function( elem ) {\n      return dir( elem, \"nextSibling\" );\n    },\n    prevAll: function( elem ) {\n      return dir( elem, \"previousSibling\" );\n    },\n    nextUntil: function( elem, _i, until ) {\n      return dir( elem, \"nextSibling\", until );\n    },\n    prevUntil: function( elem, _i, until ) {\n      return dir( elem, \"previousSibling\", until );\n    },\n    siblings: function( elem ) {\n      return siblings( ( elem.parentNode || {} ).firstChild, elem );\n    },\n    children: function( elem ) {\n      return siblings( elem.firstChild );\n    },\n    contents: function( elem ) {\n      if ( elem.contentDocument != null &&\n\n        // Support: IE 11+\n        // <object> elements with no `data` attribute has an object\n        // `contentDocument` with a `null` prototype.\n        getProto( elem.contentDocument ) ) {\n\n        return elem.contentDocument;\n      }\n\n      // Support: IE 9 - 11 only, iOS 7 only, Android Browser <=4.3 only\n      // Treat the template element as a regular one in browsers that\n      // don't support it.\n      if ( nodeName( elem, \"template\" ) ) {\n        elem = elem.content || elem;\n      }\n\n      return jQuery.merge( [], elem.childNodes );\n    }\n  }, function( name, fn ) {\n    jQuery.fn[ name ] = function( until, selector ) {\n      var matched = jQuery.map( this, fn, until );\n\n      if ( name.slice( -5 ) !== \"Until\" ) {\n        selector = until;\n      }\n\n      if ( selector && typeof selector === \"string\" ) {\n        matched = jQuery.filter( selector, matched );\n      }\n\n      if ( this.length > 1 ) {\n\n        // Remove duplicates\n        if ( !guaranteedUnique[ name ] ) {\n          jQuery.uniqueSort( matched );\n        }\n\n        // Reverse order for parents* and prev-derivatives\n        if ( rparentsprev.test( name ) ) {\n          matched.reverse();\n        }\n      }\n\n      return this.pushStack( matched );\n    };\n  } );\n  var rnothtmlwhite = ( /[^\\x20\\t\\r\\n\\f]+/g );\n\n\n\n// Convert String-formatted options into Object-formatted ones\n  function createOptions( options ) {\n    var object = {};\n    jQuery.each( options.match( rnothtmlwhite ) || [], function( _, flag ) {\n      object[ flag ] = true;\n    } );\n    return object;\n  }\n\n  /*\n * Create a callback list using the following parameters:\n *\n *\toptions: an optional list of space-separated options that will change how\n *\t\t\tthe callback list behaves or a more traditional option object\n *\n * By default a callback list will act like an event callback list and can be\n * \"fired\" multiple times.\n *\n * Possible options:\n *\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n *\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n *\t\t\t\t\tafter the list has been fired right away with the latest \"memorized\"\n *\t\t\t\t\tvalues (like a Deferred)\n *\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n *\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\n *\n */\n  jQuery.Callbacks = function( options ) {\n\n    // Convert options from String-formatted to Object-formatted if needed\n    // (we check in cache first)\n    options = typeof options === \"string\" ?\n      createOptions( options ) :\n      jQuery.extend( {}, options );\n\n    var // Flag to know if list is currently firing\n      firing,\n\n      // Last fire value for non-forgettable lists\n      memory,\n\n      // Flag to know if list was already fired\n      fired,\n\n      // Flag to prevent firing\n      locked,\n\n      // Actual callback list\n      list = [],\n\n      // Queue of execution data for repeatable lists\n      queue = [],\n\n      // Index of currently firing callback (modified by add/remove as needed)\n      firingIndex = -1,\n\n      // Fire callbacks\n      fire = function() {\n\n        // Enforce single-firing\n        locked = locked || options.once;\n\n        // Execute callbacks for all pending executions,\n        // respecting firingIndex overrides and runtime changes\n        fired = firing = true;\n        for ( ; queue.length; firingIndex = -1 ) {\n          memory = queue.shift();\n          while ( ++firingIndex < list.length ) {\n\n            // Run callback and check for early termination\n            if ( list[ firingIndex ].apply( memory[ 0 ], memory[ 1 ] ) === false &&\n              options.stopOnFalse ) {\n\n              // Jump to end and forget the data so .add doesn't re-fire\n              firingIndex = list.length;\n              memory = false;\n            }\n          }\n        }\n\n        // Forget the data if we're done with it\n        if ( !options.memory ) {\n          memory = false;\n        }\n\n        firing = false;\n\n        // Clean up if we're done firing for good\n        if ( locked ) {\n\n          // Keep an empty list if we have data for future add calls\n          if ( memory ) {\n            list = [];\n\n            // Otherwise, this object is spent\n          } else {\n            list = \"\";\n          }\n        }\n      },\n\n      // Actual Callbacks object\n      self = {\n\n        // Add a callback or a collection of callbacks to the list\n        add: function() {\n          if ( list ) {\n\n            // If we have memory from a past run, we should fire after adding\n            if ( memory && !firing ) {\n              firingIndex = list.length - 1;\n              queue.push( memory );\n            }\n\n            ( function add( args ) {\n              jQuery.each( args, function( _, arg ) {\n                if ( isFunction( arg ) ) {\n                  if ( !options.unique || !self.has( arg ) ) {\n                    list.push( arg );\n                  }\n                } else if ( arg && arg.length && toType( arg ) !== \"string\" ) {\n\n                  // Inspect recursively\n                  add( arg );\n                }\n              } );\n            } )( arguments );\n\n            if ( memory && !firing ) {\n              fire();\n            }\n          }\n          return this;\n        },\n\n        // Remove a callback from the list\n        remove: function() {\n          jQuery.each( arguments, function( _, arg ) {\n            var index;\n            while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\n              list.splice( index, 1 );\n\n              // Handle firing indexes\n              if ( index <= firingIndex ) {\n                firingIndex--;\n              }\n            }\n          } );\n          return this;\n        },\n\n        // Check if a given callback is in the list.\n        // If no argument is given, return whether or not list has callbacks attached.\n        has: function( fn ) {\n          return fn ?\n            jQuery.inArray( fn, list ) > -1 :\n            list.length > 0;\n        },\n\n        // Remove all callbacks from the list\n        empty: function() {\n          if ( list ) {\n            list = [];\n          }\n          return this;\n        },\n\n        // Disable .fire and .add\n        // Abort any current/pending executions\n        // Clear all callbacks and values\n        disable: function() {\n          locked = queue = [];\n          list = memory = \"\";\n          return this;\n        },\n        disabled: function() {\n          return !list;\n        },\n\n        // Disable .fire\n        // Also disable .add unless we have memory (since it would have no effect)\n        // Abort any pending executions\n        lock: function() {\n          locked = queue = [];\n          if ( !memory && !firing ) {\n            list = memory = \"\";\n          }\n          return this;\n        },\n        locked: function() {\n          return !!locked;\n        },\n\n        // Call all callbacks with the given context and arguments\n        fireWith: function( context, args ) {\n          if ( !locked ) {\n            args = args || [];\n            args = [ context, args.slice ? args.slice() : args ];\n            queue.push( args );\n            if ( !firing ) {\n              fire();\n            }\n          }\n          return this;\n        },\n\n        // Call all the callbacks with the given arguments\n        fire: function() {\n          self.fireWith( this, arguments );\n          return this;\n        },\n\n        // To know if the callbacks have already been called at least once\n        fired: function() {\n          return !!fired;\n        }\n      };\n\n    return self;\n  };\n\n\n  function Identity( v ) {\n    return v;\n  }\n  function Thrower( ex ) {\n    throw ex;\n  }\n\n  function adoptValue( value, resolve, reject, noValue ) {\n    var method;\n\n    try {\n\n      // Check for promise aspect first to privilege synchronous behavior\n      if ( value && isFunction( ( method = value.promise ) ) ) {\n        method.call( value ).done( resolve ).fail( reject );\n\n        // Other thenables\n      } else if ( value && isFunction( ( method = value.then ) ) ) {\n        method.call( value, resolve, reject );\n\n        // Other non-thenables\n      } else {\n\n        // Control `resolve` arguments by letting Array#slice cast boolean `noValue` to integer:\n        // * false: [ value ].slice( 0 ) => resolve( value )\n        // * true: [ value ].slice( 1 ) => resolve()\n        resolve.apply( undefined, [ value ].slice( noValue ) );\n      }\n\n      // For Promises/A+, convert exceptions into rejections\n      // Since jQuery.when doesn't unwrap thenables, we can skip the extra checks appearing in\n      // Deferred#then to conditionally suppress rejection.\n    } catch ( value ) {\n\n      // Support: Android 4.0 only\n      // Strict mode functions invoked without .call/.apply get global-object context\n      reject.apply( undefined, [ value ] );\n    }\n  }\n\n  jQuery.extend( {\n\n    Deferred: function( func ) {\n      var tuples = [\n\n          // action, add listener, callbacks,\n          // ... .then handlers, argument index, [final state]\n          [ \"notify\", \"progress\", jQuery.Callbacks( \"memory\" ),\n            jQuery.Callbacks( \"memory\" ), 2 ],\n          [ \"resolve\", \"done\", jQuery.Callbacks( \"once memory\" ),\n            jQuery.Callbacks( \"once memory\" ), 0, \"resolved\" ],\n          [ \"reject\", \"fail\", jQuery.Callbacks( \"once memory\" ),\n            jQuery.Callbacks( \"once memory\" ), 1, \"rejected\" ]\n        ],\n        state = \"pending\",\n        promise = {\n          state: function() {\n            return state;\n          },\n          always: function() {\n            deferred.done( arguments ).fail( arguments );\n            return this;\n          },\n          \"catch\": function( fn ) {\n            return promise.then( null, fn );\n          },\n\n          // Keep pipe for back-compat\n          pipe: function( /* fnDone, fnFail, fnProgress */ ) {\n            var fns = arguments;\n\n            return jQuery.Deferred( function( newDefer ) {\n              jQuery.each( tuples, function( _i, tuple ) {\n\n                // Map tuples (progress, done, fail) to arguments (done, fail, progress)\n                var fn = isFunction( fns[ tuple[ 4 ] ] ) && fns[ tuple[ 4 ] ];\n\n                // deferred.progress(function() { bind to newDefer or newDefer.notify })\n                // deferred.done(function() { bind to newDefer or newDefer.resolve })\n                // deferred.fail(function() { bind to newDefer or newDefer.reject })\n                deferred[ tuple[ 1 ] ]( function() {\n                  var returned = fn && fn.apply( this, arguments );\n                  if ( returned && isFunction( returned.promise ) ) {\n                    returned.promise()\n                      .progress( newDefer.notify )\n                      .done( newDefer.resolve )\n                      .fail( newDefer.reject );\n                  } else {\n                    newDefer[ tuple[ 0 ] + \"With\" ](\n                      this,\n                      fn ? [ returned ] : arguments\n                    );\n                  }\n                } );\n              } );\n              fns = null;\n            } ).promise();\n          },\n          then: function( onFulfilled, onRejected, onProgress ) {\n            var maxDepth = 0;\n            function resolve( depth, deferred, handler, special ) {\n              return function() {\n                var that = this,\n                  args = arguments,\n                  mightThrow = function() {\n                    var returned, then;\n\n                    // Support: Promises/A+ section 2.3.3.3.3\n                    // https://promisesaplus.com/#point-59\n                    // Ignore double-resolution attempts\n                    if ( depth < maxDepth ) {\n                      return;\n                    }\n\n                    returned = handler.apply( that, args );\n\n                    // Support: Promises/A+ section 2.3.1\n                    // https://promisesaplus.com/#point-48\n                    if ( returned === deferred.promise() ) {\n                      throw new TypeError( \"Thenable self-resolution\" );\n                    }\n\n                    // Support: Promises/A+ sections 2.3.3.1, 3.5\n                    // https://promisesaplus.com/#point-54\n                    // https://promisesaplus.com/#point-75\n                    // Retrieve `then` only once\n                    then = returned &&\n\n                      // Support: Promises/A+ section 2.3.4\n                      // https://promisesaplus.com/#point-64\n                      // Only check objects and functions for thenability\n                      ( typeof returned === \"object\" ||\n                        typeof returned === \"function\" ) &&\n                      returned.then;\n\n                    // Handle a returned thenable\n                    if ( isFunction( then ) ) {\n\n                      // Special processors (notify) just wait for resolution\n                      if ( special ) {\n                        then.call(\n                          returned,\n                          resolve( maxDepth, deferred, Identity, special ),\n                          resolve( maxDepth, deferred, Thrower, special )\n                        );\n\n                        // Normal processors (resolve) also hook into progress\n                      } else {\n\n                        // ...and disregard older resolution values\n                        maxDepth++;\n\n                        then.call(\n                          returned,\n                          resolve( maxDepth, deferred, Identity, special ),\n                          resolve( maxDepth, deferred, Thrower, special ),\n                          resolve( maxDepth, deferred, Identity,\n                            deferred.notifyWith )\n                        );\n                      }\n\n                      // Handle all other returned values\n                    } else {\n\n                      // Only substitute handlers pass on context\n                      // and multiple values (non-spec behavior)\n                      if ( handler !== Identity ) {\n                        that = undefined;\n                        args = [ returned ];\n                      }\n\n                      // Process the value(s)\n                      // Default process is resolve\n                      ( special || deferred.resolveWith )( that, args );\n                    }\n                  },\n\n                  // Only normal processors (resolve) catch and reject exceptions\n                  process = special ?\n                    mightThrow :\n                    function() {\n                      try {\n                        mightThrow();\n                      } catch ( e ) {\n\n                        if ( jQuery.Deferred.exceptionHook ) {\n                          jQuery.Deferred.exceptionHook( e,\n                            process.stackTrace );\n                        }\n\n                        // Support: Promises/A+ section 2.3.3.3.4.1\n                        // https://promisesaplus.com/#point-61\n                        // Ignore post-resolution exceptions\n                        if ( depth + 1 >= maxDepth ) {\n\n                          // Only substitute handlers pass on context\n                          // and multiple values (non-spec behavior)\n                          if ( handler !== Thrower ) {\n                            that = undefined;\n                            args = [ e ];\n                          }\n\n                          deferred.rejectWith( that, args );\n                        }\n                      }\n                    };\n\n                // Support: Promises/A+ section 2.3.3.3.1\n                // https://promisesaplus.com/#point-57\n                // Re-resolve promises immediately to dodge false rejection from\n                // subsequent errors\n                if ( depth ) {\n                  process();\n                } else {\n\n                  // Call an optional hook to record the stack, in case of exception\n                  // since it's otherwise lost when execution goes async\n                  if ( jQuery.Deferred.getStackHook ) {\n                    process.stackTrace = jQuery.Deferred.getStackHook();\n                  }\n                  window.setTimeout( process );\n                }\n              };\n            }\n\n            return jQuery.Deferred( function( newDefer ) {\n\n              // progress_handlers.add( ... )\n              tuples[ 0 ][ 3 ].add(\n                resolve(\n                  0,\n                  newDefer,\n                  isFunction( onProgress ) ?\n                    onProgress :\n                    Identity,\n                  newDefer.notifyWith\n                )\n              );\n\n              // fulfilled_handlers.add( ... )\n              tuples[ 1 ][ 3 ].add(\n                resolve(\n                  0,\n                  newDefer,\n                  isFunction( onFulfilled ) ?\n                    onFulfilled :\n                    Identity\n                )\n              );\n\n              // rejected_handlers.add( ... )\n              tuples[ 2 ][ 3 ].add(\n                resolve(\n                  0,\n                  newDefer,\n                  isFunction( onRejected ) ?\n                    onRejected :\n                    Thrower\n                )\n              );\n            } ).promise();\n          },\n\n          // Get a promise for this deferred\n          // If obj is provided, the promise aspect is added to the object\n          promise: function( obj ) {\n            return obj != null ? jQuery.extend( obj, promise ) : promise;\n          }\n        },\n        deferred = {};\n\n      // Add list-specific methods\n      jQuery.each( tuples, function( i, tuple ) {\n        var list = tuple[ 2 ],\n          stateString = tuple[ 5 ];\n\n        // promise.progress = list.add\n        // promise.done = list.add\n        // promise.fail = list.add\n        promise[ tuple[ 1 ] ] = list.add;\n\n        // Handle state\n        if ( stateString ) {\n          list.add(\n            function() {\n\n              // state = \"resolved\" (i.e., fulfilled)\n              // state = \"rejected\"\n              state = stateString;\n            },\n\n            // rejected_callbacks.disable\n            // fulfilled_callbacks.disable\n            tuples[ 3 - i ][ 2 ].disable,\n\n            // rejected_handlers.disable\n            // fulfilled_handlers.disable\n            tuples[ 3 - i ][ 3 ].disable,\n\n            // progress_callbacks.lock\n            tuples[ 0 ][ 2 ].lock,\n\n            // progress_handlers.lock\n            tuples[ 0 ][ 3 ].lock\n          );\n        }\n\n        // progress_handlers.fire\n        // fulfilled_handlers.fire\n        // rejected_handlers.fire\n        list.add( tuple[ 3 ].fire );\n\n        // deferred.notify = function() { deferred.notifyWith(...) }\n        // deferred.resolve = function() { deferred.resolveWith(...) }\n        // deferred.reject = function() { deferred.rejectWith(...) }\n        deferred[ tuple[ 0 ] ] = function() {\n          deferred[ tuple[ 0 ] + \"With\" ]( this === deferred ? undefined : this, arguments );\n          return this;\n        };\n\n        // deferred.notifyWith = list.fireWith\n        // deferred.resolveWith = list.fireWith\n        // deferred.rejectWith = list.fireWith\n        deferred[ tuple[ 0 ] + \"With\" ] = list.fireWith;\n      } );\n\n      // Make the deferred a promise\n      promise.promise( deferred );\n\n      // Call given func if any\n      if ( func ) {\n        func.call( deferred, deferred );\n      }\n\n      // All done!\n      return deferred;\n    },\n\n    // Deferred helper\n    when: function( singleValue ) {\n      var\n\n        // count of uncompleted subordinates\n        remaining = arguments.length,\n\n        // count of unprocessed arguments\n        i = remaining,\n\n        // subordinate fulfillment data\n        resolveContexts = Array( i ),\n        resolveValues = slice.call( arguments ),\n\n        // the master Deferred\n        master = jQuery.Deferred(),\n\n        // subordinate callback factory\n        updateFunc = function( i ) {\n          return function( value ) {\n            resolveContexts[ i ] = this;\n            resolveValues[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;\n            if ( !( --remaining ) ) {\n              master.resolveWith( resolveContexts, resolveValues );\n            }\n          };\n        };\n\n      // Single- and empty arguments are adopted like Promise.resolve\n      if ( remaining <= 1 ) {\n        adoptValue( singleValue, master.done( updateFunc( i ) ).resolve, master.reject,\n          !remaining );\n\n        // Use .then() to unwrap secondary thenables (cf. gh-3000)\n        if ( master.state() === \"pending\" ||\n          isFunction( resolveValues[ i ] && resolveValues[ i ].then ) ) {\n\n          return master.then();\n        }\n      }\n\n      // Multiple arguments are aggregated like Promise.all array elements\n      while ( i-- ) {\n        adoptValue( resolveValues[ i ], updateFunc( i ), master.reject );\n      }\n\n      return master.promise();\n    }\n  } );\n\n\n// These usually indicate a programmer mistake during development,\n// warn about them ASAP rather than swallowing them by default.\n  var rerrorNames = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;\n\n  jQuery.Deferred.exceptionHook = function( error, stack ) {\n\n    // Support: IE 8 - 9 only\n    // Console exists when dev tools are open, which can happen at any time\n    if ( window.console && window.console.warn && error && rerrorNames.test( error.name ) ) {\n      window.console.warn( \"jQuery.Deferred exception: \" + error.message, error.stack, stack );\n    }\n  };\n\n\n\n\n  jQuery.readyException = function( error ) {\n    window.setTimeout( function() {\n      throw error;\n    } );\n  };\n\n\n\n\n// The deferred used on DOM ready\n  var readyList = jQuery.Deferred();\n\n  jQuery.fn.ready = function( fn ) {\n\n    readyList\n      .then( fn )\n\n      // Wrap jQuery.readyException in a function so that the lookup\n      // happens at the time of error handling instead of callback\n      // registration.\n      .catch( function( error ) {\n        jQuery.readyException( error );\n      } );\n\n    return this;\n  };\n\n  jQuery.extend( {\n\n    // Is the DOM ready to be used? Set to true once it occurs.\n    isReady: false,\n\n    // A counter to track how many items to wait for before\n    // the ready event fires. See #6781\n    readyWait: 1,\n\n    // Handle when the DOM is ready\n    ready: function( wait ) {\n\n      // Abort if there are pending holds or we're already ready\n      if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {\n        return;\n      }\n\n      // Remember that the DOM is ready\n      jQuery.isReady = true;\n\n      // If a normal DOM Ready event fired, decrement, and wait if need be\n      if ( wait !== true && --jQuery.readyWait > 0 ) {\n        return;\n      }\n\n      // If there are functions bound, to execute\n      readyList.resolveWith( document, [ jQuery ] );\n    }\n  } );\n\n  jQuery.ready.then = readyList.then;\n\n// The ready event handler and self cleanup method\n  function completed() {\n    document.removeEventListener( \"DOMContentLoaded\", completed );\n    window.removeEventListener( \"load\", completed );\n    jQuery.ready();\n  }\n\n// Catch cases where $(document).ready() is called\n// after the browser event has already occurred.\n// Support: IE <=9 - 10 only\n// Older IE sometimes signals \"interactive\" too soon\n  if ( document.readyState === \"complete\" ||\n    ( document.readyState !== \"loading\" && !document.documentElement.doScroll ) ) {\n\n    // Handle it asynchronously to allow scripts the opportunity to delay ready\n    window.setTimeout( jQuery.ready );\n\n  } else {\n\n    // Use the handy event callback\n    document.addEventListener( \"DOMContentLoaded\", completed );\n\n    // A fallback to window.onload, that will always work\n    window.addEventListener( \"load\", completed );\n  }\n\n\n\n\n// Multifunctional method to get and set values of a collection\n// The value/s can optionally be executed if it's a function\n  var access = function( elems, fn, key, value, chainable, emptyGet, raw ) {\n    var i = 0,\n      len = elems.length,\n      bulk = key == null;\n\n    // Sets many values\n    if ( toType( key ) === \"object\" ) {\n      chainable = true;\n      for ( i in key ) {\n        access( elems, fn, i, key[ i ], true, emptyGet, raw );\n      }\n\n      // Sets one value\n    } else if ( value !== undefined ) {\n      chainable = true;\n\n      if ( !isFunction( value ) ) {\n        raw = true;\n      }\n\n      if ( bulk ) {\n\n        // Bulk operations run against the entire set\n        if ( raw ) {\n          fn.call( elems, value );\n          fn = null;\n\n          // ...except when executing function values\n        } else {\n          bulk = fn;\n          fn = function( elem, _key, value ) {\n            return bulk.call( jQuery( elem ), value );\n          };\n        }\n      }\n\n      if ( fn ) {\n        for ( ; i < len; i++ ) {\n          fn(\n            elems[ i ], key, raw ?\n              value :\n              value.call( elems[ i ], i, fn( elems[ i ], key ) )\n          );\n        }\n      }\n    }\n\n    if ( chainable ) {\n      return elems;\n    }\n\n    // Gets\n    if ( bulk ) {\n      return fn.call( elems );\n    }\n\n    return len ? fn( elems[ 0 ], key ) : emptyGet;\n  };\n\n\n// Matches dashed string for camelizing\n  var rmsPrefix = /^-ms-/,\n    rdashAlpha = /-([a-z])/g;\n\n// Used by camelCase as callback to replace()\n  function fcamelCase( _all, letter ) {\n    return letter.toUpperCase();\n  }\n\n// Convert dashed to camelCase; used by the css and data modules\n// Support: IE <=9 - 11, Edge 12 - 15\n// Microsoft forgot to hump their vendor prefix (#9572)\n  function camelCase( string ) {\n    return string.replace( rmsPrefix, \"ms-\" ).replace( rdashAlpha, fcamelCase );\n  }\n  var acceptData = function( owner ) {\n\n    // Accepts only:\n    //  - Node\n    //    - Node.ELEMENT_NODE\n    //    - Node.DOCUMENT_NODE\n    //  - Object\n    //    - Any\n    return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );\n  };\n\n\n\n\n  function Data() {\n    this.expando = jQuery.expando + Data.uid++;\n  }\n\n  Data.uid = 1;\n\n  Data.prototype = {\n\n    cache: function( owner ) {\n\n      // Check if the owner object already has a cache\n      var value = owner[ this.expando ];\n\n      // If not, create one\n      if ( !value ) {\n        value = {};\n\n        // We can accept data for non-element nodes in modern browsers,\n        // but we should not, see #8335.\n        // Always return an empty object.\n        if ( acceptData( owner ) ) {\n\n          // If it is a node unlikely to be stringify-ed or looped over\n          // use plain assignment\n          if ( owner.nodeType ) {\n            owner[ this.expando ] = value;\n\n            // Otherwise secure it in a non-enumerable property\n            // configurable must be true to allow the property to be\n            // deleted when data is removed\n          } else {\n            Object.defineProperty( owner, this.expando, {\n              value: value,\n              configurable: true\n            } );\n          }\n        }\n      }\n\n      return value;\n    },\n    set: function( owner, data, value ) {\n      var prop,\n        cache = this.cache( owner );\n\n      // Handle: [ owner, key, value ] args\n      // Always use camelCase key (gh-2257)\n      if ( typeof data === \"string\" ) {\n        cache[ camelCase( data ) ] = value;\n\n        // Handle: [ owner, { properties } ] args\n      } else {\n\n        // Copy the properties one-by-one to the cache object\n        for ( prop in data ) {\n          cache[ camelCase( prop ) ] = data[ prop ];\n        }\n      }\n      return cache;\n    },\n    get: function( owner, key ) {\n      return key === undefined ?\n        this.cache( owner ) :\n\n        // Always use camelCase key (gh-2257)\n        owner[ this.expando ] && owner[ this.expando ][ camelCase( key ) ];\n    },\n    access: function( owner, key, value ) {\n\n      // In cases where either:\n      //\n      //   1. No key was specified\n      //   2. A string key was specified, but no value provided\n      //\n      // Take the \"read\" path and allow the get method to determine\n      // which value to return, respectively either:\n      //\n      //   1. The entire cache object\n      //   2. The data stored at the key\n      //\n      if ( key === undefined ||\n        ( ( key && typeof key === \"string\" ) && value === undefined ) ) {\n\n        return this.get( owner, key );\n      }\n\n      // When the key is not a string, or both a key and value\n      // are specified, set or extend (existing objects) with either:\n      //\n      //   1. An object of properties\n      //   2. A key and value\n      //\n      this.set( owner, key, value );\n\n      // Since the \"set\" path can have two possible entry points\n      // return the expected data based on which path was taken[*]\n      return value !== undefined ? value : key;\n    },\n    remove: function( owner, key ) {\n      var i,\n        cache = owner[ this.expando ];\n\n      if ( cache === undefined ) {\n        return;\n      }\n\n      if ( key !== undefined ) {\n\n        // Support array or space separated string of keys\n        if ( Array.isArray( key ) ) {\n\n          // If key is an array of keys...\n          // We always set camelCase keys, so remove that.\n          key = key.map( camelCase );\n        } else {\n          key = camelCase( key );\n\n          // If a key with the spaces exists, use it.\n          // Otherwise, create an array by matching non-whitespace\n          key = key in cache ?\n            [ key ] :\n            ( key.match( rnothtmlwhite ) || [] );\n        }\n\n        i = key.length;\n\n        while ( i-- ) {\n          delete cache[ key[ i ] ];\n        }\n      }\n\n      // Remove the expando if there's no more data\n      if ( key === undefined || jQuery.isEmptyObject( cache ) ) {\n\n        // Support: Chrome <=35 - 45\n        // Webkit & Blink performance suffers when deleting properties\n        // from DOM nodes, so set to undefined instead\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=378607 (bug restricted)\n        if ( owner.nodeType ) {\n          owner[ this.expando ] = undefined;\n        } else {\n          delete owner[ this.expando ];\n        }\n      }\n    },\n    hasData: function( owner ) {\n      var cache = owner[ this.expando ];\n      return cache !== undefined && !jQuery.isEmptyObject( cache );\n    }\n  };\n  var dataPriv = new Data();\n\n  var dataUser = new Data();\n\n\n\n//\tImplementation Summary\n//\n//\t1. Enforce API surface and semantic compatibility with 1.9.x branch\n//\t2. Improve the module's maintainability by reducing the storage\n//\t\tpaths to a single mechanism.\n//\t3. Use the same single mechanism to support \"private\" and \"user\" data.\n//\t4. _Never_ expose \"private\" data to user code (TODO: Drop _data, _removeData)\n//\t5. Avoid exposing implementation details on user objects (eg. expando properties)\n//\t6. Provide a clear path for implementation upgrade to WeakMap in 2014\n\n  var rbrace = /^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,\n    rmultiDash = /[A-Z]/g;\n\n  function getData( data ) {\n    if ( data === \"true\" ) {\n      return true;\n    }\n\n    if ( data === \"false\" ) {\n      return false;\n    }\n\n    if ( data === \"null\" ) {\n      return null;\n    }\n\n    // Only convert to a number if it doesn't change the string\n    if ( data === +data + \"\" ) {\n      return +data;\n    }\n\n    if ( rbrace.test( data ) ) {\n      return JSON.parse( data );\n    }\n\n    return data;\n  }\n\n  function dataAttr( elem, key, data ) {\n    var name;\n\n    // If nothing was found internally, try to fetch any\n    // data from the HTML5 data-* attribute\n    if ( data === undefined && elem.nodeType === 1 ) {\n      name = \"data-\" + key.replace( rmultiDash, \"-$&\" ).toLowerCase();\n      data = elem.getAttribute( name );\n\n      if ( typeof data === \"string\" ) {\n        try {\n          data = getData( data );\n        } catch ( e ) {}\n\n        // Make sure we set the data so it isn't changed later\n        dataUser.set( elem, key, data );\n      } else {\n        data = undefined;\n      }\n    }\n    return data;\n  }\n\n  jQuery.extend( {\n    hasData: function( elem ) {\n      return dataUser.hasData( elem ) || dataPriv.hasData( elem );\n    },\n\n    data: function( elem, name, data ) {\n      return dataUser.access( elem, name, data );\n    },\n\n    removeData: function( elem, name ) {\n      dataUser.remove( elem, name );\n    },\n\n    // TODO: Now that all calls to _data and _removeData have been replaced\n    // with direct calls to dataPriv methods, these can be deprecated.\n    _data: function( elem, name, data ) {\n      return dataPriv.access( elem, name, data );\n    },\n\n    _removeData: function( elem, name ) {\n      dataPriv.remove( elem, name );\n    }\n  } );\n\n  jQuery.fn.extend( {\n    data: function( key, value ) {\n      var i, name, data,\n        elem = this[ 0 ],\n        attrs = elem && elem.attributes;\n\n      // Gets all values\n      if ( key === undefined ) {\n        if ( this.length ) {\n          data = dataUser.get( elem );\n\n          if ( elem.nodeType === 1 && !dataPriv.get( elem, \"hasDataAttrs\" ) ) {\n            i = attrs.length;\n            while ( i-- ) {\n\n              // Support: IE 11 only\n              // The attrs elements can be null (#14894)\n              if ( attrs[ i ] ) {\n                name = attrs[ i ].name;\n                if ( name.indexOf( \"data-\" ) === 0 ) {\n                  name = camelCase( name.slice( 5 ) );\n                  dataAttr( elem, name, data[ name ] );\n                }\n              }\n            }\n            dataPriv.set( elem, \"hasDataAttrs\", true );\n          }\n        }\n\n        return data;\n      }\n\n      // Sets multiple values\n      if ( typeof key === \"object\" ) {\n        return this.each( function() {\n          dataUser.set( this, key );\n        } );\n      }\n\n      return access( this, function( value ) {\n        var data;\n\n        // The calling jQuery object (element matches) is not empty\n        // (and therefore has an element appears at this[ 0 ]) and the\n        // `value` parameter was not undefined. An empty jQuery object\n        // will result in `undefined` for elem = this[ 0 ] which will\n        // throw an exception if an attempt to read a data cache is made.\n        if ( elem && value === undefined ) {\n\n          // Attempt to get data from the cache\n          // The key will always be camelCased in Data\n          data = dataUser.get( elem, key );\n          if ( data !== undefined ) {\n            return data;\n          }\n\n          // Attempt to \"discover\" the data in\n          // HTML5 custom data-* attrs\n          data = dataAttr( elem, key );\n          if ( data !== undefined ) {\n            return data;\n          }\n\n          // We tried really hard, but the data doesn't exist.\n          return;\n        }\n\n        // Set the data...\n        this.each( function() {\n\n          // We always store the camelCased key\n          dataUser.set( this, key, value );\n        } );\n      }, null, value, arguments.length > 1, null, true );\n    },\n\n    removeData: function( key ) {\n      return this.each( function() {\n        dataUser.remove( this, key );\n      } );\n    }\n  } );\n\n\n  jQuery.extend( {\n    queue: function( elem, type, data ) {\n      var queue;\n\n      if ( elem ) {\n        type = ( type || \"fx\" ) + \"queue\";\n        queue = dataPriv.get( elem, type );\n\n        // Speed up dequeue by getting out quickly if this is just a lookup\n        if ( data ) {\n          if ( !queue || Array.isArray( data ) ) {\n            queue = dataPriv.access( elem, type, jQuery.makeArray( data ) );\n          } else {\n            queue.push( data );\n          }\n        }\n        return queue || [];\n      }\n    },\n\n    dequeue: function( elem, type ) {\n      type = type || \"fx\";\n\n      var queue = jQuery.queue( elem, type ),\n        startLength = queue.length,\n        fn = queue.shift(),\n        hooks = jQuery._queueHooks( elem, type ),\n        next = function() {\n          jQuery.dequeue( elem, type );\n        };\n\n      // If the fx queue is dequeued, always remove the progress sentinel\n      if ( fn === \"inprogress\" ) {\n        fn = queue.shift();\n        startLength--;\n      }\n\n      if ( fn ) {\n\n        // Add a progress sentinel to prevent the fx queue from being\n        // automatically dequeued\n        if ( type === \"fx\" ) {\n          queue.unshift( \"inprogress\" );\n        }\n\n        // Clear up the last queue stop function\n        delete hooks.stop;\n        fn.call( elem, next, hooks );\n      }\n\n      if ( !startLength && hooks ) {\n        hooks.empty.fire();\n      }\n    },\n\n    // Not public - generate a queueHooks object, or return the current one\n    _queueHooks: function( elem, type ) {\n      var key = type + \"queueHooks\";\n      return dataPriv.get( elem, key ) || dataPriv.access( elem, key, {\n        empty: jQuery.Callbacks( \"once memory\" ).add( function() {\n          dataPriv.remove( elem, [ type + \"queue\", key ] );\n        } )\n      } );\n    }\n  } );\n\n  jQuery.fn.extend( {\n    queue: function( type, data ) {\n      var setter = 2;\n\n      if ( typeof type !== \"string\" ) {\n        data = type;\n        type = \"fx\";\n        setter--;\n      }\n\n      if ( arguments.length < setter ) {\n        return jQuery.queue( this[ 0 ], type );\n      }\n\n      return data === undefined ?\n        this :\n        this.each( function() {\n          var queue = jQuery.queue( this, type, data );\n\n          // Ensure a hooks for this queue\n          jQuery._queueHooks( this, type );\n\n          if ( type === \"fx\" && queue[ 0 ] !== \"inprogress\" ) {\n            jQuery.dequeue( this, type );\n          }\n        } );\n    },\n    dequeue: function( type ) {\n      return this.each( function() {\n        jQuery.dequeue( this, type );\n      } );\n    },\n    clearQueue: function( type ) {\n      return this.queue( type || \"fx\", [] );\n    },\n\n    // Get a promise resolved when queues of a certain type\n    // are emptied (fx is the type by default)\n    promise: function( type, obj ) {\n      var tmp,\n        count = 1,\n        defer = jQuery.Deferred(),\n        elements = this,\n        i = this.length,\n        resolve = function() {\n          if ( !( --count ) ) {\n            defer.resolveWith( elements, [ elements ] );\n          }\n        };\n\n      if ( typeof type !== \"string\" ) {\n        obj = type;\n        type = undefined;\n      }\n      type = type || \"fx\";\n\n      while ( i-- ) {\n        tmp = dataPriv.get( elements[ i ], type + \"queueHooks\" );\n        if ( tmp && tmp.empty ) {\n          count++;\n          tmp.empty.add( resolve );\n        }\n      }\n      resolve();\n      return defer.promise( obj );\n    }\n  } );\n  var pnum = ( /[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/ ).source;\n\n  var rcssNum = new RegExp( \"^(?:([+-])=|)(\" + pnum + \")([a-z%]*)$\", \"i\" );\n\n\n  var cssExpand = [ \"Top\", \"Right\", \"Bottom\", \"Left\" ];\n\n  var documentElement = document.documentElement;\n\n\n\n  var isAttached = function( elem ) {\n      return jQuery.contains( elem.ownerDocument, elem );\n    },\n    composed = { composed: true };\n\n  // Support: IE 9 - 11+, Edge 12 - 18+, iOS 10.0 - 10.2 only\n  // Check attachment across shadow DOM boundaries when possible (gh-3504)\n  // Support: iOS 10.0-10.2 only\n  // Early iOS 10 versions support `attachShadow` but not `getRootNode`,\n  // leading to errors. We need to check for `getRootNode`.\n  if ( documentElement.getRootNode ) {\n    isAttached = function( elem ) {\n      return jQuery.contains( elem.ownerDocument, elem ) ||\n        elem.getRootNode( composed ) === elem.ownerDocument;\n    };\n  }\n  var isHiddenWithinTree = function( elem, el ) {\n\n    // isHiddenWithinTree might be called from jQuery#filter function;\n    // in that case, element will be second argument\n    elem = el || elem;\n\n    // Inline style trumps all\n    return elem.style.display === \"none\" ||\n      elem.style.display === \"\" &&\n\n      // Otherwise, check computed style\n      // Support: Firefox <=43 - 45\n      // Disconnected elements can have computed display: none, so first confirm that elem is\n      // in the document.\n      isAttached( elem ) &&\n\n      jQuery.css( elem, \"display\" ) === \"none\";\n  };\n\n\n\n  function adjustCSS( elem, prop, valueParts, tween ) {\n    var adjusted, scale,\n      maxIterations = 20,\n      currentValue = tween ?\n        function() {\n          return tween.cur();\n        } :\n        function() {\n          return jQuery.css( elem, prop, \"\" );\n        },\n      initial = currentValue(),\n      unit = valueParts && valueParts[ 3 ] || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" ),\n\n      // Starting value computation is required for potential unit mismatches\n      initialInUnit = elem.nodeType &&\n        ( jQuery.cssNumber[ prop ] || unit !== \"px\" && +initial ) &&\n        rcssNum.exec( jQuery.css( elem, prop ) );\n\n    if ( initialInUnit && initialInUnit[ 3 ] !== unit ) {\n\n      // Support: Firefox <=54\n      // Halve the iteration target value to prevent interference from CSS upper bounds (gh-2144)\n      initial = initial / 2;\n\n      // Trust units reported by jQuery.css\n      unit = unit || initialInUnit[ 3 ];\n\n      // Iteratively approximate from a nonzero starting point\n      initialInUnit = +initial || 1;\n\n      while ( maxIterations-- ) {\n\n        // Evaluate and update our best guess (doubling guesses that zero out).\n        // Finish if the scale equals or crosses 1 (making the old*new product non-positive).\n        jQuery.style( elem, prop, initialInUnit + unit );\n        if ( ( 1 - scale ) * ( 1 - ( scale = currentValue() / initial || 0.5 ) ) <= 0 ) {\n          maxIterations = 0;\n        }\n        initialInUnit = initialInUnit / scale;\n\n      }\n\n      initialInUnit = initialInUnit * 2;\n      jQuery.style( elem, prop, initialInUnit + unit );\n\n      // Make sure we update the tween properties later on\n      valueParts = valueParts || [];\n    }\n\n    if ( valueParts ) {\n      initialInUnit = +initialInUnit || +initial || 0;\n\n      // Apply relative offset (+=/-=) if specified\n      adjusted = valueParts[ 1 ] ?\n        initialInUnit + ( valueParts[ 1 ] + 1 ) * valueParts[ 2 ] :\n        +valueParts[ 2 ];\n      if ( tween ) {\n        tween.unit = unit;\n        tween.start = initialInUnit;\n        tween.end = adjusted;\n      }\n    }\n    return adjusted;\n  }\n\n\n  var defaultDisplayMap = {};\n\n  function getDefaultDisplay( elem ) {\n    var temp,\n      doc = elem.ownerDocument,\n      nodeName = elem.nodeName,\n      display = defaultDisplayMap[ nodeName ];\n\n    if ( display ) {\n      return display;\n    }\n\n    temp = doc.body.appendChild( doc.createElement( nodeName ) );\n    display = jQuery.css( temp, \"display\" );\n\n    temp.parentNode.removeChild( temp );\n\n    if ( display === \"none\" ) {\n      display = \"block\";\n    }\n    defaultDisplayMap[ nodeName ] = display;\n\n    return display;\n  }\n\n  function showHide( elements, show ) {\n    var display, elem,\n      values = [],\n      index = 0,\n      length = elements.length;\n\n    // Determine new display value for elements that need to change\n    for ( ; index < length; index++ ) {\n      elem = elements[ index ];\n      if ( !elem.style ) {\n        continue;\n      }\n\n      display = elem.style.display;\n      if ( show ) {\n\n        // Since we force visibility upon cascade-hidden elements, an immediate (and slow)\n        // check is required in this first loop unless we have a nonempty display value (either\n        // inline or about-to-be-restored)\n        if ( display === \"none\" ) {\n          values[ index ] = dataPriv.get( elem, \"display\" ) || null;\n          if ( !values[ index ] ) {\n            elem.style.display = \"\";\n          }\n        }\n        if ( elem.style.display === \"\" && isHiddenWithinTree( elem ) ) {\n          values[ index ] = getDefaultDisplay( elem );\n        }\n      } else {\n        if ( display !== \"none\" ) {\n          values[ index ] = \"none\";\n\n          // Remember what we're overwriting\n          dataPriv.set( elem, \"display\", display );\n        }\n      }\n    }\n\n    // Set the display of the elements in a second loop to avoid constant reflow\n    for ( index = 0; index < length; index++ ) {\n      if ( values[ index ] != null ) {\n        elements[ index ].style.display = values[ index ];\n      }\n    }\n\n    return elements;\n  }\n\n  jQuery.fn.extend( {\n    show: function() {\n      return showHide( this, true );\n    },\n    hide: function() {\n      return showHide( this );\n    },\n    toggle: function( state ) {\n      if ( typeof state === \"boolean\" ) {\n        return state ? this.show() : this.hide();\n      }\n\n      return this.each( function() {\n        if ( isHiddenWithinTree( this ) ) {\n          jQuery( this ).show();\n        } else {\n          jQuery( this ).hide();\n        }\n      } );\n    }\n  } );\n  var rcheckableType = ( /^(?:checkbox|radio)$/i );\n\n  var rtagName = ( /<([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]*)/i );\n\n  var rscriptType = ( /^$|^module$|\\/(?:java|ecma)script/i );\n\n\n\n  ( function() {\n    var fragment = document.createDocumentFragment(),\n      div = fragment.appendChild( document.createElement( \"div\" ) ),\n      input = document.createElement( \"input\" );\n\n    // Support: Android 4.0 - 4.3 only\n    // Check state lost if the name is set (#11217)\n    // Support: Windows Web Apps (WWA)\n    // `name` and `type` must use .setAttribute for WWA (#14901)\n    input.setAttribute( \"type\", \"radio\" );\n    input.setAttribute( \"checked\", \"checked\" );\n    input.setAttribute( \"name\", \"t\" );\n\n    div.appendChild( input );\n\n    // Support: Android <=4.1 only\n    // Older WebKit doesn't clone checked state correctly in fragments\n    support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;\n\n    // Support: IE <=11 only\n    // Make sure textarea (and checkbox) defaultValue is properly cloned\n    div.innerHTML = \"<textarea>x</textarea>\";\n    support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;\n\n    // Support: IE <=9 only\n    // IE <=9 replaces <option> tags with their contents when inserted outside of\n    // the select element.\n    div.innerHTML = \"<option></option>\";\n    support.option = !!div.lastChild;\n  } )();\n\n\n// We have to close these tags to support XHTML (#13200)\n  var wrapMap = {\n\n    // XHTML parsers do not magically insert elements in the\n    // same way that tag soup parsers do. So we cannot shorten\n    // this by omitting <tbody> or other required elements.\n    thead: [ 1, \"<table>\", \"</table>\" ],\n    col: [ 2, \"<table><colgroup>\", \"</colgroup></table>\" ],\n    tr: [ 2, \"<table><tbody>\", \"</tbody></table>\" ],\n    td: [ 3, \"<table><tbody><tr>\", \"</tr></tbody></table>\" ],\n\n    _default: [ 0, \"\", \"\" ]\n  };\n\n  wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\n  wrapMap.th = wrapMap.td;\n\n// Support: IE <=9 only\n  if ( !support.option ) {\n    wrapMap.optgroup = wrapMap.option = [ 1, \"<select multiple='multiple'>\", \"</select>\" ];\n  }\n\n\n  function getAll( context, tag ) {\n\n    // Support: IE <=9 - 11 only\n    // Use typeof to avoid zero-argument method invocation on host objects (#15151)\n    var ret;\n\n    if ( typeof context.getElementsByTagName !== \"undefined\" ) {\n      ret = context.getElementsByTagName( tag || \"*\" );\n\n    } else if ( typeof context.querySelectorAll !== \"undefined\" ) {\n      ret = context.querySelectorAll( tag || \"*\" );\n\n    } else {\n      ret = [];\n    }\n\n    if ( tag === undefined || tag && nodeName( context, tag ) ) {\n      return jQuery.merge( [ context ], ret );\n    }\n\n    return ret;\n  }\n\n\n// Mark scripts as having already been evaluated\n  function setGlobalEval( elems, refElements ) {\n    var i = 0,\n      l = elems.length;\n\n    for ( ; i < l; i++ ) {\n      dataPriv.set(\n        elems[ i ],\n        \"globalEval\",\n        !refElements || dataPriv.get( refElements[ i ], \"globalEval\" )\n      );\n    }\n  }\n\n\n  var rhtml = /<|&#?\\w+;/;\n\n  function buildFragment( elems, context, scripts, selection, ignored ) {\n    var elem, tmp, tag, wrap, attached, j,\n      fragment = context.createDocumentFragment(),\n      nodes = [],\n      i = 0,\n      l = elems.length;\n\n    for ( ; i < l; i++ ) {\n      elem = elems[ i ];\n\n      if ( elem || elem === 0 ) {\n\n        // Add nodes directly\n        if ( toType( elem ) === \"object\" ) {\n\n          // Support: Android <=4.0 only, PhantomJS 1 only\n          // push.apply(_, arraylike) throws on ancient WebKit\n          jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );\n\n          // Convert non-html into a text node\n        } else if ( !rhtml.test( elem ) ) {\n          nodes.push( context.createTextNode( elem ) );\n\n          // Convert html into DOM nodes\n        } else {\n          tmp = tmp || fragment.appendChild( context.createElement( \"div\" ) );\n\n          // Deserialize a standard representation\n          tag = ( rtagName.exec( elem ) || [ \"\", \"\" ] )[ 1 ].toLowerCase();\n          wrap = wrapMap[ tag ] || wrapMap._default;\n          tmp.innerHTML = wrap[ 1 ] + jQuery.htmlPrefilter( elem ) + wrap[ 2 ];\n\n          // Descend through wrappers to the right content\n          j = wrap[ 0 ];\n          while ( j-- ) {\n            tmp = tmp.lastChild;\n          }\n\n          // Support: Android <=4.0 only, PhantomJS 1 only\n          // push.apply(_, arraylike) throws on ancient WebKit\n          jQuery.merge( nodes, tmp.childNodes );\n\n          // Remember the top-level container\n          tmp = fragment.firstChild;\n\n          // Ensure the created nodes are orphaned (#12392)\n          tmp.textContent = \"\";\n        }\n      }\n    }\n\n    // Remove wrapper from fragment\n    fragment.textContent = \"\";\n\n    i = 0;\n    while ( ( elem = nodes[ i++ ] ) ) {\n\n      // Skip elements already in the context collection (trac-4087)\n      if ( selection && jQuery.inArray( elem, selection ) > -1 ) {\n        if ( ignored ) {\n          ignored.push( elem );\n        }\n        continue;\n      }\n\n      attached = isAttached( elem );\n\n      // Append to fragment\n      tmp = getAll( fragment.appendChild( elem ), \"script\" );\n\n      // Preserve script evaluation history\n      if ( attached ) {\n        setGlobalEval( tmp );\n      }\n\n      // Capture executables\n      if ( scripts ) {\n        j = 0;\n        while ( ( elem = tmp[ j++ ] ) ) {\n          if ( rscriptType.test( elem.type || \"\" ) ) {\n            scripts.push( elem );\n          }\n        }\n      }\n    }\n\n    return fragment;\n  }\n\n\n  var\n    rkeyEvent = /^key/,\n    rmouseEvent = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,\n    rtypenamespace = /^([^.]*)(?:\\.(.+)|)/;\n\n  function returnTrue() {\n    return true;\n  }\n\n  function returnFalse() {\n    return false;\n  }\n\n// Support: IE <=9 - 11+\n// focus() and blur() are asynchronous, except when they are no-op.\n// So expect focus to be synchronous when the element is already active,\n// and blur to be synchronous when the element is not already active.\n// (focus and blur are always synchronous in other supported browsers,\n// this just defines when we can count on it).\n  function expectSync( elem, type ) {\n    return ( elem === safeActiveElement() ) === ( type === \"focus\" );\n  }\n\n// Support: IE <=9 only\n// Accessing document.activeElement can throw unexpectedly\n// https://bugs.jquery.com/ticket/13393\n  function safeActiveElement() {\n    try {\n      return document.activeElement;\n    } catch ( err ) { }\n  }\n\n  function on( elem, types, selector, data, fn, one ) {\n    var origFn, type;\n\n    // Types can be a map of types/handlers\n    if ( typeof types === \"object\" ) {\n\n      // ( types-Object, selector, data )\n      if ( typeof selector !== \"string\" ) {\n\n        // ( types-Object, data )\n        data = data || selector;\n        selector = undefined;\n      }\n      for ( type in types ) {\n        on( elem, type, selector, data, types[ type ], one );\n      }\n      return elem;\n    }\n\n    if ( data == null && fn == null ) {\n\n      // ( types, fn )\n      fn = selector;\n      data = selector = undefined;\n    } else if ( fn == null ) {\n      if ( typeof selector === \"string\" ) {\n\n        // ( types, selector, fn )\n        fn = data;\n        data = undefined;\n      } else {\n\n        // ( types, data, fn )\n        fn = data;\n        data = selector;\n        selector = undefined;\n      }\n    }\n    if ( fn === false ) {\n      fn = returnFalse;\n    } else if ( !fn ) {\n      return elem;\n    }\n\n    if ( one === 1 ) {\n      origFn = fn;\n      fn = function( event ) {\n\n        // Can use an empty set, since event contains the info\n        jQuery().off( event );\n        return origFn.apply( this, arguments );\n      };\n\n      // Use same guid so caller can remove using origFn\n      fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\n    }\n    return elem.each( function() {\n      jQuery.event.add( this, types, fn, data, selector );\n    } );\n  }\n\n  /*\n * Helper functions for managing events -- not part of the public interface.\n * Props to Dean Edwards' addEvent library for many of the ideas.\n */\n  jQuery.event = {\n\n    global: {},\n\n    add: function( elem, types, handler, data, selector ) {\n\n      var handleObjIn, eventHandle, tmp,\n        events, t, handleObj,\n        special, handlers, type, namespaces, origType,\n        elemData = dataPriv.get( elem );\n\n      // Only attach events to objects that accept data\n      if ( !acceptData( elem ) ) {\n        return;\n      }\n\n      // Caller can pass in an object of custom data in lieu of the handler\n      if ( handler.handler ) {\n        handleObjIn = handler;\n        handler = handleObjIn.handler;\n        selector = handleObjIn.selector;\n      }\n\n      // Ensure that invalid selectors throw exceptions at attach time\n      // Evaluate against documentElement in case elem is a non-element node (e.g., document)\n      if ( selector ) {\n        jQuery.find.matchesSelector( documentElement, selector );\n      }\n\n      // Make sure that the handler has a unique ID, used to find/remove it later\n      if ( !handler.guid ) {\n        handler.guid = jQuery.guid++;\n      }\n\n      // Init the element's event structure and main handler, if this is the first\n      if ( !( events = elemData.events ) ) {\n        events = elemData.events = Object.create( null );\n      }\n      if ( !( eventHandle = elemData.handle ) ) {\n        eventHandle = elemData.handle = function( e ) {\n\n          // Discard the second event of a jQuery.event.trigger() and\n          // when an event is called after a page has unloaded\n          return typeof jQuery !== \"undefined\" && jQuery.event.triggered !== e.type ?\n            jQuery.event.dispatch.apply( elem, arguments ) : undefined;\n        };\n      }\n\n      // Handle multiple events separated by a space\n      types = ( types || \"\" ).match( rnothtmlwhite ) || [ \"\" ];\n      t = types.length;\n      while ( t-- ) {\n        tmp = rtypenamespace.exec( types[ t ] ) || [];\n        type = origType = tmp[ 1 ];\n        namespaces = ( tmp[ 2 ] || \"\" ).split( \".\" ).sort();\n\n        // There *must* be a type, no attaching namespace-only handlers\n        if ( !type ) {\n          continue;\n        }\n\n        // If event changes its type, use the special event handlers for the changed type\n        special = jQuery.event.special[ type ] || {};\n\n        // If selector defined, determine special event api type, otherwise given type\n        type = ( selector ? special.delegateType : special.bindType ) || type;\n\n        // Update special based on newly reset type\n        special = jQuery.event.special[ type ] || {};\n\n        // handleObj is passed to all event handlers\n        handleObj = jQuery.extend( {\n          type: type,\n          origType: origType,\n          data: data,\n          handler: handler,\n          guid: handler.guid,\n          selector: selector,\n          needsContext: selector && jQuery.expr.match.needsContext.test( selector ),\n          namespace: namespaces.join( \".\" )\n        }, handleObjIn );\n\n        // Init the event handler queue if we're the first\n        if ( !( handlers = events[ type ] ) ) {\n          handlers = events[ type ] = [];\n          handlers.delegateCount = 0;\n\n          // Only use addEventListener if the special events handler returns false\n          if ( !special.setup ||\n            special.setup.call( elem, data, namespaces, eventHandle ) === false ) {\n\n            if ( elem.addEventListener ) {\n              elem.addEventListener( type, eventHandle );\n            }\n          }\n        }\n\n        if ( special.add ) {\n          special.add.call( elem, handleObj );\n\n          if ( !handleObj.handler.guid ) {\n            handleObj.handler.guid = handler.guid;\n          }\n        }\n\n        // Add to the element's handler list, delegates in front\n        if ( selector ) {\n          handlers.splice( handlers.delegateCount++, 0, handleObj );\n        } else {\n          handlers.push( handleObj );\n        }\n\n        // Keep track of which events have ever been used, for event optimization\n        jQuery.event.global[ type ] = true;\n      }\n\n    },\n\n    // Detach an event or set of events from an element\n    remove: function( elem, types, handler, selector, mappedTypes ) {\n\n      var j, origCount, tmp,\n        events, t, handleObj,\n        special, handlers, type, namespaces, origType,\n        elemData = dataPriv.hasData( elem ) && dataPriv.get( elem );\n\n      if ( !elemData || !( events = elemData.events ) ) {\n        return;\n      }\n\n      // Once for each type.namespace in types; type may be omitted\n      types = ( types || \"\" ).match( rnothtmlwhite ) || [ \"\" ];\n      t = types.length;\n      while ( t-- ) {\n        tmp = rtypenamespace.exec( types[ t ] ) || [];\n        type = origType = tmp[ 1 ];\n        namespaces = ( tmp[ 2 ] || \"\" ).split( \".\" ).sort();\n\n        // Unbind all events (on this namespace, if provided) for the element\n        if ( !type ) {\n          for ( type in events ) {\n            jQuery.event.remove( elem, type + types[ t ], handler, selector, true );\n          }\n          continue;\n        }\n\n        special = jQuery.event.special[ type ] || {};\n        type = ( selector ? special.delegateType : special.bindType ) || type;\n        handlers = events[ type ] || [];\n        tmp = tmp[ 2 ] &&\n          new RegExp( \"(^|\\\\.)\" + namespaces.join( \"\\\\.(?:.*\\\\.|)\" ) + \"(\\\\.|$)\" );\n\n        // Remove matching events\n        origCount = j = handlers.length;\n        while ( j-- ) {\n          handleObj = handlers[ j ];\n\n          if ( ( mappedTypes || origType === handleObj.origType ) &&\n            ( !handler || handler.guid === handleObj.guid ) &&\n            ( !tmp || tmp.test( handleObj.namespace ) ) &&\n            ( !selector || selector === handleObj.selector ||\n              selector === \"**\" && handleObj.selector ) ) {\n            handlers.splice( j, 1 );\n\n            if ( handleObj.selector ) {\n              handlers.delegateCount--;\n            }\n            if ( special.remove ) {\n              special.remove.call( elem, handleObj );\n            }\n          }\n        }\n\n        // Remove generic event handler if we removed something and no more handlers exist\n        // (avoids potential for endless recursion during removal of special event handlers)\n        if ( origCount && !handlers.length ) {\n          if ( !special.teardown ||\n            special.teardown.call( elem, namespaces, elemData.handle ) === false ) {\n\n            jQuery.removeEvent( elem, type, elemData.handle );\n          }\n\n          delete events[ type ];\n        }\n      }\n\n      // Remove data and the expando if it's no longer used\n      if ( jQuery.isEmptyObject( events ) ) {\n        dataPriv.remove( elem, \"handle events\" );\n      }\n    },\n\n    dispatch: function( nativeEvent ) {\n\n      var i, j, ret, matched, handleObj, handlerQueue,\n        args = new Array( arguments.length ),\n\n        // Make a writable jQuery.Event from the native event object\n        event = jQuery.event.fix( nativeEvent ),\n\n        handlers = (\n          dataPriv.get( this, \"events\" ) || Object.create( null )\n        )[ event.type ] || [],\n        special = jQuery.event.special[ event.type ] || {};\n\n      // Use the fix-ed jQuery.Event rather than the (read-only) native event\n      args[ 0 ] = event;\n\n      for ( i = 1; i < arguments.length; i++ ) {\n        args[ i ] = arguments[ i ];\n      }\n\n      event.delegateTarget = this;\n\n      // Call the preDispatch hook for the mapped type, and let it bail if desired\n      if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\n        return;\n      }\n\n      // Determine handlers\n      handlerQueue = jQuery.event.handlers.call( this, event, handlers );\n\n      // Run delegates first; they may want to stop propagation beneath us\n      i = 0;\n      while ( ( matched = handlerQueue[ i++ ] ) && !event.isPropagationStopped() ) {\n        event.currentTarget = matched.elem;\n\n        j = 0;\n        while ( ( handleObj = matched.handlers[ j++ ] ) &&\n        !event.isImmediatePropagationStopped() ) {\n\n          // If the event is namespaced, then each handler is only invoked if it is\n          // specially universal or its namespaces are a superset of the event's.\n          if ( !event.rnamespace || handleObj.namespace === false ||\n            event.rnamespace.test( handleObj.namespace ) ) {\n\n            event.handleObj = handleObj;\n            event.data = handleObj.data;\n\n            ret = ( ( jQuery.event.special[ handleObj.origType ] || {} ).handle ||\n              handleObj.handler ).apply( matched.elem, args );\n\n            if ( ret !== undefined ) {\n              if ( ( event.result = ret ) === false ) {\n                event.preventDefault();\n                event.stopPropagation();\n              }\n            }\n          }\n        }\n      }\n\n      // Call the postDispatch hook for the mapped type\n      if ( special.postDispatch ) {\n        special.postDispatch.call( this, event );\n      }\n\n      return event.result;\n    },\n\n    handlers: function( event, handlers ) {\n      var i, handleObj, sel, matchedHandlers, matchedSelectors,\n        handlerQueue = [],\n        delegateCount = handlers.delegateCount,\n        cur = event.target;\n\n      // Find delegate handlers\n      if ( delegateCount &&\n\n        // Support: IE <=9\n        // Black-hole SVG <use> instance trees (trac-13180)\n        cur.nodeType &&\n\n        // Support: Firefox <=42\n        // Suppress spec-violating clicks indicating a non-primary pointer button (trac-3861)\n        // https://www.w3.org/TR/DOM-Level-3-Events/#event-type-click\n        // Support: IE 11 only\n        // ...but not arrow key \"clicks\" of radio inputs, which can have `button` -1 (gh-2343)\n        !( event.type === \"click\" && event.button >= 1 ) ) {\n\n        for ( ; cur !== this; cur = cur.parentNode || this ) {\n\n          // Don't check non-elements (#13208)\n          // Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)\n          if ( cur.nodeType === 1 && !( event.type === \"click\" && cur.disabled === true ) ) {\n            matchedHandlers = [];\n            matchedSelectors = {};\n            for ( i = 0; i < delegateCount; i++ ) {\n              handleObj = handlers[ i ];\n\n              // Don't conflict with Object.prototype properties (#13203)\n              sel = handleObj.selector + \" \";\n\n              if ( matchedSelectors[ sel ] === undefined ) {\n                matchedSelectors[ sel ] = handleObj.needsContext ?\n                  jQuery( sel, this ).index( cur ) > -1 :\n                  jQuery.find( sel, this, null, [ cur ] ).length;\n              }\n              if ( matchedSelectors[ sel ] ) {\n                matchedHandlers.push( handleObj );\n              }\n            }\n            if ( matchedHandlers.length ) {\n              handlerQueue.push( { elem: cur, handlers: matchedHandlers } );\n            }\n          }\n        }\n      }\n\n      // Add the remaining (directly-bound) handlers\n      cur = this;\n      if ( delegateCount < handlers.length ) {\n        handlerQueue.push( { elem: cur, handlers: handlers.slice( delegateCount ) } );\n      }\n\n      return handlerQueue;\n    },\n\n    addProp: function( name, hook ) {\n      Object.defineProperty( jQuery.Event.prototype, name, {\n        enumerable: true,\n        configurable: true,\n\n        get: isFunction( hook ) ?\n          function() {\n            if ( this.originalEvent ) {\n              return hook( this.originalEvent );\n            }\n          } :\n          function() {\n            if ( this.originalEvent ) {\n              return this.originalEvent[ name ];\n            }\n          },\n\n        set: function( value ) {\n          Object.defineProperty( this, name, {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: value\n          } );\n        }\n      } );\n    },\n\n    fix: function( originalEvent ) {\n      return originalEvent[ jQuery.expando ] ?\n        originalEvent :\n        new jQuery.Event( originalEvent );\n    },\n\n    special: {\n      load: {\n\n        // Prevent triggered image.load events from bubbling to window.load\n        noBubble: true\n      },\n      click: {\n\n        // Utilize native event to ensure correct state for checkable inputs\n        setup: function( data ) {\n\n          // For mutual compressibility with _default, replace `this` access with a local var.\n          // `|| data` is dead code meant only to preserve the variable through minification.\n          var el = this || data;\n\n          // Claim the first handler\n          if ( rcheckableType.test( el.type ) &&\n            el.click && nodeName( el, \"input\" ) ) {\n\n            // dataPriv.set( el, \"click\", ... )\n            leverageNative( el, \"click\", returnTrue );\n          }\n\n          // Return false to allow normal processing in the caller\n          return false;\n        },\n        trigger: function( data ) {\n\n          // For mutual compressibility with _default, replace `this` access with a local var.\n          // `|| data` is dead code meant only to preserve the variable through minification.\n          var el = this || data;\n\n          // Force setup before triggering a click\n          if ( rcheckableType.test( el.type ) &&\n            el.click && nodeName( el, \"input\" ) ) {\n\n            leverageNative( el, \"click\" );\n          }\n\n          // Return non-false to allow normal event-path propagation\n          return true;\n        },\n\n        // For cross-browser consistency, suppress native .click() on links\n        // Also prevent it if we're currently inside a leveraged native-event stack\n        _default: function( event ) {\n          var target = event.target;\n          return rcheckableType.test( target.type ) &&\n            target.click && nodeName( target, \"input\" ) &&\n            dataPriv.get( target, \"click\" ) ||\n            nodeName( target, \"a\" );\n        }\n      },\n\n      beforeunload: {\n        postDispatch: function( event ) {\n\n          // Support: Firefox 20+\n          // Firefox doesn't alert if the returnValue field is not set.\n          if ( event.result !== undefined && event.originalEvent ) {\n            event.originalEvent.returnValue = event.result;\n          }\n        }\n      }\n    }\n  };\n\n// Ensure the presence of an event listener that handles manually-triggered\n// synthetic events by interrupting progress until reinvoked in response to\n// *native* events that it fires directly, ensuring that state changes have\n// already occurred before other listeners are invoked.\n  function leverageNative( el, type, expectSync ) {\n\n    // Missing expectSync indicates a trigger call, which must force setup through jQuery.event.add\n    if ( !expectSync ) {\n      if ( dataPriv.get( el, type ) === undefined ) {\n        jQuery.event.add( el, type, returnTrue );\n      }\n      return;\n    }\n\n    // Register the controller as a special universal handler for all event namespaces\n    dataPriv.set( el, type, false );\n    jQuery.event.add( el, type, {\n      namespace: false,\n      handler: function( event ) {\n        var notAsync, result,\n          saved = dataPriv.get( this, type );\n\n        if ( ( event.isTrigger & 1 ) && this[ type ] ) {\n\n          // Interrupt processing of the outer synthetic .trigger()ed event\n          // Saved data should be false in such cases, but might be a leftover capture object\n          // from an async native handler (gh-4350)\n          if ( !saved.length ) {\n\n            // Store arguments for use when handling the inner native event\n            // There will always be at least one argument (an event object), so this array\n            // will not be confused with a leftover capture object.\n            saved = slice.call( arguments );\n            dataPriv.set( this, type, saved );\n\n            // Trigger the native event and capture its result\n            // Support: IE <=9 - 11+\n            // focus() and blur() are asynchronous\n            notAsync = expectSync( this, type );\n            this[ type ]();\n            result = dataPriv.get( this, type );\n            if ( saved !== result || notAsync ) {\n              dataPriv.set( this, type, false );\n            } else {\n              result = {};\n            }\n            if ( saved !== result ) {\n\n              // Cancel the outer synthetic event\n              event.stopImmediatePropagation();\n              event.preventDefault();\n              return result.value;\n            }\n\n            // If this is an inner synthetic event for an event with a bubbling surrogate\n            // (focus or blur), assume that the surrogate already propagated from triggering the\n            // native event and prevent that from happening again here.\n            // This technically gets the ordering wrong w.r.t. to `.trigger()` (in which the\n            // bubbling surrogate propagates *after* the non-bubbling base), but that seems\n            // less bad than duplication.\n          } else if ( ( jQuery.event.special[ type ] || {} ).delegateType ) {\n            event.stopPropagation();\n          }\n\n          // If this is a native event triggered above, everything is now in order\n          // Fire an inner synthetic event with the original arguments\n        } else if ( saved.length ) {\n\n          // ...and capture the result\n          dataPriv.set( this, type, {\n            value: jQuery.event.trigger(\n\n              // Support: IE <=9 - 11+\n              // Extend with the prototype to reset the above stopImmediatePropagation()\n              jQuery.extend( saved[ 0 ], jQuery.Event.prototype ),\n              saved.slice( 1 ),\n              this\n            )\n          } );\n\n          // Abort handling of the native event\n          event.stopImmediatePropagation();\n        }\n      }\n    } );\n  }\n\n  jQuery.removeEvent = function( elem, type, handle ) {\n\n    // This \"if\" is needed for plain objects\n    if ( elem.removeEventListener ) {\n      elem.removeEventListener( type, handle );\n    }\n  };\n\n  jQuery.Event = function( src, props ) {\n\n    // Allow instantiation without the 'new' keyword\n    if ( !( this instanceof jQuery.Event ) ) {\n      return new jQuery.Event( src, props );\n    }\n\n    // Event object\n    if ( src && src.type ) {\n      this.originalEvent = src;\n      this.type = src.type;\n\n      // Events bubbling up the document may have been marked as prevented\n      // by a handler lower down the tree; reflect the correct value.\n      this.isDefaultPrevented = src.defaultPrevented ||\n      src.defaultPrevented === undefined &&\n\n      // Support: Android <=2.3 only\n      src.returnValue === false ?\n        returnTrue :\n        returnFalse;\n\n      // Create target properties\n      // Support: Safari <=6 - 7 only\n      // Target should not be a text node (#504, #13143)\n      this.target = ( src.target && src.target.nodeType === 3 ) ?\n        src.target.parentNode :\n        src.target;\n\n      this.currentTarget = src.currentTarget;\n      this.relatedTarget = src.relatedTarget;\n\n      // Event type\n    } else {\n      this.type = src;\n    }\n\n    // Put explicitly provided properties onto the event object\n    if ( props ) {\n      jQuery.extend( this, props );\n    }\n\n    // Create a timestamp if incoming event doesn't have one\n    this.timeStamp = src && src.timeStamp || Date.now();\n\n    // Mark it as fixed\n    this[ jQuery.expando ] = true;\n  };\n\n// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\n// https://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\n  jQuery.Event.prototype = {\n    constructor: jQuery.Event,\n    isDefaultPrevented: returnFalse,\n    isPropagationStopped: returnFalse,\n    isImmediatePropagationStopped: returnFalse,\n    isSimulated: false,\n\n    preventDefault: function() {\n      var e = this.originalEvent;\n\n      this.isDefaultPrevented = returnTrue;\n\n      if ( e && !this.isSimulated ) {\n        e.preventDefault();\n      }\n    },\n    stopPropagation: function() {\n      var e = this.originalEvent;\n\n      this.isPropagationStopped = returnTrue;\n\n      if ( e && !this.isSimulated ) {\n        e.stopPropagation();\n      }\n    },\n    stopImmediatePropagation: function() {\n      var e = this.originalEvent;\n\n      this.isImmediatePropagationStopped = returnTrue;\n\n      if ( e && !this.isSimulated ) {\n        e.stopImmediatePropagation();\n      }\n\n      this.stopPropagation();\n    }\n  };\n\n// Includes all common event props including KeyEvent and MouseEvent specific props\n  jQuery.each( {\n    altKey: true,\n    bubbles: true,\n    cancelable: true,\n    changedTouches: true,\n    ctrlKey: true,\n    detail: true,\n    eventPhase: true,\n    metaKey: true,\n    pageX: true,\n    pageY: true,\n    shiftKey: true,\n    view: true,\n    \"char\": true,\n    code: true,\n    charCode: true,\n    key: true,\n    keyCode: true,\n    button: true,\n    buttons: true,\n    clientX: true,\n    clientY: true,\n    offsetX: true,\n    offsetY: true,\n    pointerId: true,\n    pointerType: true,\n    screenX: true,\n    screenY: true,\n    targetTouches: true,\n    toElement: true,\n    touches: true,\n\n    which: function( event ) {\n      var button = event.button;\n\n      // Add which for key events\n      if ( event.which == null && rkeyEvent.test( event.type ) ) {\n        return event.charCode != null ? event.charCode : event.keyCode;\n      }\n\n      // Add which for click: 1 === left; 2 === middle; 3 === right\n      if ( !event.which && button !== undefined && rmouseEvent.test( event.type ) ) {\n        if ( button & 1 ) {\n          return 1;\n        }\n\n        if ( button & 2 ) {\n          return 3;\n        }\n\n        if ( button & 4 ) {\n          return 2;\n        }\n\n        return 0;\n      }\n\n      return event.which;\n    }\n  }, jQuery.event.addProp );\n\n  jQuery.each( { focus: \"focusin\", blur: \"focusout\" }, function( type, delegateType ) {\n    jQuery.event.special[ type ] = {\n\n      // Utilize native event if possible so blur/focus sequence is correct\n      setup: function() {\n\n        // Claim the first handler\n        // dataPriv.set( this, \"focus\", ... )\n        // dataPriv.set( this, \"blur\", ... )\n        leverageNative( this, type, expectSync );\n\n        // Return false to allow normal processing in the caller\n        return false;\n      },\n      trigger: function() {\n\n        // Force setup before trigger\n        leverageNative( this, type );\n\n        // Return non-false to allow normal event-path propagation\n        return true;\n      },\n\n      delegateType: delegateType\n    };\n  } );\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\n// so that event delegation works in jQuery.\n// Do the same for pointerenter/pointerleave and pointerover/pointerout\n//\n// Support: Safari 7 only\n// Safari sends mouseenter too often; see:\n// https://bugs.chromium.org/p/chromium/issues/detail?id=470258\n// for the description of the bug (it existed in older Chrome versions as well).\n  jQuery.each( {\n    mouseenter: \"mouseover\",\n    mouseleave: \"mouseout\",\n    pointerenter: \"pointerover\",\n    pointerleave: \"pointerout\"\n  }, function( orig, fix ) {\n    jQuery.event.special[ orig ] = {\n      delegateType: fix,\n      bindType: fix,\n\n      handle: function( event ) {\n        var ret,\n          target = this,\n          related = event.relatedTarget,\n          handleObj = event.handleObj;\n\n        // For mouseenter/leave call the handler if related is outside the target.\n        // NB: No relatedTarget if the mouse left/entered the browser window\n        if ( !related || ( related !== target && !jQuery.contains( target, related ) ) ) {\n          event.type = handleObj.origType;\n          ret = handleObj.handler.apply( this, arguments );\n          event.type = fix;\n        }\n        return ret;\n      }\n    };\n  } );\n\n  jQuery.fn.extend( {\n\n    on: function( types, selector, data, fn ) {\n      return on( this, types, selector, data, fn );\n    },\n    one: function( types, selector, data, fn ) {\n      return on( this, types, selector, data, fn, 1 );\n    },\n    off: function( types, selector, fn ) {\n      var handleObj, type;\n      if ( types && types.preventDefault && types.handleObj ) {\n\n        // ( event )  dispatched jQuery.Event\n        handleObj = types.handleObj;\n        jQuery( types.delegateTarget ).off(\n          handleObj.namespace ?\n            handleObj.origType + \".\" + handleObj.namespace :\n            handleObj.origType,\n          handleObj.selector,\n          handleObj.handler\n        );\n        return this;\n      }\n      if ( typeof types === \"object\" ) {\n\n        // ( types-object [, selector] )\n        for ( type in types ) {\n          this.off( type, selector, types[ type ] );\n        }\n        return this;\n      }\n      if ( selector === false || typeof selector === \"function\" ) {\n\n        // ( types [, fn] )\n        fn = selector;\n        selector = undefined;\n      }\n      if ( fn === false ) {\n        fn = returnFalse;\n      }\n      return this.each( function() {\n        jQuery.event.remove( this, types, fn, selector );\n      } );\n    }\n  } );\n\n\n  var\n\n    // Support: IE <=10 - 11, Edge 12 - 13 only\n    // In IE/Edge using regex groups here causes severe slowdowns.\n    // See https://connect.microsoft.com/IE/feedback/details/1736512/\n    rnoInnerhtml = /<script|<style|<link/i,\n\n    // checked=\"checked\" or checked\n    rchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\n    rcleanScript = /^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g;\n\n// Prefer a tbody over its parent table for containing new rows\n  function manipulationTarget( elem, content ) {\n    if ( nodeName( elem, \"table\" ) &&\n      nodeName( content.nodeType !== 11 ? content : content.firstChild, \"tr\" ) ) {\n\n      return jQuery( elem ).children( \"tbody\" )[ 0 ] || elem;\n    }\n\n    return elem;\n  }\n\n// Replace/restore the type attribute of script elements for safe DOM manipulation\n  function disableScript( elem ) {\n    elem.type = ( elem.getAttribute( \"type\" ) !== null ) + \"/\" + elem.type;\n    return elem;\n  }\n  function restoreScript( elem ) {\n    if ( ( elem.type || \"\" ).slice( 0, 5 ) === \"true/\" ) {\n      elem.type = elem.type.slice( 5 );\n    } else {\n      elem.removeAttribute( \"type\" );\n    }\n\n    return elem;\n  }\n\n  function cloneCopyEvent( src, dest ) {\n    var i, l, type, pdataOld, udataOld, udataCur, events;\n\n    if ( dest.nodeType !== 1 ) {\n      return;\n    }\n\n    // 1. Copy private data: events, handlers, etc.\n    if ( dataPriv.hasData( src ) ) {\n      pdataOld = dataPriv.get( src );\n      events = pdataOld.events;\n\n      if ( events ) {\n        dataPriv.remove( dest, \"handle events\" );\n\n        for ( type in events ) {\n          for ( i = 0, l = events[ type ].length; i < l; i++ ) {\n            jQuery.event.add( dest, type, events[ type ][ i ] );\n          }\n        }\n      }\n    }\n\n    // 2. Copy user data\n    if ( dataUser.hasData( src ) ) {\n      udataOld = dataUser.access( src );\n      udataCur = jQuery.extend( {}, udataOld );\n\n      dataUser.set( dest, udataCur );\n    }\n  }\n\n// Fix IE bugs, see support tests\n  function fixInput( src, dest ) {\n    var nodeName = dest.nodeName.toLowerCase();\n\n    // Fails to persist the checked state of a cloned checkbox or radio button.\n    if ( nodeName === \"input\" && rcheckableType.test( src.type ) ) {\n      dest.checked = src.checked;\n\n      // Fails to return the selected option to the default selected state when cloning options\n    } else if ( nodeName === \"input\" || nodeName === \"textarea\" ) {\n      dest.defaultValue = src.defaultValue;\n    }\n  }\n\n  function domManip( collection, args, callback, ignored ) {\n\n    // Flatten any nested arrays\n    args = flat( args );\n\n    var fragment, first, scripts, hasScripts, node, doc,\n      i = 0,\n      l = collection.length,\n      iNoClone = l - 1,\n      value = args[ 0 ],\n      valueIsFunction = isFunction( value );\n\n    // We can't cloneNode fragments that contain checked, in WebKit\n    if ( valueIsFunction ||\n      ( l > 1 && typeof value === \"string\" &&\n        !support.checkClone && rchecked.test( value ) ) ) {\n      return collection.each( function( index ) {\n        var self = collection.eq( index );\n        if ( valueIsFunction ) {\n          args[ 0 ] = value.call( this, index, self.html() );\n        }\n        domManip( self, args, callback, ignored );\n      } );\n    }\n\n    if ( l ) {\n      fragment = buildFragment( args, collection[ 0 ].ownerDocument, false, collection, ignored );\n      first = fragment.firstChild;\n\n      if ( fragment.childNodes.length === 1 ) {\n        fragment = first;\n      }\n\n      // Require either new content or an interest in ignored elements to invoke the callback\n      if ( first || ignored ) {\n        scripts = jQuery.map( getAll( fragment, \"script\" ), disableScript );\n        hasScripts = scripts.length;\n\n        // Use the original fragment for the last item\n        // instead of the first because it can end up\n        // being emptied incorrectly in certain situations (#8070).\n        for ( ; i < l; i++ ) {\n          node = fragment;\n\n          if ( i !== iNoClone ) {\n            node = jQuery.clone( node, true, true );\n\n            // Keep references to cloned scripts for later restoration\n            if ( hasScripts ) {\n\n              // Support: Android <=4.0 only, PhantomJS 1 only\n              // push.apply(_, arraylike) throws on ancient WebKit\n              jQuery.merge( scripts, getAll( node, \"script\" ) );\n            }\n          }\n\n          callback.call( collection[ i ], node, i );\n        }\n\n        if ( hasScripts ) {\n          doc = scripts[ scripts.length - 1 ].ownerDocument;\n\n          // Reenable scripts\n          jQuery.map( scripts, restoreScript );\n\n          // Evaluate executable scripts on first document insertion\n          for ( i = 0; i < hasScripts; i++ ) {\n            node = scripts[ i ];\n            if ( rscriptType.test( node.type || \"\" ) &&\n              !dataPriv.access( node, \"globalEval\" ) &&\n              jQuery.contains( doc, node ) ) {\n\n              if ( node.src && ( node.type || \"\" ).toLowerCase()  !== \"module\" ) {\n\n                // Optional AJAX dependency, but won't run scripts if not present\n                if ( jQuery._evalUrl && !node.noModule ) {\n                  jQuery._evalUrl( node.src, {\n                    nonce: node.nonce || node.getAttribute( \"nonce\" )\n                  }, doc );\n                }\n              } else {\n                DOMEval( node.textContent.replace( rcleanScript, \"\" ), node, doc );\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return collection;\n  }\n\n  function remove( elem, selector, keepData ) {\n    var node,\n      nodes = selector ? jQuery.filter( selector, elem ) : elem,\n      i = 0;\n\n    for ( ; ( node = nodes[ i ] ) != null; i++ ) {\n      if ( !keepData && node.nodeType === 1 ) {\n        jQuery.cleanData( getAll( node ) );\n      }\n\n      if ( node.parentNode ) {\n        if ( keepData && isAttached( node ) ) {\n          setGlobalEval( getAll( node, \"script\" ) );\n        }\n        node.parentNode.removeChild( node );\n      }\n    }\n\n    return elem;\n  }\n\n  jQuery.extend( {\n    htmlPrefilter: function( html ) {\n      return html;\n    },\n\n    clone: function( elem, dataAndEvents, deepDataAndEvents ) {\n      var i, l, srcElements, destElements,\n        clone = elem.cloneNode( true ),\n        inPage = isAttached( elem );\n\n      // Fix IE cloning issues\n      if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&\n        !jQuery.isXMLDoc( elem ) ) {\n\n        // We eschew Sizzle here for performance reasons: https://jsperf.com/getall-vs-sizzle/2\n        destElements = getAll( clone );\n        srcElements = getAll( elem );\n\n        for ( i = 0, l = srcElements.length; i < l; i++ ) {\n          fixInput( srcElements[ i ], destElements[ i ] );\n        }\n      }\n\n      // Copy the events from the original to the clone\n      if ( dataAndEvents ) {\n        if ( deepDataAndEvents ) {\n          srcElements = srcElements || getAll( elem );\n          destElements = destElements || getAll( clone );\n\n          for ( i = 0, l = srcElements.length; i < l; i++ ) {\n            cloneCopyEvent( srcElements[ i ], destElements[ i ] );\n          }\n        } else {\n          cloneCopyEvent( elem, clone );\n        }\n      }\n\n      // Preserve script evaluation history\n      destElements = getAll( clone, \"script\" );\n      if ( destElements.length > 0 ) {\n        setGlobalEval( destElements, !inPage && getAll( elem, \"script\" ) );\n      }\n\n      // Return the cloned set\n      return clone;\n    },\n\n    cleanData: function( elems ) {\n      var data, elem, type,\n        special = jQuery.event.special,\n        i = 0;\n\n      for ( ; ( elem = elems[ i ] ) !== undefined; i++ ) {\n        if ( acceptData( elem ) ) {\n          if ( ( data = elem[ dataPriv.expando ] ) ) {\n            if ( data.events ) {\n              for ( type in data.events ) {\n                if ( special[ type ] ) {\n                  jQuery.event.remove( elem, type );\n\n                  // This is a shortcut to avoid jQuery.event.remove's overhead\n                } else {\n                  jQuery.removeEvent( elem, type, data.handle );\n                }\n              }\n            }\n\n            // Support: Chrome <=35 - 45+\n            // Assign undefined instead of using delete, see Data#remove\n            elem[ dataPriv.expando ] = undefined;\n          }\n          if ( elem[ dataUser.expando ] ) {\n\n            // Support: Chrome <=35 - 45+\n            // Assign undefined instead of using delete, see Data#remove\n            elem[ dataUser.expando ] = undefined;\n          }\n        }\n      }\n    }\n  } );\n\n  jQuery.fn.extend( {\n    detach: function( selector ) {\n      return remove( this, selector, true );\n    },\n\n    remove: function( selector ) {\n      return remove( this, selector );\n    },\n\n    text: function( value ) {\n      return access( this, function( value ) {\n        return value === undefined ?\n          jQuery.text( this ) :\n          this.empty().each( function() {\n            if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n              this.textContent = value;\n            }\n          } );\n      }, null, value, arguments.length );\n    },\n\n    append: function() {\n      return domManip( this, arguments, function( elem ) {\n        if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n          var target = manipulationTarget( this, elem );\n          target.appendChild( elem );\n        }\n      } );\n    },\n\n    prepend: function() {\n      return domManip( this, arguments, function( elem ) {\n        if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n          var target = manipulationTarget( this, elem );\n          target.insertBefore( elem, target.firstChild );\n        }\n      } );\n    },\n\n    before: function() {\n      return domManip( this, arguments, function( elem ) {\n        if ( this.parentNode ) {\n          this.parentNode.insertBefore( elem, this );\n        }\n      } );\n    },\n\n    after: function() {\n      return domManip( this, arguments, function( elem ) {\n        if ( this.parentNode ) {\n          this.parentNode.insertBefore( elem, this.nextSibling );\n        }\n      } );\n    },\n\n    empty: function() {\n      var elem,\n        i = 0;\n\n      for ( ; ( elem = this[ i ] ) != null; i++ ) {\n        if ( elem.nodeType === 1 ) {\n\n          // Prevent memory leaks\n          jQuery.cleanData( getAll( elem, false ) );\n\n          // Remove any remaining nodes\n          elem.textContent = \"\";\n        }\n      }\n\n      return this;\n    },\n\n    clone: function( dataAndEvents, deepDataAndEvents ) {\n      dataAndEvents = dataAndEvents == null ? false : dataAndEvents;\n      deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\n\n      return this.map( function() {\n        return jQuery.clone( this, dataAndEvents, deepDataAndEvents );\n      } );\n    },\n\n    html: function( value ) {\n      return access( this, function( value ) {\n        var elem = this[ 0 ] || {},\n          i = 0,\n          l = this.length;\n\n        if ( value === undefined && elem.nodeType === 1 ) {\n          return elem.innerHTML;\n        }\n\n        // See if we can take a shortcut and just use innerHTML\n        if ( typeof value === \"string\" && !rnoInnerhtml.test( value ) &&\n          !wrapMap[ ( rtagName.exec( value ) || [ \"\", \"\" ] )[ 1 ].toLowerCase() ] ) {\n\n          value = jQuery.htmlPrefilter( value );\n\n          try {\n            for ( ; i < l; i++ ) {\n              elem = this[ i ] || {};\n\n              // Remove element nodes and prevent memory leaks\n              if ( elem.nodeType === 1 ) {\n                jQuery.cleanData( getAll( elem, false ) );\n                elem.innerHTML = value;\n              }\n            }\n\n            elem = 0;\n\n            // If using innerHTML throws an exception, use the fallback method\n          } catch ( e ) {}\n        }\n\n        if ( elem ) {\n          this.empty().append( value );\n        }\n      }, null, value, arguments.length );\n    },\n\n    replaceWith: function() {\n      var ignored = [];\n\n      // Make the changes, replacing each non-ignored context element with the new content\n      return domManip( this, arguments, function( elem ) {\n        var parent = this.parentNode;\n\n        if ( jQuery.inArray( this, ignored ) < 0 ) {\n          jQuery.cleanData( getAll( this ) );\n          if ( parent ) {\n            parent.replaceChild( elem, this );\n          }\n        }\n\n        // Force callback invocation\n      }, ignored );\n    }\n  } );\n\n  jQuery.each( {\n    appendTo: \"append\",\n    prependTo: \"prepend\",\n    insertBefore: \"before\",\n    insertAfter: \"after\",\n    replaceAll: \"replaceWith\"\n  }, function( name, original ) {\n    jQuery.fn[ name ] = function( selector ) {\n      var elems,\n        ret = [],\n        insert = jQuery( selector ),\n        last = insert.length - 1,\n        i = 0;\n\n      for ( ; i <= last; i++ ) {\n        elems = i === last ? this : this.clone( true );\n        jQuery( insert[ i ] )[ original ]( elems );\n\n        // Support: Android <=4.0 only, PhantomJS 1 only\n        // .get() because push.apply(_, arraylike) throws on ancient WebKit\n        push.apply( ret, elems.get() );\n      }\n\n      return this.pushStack( ret );\n    };\n  } );\n  var rnumnonpx = new RegExp( \"^(\" + pnum + \")(?!px)[a-z%]+$\", \"i\" );\n\n  var getStyles = function( elem ) {\n\n    // Support: IE <=11 only, Firefox <=30 (#15098, #14150)\n    // IE throws on elements created in popups\n    // FF meanwhile throws on frame elements through \"defaultView.getComputedStyle\"\n    var view = elem.ownerDocument.defaultView;\n\n    if ( !view || !view.opener ) {\n      view = window;\n    }\n\n    return view.getComputedStyle( elem );\n  };\n\n  var swap = function( elem, options, callback ) {\n    var ret, name,\n      old = {};\n\n    // Remember the old values, and insert the new ones\n    for ( name in options ) {\n      old[ name ] = elem.style[ name ];\n      elem.style[ name ] = options[ name ];\n    }\n\n    ret = callback.call( elem );\n\n    // Revert the old values\n    for ( name in options ) {\n      elem.style[ name ] = old[ name ];\n    }\n\n    return ret;\n  };\n\n\n  var rboxStyle = new RegExp( cssExpand.join( \"|\" ), \"i\" );\n\n\n\n  ( function() {\n\n    // Executing both pixelPosition & boxSizingReliable tests require only one layout\n    // so they're executed at the same time to save the second computation.\n    function computeStyleTests() {\n\n      // This is a singleton, we need to execute it only once\n      if ( !div ) {\n        return;\n      }\n\n      container.style.cssText = \"position:absolute;left:-11111px;width:60px;\" +\n        \"margin-top:1px;padding:0;border:0\";\n      div.style.cssText =\n        \"position:relative;display:block;box-sizing:border-box;overflow:scroll;\" +\n        \"margin:auto;border:1px;padding:1px;\" +\n        \"width:60%;top:1%\";\n      documentElement.appendChild( container ).appendChild( div );\n\n      var divStyle = window.getComputedStyle( div );\n      pixelPositionVal = divStyle.top !== \"1%\";\n\n      // Support: Android 4.0 - 4.3 only, Firefox <=3 - 44\n      reliableMarginLeftVal = roundPixelMeasures( divStyle.marginLeft ) === 12;\n\n      // Support: Android 4.0 - 4.3 only, Safari <=9.1 - 10.1, iOS <=7.0 - 9.3\n      // Some styles come back with percentage values, even though they shouldn't\n      div.style.right = \"60%\";\n      pixelBoxStylesVal = roundPixelMeasures( divStyle.right ) === 36;\n\n      // Support: IE 9 - 11 only\n      // Detect misreporting of content dimensions for box-sizing:border-box elements\n      boxSizingReliableVal = roundPixelMeasures( divStyle.width ) === 36;\n\n      // Support: IE 9 only\n      // Detect overflow:scroll screwiness (gh-3699)\n      // Support: Chrome <=64\n      // Don't get tricked when zoom affects offsetWidth (gh-4029)\n      div.style.position = \"absolute\";\n      scrollboxSizeVal = roundPixelMeasures( div.offsetWidth / 3 ) === 12;\n\n      documentElement.removeChild( container );\n\n      // Nullify the div so it wouldn't be stored in the memory and\n      // it will also be a sign that checks already performed\n      div = null;\n    }\n\n    function roundPixelMeasures( measure ) {\n      return Math.round( parseFloat( measure ) );\n    }\n\n    var pixelPositionVal, boxSizingReliableVal, scrollboxSizeVal, pixelBoxStylesVal,\n      reliableTrDimensionsVal, reliableMarginLeftVal,\n      container = document.createElement( \"div\" ),\n      div = document.createElement( \"div\" );\n\n    // Finish early in limited (non-browser) environments\n    if ( !div.style ) {\n      return;\n    }\n\n    // Support: IE <=9 - 11 only\n    // Style of cloned element affects source element cloned (#8908)\n    div.style.backgroundClip = \"content-box\";\n    div.cloneNode( true ).style.backgroundClip = \"\";\n    support.clearCloneStyle = div.style.backgroundClip === \"content-box\";\n\n    jQuery.extend( support, {\n      boxSizingReliable: function() {\n        computeStyleTests();\n        return boxSizingReliableVal;\n      },\n      pixelBoxStyles: function() {\n        computeStyleTests();\n        return pixelBoxStylesVal;\n      },\n      pixelPosition: function() {\n        computeStyleTests();\n        return pixelPositionVal;\n      },\n      reliableMarginLeft: function() {\n        computeStyleTests();\n        return reliableMarginLeftVal;\n      },\n      scrollboxSize: function() {\n        computeStyleTests();\n        return scrollboxSizeVal;\n      },\n\n      // Support: IE 9 - 11+, Edge 15 - 18+\n      // IE/Edge misreport `getComputedStyle` of table rows with width/height\n      // set in CSS while `offset*` properties report correct values.\n      // Behavior in IE 9 is more subtle than in newer versions & it passes\n      // some versions of this test; make sure not to make it pass there!\n      reliableTrDimensions: function() {\n        var table, tr, trChild, trStyle;\n        if ( reliableTrDimensionsVal == null ) {\n          table = document.createElement( \"table\" );\n          tr = document.createElement( \"tr\" );\n          trChild = document.createElement( \"div\" );\n\n          table.style.cssText = \"position:absolute;left:-11111px\";\n          tr.style.height = \"1px\";\n          trChild.style.height = \"9px\";\n\n          documentElement\n            .appendChild( table )\n            .appendChild( tr )\n            .appendChild( trChild );\n\n          trStyle = window.getComputedStyle( tr );\n          reliableTrDimensionsVal = parseInt( trStyle.height ) > 3;\n\n          documentElement.removeChild( table );\n        }\n        return reliableTrDimensionsVal;\n      }\n    } );\n  } )();\n\n\n  function curCSS( elem, name, computed ) {\n    var width, minWidth, maxWidth, ret,\n\n      // Support: Firefox 51+\n      // Retrieving style before computed somehow\n      // fixes an issue with getting wrong values\n      // on detached elements\n      style = elem.style;\n\n    computed = computed || getStyles( elem );\n\n    // getPropertyValue is needed for:\n    //   .css('filter') (IE 9 only, #12537)\n    //   .css('--customProperty) (#3144)\n    if ( computed ) {\n      ret = computed.getPropertyValue( name ) || computed[ name ];\n\n      if ( ret === \"\" && !isAttached( elem ) ) {\n        ret = jQuery.style( elem, name );\n      }\n\n      // A tribute to the \"awesome hack by Dean Edwards\"\n      // Android Browser returns percentage for some values,\n      // but width seems to be reliably pixels.\n      // This is against the CSSOM draft spec:\n      // https://drafts.csswg.org/cssom/#resolved-values\n      if ( !support.pixelBoxStyles() && rnumnonpx.test( ret ) && rboxStyle.test( name ) ) {\n\n        // Remember the original values\n        width = style.width;\n        minWidth = style.minWidth;\n        maxWidth = style.maxWidth;\n\n        // Put in the new values to get a computed value out\n        style.minWidth = style.maxWidth = style.width = ret;\n        ret = computed.width;\n\n        // Revert the changed values\n        style.width = width;\n        style.minWidth = minWidth;\n        style.maxWidth = maxWidth;\n      }\n    }\n\n    return ret !== undefined ?\n\n      // Support: IE <=9 - 11 only\n      // IE returns zIndex value as an integer.\n      ret + \"\" :\n      ret;\n  }\n\n\n  function addGetHookIf( conditionFn, hookFn ) {\n\n    // Define the hook, we'll check on the first run if it's really needed.\n    return {\n      get: function() {\n        if ( conditionFn() ) {\n\n          // Hook not needed (or it's not possible to use it due\n          // to missing dependency), remove it.\n          delete this.get;\n          return;\n        }\n\n        // Hook needed; redefine it so that the support test is not executed again.\n        return ( this.get = hookFn ).apply( this, arguments );\n      }\n    };\n  }\n\n\n  var cssPrefixes = [ \"Webkit\", \"Moz\", \"ms\" ],\n    emptyStyle = document.createElement( \"div\" ).style,\n    vendorProps = {};\n\n// Return a vendor-prefixed property or undefined\n  function vendorPropName( name ) {\n\n    // Check for vendor prefixed names\n    var capName = name[ 0 ].toUpperCase() + name.slice( 1 ),\n      i = cssPrefixes.length;\n\n    while ( i-- ) {\n      name = cssPrefixes[ i ] + capName;\n      if ( name in emptyStyle ) {\n        return name;\n      }\n    }\n  }\n\n// Return a potentially-mapped jQuery.cssProps or vendor prefixed property\n  function finalPropName( name ) {\n    var final = jQuery.cssProps[ name ] || vendorProps[ name ];\n\n    if ( final ) {\n      return final;\n    }\n    if ( name in emptyStyle ) {\n      return name;\n    }\n    return vendorProps[ name ] = vendorPropName( name ) || name;\n  }\n\n\n  var\n\n    // Swappable if display is none or starts with table\n    // except \"table\", \"table-cell\", or \"table-caption\"\n    // See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display\n    rdisplayswap = /^(none|table(?!-c[ea]).+)/,\n    rcustomProp = /^--/,\n    cssShow = { position: \"absolute\", visibility: \"hidden\", display: \"block\" },\n    cssNormalTransform = {\n      letterSpacing: \"0\",\n      fontWeight: \"400\"\n    };\n\n  function setPositiveNumber( _elem, value, subtract ) {\n\n    // Any relative (+/-) values have already been\n    // normalized at this point\n    var matches = rcssNum.exec( value );\n    return matches ?\n\n      // Guard against undefined \"subtract\", e.g., when used as in cssHooks\n      Math.max( 0, matches[ 2 ] - ( subtract || 0 ) ) + ( matches[ 3 ] || \"px\" ) :\n      value;\n  }\n\n  function boxModelAdjustment( elem, dimension, box, isBorderBox, styles, computedVal ) {\n    var i = dimension === \"width\" ? 1 : 0,\n      extra = 0,\n      delta = 0;\n\n    // Adjustment may not be necessary\n    if ( box === ( isBorderBox ? \"border\" : \"content\" ) ) {\n      return 0;\n    }\n\n    for ( ; i < 4; i += 2 ) {\n\n      // Both box models exclude margin\n      if ( box === \"margin\" ) {\n        delta += jQuery.css( elem, box + cssExpand[ i ], true, styles );\n      }\n\n      // If we get here with a content-box, we're seeking \"padding\" or \"border\" or \"margin\"\n      if ( !isBorderBox ) {\n\n        // Add padding\n        delta += jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\n\n        // For \"border\" or \"margin\", add border\n        if ( box !== \"padding\" ) {\n          delta += jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n\n          // But still keep track of it otherwise\n        } else {\n          extra += jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n        }\n\n        // If we get here with a border-box (content + padding + border), we're seeking \"content\" or\n        // \"padding\" or \"margin\"\n      } else {\n\n        // For \"content\", subtract padding\n        if ( box === \"content\" ) {\n          delta -= jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\n        }\n\n        // For \"content\" or \"padding\", subtract border\n        if ( box !== \"margin\" ) {\n          delta -= jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n        }\n      }\n    }\n\n    // Account for positive content-box scroll gutter when requested by providing computedVal\n    if ( !isBorderBox && computedVal >= 0 ) {\n\n      // offsetWidth/offsetHeight is a rounded sum of content, padding, scroll gutter, and border\n      // Assuming integer scroll gutter, subtract the rest and round down\n      delta += Math.max( 0, Math.ceil(\n        elem[ \"offset\" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 ) ] -\n        computedVal -\n        delta -\n        extra -\n        0.5\n\n        // If offsetWidth/offsetHeight is unknown, then we can't determine content-box scroll gutter\n        // Use an explicit zero to avoid NaN (gh-3964)\n      ) ) || 0;\n    }\n\n    return delta;\n  }\n\n  function getWidthOrHeight( elem, dimension, extra ) {\n\n    // Start with computed style\n    var styles = getStyles( elem ),\n\n      // To avoid forcing a reflow, only fetch boxSizing if we need it (gh-4322).\n      // Fake content-box until we know it's needed to know the true value.\n      boxSizingNeeded = !support.boxSizingReliable() || extra,\n      isBorderBox = boxSizingNeeded &&\n        jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\",\n      valueIsBorderBox = isBorderBox,\n\n      val = curCSS( elem, dimension, styles ),\n      offsetProp = \"offset\" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 );\n\n    // Support: Firefox <=54\n    // Return a confounding non-pixel value or feign ignorance, as appropriate.\n    if ( rnumnonpx.test( val ) ) {\n      if ( !extra ) {\n        return val;\n      }\n      val = \"auto\";\n    }\n\n\n    // Support: IE 9 - 11 only\n    // Use offsetWidth/offsetHeight for when box sizing is unreliable.\n    // In those cases, the computed value can be trusted to be border-box.\n    if ( ( !support.boxSizingReliable() && isBorderBox ||\n\n        // Support: IE 10 - 11+, Edge 15 - 18+\n        // IE/Edge misreport `getComputedStyle` of table rows with width/height\n        // set in CSS while `offset*` properties report correct values.\n        // Interestingly, in some cases IE 9 doesn't suffer from this issue.\n        !support.reliableTrDimensions() && nodeName( elem, \"tr\" ) ||\n\n        // Fall back to offsetWidth/offsetHeight when value is \"auto\"\n        // This happens for inline elements with no explicit setting (gh-3571)\n        val === \"auto\" ||\n\n        // Support: Android <=4.1 - 4.3 only\n        // Also use offsetWidth/offsetHeight for misreported inline dimensions (gh-3602)\n        !parseFloat( val ) && jQuery.css( elem, \"display\", false, styles ) === \"inline\" ) &&\n\n      // Make sure the element is visible & connected\n      elem.getClientRects().length ) {\n\n      isBorderBox = jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\";\n\n      // Where available, offsetWidth/offsetHeight approximate border box dimensions.\n      // Where not available (e.g., SVG), assume unreliable box-sizing and interpret the\n      // retrieved value as a content box dimension.\n      valueIsBorderBox = offsetProp in elem;\n      if ( valueIsBorderBox ) {\n        val = elem[ offsetProp ];\n      }\n    }\n\n    // Normalize \"\" and auto\n    val = parseFloat( val ) || 0;\n\n    // Adjust for the element's box model\n    return ( val +\n      boxModelAdjustment(\n        elem,\n        dimension,\n        extra || ( isBorderBox ? \"border\" : \"content\" ),\n        valueIsBorderBox,\n        styles,\n\n        // Provide the current computed size to request scroll gutter calculation (gh-3589)\n        val\n      )\n    ) + \"px\";\n  }\n\n  jQuery.extend( {\n\n    // Add in style property hooks for overriding the default\n    // behavior of getting and setting a style property\n    cssHooks: {\n      opacity: {\n        get: function( elem, computed ) {\n          if ( computed ) {\n\n            // We should always get a number back from opacity\n            var ret = curCSS( elem, \"opacity\" );\n            return ret === \"\" ? \"1\" : ret;\n          }\n        }\n      }\n    },\n\n    // Don't automatically add \"px\" to these possibly-unitless properties\n    cssNumber: {\n      \"animationIterationCount\": true,\n      \"columnCount\": true,\n      \"fillOpacity\": true,\n      \"flexGrow\": true,\n      \"flexShrink\": true,\n      \"fontWeight\": true,\n      \"gridArea\": true,\n      \"gridColumn\": true,\n      \"gridColumnEnd\": true,\n      \"gridColumnStart\": true,\n      \"gridRow\": true,\n      \"gridRowEnd\": true,\n      \"gridRowStart\": true,\n      \"lineHeight\": true,\n      \"opacity\": true,\n      \"order\": true,\n      \"orphans\": true,\n      \"widows\": true,\n      \"zIndex\": true,\n      \"zoom\": true\n    },\n\n    // Add in properties whose names you wish to fix before\n    // setting or getting the value\n    cssProps: {},\n\n    // Get and set the style property on a DOM Node\n    style: function( elem, name, value, extra ) {\n\n      // Don't set styles on text and comment nodes\n      if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\n        return;\n      }\n\n      // Make sure that we're working with the right name\n      var ret, type, hooks,\n        origName = camelCase( name ),\n        isCustomProp = rcustomProp.test( name ),\n        style = elem.style;\n\n      // Make sure that we're working with the right name. We don't\n      // want to query the value if it is a CSS custom property\n      // since they are user-defined.\n      if ( !isCustomProp ) {\n        name = finalPropName( origName );\n      }\n\n      // Gets hook for the prefixed version, then unprefixed version\n      hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n      // Check if we're setting a value\n      if ( value !== undefined ) {\n        type = typeof value;\n\n        // Convert \"+=\" or \"-=\" to relative numbers (#7345)\n        if ( type === \"string\" && ( ret = rcssNum.exec( value ) ) && ret[ 1 ] ) {\n          value = adjustCSS( elem, name, ret );\n\n          // Fixes bug #9237\n          type = \"number\";\n        }\n\n        // Make sure that null and NaN values aren't set (#7116)\n        if ( value == null || value !== value ) {\n          return;\n        }\n\n        // If a number was passed in, add the unit (except for certain CSS properties)\n        // The isCustomProp check can be removed in jQuery 4.0 when we only auto-append\n        // \"px\" to a few hardcoded values.\n        if ( type === \"number\" && !isCustomProp ) {\n          value += ret && ret[ 3 ] || ( jQuery.cssNumber[ origName ] ? \"\" : \"px\" );\n        }\n\n        // background-* props affect original clone's values\n        if ( !support.clearCloneStyle && value === \"\" && name.indexOf( \"background\" ) === 0 ) {\n          style[ name ] = \"inherit\";\n        }\n\n        // If a hook was provided, use that value, otherwise just set the specified value\n        if ( !hooks || !( \"set\" in hooks ) ||\n          ( value = hooks.set( elem, value, extra ) ) !== undefined ) {\n\n          if ( isCustomProp ) {\n            style.setProperty( name, value );\n          } else {\n            style[ name ] = value;\n          }\n        }\n\n      } else {\n\n        // If a hook was provided get the non-computed value from there\n        if ( hooks && \"get\" in hooks &&\n          ( ret = hooks.get( elem, false, extra ) ) !== undefined ) {\n\n          return ret;\n        }\n\n        // Otherwise just get the value from the style object\n        return style[ name ];\n      }\n    },\n\n    css: function( elem, name, extra, styles ) {\n      var val, num, hooks,\n        origName = camelCase( name ),\n        isCustomProp = rcustomProp.test( name );\n\n      // Make sure that we're working with the right name. We don't\n      // want to modify the value if it is a CSS custom property\n      // since they are user-defined.\n      if ( !isCustomProp ) {\n        name = finalPropName( origName );\n      }\n\n      // Try prefixed name followed by the unprefixed name\n      hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n      // If a hook was provided get the computed value from there\n      if ( hooks && \"get\" in hooks ) {\n        val = hooks.get( elem, true, extra );\n      }\n\n      // Otherwise, if a way to get the computed value exists, use that\n      if ( val === undefined ) {\n        val = curCSS( elem, name, styles );\n      }\n\n      // Convert \"normal\" to computed value\n      if ( val === \"normal\" && name in cssNormalTransform ) {\n        val = cssNormalTransform[ name ];\n      }\n\n      // Make numeric if forced or a qualifier was provided and val looks numeric\n      if ( extra === \"\" || extra ) {\n        num = parseFloat( val );\n        return extra === true || isFinite( num ) ? num || 0 : val;\n      }\n\n      return val;\n    }\n  } );\n\n  jQuery.each( [ \"height\", \"width\" ], function( _i, dimension ) {\n    jQuery.cssHooks[ dimension ] = {\n      get: function( elem, computed, extra ) {\n        if ( computed ) {\n\n          // Certain elements can have dimension info if we invisibly show them\n          // but it must have a current display style that would benefit\n          return rdisplayswap.test( jQuery.css( elem, \"display\" ) ) &&\n\n          // Support: Safari 8+\n          // Table columns in Safari have non-zero offsetWidth & zero\n          // getBoundingClientRect().width unless display is changed.\n          // Support: IE <=11 only\n          // Running getBoundingClientRect on a disconnected node\n          // in IE throws an error.\n          ( !elem.getClientRects().length || !elem.getBoundingClientRect().width ) ?\n            swap( elem, cssShow, function() {\n              return getWidthOrHeight( elem, dimension, extra );\n            } ) :\n            getWidthOrHeight( elem, dimension, extra );\n        }\n      },\n\n      set: function( elem, value, extra ) {\n        var matches,\n          styles = getStyles( elem ),\n\n          // Only read styles.position if the test has a chance to fail\n          // to avoid forcing a reflow.\n          scrollboxSizeBuggy = !support.scrollboxSize() &&\n            styles.position === \"absolute\",\n\n          // To avoid forcing a reflow, only fetch boxSizing if we need it (gh-3991)\n          boxSizingNeeded = scrollboxSizeBuggy || extra,\n          isBorderBox = boxSizingNeeded &&\n            jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\",\n          subtract = extra ?\n            boxModelAdjustment(\n              elem,\n              dimension,\n              extra,\n              isBorderBox,\n              styles\n            ) :\n            0;\n\n        // Account for unreliable border-box dimensions by comparing offset* to computed and\n        // faking a content-box to get border and padding (gh-3699)\n        if ( isBorderBox && scrollboxSizeBuggy ) {\n          subtract -= Math.ceil(\n            elem[ \"offset\" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 ) ] -\n            parseFloat( styles[ dimension ] ) -\n            boxModelAdjustment( elem, dimension, \"border\", false, styles ) -\n            0.5\n          );\n        }\n\n        // Convert to pixels if value adjustment is needed\n        if ( subtract && ( matches = rcssNum.exec( value ) ) &&\n          ( matches[ 3 ] || \"px\" ) !== \"px\" ) {\n\n          elem.style[ dimension ] = value;\n          value = jQuery.css( elem, dimension );\n        }\n\n        return setPositiveNumber( elem, value, subtract );\n      }\n    };\n  } );\n\n  jQuery.cssHooks.marginLeft = addGetHookIf( support.reliableMarginLeft,\n    function( elem, computed ) {\n      if ( computed ) {\n        return ( parseFloat( curCSS( elem, \"marginLeft\" ) ) ||\n          elem.getBoundingClientRect().left -\n          swap( elem, { marginLeft: 0 }, function() {\n            return elem.getBoundingClientRect().left;\n          } )\n        ) + \"px\";\n      }\n    }\n  );\n\n// These hooks are used by animate to expand properties\n  jQuery.each( {\n    margin: \"\",\n    padding: \"\",\n    border: \"Width\"\n  }, function( prefix, suffix ) {\n    jQuery.cssHooks[ prefix + suffix ] = {\n      expand: function( value ) {\n        var i = 0,\n          expanded = {},\n\n          // Assumes a single number if not a string\n          parts = typeof value === \"string\" ? value.split( \" \" ) : [ value ];\n\n        for ( ; i < 4; i++ ) {\n          expanded[ prefix + cssExpand[ i ] + suffix ] =\n            parts[ i ] || parts[ i - 2 ] || parts[ 0 ];\n        }\n\n        return expanded;\n      }\n    };\n\n    if ( prefix !== \"margin\" ) {\n      jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;\n    }\n  } );\n\n  jQuery.fn.extend( {\n    css: function( name, value ) {\n      return access( this, function( elem, name, value ) {\n        var styles, len,\n          map = {},\n          i = 0;\n\n        if ( Array.isArray( name ) ) {\n          styles = getStyles( elem );\n          len = name.length;\n\n          for ( ; i < len; i++ ) {\n            map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );\n          }\n\n          return map;\n        }\n\n        return value !== undefined ?\n          jQuery.style( elem, name, value ) :\n          jQuery.css( elem, name );\n      }, name, value, arguments.length > 1 );\n    }\n  } );\n\n\n  function Tween( elem, options, prop, end, easing ) {\n    return new Tween.prototype.init( elem, options, prop, end, easing );\n  }\n  jQuery.Tween = Tween;\n\n  Tween.prototype = {\n    constructor: Tween,\n    init: function( elem, options, prop, end, easing, unit ) {\n      this.elem = elem;\n      this.prop = prop;\n      this.easing = easing || jQuery.easing._default;\n      this.options = options;\n      this.start = this.now = this.cur();\n      this.end = end;\n      this.unit = unit || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" );\n    },\n    cur: function() {\n      var hooks = Tween.propHooks[ this.prop ];\n\n      return hooks && hooks.get ?\n        hooks.get( this ) :\n        Tween.propHooks._default.get( this );\n    },\n    run: function( percent ) {\n      var eased,\n        hooks = Tween.propHooks[ this.prop ];\n\n      if ( this.options.duration ) {\n        this.pos = eased = jQuery.easing[ this.easing ](\n          percent, this.options.duration * percent, 0, 1, this.options.duration\n        );\n      } else {\n        this.pos = eased = percent;\n      }\n      this.now = ( this.end - this.start ) * eased + this.start;\n\n      if ( this.options.step ) {\n        this.options.step.call( this.elem, this.now, this );\n      }\n\n      if ( hooks && hooks.set ) {\n        hooks.set( this );\n      } else {\n        Tween.propHooks._default.set( this );\n      }\n      return this;\n    }\n  };\n\n  Tween.prototype.init.prototype = Tween.prototype;\n\n  Tween.propHooks = {\n    _default: {\n      get: function( tween ) {\n        var result;\n\n        // Use a property on the element directly when it is not a DOM element,\n        // or when there is no matching style property that exists.\n        if ( tween.elem.nodeType !== 1 ||\n          tween.elem[ tween.prop ] != null && tween.elem.style[ tween.prop ] == null ) {\n          return tween.elem[ tween.prop ];\n        }\n\n        // Passing an empty string as a 3rd parameter to .css will automatically\n        // attempt a parseFloat and fallback to a string if the parse fails.\n        // Simple values such as \"10px\" are parsed to Float;\n        // complex values such as \"rotate(1rad)\" are returned as-is.\n        result = jQuery.css( tween.elem, tween.prop, \"\" );\n\n        // Empty strings, null, undefined and \"auto\" are converted to 0.\n        return !result || result === \"auto\" ? 0 : result;\n      },\n      set: function( tween ) {\n\n        // Use step hook for back compat.\n        // Use cssHook if its there.\n        // Use .style if available and use plain properties where available.\n        if ( jQuery.fx.step[ tween.prop ] ) {\n          jQuery.fx.step[ tween.prop ]( tween );\n        } else if ( tween.elem.nodeType === 1 && (\n          jQuery.cssHooks[ tween.prop ] ||\n          tween.elem.style[ finalPropName( tween.prop ) ] != null ) ) {\n          jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );\n        } else {\n          tween.elem[ tween.prop ] = tween.now;\n        }\n      }\n    }\n  };\n\n// Support: IE <=9 only\n// Panic based approach to setting things on disconnected nodes\n  Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {\n    set: function( tween ) {\n      if ( tween.elem.nodeType && tween.elem.parentNode ) {\n        tween.elem[ tween.prop ] = tween.now;\n      }\n    }\n  };\n\n  jQuery.easing = {\n    linear: function( p ) {\n      return p;\n    },\n    swing: function( p ) {\n      return 0.5 - Math.cos( p * Math.PI ) / 2;\n    },\n    _default: \"swing\"\n  };\n\n  jQuery.fx = Tween.prototype.init;\n\n// Back compat <1.8 extension point\n  jQuery.fx.step = {};\n\n\n\n\n  var\n    fxNow, inProgress,\n    rfxtypes = /^(?:toggle|show|hide)$/,\n    rrun = /queueHooks$/;\n\n  function schedule() {\n    if ( inProgress ) {\n      if ( document.hidden === false && window.requestAnimationFrame ) {\n        window.requestAnimationFrame( schedule );\n      } else {\n        window.setTimeout( schedule, jQuery.fx.interval );\n      }\n\n      jQuery.fx.tick();\n    }\n  }\n\n// Animations created synchronously will run synchronously\n  function createFxNow() {\n    window.setTimeout( function() {\n      fxNow = undefined;\n    } );\n    return ( fxNow = Date.now() );\n  }\n\n// Generate parameters to create a standard animation\n  function genFx( type, includeWidth ) {\n    var which,\n      i = 0,\n      attrs = { height: type };\n\n    // If we include width, step value is 1 to do all cssExpand values,\n    // otherwise step value is 2 to skip over Left and Right\n    includeWidth = includeWidth ? 1 : 0;\n    for ( ; i < 4; i += 2 - includeWidth ) {\n      which = cssExpand[ i ];\n      attrs[ \"margin\" + which ] = attrs[ \"padding\" + which ] = type;\n    }\n\n    if ( includeWidth ) {\n      attrs.opacity = attrs.width = type;\n    }\n\n    return attrs;\n  }\n\n  function createTween( value, prop, animation ) {\n    var tween,\n      collection = ( Animation.tweeners[ prop ] || [] ).concat( Animation.tweeners[ \"*\" ] ),\n      index = 0,\n      length = collection.length;\n    for ( ; index < length; index++ ) {\n      if ( ( tween = collection[ index ].call( animation, prop, value ) ) ) {\n\n        // We're done with this property\n        return tween;\n      }\n    }\n  }\n\n  function defaultPrefilter( elem, props, opts ) {\n    var prop, value, toggle, hooks, oldfire, propTween, restoreDisplay, display,\n      isBox = \"width\" in props || \"height\" in props,\n      anim = this,\n      orig = {},\n      style = elem.style,\n      hidden = elem.nodeType && isHiddenWithinTree( elem ),\n      dataShow = dataPriv.get( elem, \"fxshow\" );\n\n    // Queue-skipping animations hijack the fx hooks\n    if ( !opts.queue ) {\n      hooks = jQuery._queueHooks( elem, \"fx\" );\n      if ( hooks.unqueued == null ) {\n        hooks.unqueued = 0;\n        oldfire = hooks.empty.fire;\n        hooks.empty.fire = function() {\n          if ( !hooks.unqueued ) {\n            oldfire();\n          }\n        };\n      }\n      hooks.unqueued++;\n\n      anim.always( function() {\n\n        // Ensure the complete handler is called before this completes\n        anim.always( function() {\n          hooks.unqueued--;\n          if ( !jQuery.queue( elem, \"fx\" ).length ) {\n            hooks.empty.fire();\n          }\n        } );\n      } );\n    }\n\n    // Detect show/hide animations\n    for ( prop in props ) {\n      value = props[ prop ];\n      if ( rfxtypes.test( value ) ) {\n        delete props[ prop ];\n        toggle = toggle || value === \"toggle\";\n        if ( value === ( hidden ? \"hide\" : \"show\" ) ) {\n\n          // Pretend to be hidden if this is a \"show\" and\n          // there is still data from a stopped show/hide\n          if ( value === \"show\" && dataShow && dataShow[ prop ] !== undefined ) {\n            hidden = true;\n\n            // Ignore all other no-op show/hide data\n          } else {\n            continue;\n          }\n        }\n        orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );\n      }\n    }\n\n    // Bail out if this is a no-op like .hide().hide()\n    propTween = !jQuery.isEmptyObject( props );\n    if ( !propTween && jQuery.isEmptyObject( orig ) ) {\n      return;\n    }\n\n    // Restrict \"overflow\" and \"display\" styles during box animations\n    if ( isBox && elem.nodeType === 1 ) {\n\n      // Support: IE <=9 - 11, Edge 12 - 15\n      // Record all 3 overflow attributes because IE does not infer the shorthand\n      // from identically-valued overflowX and overflowY and Edge just mirrors\n      // the overflowX value there.\n      opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];\n\n      // Identify a display type, preferring old show/hide data over the CSS cascade\n      restoreDisplay = dataShow && dataShow.display;\n      if ( restoreDisplay == null ) {\n        restoreDisplay = dataPriv.get( elem, \"display\" );\n      }\n      display = jQuery.css( elem, \"display\" );\n      if ( display === \"none\" ) {\n        if ( restoreDisplay ) {\n          display = restoreDisplay;\n        } else {\n\n          // Get nonempty value(s) by temporarily forcing visibility\n          showHide( [ elem ], true );\n          restoreDisplay = elem.style.display || restoreDisplay;\n          display = jQuery.css( elem, \"display\" );\n          showHide( [ elem ] );\n        }\n      }\n\n      // Animate inline elements as inline-block\n      if ( display === \"inline\" || display === \"inline-block\" && restoreDisplay != null ) {\n        if ( jQuery.css( elem, \"float\" ) === \"none\" ) {\n\n          // Restore the original display value at the end of pure show/hide animations\n          if ( !propTween ) {\n            anim.done( function() {\n              style.display = restoreDisplay;\n            } );\n            if ( restoreDisplay == null ) {\n              display = style.display;\n              restoreDisplay = display === \"none\" ? \"\" : display;\n            }\n          }\n          style.display = \"inline-block\";\n        }\n      }\n    }\n\n    if ( opts.overflow ) {\n      style.overflow = \"hidden\";\n      anim.always( function() {\n        style.overflow = opts.overflow[ 0 ];\n        style.overflowX = opts.overflow[ 1 ];\n        style.overflowY = opts.overflow[ 2 ];\n      } );\n    }\n\n    // Implement show/hide animations\n    propTween = false;\n    for ( prop in orig ) {\n\n      // General show/hide setup for this element animation\n      if ( !propTween ) {\n        if ( dataShow ) {\n          if ( \"hidden\" in dataShow ) {\n            hidden = dataShow.hidden;\n          }\n        } else {\n          dataShow = dataPriv.access( elem, \"fxshow\", { display: restoreDisplay } );\n        }\n\n        // Store hidden/visible for toggle so `.stop().toggle()` \"reverses\"\n        if ( toggle ) {\n          dataShow.hidden = !hidden;\n        }\n\n        // Show elements before animating them\n        if ( hidden ) {\n          showHide( [ elem ], true );\n        }\n\n        /* eslint-disable no-loop-func */\n\n        anim.done( function() {\n\n          /* eslint-enable no-loop-func */\n\n          // The final step of a \"hide\" animation is actually hiding the element\n          if ( !hidden ) {\n            showHide( [ elem ] );\n          }\n          dataPriv.remove( elem, \"fxshow\" );\n          for ( prop in orig ) {\n            jQuery.style( elem, prop, orig[ prop ] );\n          }\n        } );\n      }\n\n      // Per-property setup\n      propTween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );\n      if ( !( prop in dataShow ) ) {\n        dataShow[ prop ] = propTween.start;\n        if ( hidden ) {\n          propTween.end = propTween.start;\n          propTween.start = 0;\n        }\n      }\n    }\n  }\n\n  function propFilter( props, specialEasing ) {\n    var index, name, easing, value, hooks;\n\n    // camelCase, specialEasing and expand cssHook pass\n    for ( index in props ) {\n      name = camelCase( index );\n      easing = specialEasing[ name ];\n      value = props[ index ];\n      if ( Array.isArray( value ) ) {\n        easing = value[ 1 ];\n        value = props[ index ] = value[ 0 ];\n      }\n\n      if ( index !== name ) {\n        props[ name ] = value;\n        delete props[ index ];\n      }\n\n      hooks = jQuery.cssHooks[ name ];\n      if ( hooks && \"expand\" in hooks ) {\n        value = hooks.expand( value );\n        delete props[ name ];\n\n        // Not quite $.extend, this won't overwrite existing keys.\n        // Reusing 'index' because we have the correct \"name\"\n        for ( index in value ) {\n          if ( !( index in props ) ) {\n            props[ index ] = value[ index ];\n            specialEasing[ index ] = easing;\n          }\n        }\n      } else {\n        specialEasing[ name ] = easing;\n      }\n    }\n  }\n\n  function Animation( elem, properties, options ) {\n    var result,\n      stopped,\n      index = 0,\n      length = Animation.prefilters.length,\n      deferred = jQuery.Deferred().always( function() {\n\n        // Don't match elem in the :animated selector\n        delete tick.elem;\n      } ),\n      tick = function() {\n        if ( stopped ) {\n          return false;\n        }\n        var currentTime = fxNow || createFxNow(),\n          remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),\n\n          // Support: Android 2.3 only\n          // Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)\n          temp = remaining / animation.duration || 0,\n          percent = 1 - temp,\n          index = 0,\n          length = animation.tweens.length;\n\n        for ( ; index < length; index++ ) {\n          animation.tweens[ index ].run( percent );\n        }\n\n        deferred.notifyWith( elem, [ animation, percent, remaining ] );\n\n        // If there's more to do, yield\n        if ( percent < 1 && length ) {\n          return remaining;\n        }\n\n        // If this was an empty animation, synthesize a final progress notification\n        if ( !length ) {\n          deferred.notifyWith( elem, [ animation, 1, 0 ] );\n        }\n\n        // Resolve the animation and report its conclusion\n        deferred.resolveWith( elem, [ animation ] );\n        return false;\n      },\n      animation = deferred.promise( {\n        elem: elem,\n        props: jQuery.extend( {}, properties ),\n        opts: jQuery.extend( true, {\n          specialEasing: {},\n          easing: jQuery.easing._default\n        }, options ),\n        originalProperties: properties,\n        originalOptions: options,\n        startTime: fxNow || createFxNow(),\n        duration: options.duration,\n        tweens: [],\n        createTween: function( prop, end ) {\n          var tween = jQuery.Tween( elem, animation.opts, prop, end,\n            animation.opts.specialEasing[ prop ] || animation.opts.easing );\n          animation.tweens.push( tween );\n          return tween;\n        },\n        stop: function( gotoEnd ) {\n          var index = 0,\n\n            // If we are going to the end, we want to run all the tweens\n            // otherwise we skip this part\n            length = gotoEnd ? animation.tweens.length : 0;\n          if ( stopped ) {\n            return this;\n          }\n          stopped = true;\n          for ( ; index < length; index++ ) {\n            animation.tweens[ index ].run( 1 );\n          }\n\n          // Resolve when we played the last frame; otherwise, reject\n          if ( gotoEnd ) {\n            deferred.notifyWith( elem, [ animation, 1, 0 ] );\n            deferred.resolveWith( elem, [ animation, gotoEnd ] );\n          } else {\n            deferred.rejectWith( elem, [ animation, gotoEnd ] );\n          }\n          return this;\n        }\n      } ),\n      props = animation.props;\n\n    propFilter( props, animation.opts.specialEasing );\n\n    for ( ; index < length; index++ ) {\n      result = Animation.prefilters[ index ].call( animation, elem, props, animation.opts );\n      if ( result ) {\n        if ( isFunction( result.stop ) ) {\n          jQuery._queueHooks( animation.elem, animation.opts.queue ).stop =\n            result.stop.bind( result );\n        }\n        return result;\n      }\n    }\n\n    jQuery.map( props, createTween, animation );\n\n    if ( isFunction( animation.opts.start ) ) {\n      animation.opts.start.call( elem, animation );\n    }\n\n    // Attach callbacks from options\n    animation\n      .progress( animation.opts.progress )\n      .done( animation.opts.done, animation.opts.complete )\n      .fail( animation.opts.fail )\n      .always( animation.opts.always );\n\n    jQuery.fx.timer(\n      jQuery.extend( tick, {\n        elem: elem,\n        anim: animation,\n        queue: animation.opts.queue\n      } )\n    );\n\n    return animation;\n  }\n\n  jQuery.Animation = jQuery.extend( Animation, {\n\n    tweeners: {\n      \"*\": [ function( prop, value ) {\n        var tween = this.createTween( prop, value );\n        adjustCSS( tween.elem, prop, rcssNum.exec( value ), tween );\n        return tween;\n      } ]\n    },\n\n    tweener: function( props, callback ) {\n      if ( isFunction( props ) ) {\n        callback = props;\n        props = [ \"*\" ];\n      } else {\n        props = props.match( rnothtmlwhite );\n      }\n\n      var prop,\n        index = 0,\n        length = props.length;\n\n      for ( ; index < length; index++ ) {\n        prop = props[ index ];\n        Animation.tweeners[ prop ] = Animation.tweeners[ prop ] || [];\n        Animation.tweeners[ prop ].unshift( callback );\n      }\n    },\n\n    prefilters: [ defaultPrefilter ],\n\n    prefilter: function( callback, prepend ) {\n      if ( prepend ) {\n        Animation.prefilters.unshift( callback );\n      } else {\n        Animation.prefilters.push( callback );\n      }\n    }\n  } );\n\n  jQuery.speed = function( speed, easing, fn ) {\n    var opt = speed && typeof speed === \"object\" ? jQuery.extend( {}, speed ) : {\n      complete: fn || !fn && easing ||\n        isFunction( speed ) && speed,\n      duration: speed,\n      easing: fn && easing || easing && !isFunction( easing ) && easing\n    };\n\n    // Go to the end state if fx are off\n    if ( jQuery.fx.off ) {\n      opt.duration = 0;\n\n    } else {\n      if ( typeof opt.duration !== \"number\" ) {\n        if ( opt.duration in jQuery.fx.speeds ) {\n          opt.duration = jQuery.fx.speeds[ opt.duration ];\n\n        } else {\n          opt.duration = jQuery.fx.speeds._default;\n        }\n      }\n    }\n\n    // Normalize opt.queue - true/undefined/null -> \"fx\"\n    if ( opt.queue == null || opt.queue === true ) {\n      opt.queue = \"fx\";\n    }\n\n    // Queueing\n    opt.old = opt.complete;\n\n    opt.complete = function() {\n      if ( isFunction( opt.old ) ) {\n        opt.old.call( this );\n      }\n\n      if ( opt.queue ) {\n        jQuery.dequeue( this, opt.queue );\n      }\n    };\n\n    return opt;\n  };\n\n  jQuery.fn.extend( {\n    fadeTo: function( speed, to, easing, callback ) {\n\n      // Show any hidden elements after setting opacity to 0\n      return this.filter( isHiddenWithinTree ).css( \"opacity\", 0 ).show()\n\n        // Animate to the value specified\n        .end().animate( { opacity: to }, speed, easing, callback );\n    },\n    animate: function( prop, speed, easing, callback ) {\n      var empty = jQuery.isEmptyObject( prop ),\n        optall = jQuery.speed( speed, easing, callback ),\n        doAnimation = function() {\n\n          // Operate on a copy of prop so per-property easing won't be lost\n          var anim = Animation( this, jQuery.extend( {}, prop ), optall );\n\n          // Empty animations, or finishing resolves immediately\n          if ( empty || dataPriv.get( this, \"finish\" ) ) {\n            anim.stop( true );\n          }\n        };\n      doAnimation.finish = doAnimation;\n\n      return empty || optall.queue === false ?\n        this.each( doAnimation ) :\n        this.queue( optall.queue, doAnimation );\n    },\n    stop: function( type, clearQueue, gotoEnd ) {\n      var stopQueue = function( hooks ) {\n        var stop = hooks.stop;\n        delete hooks.stop;\n        stop( gotoEnd );\n      };\n\n      if ( typeof type !== \"string\" ) {\n        gotoEnd = clearQueue;\n        clearQueue = type;\n        type = undefined;\n      }\n      if ( clearQueue ) {\n        this.queue( type || \"fx\", [] );\n      }\n\n      return this.each( function() {\n        var dequeue = true,\n          index = type != null && type + \"queueHooks\",\n          timers = jQuery.timers,\n          data = dataPriv.get( this );\n\n        if ( index ) {\n          if ( data[ index ] && data[ index ].stop ) {\n            stopQueue( data[ index ] );\n          }\n        } else {\n          for ( index in data ) {\n            if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {\n              stopQueue( data[ index ] );\n            }\n          }\n        }\n\n        for ( index = timers.length; index--; ) {\n          if ( timers[ index ].elem === this &&\n            ( type == null || timers[ index ].queue === type ) ) {\n\n            timers[ index ].anim.stop( gotoEnd );\n            dequeue = false;\n            timers.splice( index, 1 );\n          }\n        }\n\n        // Start the next in the queue if the last step wasn't forced.\n        // Timers currently will call their complete callbacks, which\n        // will dequeue but only if they were gotoEnd.\n        if ( dequeue || !gotoEnd ) {\n          jQuery.dequeue( this, type );\n        }\n      } );\n    },\n    finish: function( type ) {\n      if ( type !== false ) {\n        type = type || \"fx\";\n      }\n      return this.each( function() {\n        var index,\n          data = dataPriv.get( this ),\n          queue = data[ type + \"queue\" ],\n          hooks = data[ type + \"queueHooks\" ],\n          timers = jQuery.timers,\n          length = queue ? queue.length : 0;\n\n        // Enable finishing flag on private data\n        data.finish = true;\n\n        // Empty the queue first\n        jQuery.queue( this, type, [] );\n\n        if ( hooks && hooks.stop ) {\n          hooks.stop.call( this, true );\n        }\n\n        // Look for any active animations, and finish them\n        for ( index = timers.length; index--; ) {\n          if ( timers[ index ].elem === this && timers[ index ].queue === type ) {\n            timers[ index ].anim.stop( true );\n            timers.splice( index, 1 );\n          }\n        }\n\n        // Look for any animations in the old queue and finish them\n        for ( index = 0; index < length; index++ ) {\n          if ( queue[ index ] && queue[ index ].finish ) {\n            queue[ index ].finish.call( this );\n          }\n        }\n\n        // Turn off finishing flag\n        delete data.finish;\n      } );\n    }\n  } );\n\n  jQuery.each( [ \"toggle\", \"show\", \"hide\" ], function( _i, name ) {\n    var cssFn = jQuery.fn[ name ];\n    jQuery.fn[ name ] = function( speed, easing, callback ) {\n      return speed == null || typeof speed === \"boolean\" ?\n        cssFn.apply( this, arguments ) :\n        this.animate( genFx( name, true ), speed, easing, callback );\n    };\n  } );\n\n// Generate shortcuts for custom animations\n  jQuery.each( {\n    slideDown: genFx( \"show\" ),\n    slideUp: genFx( \"hide\" ),\n    slideToggle: genFx( \"toggle\" ),\n    fadeIn: { opacity: \"show\" },\n    fadeOut: { opacity: \"hide\" },\n    fadeToggle: { opacity: \"toggle\" }\n  }, function( name, props ) {\n    jQuery.fn[ name ] = function( speed, easing, callback ) {\n      return this.animate( props, speed, easing, callback );\n    };\n  } );\n\n  jQuery.timers = [];\n  jQuery.fx.tick = function() {\n    var timer,\n      i = 0,\n      timers = jQuery.timers;\n\n    fxNow = Date.now();\n\n    for ( ; i < timers.length; i++ ) {\n      timer = timers[ i ];\n\n      // Run the timer and safely remove it when done (allowing for external removal)\n      if ( !timer() && timers[ i ] === timer ) {\n        timers.splice( i--, 1 );\n      }\n    }\n\n    if ( !timers.length ) {\n      jQuery.fx.stop();\n    }\n    fxNow = undefined;\n  };\n\n  jQuery.fx.timer = function( timer ) {\n    jQuery.timers.push( timer );\n    jQuery.fx.start();\n  };\n\n  jQuery.fx.interval = 13;\n  jQuery.fx.start = function() {\n    if ( inProgress ) {\n      return;\n    }\n\n    inProgress = true;\n    schedule();\n  };\n\n  jQuery.fx.stop = function() {\n    inProgress = null;\n  };\n\n  jQuery.fx.speeds = {\n    slow: 600,\n    fast: 200,\n\n    // Default speed\n    _default: 400\n  };\n\n\n// Based off of the plugin by Clint Helfers, with permission.\n// https://web.archive.org/web/20100324014747/http://blindsignals.com/index.php/2009/07/jquery-delay/\n  jQuery.fn.delay = function( time, type ) {\n    time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\n    type = type || \"fx\";\n\n    return this.queue( type, function( next, hooks ) {\n      var timeout = window.setTimeout( next, time );\n      hooks.stop = function() {\n        window.clearTimeout( timeout );\n      };\n    } );\n  };\n\n\n  ( function() {\n    var input = document.createElement( \"input\" ),\n      select = document.createElement( \"select\" ),\n      opt = select.appendChild( document.createElement( \"option\" ) );\n\n    input.type = \"checkbox\";\n\n    // Support: Android <=4.3 only\n    // Default value for a checkbox should be \"on\"\n    support.checkOn = input.value !== \"\";\n\n    // Support: IE <=11 only\n    // Must access selectedIndex to make default options select\n    support.optSelected = opt.selected;\n\n    // Support: IE <=11 only\n    // An input loses its value after becoming a radio\n    input = document.createElement( \"input\" );\n    input.value = \"t\";\n    input.type = \"radio\";\n    support.radioValue = input.value === \"t\";\n  } )();\n\n\n  var boolHook,\n    attrHandle = jQuery.expr.attrHandle;\n\n  jQuery.fn.extend( {\n    attr: function( name, value ) {\n      return access( this, jQuery.attr, name, value, arguments.length > 1 );\n    },\n\n    removeAttr: function( name ) {\n      return this.each( function() {\n        jQuery.removeAttr( this, name );\n      } );\n    }\n  } );\n\n  jQuery.extend( {\n    attr: function( elem, name, value ) {\n      var ret, hooks,\n        nType = elem.nodeType;\n\n      // Don't get/set attributes on text, comment and attribute nodes\n      if ( nType === 3 || nType === 8 || nType === 2 ) {\n        return;\n      }\n\n      // Fallback to prop when attributes are not supported\n      if ( typeof elem.getAttribute === \"undefined\" ) {\n        return jQuery.prop( elem, name, value );\n      }\n\n      // Attribute hooks are determined by the lowercase version\n      // Grab necessary hook if one is defined\n      if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n        hooks = jQuery.attrHooks[ name.toLowerCase() ] ||\n          ( jQuery.expr.match.bool.test( name ) ? boolHook : undefined );\n      }\n\n      if ( value !== undefined ) {\n        if ( value === null ) {\n          jQuery.removeAttr( elem, name );\n          return;\n        }\n\n        if ( hooks && \"set\" in hooks &&\n          ( ret = hooks.set( elem, value, name ) ) !== undefined ) {\n          return ret;\n        }\n\n        elem.setAttribute( name, value + \"\" );\n        return value;\n      }\n\n      if ( hooks && \"get\" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {\n        return ret;\n      }\n\n      ret = jQuery.find.attr( elem, name );\n\n      // Non-existent attributes return null, we normalize to undefined\n      return ret == null ? undefined : ret;\n    },\n\n    attrHooks: {\n      type: {\n        set: function( elem, value ) {\n          if ( !support.radioValue && value === \"radio\" &&\n            nodeName( elem, \"input\" ) ) {\n            var val = elem.value;\n            elem.setAttribute( \"type\", value );\n            if ( val ) {\n              elem.value = val;\n            }\n            return value;\n          }\n        }\n      }\n    },\n\n    removeAttr: function( elem, value ) {\n      var name,\n        i = 0,\n\n        // Attribute names can contain non-HTML whitespace characters\n        // https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n        attrNames = value && value.match( rnothtmlwhite );\n\n      if ( attrNames && elem.nodeType === 1 ) {\n        while ( ( name = attrNames[ i++ ] ) ) {\n          elem.removeAttribute( name );\n        }\n      }\n    }\n  } );\n\n// Hooks for boolean attributes\n  boolHook = {\n    set: function( elem, value, name ) {\n      if ( value === false ) {\n\n        // Remove boolean attributes when set to false\n        jQuery.removeAttr( elem, name );\n      } else {\n        elem.setAttribute( name, name );\n      }\n      return name;\n    }\n  };\n\n  jQuery.each( jQuery.expr.match.bool.source.match( /\\w+/g ), function( _i, name ) {\n    var getter = attrHandle[ name ] || jQuery.find.attr;\n\n    attrHandle[ name ] = function( elem, name, isXML ) {\n      var ret, handle,\n        lowercaseName = name.toLowerCase();\n\n      if ( !isXML ) {\n\n        // Avoid an infinite loop by temporarily removing this function from the getter\n        handle = attrHandle[ lowercaseName ];\n        attrHandle[ lowercaseName ] = ret;\n        ret = getter( elem, name, isXML ) != null ?\n          lowercaseName :\n          null;\n        attrHandle[ lowercaseName ] = handle;\n      }\n      return ret;\n    };\n  } );\n\n\n\n\n  var rfocusable = /^(?:input|select|textarea|button)$/i,\n    rclickable = /^(?:a|area)$/i;\n\n  jQuery.fn.extend( {\n    prop: function( name, value ) {\n      return access( this, jQuery.prop, name, value, arguments.length > 1 );\n    },\n\n    removeProp: function( name ) {\n      return this.each( function() {\n        delete this[ jQuery.propFix[ name ] || name ];\n      } );\n    }\n  } );\n\n  jQuery.extend( {\n    prop: function( elem, name, value ) {\n      var ret, hooks,\n        nType = elem.nodeType;\n\n      // Don't get/set properties on text, comment and attribute nodes\n      if ( nType === 3 || nType === 8 || nType === 2 ) {\n        return;\n      }\n\n      if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n\n        // Fix name and attach hooks\n        name = jQuery.propFix[ name ] || name;\n        hooks = jQuery.propHooks[ name ];\n      }\n\n      if ( value !== undefined ) {\n        if ( hooks && \"set\" in hooks &&\n          ( ret = hooks.set( elem, value, name ) ) !== undefined ) {\n          return ret;\n        }\n\n        return ( elem[ name ] = value );\n      }\n\n      if ( hooks && \"get\" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {\n        return ret;\n      }\n\n      return elem[ name ];\n    },\n\n    propHooks: {\n      tabIndex: {\n        get: function( elem ) {\n\n          // Support: IE <=9 - 11 only\n          // elem.tabIndex doesn't always return the\n          // correct value when it hasn't been explicitly set\n          // https://web.archive.org/web/20141116233347/http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/\n          // Use proper attribute retrieval(#12072)\n          var tabindex = jQuery.find.attr( elem, \"tabindex\" );\n\n          if ( tabindex ) {\n            return parseInt( tabindex, 10 );\n          }\n\n          if (\n            rfocusable.test( elem.nodeName ) ||\n            rclickable.test( elem.nodeName ) &&\n            elem.href\n          ) {\n            return 0;\n          }\n\n          return -1;\n        }\n      }\n    },\n\n    propFix: {\n      \"for\": \"htmlFor\",\n      \"class\": \"className\"\n    }\n  } );\n\n// Support: IE <=11 only\n// Accessing the selectedIndex property\n// forces the browser to respect setting selected\n// on the option\n// The getter ensures a default option is selected\n// when in an optgroup\n// eslint rule \"no-unused-expressions\" is disabled for this code\n// since it considers such accessions noop\n  if ( !support.optSelected ) {\n    jQuery.propHooks.selected = {\n      get: function( elem ) {\n\n        /* eslint no-unused-expressions: \"off\" */\n\n        var parent = elem.parentNode;\n        if ( parent && parent.parentNode ) {\n          parent.parentNode.selectedIndex;\n        }\n        return null;\n      },\n      set: function( elem ) {\n\n        /* eslint no-unused-expressions: \"off\" */\n\n        var parent = elem.parentNode;\n        if ( parent ) {\n          parent.selectedIndex;\n\n          if ( parent.parentNode ) {\n            parent.parentNode.selectedIndex;\n          }\n        }\n      }\n    };\n  }\n\n  jQuery.each( [\n    \"tabIndex\",\n    \"readOnly\",\n    \"maxLength\",\n    \"cellSpacing\",\n    \"cellPadding\",\n    \"rowSpan\",\n    \"colSpan\",\n    \"useMap\",\n    \"frameBorder\",\n    \"contentEditable\"\n  ], function() {\n    jQuery.propFix[ this.toLowerCase() ] = this;\n  } );\n\n\n\n\n  // Strip and collapse whitespace according to HTML spec\n  // https://infra.spec.whatwg.org/#strip-and-collapse-ascii-whitespace\n  function stripAndCollapse( value ) {\n    var tokens = value.match( rnothtmlwhite ) || [];\n    return tokens.join( \" \" );\n  }\n\n\n  function getClass( elem ) {\n    return elem.getAttribute && elem.getAttribute( \"class\" ) || \"\";\n  }\n\n  function classesToArray( value ) {\n    if ( Array.isArray( value ) ) {\n      return value;\n    }\n    if ( typeof value === \"string\" ) {\n      return value.match( rnothtmlwhite ) || [];\n    }\n    return [];\n  }\n\n  jQuery.fn.extend( {\n    addClass: function( value ) {\n      var classes, elem, cur, curValue, clazz, j, finalValue,\n        i = 0;\n\n      if ( isFunction( value ) ) {\n        return this.each( function( j ) {\n          jQuery( this ).addClass( value.call( this, j, getClass( this ) ) );\n        } );\n      }\n\n      classes = classesToArray( value );\n\n      if ( classes.length ) {\n        while ( ( elem = this[ i++ ] ) ) {\n          curValue = getClass( elem );\n          cur = elem.nodeType === 1 && ( \" \" + stripAndCollapse( curValue ) + \" \" );\n\n          if ( cur ) {\n            j = 0;\n            while ( ( clazz = classes[ j++ ] ) ) {\n              if ( cur.indexOf( \" \" + clazz + \" \" ) < 0 ) {\n                cur += clazz + \" \";\n              }\n            }\n\n            // Only assign if different to avoid unneeded rendering.\n            finalValue = stripAndCollapse( cur );\n            if ( curValue !== finalValue ) {\n              elem.setAttribute( \"class\", finalValue );\n            }\n          }\n        }\n      }\n\n      return this;\n    },\n\n    removeClass: function( value ) {\n      var classes, elem, cur, curValue, clazz, j, finalValue,\n        i = 0;\n\n      if ( isFunction( value ) ) {\n        return this.each( function( j ) {\n          jQuery( this ).removeClass( value.call( this, j, getClass( this ) ) );\n        } );\n      }\n\n      if ( !arguments.length ) {\n        return this.attr( \"class\", \"\" );\n      }\n\n      classes = classesToArray( value );\n\n      if ( classes.length ) {\n        while ( ( elem = this[ i++ ] ) ) {\n          curValue = getClass( elem );\n\n          // This expression is here for better compressibility (see addClass)\n          cur = elem.nodeType === 1 && ( \" \" + stripAndCollapse( curValue ) + \" \" );\n\n          if ( cur ) {\n            j = 0;\n            while ( ( clazz = classes[ j++ ] ) ) {\n\n              // Remove *all* instances\n              while ( cur.indexOf( \" \" + clazz + \" \" ) > -1 ) {\n                cur = cur.replace( \" \" + clazz + \" \", \" \" );\n              }\n            }\n\n            // Only assign if different to avoid unneeded rendering.\n            finalValue = stripAndCollapse( cur );\n            if ( curValue !== finalValue ) {\n              elem.setAttribute( \"class\", finalValue );\n            }\n          }\n        }\n      }\n\n      return this;\n    },\n\n    toggleClass: function( value, stateVal ) {\n      var type = typeof value,\n        isValidValue = type === \"string\" || Array.isArray( value );\n\n      if ( typeof stateVal === \"boolean\" && isValidValue ) {\n        return stateVal ? this.addClass( value ) : this.removeClass( value );\n      }\n\n      if ( isFunction( value ) ) {\n        return this.each( function( i ) {\n          jQuery( this ).toggleClass(\n            value.call( this, i, getClass( this ), stateVal ),\n            stateVal\n          );\n        } );\n      }\n\n      return this.each( function() {\n        var className, i, self, classNames;\n\n        if ( isValidValue ) {\n\n          // Toggle individual class names\n          i = 0;\n          self = jQuery( this );\n          classNames = classesToArray( value );\n\n          while ( ( className = classNames[ i++ ] ) ) {\n\n            // Check each className given, space separated list\n            if ( self.hasClass( className ) ) {\n              self.removeClass( className );\n            } else {\n              self.addClass( className );\n            }\n          }\n\n          // Toggle whole class name\n        } else if ( value === undefined || type === \"boolean\" ) {\n          className = getClass( this );\n          if ( className ) {\n\n            // Store className if set\n            dataPriv.set( this, \"__className__\", className );\n          }\n\n          // If the element has a class name or if we're passed `false`,\n          // then remove the whole classname (if there was one, the above saved it).\n          // Otherwise bring back whatever was previously saved (if anything),\n          // falling back to the empty string if nothing was stored.\n          if ( this.setAttribute ) {\n            this.setAttribute( \"class\",\n              className || value === false ?\n                \"\" :\n                dataPriv.get( this, \"__className__\" ) || \"\"\n            );\n          }\n        }\n      } );\n    },\n\n    hasClass: function( selector ) {\n      var className, elem,\n        i = 0;\n\n      className = \" \" + selector + \" \";\n      while ( ( elem = this[ i++ ] ) ) {\n        if ( elem.nodeType === 1 &&\n          ( \" \" + stripAndCollapse( getClass( elem ) ) + \" \" ).indexOf( className ) > -1 ) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  } );\n\n\n\n\n  var rreturn = /\\r/g;\n\n  jQuery.fn.extend( {\n    val: function( value ) {\n      var hooks, ret, valueIsFunction,\n        elem = this[ 0 ];\n\n      if ( !arguments.length ) {\n        if ( elem ) {\n          hooks = jQuery.valHooks[ elem.type ] ||\n            jQuery.valHooks[ elem.nodeName.toLowerCase() ];\n\n          if ( hooks &&\n            \"get\" in hooks &&\n            ( ret = hooks.get( elem, \"value\" ) ) !== undefined\n          ) {\n            return ret;\n          }\n\n          ret = elem.value;\n\n          // Handle most common string cases\n          if ( typeof ret === \"string\" ) {\n            return ret.replace( rreturn, \"\" );\n          }\n\n          // Handle cases where value is null/undef or number\n          return ret == null ? \"\" : ret;\n        }\n\n        return;\n      }\n\n      valueIsFunction = isFunction( value );\n\n      return this.each( function( i ) {\n        var val;\n\n        if ( this.nodeType !== 1 ) {\n          return;\n        }\n\n        if ( valueIsFunction ) {\n          val = value.call( this, i, jQuery( this ).val() );\n        } else {\n          val = value;\n        }\n\n        // Treat null/undefined as \"\"; convert numbers to string\n        if ( val == null ) {\n          val = \"\";\n\n        } else if ( typeof val === \"number\" ) {\n          val += \"\";\n\n        } else if ( Array.isArray( val ) ) {\n          val = jQuery.map( val, function( value ) {\n            return value == null ? \"\" : value + \"\";\n          } );\n        }\n\n        hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\n\n        // If set returns undefined, fall back to normal setting\n        if ( !hooks || !( \"set\" in hooks ) || hooks.set( this, val, \"value\" ) === undefined ) {\n          this.value = val;\n        }\n      } );\n    }\n  } );\n\n  jQuery.extend( {\n    valHooks: {\n      option: {\n        get: function( elem ) {\n\n          var val = jQuery.find.attr( elem, \"value\" );\n          return val != null ?\n            val :\n\n            // Support: IE <=10 - 11 only\n            // option.text throws exceptions (#14686, #14858)\n            // Strip and collapse whitespace\n            // https://html.spec.whatwg.org/#strip-and-collapse-whitespace\n            stripAndCollapse( jQuery.text( elem ) );\n        }\n      },\n      select: {\n        get: function( elem ) {\n          var value, option, i,\n            options = elem.options,\n            index = elem.selectedIndex,\n            one = elem.type === \"select-one\",\n            values = one ? null : [],\n            max = one ? index + 1 : options.length;\n\n          if ( index < 0 ) {\n            i = max;\n\n          } else {\n            i = one ? index : 0;\n          }\n\n          // Loop through all the selected options\n          for ( ; i < max; i++ ) {\n            option = options[ i ];\n\n            // Support: IE <=9 only\n            // IE8-9 doesn't update selected after form reset (#2551)\n            if ( ( option.selected || i === index ) &&\n\n              // Don't return options that are disabled or in a disabled optgroup\n              !option.disabled &&\n              ( !option.parentNode.disabled ||\n                !nodeName( option.parentNode, \"optgroup\" ) ) ) {\n\n              // Get the specific value for the option\n              value = jQuery( option ).val();\n\n              // We don't need an array for one selects\n              if ( one ) {\n                return value;\n              }\n\n              // Multi-Selects return an array\n              values.push( value );\n            }\n          }\n\n          return values;\n        },\n\n        set: function( elem, value ) {\n          var optionSet, option,\n            options = elem.options,\n            values = jQuery.makeArray( value ),\n            i = options.length;\n\n          while ( i-- ) {\n            option = options[ i ];\n\n            /* eslint-disable no-cond-assign */\n\n            if ( option.selected =\n              jQuery.inArray( jQuery.valHooks.option.get( option ), values ) > -1\n            ) {\n              optionSet = true;\n            }\n\n            /* eslint-enable no-cond-assign */\n          }\n\n          // Force browsers to behave consistently when non-matching value is set\n          if ( !optionSet ) {\n            elem.selectedIndex = -1;\n          }\n          return values;\n        }\n      }\n    }\n  } );\n\n// Radios and checkboxes getter/setter\n  jQuery.each( [ \"radio\", \"checkbox\" ], function() {\n    jQuery.valHooks[ this ] = {\n      set: function( elem, value ) {\n        if ( Array.isArray( value ) ) {\n          return ( elem.checked = jQuery.inArray( jQuery( elem ).val(), value ) > -1 );\n        }\n      }\n    };\n    if ( !support.checkOn ) {\n      jQuery.valHooks[ this ].get = function( elem ) {\n        return elem.getAttribute( \"value\" ) === null ? \"on\" : elem.value;\n      };\n    }\n  } );\n\n\n\n\n// Return jQuery for attributes-only inclusion\n\n\n  support.focusin = \"onfocusin\" in window;\n\n\n  var rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,\n    stopPropagationCallback = function( e ) {\n      e.stopPropagation();\n    };\n\n  jQuery.extend( jQuery.event, {\n\n    trigger: function( event, data, elem, onlyHandlers ) {\n\n      var i, cur, tmp, bubbleType, ontype, handle, special, lastElement,\n        eventPath = [ elem || document ],\n        type = hasOwn.call( event, \"type\" ) ? event.type : event,\n        namespaces = hasOwn.call( event, \"namespace\" ) ? event.namespace.split( \".\" ) : [];\n\n      cur = lastElement = tmp = elem = elem || document;\n\n      // Don't do events on text and comment nodes\n      if ( elem.nodeType === 3 || elem.nodeType === 8 ) {\n        return;\n      }\n\n      // focus/blur morphs to focusin/out; ensure we're not firing them right now\n      if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\n        return;\n      }\n\n      if ( type.indexOf( \".\" ) > -1 ) {\n\n        // Namespaced trigger; create a regexp to match event type in handle()\n        namespaces = type.split( \".\" );\n        type = namespaces.shift();\n        namespaces.sort();\n      }\n      ontype = type.indexOf( \":\" ) < 0 && \"on\" + type;\n\n      // Caller can pass in a jQuery.Event object, Object, or just an event type string\n      event = event[ jQuery.expando ] ?\n        event :\n        new jQuery.Event( type, typeof event === \"object\" && event );\n\n      // Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)\n      event.isTrigger = onlyHandlers ? 2 : 3;\n      event.namespace = namespaces.join( \".\" );\n      event.rnamespace = event.namespace ?\n        new RegExp( \"(^|\\\\.)\" + namespaces.join( \"\\\\.(?:.*\\\\.|)\" ) + \"(\\\\.|$)\" ) :\n        null;\n\n      // Clean up the event in case it is being reused\n      event.result = undefined;\n      if ( !event.target ) {\n        event.target = elem;\n      }\n\n      // Clone any incoming data and prepend the event, creating the handler arg list\n      data = data == null ?\n        [ event ] :\n        jQuery.makeArray( data, [ event ] );\n\n      // Allow special events to draw outside the lines\n      special = jQuery.event.special[ type ] || {};\n      if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {\n        return;\n      }\n\n      // Determine event propagation path in advance, per W3C events spec (#9951)\n      // Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\n      if ( !onlyHandlers && !special.noBubble && !isWindow( elem ) ) {\n\n        bubbleType = special.delegateType || type;\n        if ( !rfocusMorph.test( bubbleType + type ) ) {\n          cur = cur.parentNode;\n        }\n        for ( ; cur; cur = cur.parentNode ) {\n          eventPath.push( cur );\n          tmp = cur;\n        }\n\n        // Only add window if we got to document (e.g., not plain obj or detached DOM)\n        if ( tmp === ( elem.ownerDocument || document ) ) {\n          eventPath.push( tmp.defaultView || tmp.parentWindow || window );\n        }\n      }\n\n      // Fire handlers on the event path\n      i = 0;\n      while ( ( cur = eventPath[ i++ ] ) && !event.isPropagationStopped() ) {\n        lastElement = cur;\n        event.type = i > 1 ?\n          bubbleType :\n          special.bindType || type;\n\n        // jQuery handler\n        handle = (\n            dataPriv.get( cur, \"events\" ) || Object.create( null )\n          )[ event.type ] &&\n          dataPriv.get( cur, \"handle\" );\n        if ( handle ) {\n          handle.apply( cur, data );\n        }\n\n        // Native handler\n        handle = ontype && cur[ ontype ];\n        if ( handle && handle.apply && acceptData( cur ) ) {\n          event.result = handle.apply( cur, data );\n          if ( event.result === false ) {\n            event.preventDefault();\n          }\n        }\n      }\n      event.type = type;\n\n      // If nobody prevented the default action, do it now\n      if ( !onlyHandlers && !event.isDefaultPrevented() ) {\n\n        if ( ( !special._default ||\n            special._default.apply( eventPath.pop(), data ) === false ) &&\n          acceptData( elem ) ) {\n\n          // Call a native DOM method on the target with the same name as the event.\n          // Don't do default actions on window, that's where global variables be (#6170)\n          if ( ontype && isFunction( elem[ type ] ) && !isWindow( elem ) ) {\n\n            // Don't re-trigger an onFOO event when we call its FOO() method\n            tmp = elem[ ontype ];\n\n            if ( tmp ) {\n              elem[ ontype ] = null;\n            }\n\n            // Prevent re-triggering of the same event, since we already bubbled it above\n            jQuery.event.triggered = type;\n\n            if ( event.isPropagationStopped() ) {\n              lastElement.addEventListener( type, stopPropagationCallback );\n            }\n\n            elem[ type ]();\n\n            if ( event.isPropagationStopped() ) {\n              lastElement.removeEventListener( type, stopPropagationCallback );\n            }\n\n            jQuery.event.triggered = undefined;\n\n            if ( tmp ) {\n              elem[ ontype ] = tmp;\n            }\n          }\n        }\n      }\n\n      return event.result;\n    },\n\n    // Piggyback on a donor event to simulate a different one\n    // Used only for `focus(in | out)` events\n    simulate: function( type, elem, event ) {\n      var e = jQuery.extend(\n        new jQuery.Event(),\n        event,\n        {\n          type: type,\n          isSimulated: true\n        }\n      );\n\n      jQuery.event.trigger( e, null, elem );\n    }\n\n  } );\n\n  jQuery.fn.extend( {\n\n    trigger: function( type, data ) {\n      return this.each( function() {\n        jQuery.event.trigger( type, data, this );\n      } );\n    },\n    triggerHandler: function( type, data ) {\n      var elem = this[ 0 ];\n      if ( elem ) {\n        return jQuery.event.trigger( type, data, elem, true );\n      }\n    }\n  } );\n\n\n// Support: Firefox <=44\n// Firefox doesn't have focus(in | out) events\n// Related ticket - https://bugzilla.mozilla.org/show_bug.cgi?id=687787\n//\n// Support: Chrome <=48 - 49, Safari <=9.0 - 9.1\n// focus(in | out) events fire after focus & blur events,\n// which is spec violation - http://www.w3.org/TR/DOM-Level-3-Events/#events-focusevent-event-order\n// Related ticket - https://bugs.chromium.org/p/chromium/issues/detail?id=449857\n  if ( !support.focusin ) {\n    jQuery.each( { focus: \"focusin\", blur: \"focusout\" }, function( orig, fix ) {\n\n      // Attach a single capturing handler on the document while someone wants focusin/focusout\n      var handler = function( event ) {\n        jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ) );\n      };\n\n      jQuery.event.special[ fix ] = {\n        setup: function() {\n\n          // Handle: regular nodes (via `this.ownerDocument`), window\n          // (via `this.document`) & document (via `this`).\n          var doc = this.ownerDocument || this.document || this,\n            attaches = dataPriv.access( doc, fix );\n\n          if ( !attaches ) {\n            doc.addEventListener( orig, handler, true );\n          }\n          dataPriv.access( doc, fix, ( attaches || 0 ) + 1 );\n        },\n        teardown: function() {\n          var doc = this.ownerDocument || this.document || this,\n            attaches = dataPriv.access( doc, fix ) - 1;\n\n          if ( !attaches ) {\n            doc.removeEventListener( orig, handler, true );\n            dataPriv.remove( doc, fix );\n\n          } else {\n            dataPriv.access( doc, fix, attaches );\n          }\n        }\n      };\n    } );\n  }\n  var location = window.location;\n\n  var nonce = { guid: Date.now() };\n\n  var rquery = ( /\\?/ );\n\n\n\n// Cross-browser xml parsing\n  jQuery.parseXML = function( data ) {\n    var xml;\n    if ( !data || typeof data !== \"string\" ) {\n      return null;\n    }\n\n    // Support: IE 9 - 11 only\n    // IE throws on parseFromString with invalid input.\n    try {\n      xml = ( new window.DOMParser() ).parseFromString( data, \"text/xml\" );\n    } catch ( e ) {\n      xml = undefined;\n    }\n\n    if ( !xml || xml.getElementsByTagName( \"parsererror\" ).length ) {\n      jQuery.error( \"Invalid XML: \" + data );\n    }\n    return xml;\n  };\n\n\n  var\n    rbracket = /\\[\\]$/,\n    rCRLF = /\\r?\\n/g,\n    rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,\n    rsubmittable = /^(?:input|select|textarea|keygen)/i;\n\n  function buildParams( prefix, obj, traditional, add ) {\n    var name;\n\n    if ( Array.isArray( obj ) ) {\n\n      // Serialize array item.\n      jQuery.each( obj, function( i, v ) {\n        if ( traditional || rbracket.test( prefix ) ) {\n\n          // Treat each array item as a scalar.\n          add( prefix, v );\n\n        } else {\n\n          // Item is non-scalar (array or object), encode its numeric index.\n          buildParams(\n            prefix + \"[\" + ( typeof v === \"object\" && v != null ? i : \"\" ) + \"]\",\n            v,\n            traditional,\n            add\n          );\n        }\n      } );\n\n    } else if ( !traditional && toType( obj ) === \"object\" ) {\n\n      // Serialize object item.\n      for ( name in obj ) {\n        buildParams( prefix + \"[\" + name + \"]\", obj[ name ], traditional, add );\n      }\n\n    } else {\n\n      // Serialize scalar item.\n      add( prefix, obj );\n    }\n  }\n\n// Serialize an array of form elements or a set of\n// key/values into a query string\n  jQuery.param = function( a, traditional ) {\n    var prefix,\n      s = [],\n      add = function( key, valueOrFunction ) {\n\n        // If value is a function, invoke it and use its return value\n        var value = isFunction( valueOrFunction ) ?\n          valueOrFunction() :\n          valueOrFunction;\n\n        s[ s.length ] = encodeURIComponent( key ) + \"=\" +\n          encodeURIComponent( value == null ? \"\" : value );\n      };\n\n    if ( a == null ) {\n      return \"\";\n    }\n\n    // If an array was passed in, assume that it is an array of form elements.\n    if ( Array.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\n\n      // Serialize the form elements\n      jQuery.each( a, function() {\n        add( this.name, this.value );\n      } );\n\n    } else {\n\n      // If traditional, encode the \"old\" way (the way 1.3.2 or older\n      // did it), otherwise encode params recursively.\n      for ( prefix in a ) {\n        buildParams( prefix, a[ prefix ], traditional, add );\n      }\n    }\n\n    // Return the resulting serialization\n    return s.join( \"&\" );\n  };\n\n  jQuery.fn.extend( {\n    serialize: function() {\n      return jQuery.param( this.serializeArray() );\n    },\n    serializeArray: function() {\n      return this.map( function() {\n\n        // Can add propHook for \"elements\" to filter or add form elements\n        var elements = jQuery.prop( this, \"elements\" );\n        return elements ? jQuery.makeArray( elements ) : this;\n      } )\n        .filter( function() {\n          var type = this.type;\n\n          // Use .is( \":disabled\" ) so that fieldset[disabled] works\n          return this.name && !jQuery( this ).is( \":disabled\" ) &&\n            rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&\n            ( this.checked || !rcheckableType.test( type ) );\n        } )\n        .map( function( _i, elem ) {\n          var val = jQuery( this ).val();\n\n          if ( val == null ) {\n            return null;\n          }\n\n          if ( Array.isArray( val ) ) {\n            return jQuery.map( val, function( val ) {\n              return { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n            } );\n          }\n\n          return { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n        } ).get();\n    }\n  } );\n\n\n  var\n    r20 = /%20/g,\n    rhash = /#.*$/,\n    rantiCache = /([?&])_=[^&]*/,\n    rheaders = /^(.*?):[ \\t]*([^\\r\\n]*)$/mg,\n\n    // #7653, #8125, #8152: local protocol detection\n    rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,\n    rnoContent = /^(?:GET|HEAD)$/,\n    rprotocol = /^\\/\\//,\n\n    /* Prefilters\n\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\n\t * 2) These are called:\n\t *    - BEFORE asking for a transport\n\t *    - AFTER param serialization (s.data is a string if s.processData is true)\n\t * 3) key is the dataType\n\t * 4) the catchall symbol \"*\" can be used\n\t * 5) execution will start with transport dataType and THEN continue down to \"*\" if needed\n\t */\n    prefilters = {},\n\n    /* Transports bindings\n\t * 1) key is the dataType\n\t * 2) the catchall symbol \"*\" can be used\n\t * 3) selection will start with transport dataType and THEN go to \"*\" if needed\n\t */\n    transports = {},\n\n    // Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\n    allTypes = \"*/\".concat( \"*\" ),\n\n    // Anchor tag for parsing the document origin\n    originAnchor = document.createElement( \"a\" );\n  originAnchor.href = location.href;\n\n// Base \"constructor\" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\n  function addToPrefiltersOrTransports( structure ) {\n\n    // dataTypeExpression is optional and defaults to \"*\"\n    return function( dataTypeExpression, func ) {\n\n      if ( typeof dataTypeExpression !== \"string\" ) {\n        func = dataTypeExpression;\n        dataTypeExpression = \"*\";\n      }\n\n      var dataType,\n        i = 0,\n        dataTypes = dataTypeExpression.toLowerCase().match( rnothtmlwhite ) || [];\n\n      if ( isFunction( func ) ) {\n\n        // For each dataType in the dataTypeExpression\n        while ( ( dataType = dataTypes[ i++ ] ) ) {\n\n          // Prepend if requested\n          if ( dataType[ 0 ] === \"+\" ) {\n            dataType = dataType.slice( 1 ) || \"*\";\n            ( structure[ dataType ] = structure[ dataType ] || [] ).unshift( func );\n\n            // Otherwise append\n          } else {\n            ( structure[ dataType ] = structure[ dataType ] || [] ).push( func );\n          }\n        }\n      }\n    };\n  }\n\n// Base inspection function for prefilters and transports\n  function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {\n\n    var inspected = {},\n      seekingTransport = ( structure === transports );\n\n    function inspect( dataType ) {\n      var selected;\n      inspected[ dataType ] = true;\n      jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {\n        var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );\n        if ( typeof dataTypeOrTransport === \"string\" &&\n          !seekingTransport && !inspected[ dataTypeOrTransport ] ) {\n\n          options.dataTypes.unshift( dataTypeOrTransport );\n          inspect( dataTypeOrTransport );\n          return false;\n        } else if ( seekingTransport ) {\n          return !( selected = dataTypeOrTransport );\n        }\n      } );\n      return selected;\n    }\n\n    return inspect( options.dataTypes[ 0 ] ) || !inspected[ \"*\" ] && inspect( \"*\" );\n  }\n\n// A special extend for ajax options\n// that takes \"flat\" options (not to be deep extended)\n// Fixes #9887\n  function ajaxExtend( target, src ) {\n    var key, deep,\n      flatOptions = jQuery.ajaxSettings.flatOptions || {};\n\n    for ( key in src ) {\n      if ( src[ key ] !== undefined ) {\n        ( flatOptions[ key ] ? target : ( deep || ( deep = {} ) ) )[ key ] = src[ key ];\n      }\n    }\n    if ( deep ) {\n      jQuery.extend( true, target, deep );\n    }\n\n    return target;\n  }\n\n  /* Handles responses to an ajax request:\n * - finds the right dataType (mediates between content-type and expected dataType)\n * - returns the corresponding response\n */\n  function ajaxHandleResponses( s, jqXHR, responses ) {\n\n    var ct, type, finalDataType, firstDataType,\n      contents = s.contents,\n      dataTypes = s.dataTypes;\n\n    // Remove auto dataType and get content-type in the process\n    while ( dataTypes[ 0 ] === \"*\" ) {\n      dataTypes.shift();\n      if ( ct === undefined ) {\n        ct = s.mimeType || jqXHR.getResponseHeader( \"Content-Type\" );\n      }\n    }\n\n    // Check if we're dealing with a known content-type\n    if ( ct ) {\n      for ( type in contents ) {\n        if ( contents[ type ] && contents[ type ].test( ct ) ) {\n          dataTypes.unshift( type );\n          break;\n        }\n      }\n    }\n\n    // Check to see if we have a response for the expected dataType\n    if ( dataTypes[ 0 ] in responses ) {\n      finalDataType = dataTypes[ 0 ];\n    } else {\n\n      // Try convertible dataTypes\n      for ( type in responses ) {\n        if ( !dataTypes[ 0 ] || s.converters[ type + \" \" + dataTypes[ 0 ] ] ) {\n          finalDataType = type;\n          break;\n        }\n        if ( !firstDataType ) {\n          firstDataType = type;\n        }\n      }\n\n      // Or just use first one\n      finalDataType = finalDataType || firstDataType;\n    }\n\n    // If we found a dataType\n    // We add the dataType to the list if needed\n    // and return the corresponding response\n    if ( finalDataType ) {\n      if ( finalDataType !== dataTypes[ 0 ] ) {\n        dataTypes.unshift( finalDataType );\n      }\n      return responses[ finalDataType ];\n    }\n  }\n\n  /* Chain conversions given the request and the original response\n * Also sets the responseXXX fields on the jqXHR instance\n */\n  function ajaxConvert( s, response, jqXHR, isSuccess ) {\n    var conv2, current, conv, tmp, prev,\n      converters = {},\n\n      // Work with a copy of dataTypes in case we need to modify it for conversion\n      dataTypes = s.dataTypes.slice();\n\n    // Create converters map with lowercased keys\n    if ( dataTypes[ 1 ] ) {\n      for ( conv in s.converters ) {\n        converters[ conv.toLowerCase() ] = s.converters[ conv ];\n      }\n    }\n\n    current = dataTypes.shift();\n\n    // Convert to each sequential dataType\n    while ( current ) {\n\n      if ( s.responseFields[ current ] ) {\n        jqXHR[ s.responseFields[ current ] ] = response;\n      }\n\n      // Apply the dataFilter if provided\n      if ( !prev && isSuccess && s.dataFilter ) {\n        response = s.dataFilter( response, s.dataType );\n      }\n\n      prev = current;\n      current = dataTypes.shift();\n\n      if ( current ) {\n\n        // There's only work to do if current dataType is non-auto\n        if ( current === \"*\" ) {\n\n          current = prev;\n\n          // Convert response if prev dataType is non-auto and differs from current\n        } else if ( prev !== \"*\" && prev !== current ) {\n\n          // Seek a direct converter\n          conv = converters[ prev + \" \" + current ] || converters[ \"* \" + current ];\n\n          // If none found, seek a pair\n          if ( !conv ) {\n            for ( conv2 in converters ) {\n\n              // If conv2 outputs current\n              tmp = conv2.split( \" \" );\n              if ( tmp[ 1 ] === current ) {\n\n                // If prev can be converted to accepted input\n                conv = converters[ prev + \" \" + tmp[ 0 ] ] ||\n                  converters[ \"* \" + tmp[ 0 ] ];\n                if ( conv ) {\n\n                  // Condense equivalence converters\n                  if ( conv === true ) {\n                    conv = converters[ conv2 ];\n\n                    // Otherwise, insert the intermediate dataType\n                  } else if ( converters[ conv2 ] !== true ) {\n                    current = tmp[ 0 ];\n                    dataTypes.unshift( tmp[ 1 ] );\n                  }\n                  break;\n                }\n              }\n            }\n          }\n\n          // Apply converter (if not an equivalence)\n          if ( conv !== true ) {\n\n            // Unless errors are allowed to bubble, catch and return them\n            if ( conv && s.throws ) {\n              response = conv( response );\n            } else {\n              try {\n                response = conv( response );\n              } catch ( e ) {\n                return {\n                  state: \"parsererror\",\n                  error: conv ? e : \"No conversion from \" + prev + \" to \" + current\n                };\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return { state: \"success\", data: response };\n  }\n\n  jQuery.extend( {\n\n    // Counter for holding the number of active queries\n    active: 0,\n\n    // Last-Modified header cache for next request\n    lastModified: {},\n    etag: {},\n\n    ajaxSettings: {\n      url: location.href,\n      type: \"GET\",\n      isLocal: rlocalProtocol.test( location.protocol ),\n      global: true,\n      processData: true,\n      async: true,\n      contentType: \"application/x-www-form-urlencoded; charset=UTF-8\",\n\n      /*\n\t\ttimeout: 0,\n\t\tdata: null,\n\t\tdataType: null,\n\t\tusername: null,\n\t\tpassword: null,\n\t\tcache: null,\n\t\tthrows: false,\n\t\ttraditional: false,\n\t\theaders: {},\n\t\t*/\n\n      accepts: {\n        \"*\": allTypes,\n        text: \"text/plain\",\n        html: \"text/html\",\n        xml: \"application/xml, text/xml\",\n        json: \"application/json, text/javascript\"\n      },\n\n      contents: {\n        xml: /\\bxml\\b/,\n        html: /\\bhtml/,\n        json: /\\bjson\\b/\n      },\n\n      responseFields: {\n        xml: \"responseXML\",\n        text: \"responseText\",\n        json: \"responseJSON\"\n      },\n\n      // Data converters\n      // Keys separate source (or catchall \"*\") and destination types with a single space\n      converters: {\n\n        // Convert anything to text\n        \"* text\": String,\n\n        // Text to html (true = no transformation)\n        \"text html\": true,\n\n        // Evaluate text as a json expression\n        \"text json\": JSON.parse,\n\n        // Parse text as xml\n        \"text xml\": jQuery.parseXML\n      },\n\n      // For options that shouldn't be deep extended:\n      // you can add your own custom options here if\n      // and when you create one that shouldn't be\n      // deep extended (see ajaxExtend)\n      flatOptions: {\n        url: true,\n        context: true\n      }\n    },\n\n    // Creates a full fledged settings object into target\n    // with both ajaxSettings and settings fields.\n    // If target is omitted, writes into ajaxSettings.\n    ajaxSetup: function( target, settings ) {\n      return settings ?\n\n        // Building a settings object\n        ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :\n\n        // Extending ajaxSettings\n        ajaxExtend( jQuery.ajaxSettings, target );\n    },\n\n    ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\n    ajaxTransport: addToPrefiltersOrTransports( transports ),\n\n    // Main method\n    ajax: function( url, options ) {\n\n      // If url is an object, simulate pre-1.5 signature\n      if ( typeof url === \"object\" ) {\n        options = url;\n        url = undefined;\n      }\n\n      // Force options to be an object\n      options = options || {};\n\n      var transport,\n\n        // URL without anti-cache param\n        cacheURL,\n\n        // Response headers\n        responseHeadersString,\n        responseHeaders,\n\n        // timeout handle\n        timeoutTimer,\n\n        // Url cleanup var\n        urlAnchor,\n\n        // Request state (becomes false upon send and true upon completion)\n        completed,\n\n        // To know if global events are to be dispatched\n        fireGlobals,\n\n        // Loop variable\n        i,\n\n        // uncached part of the url\n        uncached,\n\n        // Create the final options object\n        s = jQuery.ajaxSetup( {}, options ),\n\n        // Callbacks context\n        callbackContext = s.context || s,\n\n        // Context for global events is callbackContext if it is a DOM node or jQuery collection\n        globalEventContext = s.context &&\n        ( callbackContext.nodeType || callbackContext.jquery ) ?\n          jQuery( callbackContext ) :\n          jQuery.event,\n\n        // Deferreds\n        deferred = jQuery.Deferred(),\n        completeDeferred = jQuery.Callbacks( \"once memory\" ),\n\n        // Status-dependent callbacks\n        statusCode = s.statusCode || {},\n\n        // Headers (they are sent all at once)\n        requestHeaders = {},\n        requestHeadersNames = {},\n\n        // Default abort message\n        strAbort = \"canceled\",\n\n        // Fake xhr\n        jqXHR = {\n          readyState: 0,\n\n          // Builds headers hashtable if needed\n          getResponseHeader: function( key ) {\n            var match;\n            if ( completed ) {\n              if ( !responseHeaders ) {\n                responseHeaders = {};\n                while ( ( match = rheaders.exec( responseHeadersString ) ) ) {\n                  responseHeaders[ match[ 1 ].toLowerCase() + \" \" ] =\n                    ( responseHeaders[ match[ 1 ].toLowerCase() + \" \" ] || [] )\n                      .concat( match[ 2 ] );\n                }\n              }\n              match = responseHeaders[ key.toLowerCase() + \" \" ];\n            }\n            return match == null ? null : match.join( \", \" );\n          },\n\n          // Raw string\n          getAllResponseHeaders: function() {\n            return completed ? responseHeadersString : null;\n          },\n\n          // Caches the header\n          setRequestHeader: function( name, value ) {\n            if ( completed == null ) {\n              name = requestHeadersNames[ name.toLowerCase() ] =\n                requestHeadersNames[ name.toLowerCase() ] || name;\n              requestHeaders[ name ] = value;\n            }\n            return this;\n          },\n\n          // Overrides response content-type header\n          overrideMimeType: function( type ) {\n            if ( completed == null ) {\n              s.mimeType = type;\n            }\n            return this;\n          },\n\n          // Status-dependent callbacks\n          statusCode: function( map ) {\n            var code;\n            if ( map ) {\n              if ( completed ) {\n\n                // Execute the appropriate callbacks\n                jqXHR.always( map[ jqXHR.status ] );\n              } else {\n\n                // Lazy-add the new callbacks in a way that preserves old ones\n                for ( code in map ) {\n                  statusCode[ code ] = [ statusCode[ code ], map[ code ] ];\n                }\n              }\n            }\n            return this;\n          },\n\n          // Cancel the request\n          abort: function( statusText ) {\n            var finalText = statusText || strAbort;\n            if ( transport ) {\n              transport.abort( finalText );\n            }\n            done( 0, finalText );\n            return this;\n          }\n        };\n\n      // Attach deferreds\n      deferred.promise( jqXHR );\n\n      // Add protocol if not provided (prefilters might expect it)\n      // Handle falsy url in the settings object (#10093: consistency with old signature)\n      // We also use the url parameter if available\n      s.url = ( ( url || s.url || location.href ) + \"\" )\n        .replace( rprotocol, location.protocol + \"//\" );\n\n      // Alias method option to type as per ticket #12004\n      s.type = options.method || options.type || s.method || s.type;\n\n      // Extract dataTypes list\n      s.dataTypes = ( s.dataType || \"*\" ).toLowerCase().match( rnothtmlwhite ) || [ \"\" ];\n\n      // A cross-domain request is in order when the origin doesn't match the current origin.\n      if ( s.crossDomain == null ) {\n        urlAnchor = document.createElement( \"a\" );\n\n        // Support: IE <=8 - 11, Edge 12 - 15\n        // IE throws exception on accessing the href property if url is malformed,\n        // e.g. http://example.com:80x/\n        try {\n          urlAnchor.href = s.url;\n\n          // Support: IE <=8 - 11 only\n          // Anchor's host property isn't correctly set when s.url is relative\n          urlAnchor.href = urlAnchor.href;\n          s.crossDomain = originAnchor.protocol + \"//\" + originAnchor.host !==\n            urlAnchor.protocol + \"//\" + urlAnchor.host;\n        } catch ( e ) {\n\n          // If there is an error parsing the URL, assume it is crossDomain,\n          // it can be rejected by the transport if it is invalid\n          s.crossDomain = true;\n        }\n      }\n\n      // Convert data if not already a string\n      if ( s.data && s.processData && typeof s.data !== \"string\" ) {\n        s.data = jQuery.param( s.data, s.traditional );\n      }\n\n      // Apply prefilters\n      inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\n\n      // If request was aborted inside a prefilter, stop there\n      if ( completed ) {\n        return jqXHR;\n      }\n\n      // We can fire global events as of now if asked to\n      // Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)\n      fireGlobals = jQuery.event && s.global;\n\n      // Watch for a new set of requests\n      if ( fireGlobals && jQuery.active++ === 0 ) {\n        jQuery.event.trigger( \"ajaxStart\" );\n      }\n\n      // Uppercase the type\n      s.type = s.type.toUpperCase();\n\n      // Determine if request has content\n      s.hasContent = !rnoContent.test( s.type );\n\n      // Save the URL in case we're toying with the If-Modified-Since\n      // and/or If-None-Match header later on\n      // Remove hash to simplify url manipulation\n      cacheURL = s.url.replace( rhash, \"\" );\n\n      // More options handling for requests with no content\n      if ( !s.hasContent ) {\n\n        // Remember the hash so we can put it back\n        uncached = s.url.slice( cacheURL.length );\n\n        // If data is available and should be processed, append data to url\n        if ( s.data && ( s.processData || typeof s.data === \"string\" ) ) {\n          cacheURL += ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + s.data;\n\n          // #9682: remove data so that it's not used in an eventual retry\n          delete s.data;\n        }\n\n        // Add or update anti-cache param if needed\n        if ( s.cache === false ) {\n          cacheURL = cacheURL.replace( rantiCache, \"$1\" );\n          uncached = ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + \"_=\" + ( nonce.guid++ ) +\n            uncached;\n        }\n\n        // Put hash and anti-cache on the URL that will be requested (gh-1732)\n        s.url = cacheURL + uncached;\n\n        // Change '%20' to '+' if this is encoded form body content (gh-2658)\n      } else if ( s.data && s.processData &&\n        ( s.contentType || \"\" ).indexOf( \"application/x-www-form-urlencoded\" ) === 0 ) {\n        s.data = s.data.replace( r20, \"+\" );\n      }\n\n      // Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n      if ( s.ifModified ) {\n        if ( jQuery.lastModified[ cacheURL ] ) {\n          jqXHR.setRequestHeader( \"If-Modified-Since\", jQuery.lastModified[ cacheURL ] );\n        }\n        if ( jQuery.etag[ cacheURL ] ) {\n          jqXHR.setRequestHeader( \"If-None-Match\", jQuery.etag[ cacheURL ] );\n        }\n      }\n\n      // Set the correct header, if data is being sent\n      if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\n        jqXHR.setRequestHeader( \"Content-Type\", s.contentType );\n      }\n\n      // Set the Accepts header for the server, depending on the dataType\n      jqXHR.setRequestHeader(\n        \"Accept\",\n        s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[ 0 ] ] ?\n          s.accepts[ s.dataTypes[ 0 ] ] +\n          ( s.dataTypes[ 0 ] !== \"*\" ? \", \" + allTypes + \"; q=0.01\" : \"\" ) :\n          s.accepts[ \"*\" ]\n      );\n\n      // Check for headers option\n      for ( i in s.headers ) {\n        jqXHR.setRequestHeader( i, s.headers[ i ] );\n      }\n\n      // Allow custom headers/mimetypes and early abort\n      if ( s.beforeSend &&\n        ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || completed ) ) {\n\n        // Abort if not done already and return\n        return jqXHR.abort();\n      }\n\n      // Aborting is no longer a cancellation\n      strAbort = \"abort\";\n\n      // Install callbacks on deferreds\n      completeDeferred.add( s.complete );\n      jqXHR.done( s.success );\n      jqXHR.fail( s.error );\n\n      // Get transport\n      transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\n\n      // If no transport, we auto-abort\n      if ( !transport ) {\n        done( -1, \"No Transport\" );\n      } else {\n        jqXHR.readyState = 1;\n\n        // Send global event\n        if ( fireGlobals ) {\n          globalEventContext.trigger( \"ajaxSend\", [ jqXHR, s ] );\n        }\n\n        // If request was aborted inside ajaxSend, stop there\n        if ( completed ) {\n          return jqXHR;\n        }\n\n        // Timeout\n        if ( s.async && s.timeout > 0 ) {\n          timeoutTimer = window.setTimeout( function() {\n            jqXHR.abort( \"timeout\" );\n          }, s.timeout );\n        }\n\n        try {\n          completed = false;\n          transport.send( requestHeaders, done );\n        } catch ( e ) {\n\n          // Rethrow post-completion exceptions\n          if ( completed ) {\n            throw e;\n          }\n\n          // Propagate others as results\n          done( -1, e );\n        }\n      }\n\n      // Callback for when everything is done\n      function done( status, nativeStatusText, responses, headers ) {\n        var isSuccess, success, error, response, modified,\n          statusText = nativeStatusText;\n\n        // Ignore repeat invocations\n        if ( completed ) {\n          return;\n        }\n\n        completed = true;\n\n        // Clear timeout if it exists\n        if ( timeoutTimer ) {\n          window.clearTimeout( timeoutTimer );\n        }\n\n        // Dereference transport for early garbage collection\n        // (no matter how long the jqXHR object will be used)\n        transport = undefined;\n\n        // Cache response headers\n        responseHeadersString = headers || \"\";\n\n        // Set readyState\n        jqXHR.readyState = status > 0 ? 4 : 0;\n\n        // Determine if successful\n        isSuccess = status >= 200 && status < 300 || status === 304;\n\n        // Get response data\n        if ( responses ) {\n          response = ajaxHandleResponses( s, jqXHR, responses );\n        }\n\n        // Use a noop converter for missing script\n        if ( !isSuccess && jQuery.inArray( \"script\", s.dataTypes ) > -1 ) {\n          s.converters[ \"text script\" ] = function() {};\n        }\n\n        // Convert no matter what (that way responseXXX fields are always set)\n        response = ajaxConvert( s, response, jqXHR, isSuccess );\n\n        // If successful, handle type chaining\n        if ( isSuccess ) {\n\n          // Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n          if ( s.ifModified ) {\n            modified = jqXHR.getResponseHeader( \"Last-Modified\" );\n            if ( modified ) {\n              jQuery.lastModified[ cacheURL ] = modified;\n            }\n            modified = jqXHR.getResponseHeader( \"etag\" );\n            if ( modified ) {\n              jQuery.etag[ cacheURL ] = modified;\n            }\n          }\n\n          // if no content\n          if ( status === 204 || s.type === \"HEAD\" ) {\n            statusText = \"nocontent\";\n\n            // if not modified\n          } else if ( status === 304 ) {\n            statusText = \"notmodified\";\n\n            // If we have data, let's convert it\n          } else {\n            statusText = response.state;\n            success = response.data;\n            error = response.error;\n            isSuccess = !error;\n          }\n        } else {\n\n          // Extract error from statusText and normalize for non-aborts\n          error = statusText;\n          if ( status || !statusText ) {\n            statusText = \"error\";\n            if ( status < 0 ) {\n              status = 0;\n            }\n          }\n        }\n\n        // Set data for the fake xhr object\n        jqXHR.status = status;\n        jqXHR.statusText = ( nativeStatusText || statusText ) + \"\";\n\n        // Success/Error\n        if ( isSuccess ) {\n          deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\n        } else {\n          deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\n        }\n\n        // Status-dependent callbacks\n        jqXHR.statusCode( statusCode );\n        statusCode = undefined;\n\n        if ( fireGlobals ) {\n          globalEventContext.trigger( isSuccess ? \"ajaxSuccess\" : \"ajaxError\",\n            [ jqXHR, s, isSuccess ? success : error ] );\n        }\n\n        // Complete\n        completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\n\n        if ( fireGlobals ) {\n          globalEventContext.trigger( \"ajaxComplete\", [ jqXHR, s ] );\n\n          // Handle the global AJAX counter\n          if ( !( --jQuery.active ) ) {\n            jQuery.event.trigger( \"ajaxStop\" );\n          }\n        }\n      }\n\n      return jqXHR;\n    },\n\n    getJSON: function( url, data, callback ) {\n      return jQuery.get( url, data, callback, \"json\" );\n    },\n\n    getScript: function( url, callback ) {\n      return jQuery.get( url, undefined, callback, \"script\" );\n    }\n  } );\n\n  jQuery.each( [ \"get\", \"post\" ], function( _i, method ) {\n    jQuery[ method ] = function( url, data, callback, type ) {\n\n      // Shift arguments if data argument was omitted\n      if ( isFunction( data ) ) {\n        type = type || callback;\n        callback = data;\n        data = undefined;\n      }\n\n      // The url can be an options object (which then must have .url)\n      return jQuery.ajax( jQuery.extend( {\n        url: url,\n        type: method,\n        dataType: type,\n        data: data,\n        success: callback\n      }, jQuery.isPlainObject( url ) && url ) );\n    };\n  } );\n\n  jQuery.ajaxPrefilter( function( s ) {\n    var i;\n    for ( i in s.headers ) {\n      if ( i.toLowerCase() === \"content-type\" ) {\n        s.contentType = s.headers[ i ] || \"\";\n      }\n    }\n  } );\n\n\n  jQuery._evalUrl = function( url, options, doc ) {\n    return jQuery.ajax( {\n      url: url,\n\n      // Make this explicit, since user can override this through ajaxSetup (#11264)\n      type: \"GET\",\n      dataType: \"script\",\n      cache: true,\n      async: false,\n      global: false,\n\n      // Only evaluate the response if it is successful (gh-4126)\n      // dataFilter is not invoked for failure responses, so using it instead\n      // of the default converter is kludgy but it works.\n      converters: {\n        \"text script\": function() {}\n      },\n      dataFilter: function( response ) {\n        jQuery.globalEval( response, options, doc );\n      }\n    } );\n  };\n\n\n  jQuery.fn.extend( {\n    wrapAll: function( html ) {\n      var wrap;\n\n      if ( this[ 0 ] ) {\n        if ( isFunction( html ) ) {\n          html = html.call( this[ 0 ] );\n        }\n\n        // The elements to wrap the target around\n        wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );\n\n        if ( this[ 0 ].parentNode ) {\n          wrap.insertBefore( this[ 0 ] );\n        }\n\n        wrap.map( function() {\n          var elem = this;\n\n          while ( elem.firstElementChild ) {\n            elem = elem.firstElementChild;\n          }\n\n          return elem;\n        } ).append( this );\n      }\n\n      return this;\n    },\n\n    wrapInner: function( html ) {\n      if ( isFunction( html ) ) {\n        return this.each( function( i ) {\n          jQuery( this ).wrapInner( html.call( this, i ) );\n        } );\n      }\n\n      return this.each( function() {\n        var self = jQuery( this ),\n          contents = self.contents();\n\n        if ( contents.length ) {\n          contents.wrapAll( html );\n\n        } else {\n          self.append( html );\n        }\n      } );\n    },\n\n    wrap: function( html ) {\n      var htmlIsFunction = isFunction( html );\n\n      return this.each( function( i ) {\n        jQuery( this ).wrapAll( htmlIsFunction ? html.call( this, i ) : html );\n      } );\n    },\n\n    unwrap: function( selector ) {\n      this.parent( selector ).not( \"body\" ).each( function() {\n        jQuery( this ).replaceWith( this.childNodes );\n      } );\n      return this;\n    }\n  } );\n\n\n  jQuery.expr.pseudos.hidden = function( elem ) {\n    return !jQuery.expr.pseudos.visible( elem );\n  };\n  jQuery.expr.pseudos.visible = function( elem ) {\n    return !!( elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length );\n  };\n\n\n\n\n  jQuery.ajaxSettings.xhr = function() {\n    try {\n      return new window.XMLHttpRequest();\n    } catch ( e ) {}\n  };\n\n  var xhrSuccessStatus = {\n\n      // File protocol always yields status code 0, assume 200\n      0: 200,\n\n      // Support: IE <=9 only\n      // #1450: sometimes IE returns 1223 when it should be 204\n      1223: 204\n    },\n    xhrSupported = jQuery.ajaxSettings.xhr();\n\n  support.cors = !!xhrSupported && ( \"withCredentials\" in xhrSupported );\n  support.ajax = xhrSupported = !!xhrSupported;\n\n  jQuery.ajaxTransport( function( options ) {\n    var callback, errorCallback;\n\n    // Cross domain only allowed if supported through XMLHttpRequest\n    if ( support.cors || xhrSupported && !options.crossDomain ) {\n      return {\n        send: function( headers, complete ) {\n          var i,\n            xhr = options.xhr();\n\n          xhr.open(\n            options.type,\n            options.url,\n            options.async,\n            options.username,\n            options.password\n          );\n\n          // Apply custom fields if provided\n          if ( options.xhrFields ) {\n            for ( i in options.xhrFields ) {\n              xhr[ i ] = options.xhrFields[ i ];\n            }\n          }\n\n          // Override mime type if needed\n          if ( options.mimeType && xhr.overrideMimeType ) {\n            xhr.overrideMimeType( options.mimeType );\n          }\n\n          // X-Requested-With header\n          // For cross-domain requests, seeing as conditions for a preflight are\n          // akin to a jigsaw puzzle, we simply never set it to be sure.\n          // (it can always be set on a per-request basis or even using ajaxSetup)\n          // For same-domain requests, won't change header if already provided.\n          if ( !options.crossDomain && !headers[ \"X-Requested-With\" ] ) {\n            headers[ \"X-Requested-With\" ] = \"XMLHttpRequest\";\n          }\n\n          // Set headers\n          for ( i in headers ) {\n            xhr.setRequestHeader( i, headers[ i ] );\n          }\n\n          // Callback\n          callback = function( type ) {\n            return function() {\n              if ( callback ) {\n                callback = errorCallback = xhr.onload =\n                  xhr.onerror = xhr.onabort = xhr.ontimeout =\n                    xhr.onreadystatechange = null;\n\n                if ( type === \"abort\" ) {\n                  xhr.abort();\n                } else if ( type === \"error\" ) {\n\n                  // Support: IE <=9 only\n                  // On a manual native abort, IE9 throws\n                  // errors on any property access that is not readyState\n                  if ( typeof xhr.status !== \"number\" ) {\n                    complete( 0, \"error\" );\n                  } else {\n                    complete(\n\n                      // File: protocol always yields status 0; see #8605, #14207\n                      xhr.status,\n                      xhr.statusText\n                    );\n                  }\n                } else {\n                  complete(\n                    xhrSuccessStatus[ xhr.status ] || xhr.status,\n                    xhr.statusText,\n\n                    // Support: IE <=9 only\n                    // IE9 has no XHR2 but throws on binary (trac-11426)\n                    // For XHR2 non-text, let the caller handle it (gh-2498)\n                    ( xhr.responseType || \"text\" ) !== \"text\"  ||\n                    typeof xhr.responseText !== \"string\" ?\n                      { binary: xhr.response } :\n                      { text: xhr.responseText },\n                    xhr.getAllResponseHeaders()\n                  );\n                }\n              }\n            };\n          };\n\n          // Listen to events\n          xhr.onload = callback();\n          errorCallback = xhr.onerror = xhr.ontimeout = callback( \"error\" );\n\n          // Support: IE 9 only\n          // Use onreadystatechange to replace onabort\n          // to handle uncaught aborts\n          if ( xhr.onabort !== undefined ) {\n            xhr.onabort = errorCallback;\n          } else {\n            xhr.onreadystatechange = function() {\n\n              // Check readyState before timeout as it changes\n              if ( xhr.readyState === 4 ) {\n\n                // Allow onerror to be called first,\n                // but that will not handle a native abort\n                // Also, save errorCallback to a variable\n                // as xhr.onerror cannot be accessed\n                window.setTimeout( function() {\n                  if ( callback ) {\n                    errorCallback();\n                  }\n                } );\n              }\n            };\n          }\n\n          // Create the abort callback\n          callback = callback( \"abort\" );\n\n          try {\n\n            // Do send the request (this may raise an exception)\n            xhr.send( options.hasContent && options.data || null );\n          } catch ( e ) {\n\n            // #14683: Only rethrow if this hasn't been notified as an error yet\n            if ( callback ) {\n              throw e;\n            }\n          }\n        },\n\n        abort: function() {\n          if ( callback ) {\n            callback();\n          }\n        }\n      };\n    }\n  } );\n\n\n\n\n// Prevent auto-execution of scripts when no explicit dataType was provided (See gh-2432)\n  jQuery.ajaxPrefilter( function( s ) {\n    if ( s.crossDomain ) {\n      s.contents.script = false;\n    }\n  } );\n\n// Install script dataType\n  jQuery.ajaxSetup( {\n    accepts: {\n      script: \"text/javascript, application/javascript, \" +\n        \"application/ecmascript, application/x-ecmascript\"\n    },\n    contents: {\n      script: /\\b(?:java|ecma)script\\b/\n    },\n    converters: {\n      \"text script\": function( text ) {\n        jQuery.globalEval( text );\n        return text;\n      }\n    }\n  } );\n\n// Handle cache's special case and crossDomain\n  jQuery.ajaxPrefilter( \"script\", function( s ) {\n    if ( s.cache === undefined ) {\n      s.cache = false;\n    }\n    if ( s.crossDomain ) {\n      s.type = \"GET\";\n    }\n  } );\n\n// Bind script tag hack transport\n  jQuery.ajaxTransport( \"script\", function( s ) {\n\n    // This transport only deals with cross domain or forced-by-attrs requests\n    if ( s.crossDomain || s.scriptAttrs ) {\n      var script, callback;\n      return {\n        send: function( _, complete ) {\n          script = jQuery( \"<script>\" )\n            .attr( s.scriptAttrs || {} )\n            .prop( { charset: s.scriptCharset, src: s.url } )\n            .on( \"load error\", callback = function( evt ) {\n              script.remove();\n              callback = null;\n              if ( evt ) {\n                complete( evt.type === \"error\" ? 404 : 200, evt.type );\n              }\n            } );\n\n          // Use native DOM manipulation to avoid our domManip AJAX trickery\n          document.head.appendChild( script[ 0 ] );\n        },\n        abort: function() {\n          if ( callback ) {\n            callback();\n          }\n        }\n      };\n    }\n  } );\n\n\n\n\n  var oldCallbacks = [],\n    rjsonp = /(=)\\?(?=&|$)|\\?\\?/;\n\n// Default jsonp settings\n  jQuery.ajaxSetup( {\n    jsonp: \"callback\",\n    jsonpCallback: function() {\n      var callback = oldCallbacks.pop() || ( jQuery.expando + \"_\" + ( nonce.guid++ ) );\n      this[ callback ] = true;\n      return callback;\n    }\n  } );\n\n// Detect, normalize options and install callbacks for jsonp requests\n  jQuery.ajaxPrefilter( \"json jsonp\", function( s, originalSettings, jqXHR ) {\n\n    var callbackName, overwritten, responseContainer,\n      jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?\n          \"url\" :\n          typeof s.data === \"string\" &&\n          ( s.contentType || \"\" )\n            .indexOf( \"application/x-www-form-urlencoded\" ) === 0 &&\n          rjsonp.test( s.data ) && \"data\"\n      );\n\n    // Handle iff the expected data type is \"jsonp\" or we have a parameter to set\n    if ( jsonProp || s.dataTypes[ 0 ] === \"jsonp\" ) {\n\n      // Get callback name, remembering preexisting value associated with it\n      callbackName = s.jsonpCallback = isFunction( s.jsonpCallback ) ?\n        s.jsonpCallback() :\n        s.jsonpCallback;\n\n      // Insert callback into url or form data\n      if ( jsonProp ) {\n        s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, \"$1\" + callbackName );\n      } else if ( s.jsonp !== false ) {\n        s.url += ( rquery.test( s.url ) ? \"&\" : \"?\" ) + s.jsonp + \"=\" + callbackName;\n      }\n\n      // Use data converter to retrieve json after script execution\n      s.converters[ \"script json\" ] = function() {\n        if ( !responseContainer ) {\n          jQuery.error( callbackName + \" was not called\" );\n        }\n        return responseContainer[ 0 ];\n      };\n\n      // Force json dataType\n      s.dataTypes[ 0 ] = \"json\";\n\n      // Install callback\n      overwritten = window[ callbackName ];\n      window[ callbackName ] = function() {\n        responseContainer = arguments;\n      };\n\n      // Clean-up function (fires after converters)\n      jqXHR.always( function() {\n\n        // If previous value didn't exist - remove it\n        if ( overwritten === undefined ) {\n          jQuery( window ).removeProp( callbackName );\n\n          // Otherwise restore preexisting value\n        } else {\n          window[ callbackName ] = overwritten;\n        }\n\n        // Save back as free\n        if ( s[ callbackName ] ) {\n\n          // Make sure that re-using the options doesn't screw things around\n          s.jsonpCallback = originalSettings.jsonpCallback;\n\n          // Save the callback name for future use\n          oldCallbacks.push( callbackName );\n        }\n\n        // Call if it was a function and we have a response\n        if ( responseContainer && isFunction( overwritten ) ) {\n          overwritten( responseContainer[ 0 ] );\n        }\n\n        responseContainer = overwritten = undefined;\n      } );\n\n      // Delegate to script\n      return \"script\";\n    }\n  } );\n\n\n\n\n// Support: Safari 8 only\n// In Safari 8 documents created via document.implementation.createHTMLDocument\n// collapse sibling forms: the second one becomes a child of the first one.\n// Because of that, this security measure has to be disabled in Safari 8.\n// https://bugs.webkit.org/show_bug.cgi?id=137337\n  support.createHTMLDocument = ( function() {\n    var body = document.implementation.createHTMLDocument( \"\" ).body;\n    body.innerHTML = \"<form></form><form></form>\";\n    return body.childNodes.length === 2;\n  } )();\n\n\n// Argument \"data\" should be string of html\n// context (optional): If specified, the fragment will be created in this context,\n// defaults to document\n// keepScripts (optional): If true, will include scripts passed in the html string\n  jQuery.parseHTML = function( data, context, keepScripts ) {\n    if ( typeof data !== \"string\" ) {\n      return [];\n    }\n    if ( typeof context === \"boolean\" ) {\n      keepScripts = context;\n      context = false;\n    }\n\n    var base, parsed, scripts;\n\n    if ( !context ) {\n\n      // Stop scripts or inline event handlers from being executed immediately\n      // by using document.implementation\n      if ( support.createHTMLDocument ) {\n        context = document.implementation.createHTMLDocument( \"\" );\n\n        // Set the base href for the created document\n        // so any parsed elements with URLs\n        // are based on the document's URL (gh-2965)\n        base = context.createElement( \"base\" );\n        base.href = document.location.href;\n        context.head.appendChild( base );\n      } else {\n        context = document;\n      }\n    }\n\n    parsed = rsingleTag.exec( data );\n    scripts = !keepScripts && [];\n\n    // Single tag\n    if ( parsed ) {\n      return [ context.createElement( parsed[ 1 ] ) ];\n    }\n\n    parsed = buildFragment( [ data ], context, scripts );\n\n    if ( scripts && scripts.length ) {\n      jQuery( scripts ).remove();\n    }\n\n    return jQuery.merge( [], parsed.childNodes );\n  };\n\n\n  /**\n   * Load a url into a page\n   */\n  jQuery.fn.load = function( url, params, callback ) {\n    var selector, type, response,\n      self = this,\n      off = url.indexOf( \" \" );\n\n    if ( off > -1 ) {\n      selector = stripAndCollapse( url.slice( off ) );\n      url = url.slice( 0, off );\n    }\n\n    // If it's a function\n    if ( isFunction( params ) ) {\n\n      // We assume that it's the callback\n      callback = params;\n      params = undefined;\n\n      // Otherwise, build a param string\n    } else if ( params && typeof params === \"object\" ) {\n      type = \"POST\";\n    }\n\n    // If we have elements to modify, make the request\n    if ( self.length > 0 ) {\n      jQuery.ajax( {\n        url: url,\n\n        // If \"type\" variable is undefined, then \"GET\" method will be used.\n        // Make value of this field explicit since\n        // user can override it through ajaxSetup method\n        type: type || \"GET\",\n        dataType: \"html\",\n        data: params\n      } ).done( function( responseText ) {\n\n        // Save response for use in complete callback\n        response = arguments;\n\n        self.html( selector ?\n\n          // If a selector was specified, locate the right elements in a dummy div\n          // Exclude scripts to avoid IE 'Permission Denied' errors\n          jQuery( \"<div>\" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :\n\n          // Otherwise use the full result\n          responseText );\n\n        // If the request succeeds, this function gets \"data\", \"status\", \"jqXHR\"\n        // but they are ignored because response was set above.\n        // If it fails, this function gets \"jqXHR\", \"status\", \"error\"\n      } ).always( callback && function( jqXHR, status ) {\n        self.each( function() {\n          callback.apply( this, response || [ jqXHR.responseText, status, jqXHR ] );\n        } );\n      } );\n    }\n\n    return this;\n  };\n\n\n\n\n  jQuery.expr.pseudos.animated = function( elem ) {\n    return jQuery.grep( jQuery.timers, function( fn ) {\n      return elem === fn.elem;\n    } ).length;\n  };\n\n\n\n\n  jQuery.offset = {\n    setOffset: function( elem, options, i ) {\n      var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,\n        position = jQuery.css( elem, \"position\" ),\n        curElem = jQuery( elem ),\n        props = {};\n\n      // Set position first, in-case top/left are set even on static elem\n      if ( position === \"static\" ) {\n        elem.style.position = \"relative\";\n      }\n\n      curOffset = curElem.offset();\n      curCSSTop = jQuery.css( elem, \"top\" );\n      curCSSLeft = jQuery.css( elem, \"left\" );\n      calculatePosition = ( position === \"absolute\" || position === \"fixed\" ) &&\n        ( curCSSTop + curCSSLeft ).indexOf( \"auto\" ) > -1;\n\n      // Need to be able to calculate position if either\n      // top or left is auto and position is either absolute or fixed\n      if ( calculatePosition ) {\n        curPosition = curElem.position();\n        curTop = curPosition.top;\n        curLeft = curPosition.left;\n\n      } else {\n        curTop = parseFloat( curCSSTop ) || 0;\n        curLeft = parseFloat( curCSSLeft ) || 0;\n      }\n\n      if ( isFunction( options ) ) {\n\n        // Use jQuery.extend here to allow modification of coordinates argument (gh-1848)\n        options = options.call( elem, i, jQuery.extend( {}, curOffset ) );\n      }\n\n      if ( options.top != null ) {\n        props.top = ( options.top - curOffset.top ) + curTop;\n      }\n      if ( options.left != null ) {\n        props.left = ( options.left - curOffset.left ) + curLeft;\n      }\n\n      if ( \"using\" in options ) {\n        options.using.call( elem, props );\n\n      } else {\n        if ( typeof props.top === \"number\" ) {\n          props.top += \"px\";\n        }\n        if ( typeof props.left === \"number\" ) {\n          props.left += \"px\";\n        }\n        curElem.css( props );\n      }\n    }\n  };\n\n  jQuery.fn.extend( {\n\n    // offset() relates an element's border box to the document origin\n    offset: function( options ) {\n\n      // Preserve chaining for setter\n      if ( arguments.length ) {\n        return options === undefined ?\n          this :\n          this.each( function( i ) {\n            jQuery.offset.setOffset( this, options, i );\n          } );\n      }\n\n      var rect, win,\n        elem = this[ 0 ];\n\n      if ( !elem ) {\n        return;\n      }\n\n      // Return zeros for disconnected and hidden (display: none) elements (gh-2310)\n      // Support: IE <=11 only\n      // Running getBoundingClientRect on a\n      // disconnected node in IE throws an error\n      if ( !elem.getClientRects().length ) {\n        return { top: 0, left: 0 };\n      }\n\n      // Get document-relative position by adding viewport scroll to viewport-relative gBCR\n      rect = elem.getBoundingClientRect();\n      win = elem.ownerDocument.defaultView;\n      return {\n        top: rect.top + win.pageYOffset,\n        left: rect.left + win.pageXOffset\n      };\n    },\n\n    // position() relates an element's margin box to its offset parent's padding box\n    // This corresponds to the behavior of CSS absolute positioning\n    position: function() {\n      if ( !this[ 0 ] ) {\n        return;\n      }\n\n      var offsetParent, offset, doc,\n        elem = this[ 0 ],\n        parentOffset = { top: 0, left: 0 };\n\n      // position:fixed elements are offset from the viewport, which itself always has zero offset\n      if ( jQuery.css( elem, \"position\" ) === \"fixed\" ) {\n\n        // Assume position:fixed implies availability of getBoundingClientRect\n        offset = elem.getBoundingClientRect();\n\n      } else {\n        offset = this.offset();\n\n        // Account for the *real* offset parent, which can be the document or its root element\n        // when a statically positioned element is identified\n        doc = elem.ownerDocument;\n        offsetParent = elem.offsetParent || doc.documentElement;\n        while ( offsetParent &&\n        ( offsetParent === doc.body || offsetParent === doc.documentElement ) &&\n        jQuery.css( offsetParent, \"position\" ) === \"static\" ) {\n\n          offsetParent = offsetParent.parentNode;\n        }\n        if ( offsetParent && offsetParent !== elem && offsetParent.nodeType === 1 ) {\n\n          // Incorporate borders into its offset, since they are outside its content origin\n          parentOffset = jQuery( offsetParent ).offset();\n          parentOffset.top += jQuery.css( offsetParent, \"borderTopWidth\", true );\n          parentOffset.left += jQuery.css( offsetParent, \"borderLeftWidth\", true );\n        }\n      }\n\n      // Subtract parent offsets and element margins\n      return {\n        top: offset.top - parentOffset.top - jQuery.css( elem, \"marginTop\", true ),\n        left: offset.left - parentOffset.left - jQuery.css( elem, \"marginLeft\", true )\n      };\n    },\n\n    // This method will return documentElement in the following cases:\n    // 1) For the element inside the iframe without offsetParent, this method will return\n    //    documentElement of the parent window\n    // 2) For the hidden or detached element\n    // 3) For body or html element, i.e. in case of the html node - it will return itself\n    //\n    // but those exceptions were never presented as a real life use-cases\n    // and might be considered as more preferable results.\n    //\n    // This logic, however, is not guaranteed and can change at any point in the future\n    offsetParent: function() {\n      return this.map( function() {\n        var offsetParent = this.offsetParent;\n\n        while ( offsetParent && jQuery.css( offsetParent, \"position\" ) === \"static\" ) {\n          offsetParent = offsetParent.offsetParent;\n        }\n\n        return offsetParent || documentElement;\n      } );\n    }\n  } );\n\n// Create scrollLeft and scrollTop methods\n  jQuery.each( { scrollLeft: \"pageXOffset\", scrollTop: \"pageYOffset\" }, function( method, prop ) {\n    var top = \"pageYOffset\" === prop;\n\n    jQuery.fn[ method ] = function( val ) {\n      return access( this, function( elem, method, val ) {\n\n        // Coalesce documents and windows\n        var win;\n        if ( isWindow( elem ) ) {\n          win = elem;\n        } else if ( elem.nodeType === 9 ) {\n          win = elem.defaultView;\n        }\n\n        if ( val === undefined ) {\n          return win ? win[ prop ] : elem[ method ];\n        }\n\n        if ( win ) {\n          win.scrollTo(\n            !top ? val : win.pageXOffset,\n            top ? val : win.pageYOffset\n          );\n\n        } else {\n          elem[ method ] = val;\n        }\n      }, method, val, arguments.length );\n    };\n  } );\n\n// Support: Safari <=7 - 9.1, Chrome <=37 - 49\n// Add the top/left cssHooks using jQuery.fn.position\n// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084\n// Blink bug: https://bugs.chromium.org/p/chromium/issues/detail?id=589347\n// getComputedStyle returns percent when specified for top/left/bottom/right;\n// rather than make the css module depend on the offset module, just check for it here\n  jQuery.each( [ \"top\", \"left\" ], function( _i, prop ) {\n    jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,\n      function( elem, computed ) {\n        if ( computed ) {\n          computed = curCSS( elem, prop );\n\n          // If curCSS returns percentage, fallback to offset\n          return rnumnonpx.test( computed ) ?\n            jQuery( elem ).position()[ prop ] + \"px\" :\n            computed;\n        }\n      }\n    );\n  } );\n\n\n// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods\n  jQuery.each( { Height: \"height\", Width: \"width\" }, function( name, type ) {\n    jQuery.each( { padding: \"inner\" + name, content: type, \"\": \"outer\" + name },\n      function( defaultExtra, funcName ) {\n\n        // Margin is only for outerHeight, outerWidth\n        jQuery.fn[ funcName ] = function( margin, value ) {\n          var chainable = arguments.length && ( defaultExtra || typeof margin !== \"boolean\" ),\n            extra = defaultExtra || ( margin === true || value === true ? \"margin\" : \"border\" );\n\n          return access( this, function( elem, type, value ) {\n            var doc;\n\n            if ( isWindow( elem ) ) {\n\n              // $( window ).outerWidth/Height return w/h including scrollbars (gh-1729)\n              return funcName.indexOf( \"outer\" ) === 0 ?\n                elem[ \"inner\" + name ] :\n                elem.document.documentElement[ \"client\" + name ];\n            }\n\n            // Get document width or height\n            if ( elem.nodeType === 9 ) {\n              doc = elem.documentElement;\n\n              // Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],\n              // whichever is greatest\n              return Math.max(\n                elem.body[ \"scroll\" + name ], doc[ \"scroll\" + name ],\n                elem.body[ \"offset\" + name ], doc[ \"offset\" + name ],\n                doc[ \"client\" + name ]\n              );\n            }\n\n            return value === undefined ?\n\n              // Get width or height on the element, requesting but not forcing parseFloat\n              jQuery.css( elem, type, extra ) :\n\n              // Set width or height on the element\n              jQuery.style( elem, type, value, extra );\n          }, type, chainable ? margin : undefined, chainable );\n        };\n      } );\n  } );\n\n\n  jQuery.each( [\n    \"ajaxStart\",\n    \"ajaxStop\",\n    \"ajaxComplete\",\n    \"ajaxError\",\n    \"ajaxSuccess\",\n    \"ajaxSend\"\n  ], function( _i, type ) {\n    jQuery.fn[ type ] = function( fn ) {\n      return this.on( type, fn );\n    };\n  } );\n\n\n\n\n  jQuery.fn.extend( {\n\n    bind: function( types, data, fn ) {\n      return this.on( types, null, data, fn );\n    },\n    unbind: function( types, fn ) {\n      return this.off( types, null, fn );\n    },\n\n    delegate: function( selector, types, data, fn ) {\n      return this.on( types, selector, data, fn );\n    },\n    undelegate: function( selector, types, fn ) {\n\n      // ( namespace ) or ( selector, types [, fn] )\n      return arguments.length === 1 ?\n        this.off( selector, \"**\" ) :\n        this.off( types, selector || \"**\", fn );\n    },\n\n    hover: function( fnOver, fnOut ) {\n      return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\n    }\n  } );\n\n  jQuery.each( ( \"blur focus focusin focusout resize scroll click dblclick \" +\n      \"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave \" +\n      \"change select submit keydown keypress keyup contextmenu\" ).split( \" \" ),\n    function( _i, name ) {\n\n      // Handle event binding\n      jQuery.fn[ name ] = function( data, fn ) {\n        return arguments.length > 0 ?\n          this.on( name, null, data, fn ) :\n          this.trigger( name );\n      };\n    } );\n\n\n\n\n// Support: Android <=4.0 only\n// Make sure we trim BOM and NBSP\n  var rtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\n// Bind a function to a context, optionally partially applying any\n// arguments.\n// jQuery.proxy is deprecated to promote standards (specifically Function#bind)\n// However, it is not slated for removal any time soon\n  jQuery.proxy = function( fn, context ) {\n    var tmp, args, proxy;\n\n    if ( typeof context === \"string\" ) {\n      tmp = fn[ context ];\n      context = fn;\n      fn = tmp;\n    }\n\n    // Quick check to determine if target is callable, in the spec\n    // this throws a TypeError, but we will just return undefined.\n    if ( !isFunction( fn ) ) {\n      return undefined;\n    }\n\n    // Simulated bind\n    args = slice.call( arguments, 2 );\n    proxy = function() {\n      return fn.apply( context || this, args.concat( slice.call( arguments ) ) );\n    };\n\n    // Set the guid of unique handler to the same of original handler, so it can be removed\n    proxy.guid = fn.guid = fn.guid || jQuery.guid++;\n\n    return proxy;\n  };\n\n  jQuery.holdReady = function( hold ) {\n    if ( hold ) {\n      jQuery.readyWait++;\n    } else {\n      jQuery.ready( true );\n    }\n  };\n  jQuery.isArray = Array.isArray;\n  jQuery.parseJSON = JSON.parse;\n  jQuery.nodeName = nodeName;\n  jQuery.isFunction = isFunction;\n  jQuery.isWindow = isWindow;\n  jQuery.camelCase = camelCase;\n  jQuery.type = toType;\n\n  jQuery.now = Date.now;\n\n  jQuery.isNumeric = function( obj ) {\n\n    // As of jQuery 3.0, isNumeric is limited to\n    // strings and numbers (primitives or objects)\n    // that can be coerced to finite numbers (gh-2662)\n    var type = jQuery.type( obj );\n    return ( type === \"number\" || type === \"string\" ) &&\n\n      // parseFloat NaNs numeric-cast false positives (\"\")\n      // ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\n      // subtraction forces infinities to NaN\n      !isNaN( obj - parseFloat( obj ) );\n  };\n\n  jQuery.trim = function( text ) {\n    return text == null ?\n      \"\" :\n      ( text + \"\" ).replace( rtrim, \"\" );\n  };\n\n\n\n// Register as a named AMD module, since jQuery can be concatenated with other\n// files that may use define, but not via a proper concatenation script that\n// understands anonymous AMD modules. A named AMD is safest and most robust\n// way to register. Lowercase jquery is used because AMD module names are\n// derived from file names, and jQuery is normally delivered in a lowercase\n// file name. Do this after creating the global so that if an AMD module wants\n// to call noConflict to hide this version of jQuery, it will work.\n\n// Note that for maximum portability, libraries that are not jQuery should\n// declare themselves as anonymous modules, and avoid setting a global if an\n// AMD loader is present. jQuery is a special case. For more information, see\n// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon\n\n  if ( typeof define === \"function\" && define.amd ) {\n    define( \"jquery\", [], function() {\n      return jQuery;\n    } );\n  }\n\n\n\n\n  var\n\n    // Map over jQuery in case of overwrite\n    _jQuery = window.jQuery,\n\n    // Map over the $ in case of overwrite\n    _$ = window.$;\n\n  jQuery.noConflict = function( deep ) {\n    if ( window.$ === jQuery ) {\n      window.$ = _$;\n    }\n\n    if ( deep && window.jQuery === jQuery ) {\n      window.jQuery = _jQuery;\n    }\n\n    return jQuery;\n  };\n\n// Expose jQuery and $ identifiers, even in AMD\n// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)\n// and CommonJS for browser emulators (#13566)\n  if ( typeof noGlobal === \"undefined\" ) {\n    window.jQuery = window.$ = jQuery;\n  }\n\n\n\n\n  return jQuery;\n} );\n"],"mappings":"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"}]}